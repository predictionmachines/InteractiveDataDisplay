(InteractiveDataDisplay=(InteractiveDataDisplay={MinSizeToShow:1,Padding:20,maxTickArrangeIterations:5,tickLength:10,minLabelSpace:60,minTickSpace:5,minLogOrder:4,minNumOrder:8,TooltipDelay:1,TooltipDuration:10,CssPrefix:"",ZIndexNavigationLayer:1e3,ZIndexDOMMarkers:1500,ZIndexTooltipLayer:2e3,MaxInteger:9007199254740991,HeatmapworkerPath:void 0,factory:{}})||{}).Utils={logE10neg:1/Math.log(10),log10:void 0!==Math.log10?Math.log10:function(t){return Math.log(t)*InteractiveDataDisplay.Utils.logE10neg},applyMask:function(t,e,i){for(var a=t.length,r=new Array(i),n=0,o=0;n<a;n++)0===t[n]&&(r[o++]=e[n]);return r},maskNaN:function(t,e){for(var i=t.length;0<=--i;){var a=e[i];a!=a&&(t[i]=1)}},isArray:function(t){return t instanceof Array||t instanceof Float64Array||t instanceof Float32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array},isOrderedArray:function(t){if(t.length<=1)return!0;if(isNaN(t[1]))return!1;if(isNaN(t[2]))return!1;for(var e=t[1]-t[0],i=2;i<t.length;i++){if(e*(t[i]-t[i-1])<0)return!1}return!0},cutArray:function(t,e){if(null==t)return t;if(t.length>e){for(var i=new Array(e),a=0;a<e;a++)i[a]=t[a];return i}return t},intersect:function(t,e){if(t&&e){var i=Math.max(t.x,e.x),a=Math.min(t.x+t.width,e.x+e.width),r=Math.max(t.y,e.y),n=Math.min(t.y+t.height,e.y+e.height);return i<=a&&r<=n?{x:i,y:r,width:a-i,height:n-r}:void 0}},includes:function(t,e){return!(!t||!e)&&(t.x<=e.x&&t.x+t.width>=e.x+e.width&&t.y<=e.y&&t.y+t.height>=e.y+e.height)},equalRect:function(t,e){return!(!t||!e)&&(t.x==e.x&&t.width==e.width&&t.y==e.y&&t.height==e.height)},calcCSWithPadding:function(t,e,i,a){var r={left:i.left,top:i.top,width:e.width-i.left-i.right,height:e.height-i.top-i.bottom};return new InteractiveDataDisplay.CoordinateTransform(t,r,a)},requestAnimationFrame:function(t,e){setTimeout(t,1e3/60,e)},range:function(t,e){var i=e-t+1;if(i<=0)return[];for(var a=new Array(i),r=0;r<i;r++)a[r]=r;return a},arrangeDiv:function(t,e){t.width(e.width),t.height(e.height)},unionRects:function(t,e){if(void 0===t)return void 0===e?void 0:{x:e.x,y:e.y,width:e.width,height:e.height};if(void 0===e)return void 0===t?void 0:{x:t.x,y:t.y,width:t.width,height:t.height};var i=0,a=0;a=isNaN(t.x)&&isNaN(e.x)?i=0:isNaN(t.x)?(i=e.x,e.x+e.width):isNaN(e.x)?(i=t.x,t.x+t.width):(i=Math.min(t.x,e.x),Math.max(t.x+t.width,e.x+e.width));var r=0,n=0;return n=isNaN(t.y)&&isNaN(e.y)?r=0:isNaN(t.y)?(r=e.y,e.y+e.height):isNaN(e.y)?(r=t.y,t.y+t.height):(r=Math.min(t.y,e.y),Math.max(t.y+t.height,e.y+e.height)),{x:i,y:r,width:a-i,height:n-r}},readStyle:function(t,e){var i=t.attr("data-idd-style");if(i){for(var a=i.split(";"),r=a.length,n=0;n<r;n++){var o=a[n].split(":",2);if(o&&2===o.length){var s=o[0].trim(),l=o[1].trim();e[s]=l}}return e}},updateStyle:function(t,e,i,a){(e=(e=InteractiveDataDisplay.Utils.readStyle(t,e))||{})[i]=a;var r="";$.each(e,function(t,e){r+=t+": "+e+"; "}),t.attr("data-idd-style",r)},getDataSourceFunction:function(t,e){var i=t.attr("data-idd-datasource");return"InteractiveDataDisplay.readTable"==i?InteractiveDataDisplay.readTable:"InteractiveDataDisplay.readCsv"==i?InteractiveDataDisplay.readCsv:"InteractiveDataDisplay.readCsv2d"==i?InteractiveDataDisplay.readCsv2d:"InteractiveDataDisplay.readBase64"==i?InteractiveDataDisplay.readBase64:i?function(){return JSON.parse(i,function(t,e){return null===e?NaN:e})}:e},makeNonEqual:function(t){return t.min==t.max?0==t.min?{min:-1,max:1}:0<t.min?{min:.9*t.min,max:1.1*t.min}:{min:1.1*t.min,max:.9*t.min}:t},getMinMax:function(t){if(t&&0!==t.length){for(var e,i,a,r=t.length,n=0;n<r;n++)if((a=t[n])==a){e=i=a;break}for(n++;n<r;n++)(a=t[n])==a&&(a<e?e=a:i<a&&(i=a));return{min:e,max:i}}},getMin:function(t){if(t&&0!==t.length){for(var e,i,a=t.length,r=0;r<a;r++)if((i=t[r])==i){e=i;break}for(r++;r<a;r++)(i=t[r])==i&&i<e&&(e=i);return e}},getMax:function(t){if(t&&0!==t.length){for(var e,i,a=t.length,r=0;r<a;r++)if((i=t[r])==i){e=i;break}for(r++;r<a;r++)(i=t[r])==i&&e<i&&(e=i);return e}},getMinMaxForPair:function(t,e){if(t&&0!==t.length){if(!e||t.length!==e.length)throw"Arrays should be equal";for(var i,a,r,n,o,s,l=t.length,d=0;d<l;d++)if(o=t[d],s=e[d],!isNaN(o)&&!isNaN(s)){i=a=o,r=n=s;break}for(d++;d<l;d++)o=t[d],s=e[d],isNaN(o)||isNaN(s)||(o<i?i=o:a<o&&(a=o),s<r?r=s:n<s&&(n=s));return{minx:i,maxx:a,miny:r,maxy:n}}},enumPlots:function(t){var e=[],i=function(t,e){e.push(t),t.children&&t.children.forEach(function(t){i(t,e)})};return i(t,e),e.sort(function(t,e){return e.order-t.order}),e},reorder:function(t,e,i){t.order=i?e.order:e.order+1;var a=function(t,e){t.order>=e.order&&t!=e&&t.order<InteractiveDataDisplay.MaxInteger&&(t.order+=1),t.children&&t.children.forEach(function(t){a(t,e)})};a(t.master,t)},getMaxOrder:function(t){var i=t&&t.order!=InteractiveDataDisplay.MaxInteger?t.order:0;return t&&t.children&&t.children.forEach(function(t){var e=InteractiveDataDisplay.Utils.getMaxOrder(t);e!=InteractiveDataDisplay.MaxInteger&&(i=Math.max(i,e))}),i},getBoundingBoxForArrays:function(t,e,i,a){var r=void 0;if(t&&e){var n=InteractiveDataDisplay.Utils.getMinMaxForPair(t,e);if(n){i&&(n.minx=i(n.minx),n.maxx=i(n.maxx)),a&&(n.miny=a(n.miny),n.maxy=a(n.maxy));var o=Math.min(n.minx,n.maxx),s=Math.abs(n.maxx-n.minx);r={x:o,y:Math.min(n.miny,n.maxy),width:s,height:Math.abs(n.maxy-n.miny)}}}return r},getIEVersion:function(){var t=window.navigator.userAgent,e=t.indexOf("MSIE");return 0<e?parseInt(t.substring(e+5,t.indexOf(".",e))):navigator.userAgent.match(/Trident\/7\./)?11:0},lastUsedIntId:0,generateNextIntId:function(){return this.lastUsedIntId++},resetLastUsedIntId:function(){return this.lastUsedIntId=0,this.lastUsedIntId},base64toByteArray:function(t){for(var e=atob(t),i=new Array(e.length),a=0;a<e.length;a++)i[a]=e.charCodeAt(a);return new Uint8Array(i)},byteArrayToTypedArray:function(t,e){var i,a=t.buffer;switch(e){case"uint8":return t;case"float32":i=new Float32Array(a);break;case"float64":i=new Float64Array(a);break;case"int16":i=new Int16Array(a);break;case"int32":i=new Int32Array(a);break;default:throw"Unexpected array type: "+e}return i},getArrayToSetLineDash:function(t,e){var i=e;switch(e||(i=1),i=(i=parseInt(i))||1,t){case"dot":t=[i,2*i];break;case"dash":t=[3*i,2*i];break;case"dash dot":t=[3*i,2*i,i,2*i];break;case"long dash":t=[8*i,2*i];break;case"long dash dot":t=[8*i,2*i,i,2*i];break;case"long dash dot dot":t=[8*i,2*i,i,2*i,i,2*i]}for(var a=[],r=0;r<t.length;r+=2)"number"==typeof t[r]&&"number"==typeof t[r+1]&&(a.push(t[r]),a.push(t[r+1]));return a}},(InteractiveDataDisplay=InteractiveDataDisplay||{}).Binding=InteractiveDataDisplay.Binding||{},function(){function c(t,e,i){for(var a=0,r=t.length;a<r;a++){var n=t[a];if(!(n.plot1!==e&&n.plot1!==i||n.plot2!==e&&n.plot2!==i))return a}return-1}function s(t,e){var i=[];e=e.slice(0);for(var a=[t];0<a.length;){var r=a.shift();r!=t&&i.indexOf(r)<0&&i.push(r);for(var n=e.length;0<=--n;){var o=e[n],s=null;o.plot1===r?s=o.plot2:o.plot2===r&&(s=o.plot1),s&&(a.push(s),e.splice(n,1))}}return i}function h(t,e){for(var i=[],a=0,r=t.length;a<r;a++){var n=t[a];i.indexOf(n.plot1)<0&&i.push(n.plot1),i.indexOf(n.plot2)<0&&i.push(n.plot2)}for(e.splice(0),a=0,r=i.length;a<r;a++){var o=s(i[a],t);e.push({plot:i[a],reachable:o})}}var g=[],p=[],f=[],u=[];InteractiveDataDisplay.Binding.bindPlots=function(e,i,t){if(null==t||"vh"==t){var a=InteractiveDataDisplay.Binding.bindPlots(e,i,"v"),r=InteractiveDataDisplay.Binding.bindPlots(e,i,"h"),n=!1;return{destroy:function(){n||(a.destroy(),r.destroy(),n=!0)}}}if("v"!=t&&"h"!=t)throw"Parameter filter is incorrect";if(!e)throw"plot1 is incorrect";if(!i)throw"plot2 is incorrect";if(e=e.master,i=i.master,e===i)throw"plot1 equals plot2";var o="v"==t?p:g,s=c(o,e,i);if(0<=s)return o[s].binding;var l="v"==t?u:f,d=(n=!1,{plot1:e,plot2:i,binding:{destroy:function(){if(!n){var t=c(o,e,i);t&&o.splice(t,1),h(o,l),n=!0}}}});return o.push(d),h(o,l),e.requestUpdateLayout(),d.binding},InteractiveDataDisplay.Binding.getBoundPlots=function(t){for(var e={h:[],v:[]},i=0,a=f.length;i<a;i++)if(f[i].plot===t){e.h=f[i].reachable;break}for(i=0,a=u.length;i<a;i++)if(u[i].plot===t){e.v=u[i].reachable;break}return e}}(),InteractiveDataDisplay.AdaptiveFormatter=function(t,e){function c(t){if(0<=t){for(var e=1,i=0;i<t;i++)e*=10;return e}for(e=1,i=0;i<-t;i++)e*=.1;return e}var i,a,r,n,o,s,l,d=function(t){for(var e=0,i=0,a=0;a<t.length;a++)isNaN(t[a])||(e+=t[a],++i);return 0!=i?e/i:NaN};if(this.getPrintFormat=function(t,e,i){var a=Math.max(Math.abs(t),Math.abs(e));if(a===1/0||i===1/0||i===-1/0||isNaN(a)||isNaN(i))return{toString:function(t){return t}};var r,n=Math.LN10,o=1e-12<a?Math.log(a)/n:0;if((r=1e-12<i?Math.floor(Math.log(i)/n)-2:Math.floor(o-2))<0){var s=Math.floor(o);if(r<=-2&&s<=-4){var l=c(-s),d=s;return{toString:function(t){return 0<d?(t*l).toFixed(-r+s)+"e+"+d:(t*l).toFixed(-r+s)+"e"+d},exponent:s}}return{toString:function(t){return t.toFixed(-r)}}}if(2<=r&&5<o){l=c(-r-2),d=r+2;return{toString:function(t){return 0<d?(t*l).toFixed(2)+"e+"+d:(t*l).toFixed(2)+"e"+d},exponent:r+2}}return{toString:function(t){var e=t.toFixed();return t!=e&&(e+="."),e}}},void 0!==t&&void 0!==e)i=((r=e)-(a=t))/4;else if(void 0!==t&&void 0===e){var h=InteractiveDataDisplay.Utils.getMinMax(t);a=h.min,r=h.max,o=d(n=t),s=n.map(function(t){var e=t-o;return e*e}),l=d(s),i=Math.sqrt(l)}return this.getPrintFormat(a,r,i)},InteractiveDataDisplay.register=function(t,e){if(!t)throw"key is undefined";if(!e)throw"factory is undefined";InteractiveDataDisplay.factory[t]=e};var _initializeInteractiveDataDisplay=function(){"use strict";var t=navigator.userAgent.toLowerCase();0<=t.indexOf("firefox")?InteractiveDataDisplay.CssPrefix="-moz":(0<=t.indexOf("chrome")||0<=t.indexOf("safari"))&&(InteractiveDataDisplay.CssPrefix="-webkit"),window.requestAnimationFrame?InteractiveDataDisplay.Utils.requestAnimationFrame=function(t){return window.requestAnimationFrame(t)}:window.msRequestAnimationFrame?InteractiveDataDisplay.Utils.requestAnimationFrame=function(t){return window.msRequestAnimationFrame(t)}:window.webkitRequestAnimationFrame?InteractiveDataDisplay.Utils.requestAnimationFrame=function(t){return window.webkitRequestAnimationFrame(t)}:window.mozRequestAnimationFrame?InteractiveDataDisplay.Utils.requestAnimationFrame=function(t){return window.mozRequestAnimationFrame(t)}:window.oRequestAnimationFrame&&(InteractiveDataDisplay.Utils.requestAnimationFrame=function(t){return window.oRequestAnimationFrame(t)});var vt=function(t,s){if("undefined"!=typeof Modernizr&&t&&(Modernizr.canvas?Modernizr.borderradius?Modernizr.boxshadow?Modernizr.csstransforms?Modernizr.hsla?Modernizr.rgba||t.replaceWith('<div">Browser does not support rgba colors</div>'):t.replaceWith('<div">Browser does not support hsla colors</div>'):t.replaceWith('<div">Browser does not support 2d css transformations</div>'):t.replaceWith('<div">Browser does not support "box-shadow" style property</div>'):t.replaceWith('<div">Browser does not support "border-radius" style property</div>'):t.replaceWith('<div">Browser does not support HTML5 canvas</div>')),t.hasClass("idd-plot-master")||t.hasClass("idd-plot-dependant"))throw"The div element already is initialized as a plot";var l=void 0,e=t.attr("data-idd-plot");switch(e){case"plot":(l=new InteractiveDataDisplay.Plot(t,s)).order=InteractiveDataDisplay.MaxInteger;break;case"polyline":l=new InteractiveDataDisplay.Polyline(t,s);break;case"dom":(l=new InteractiveDataDisplay.DOMPlot(t,s)).order=InteractiveDataDisplay.MaxInteger;break;case"label":(l=new InteractiveDataDisplay.LabelPlot(t,s)).order=InteractiveDataDisplay.MaxInteger;break;case"figure":l=new InteractiveDataDisplay.Figure(t,s);break;case"chart":l=new InteractiveDataDisplay.Chart(t,s);break;case"grid":l=new InteractiveDataDisplay.GridlinesPlot(t,s);break;case"markers":l=new InteractiveDataDisplay.Markers(t,s);break;case"area":l=new InteractiveDataDisplay.Area(t,s);break;case"bingMaps":l=new InteractiveDataDisplay.BingMapsPlot(t,s);break;case"boundaryLine":l=new InteractiveDataDisplay.BoundaryLinePlot(t,s)}var i=window.MutationObserver||window.WebKitMutationObserver;i?new i(function(t,e){t.forEach(function(t){var e=t.addedNodes,i=t.removedNodes;if(0<e.length)for(var a=0;a<e.length;a++){var r=$(e[a]);if(r.attr("data-idd-plot")){r.removeClass("idd-plot-master").removeClass("idd-plot-dependant");var n=vt(r,s);l.addChild(n),l.assignChildOrder(n)}}if(0<i.length)for(a=0;a<i.length;a++){var o=i[a];if("function"==typeof o.getAttribute)null!=o.getAttribute("data-idd-plot")&&l.removeChild(o.plot)}})}).observe(t[0],{subtree:!1,characterData:!1,attributes:!1,childList:!0,attributeOldValue:!1,characterDataOldValue:!1}):console.warn("MutationObservers are not supported by the browser. DOM changes are not tracked by IDD");if(l)return l;var a=InteractiveDataDisplay.factory[e];if(a)return a(t,s);throw"Unknown plot type"};InteractiveDataDisplay.asPlot=function(t){if(!t)throw"Plot must be attached to div!";var e;if(void 0!==t.tagName&&"div"===t.tagName.toLowerCase())e=$(t);else if("string"==typeof t){if(0===(e=$("#"+t)).length)throw"There is no element with id "+t;t=e[0]}else{if(!(t instanceof jQuery&&t.is("div")))throw"Invalid input parameter! It should be div or id of div or jQuery of single div";t=(e=t)[0]}return void 0!==t.plot?t.plot:vt(e)},InteractiveDataDisplay.tryGetMasterPlot=function(t){if(t&&t.hasClass("idd-plot-master")){var e=t.get(0);return"plot"in e?e.plot:null}return null},InteractiveDataDisplay.updateLayouts=function(t){var e=InteractiveDataDisplay.tryGetMasterPlot(t);if(e)e.updateLayout();else for(var i=t.children(),a=0;a<i.length;a++)InteractiveDataDisplay.updateLayouts(i.eq(a))},InteractiveDataDisplay.Event=InteractiveDataDisplay.Event||{},InteractiveDataDisplay.Event.appearanceChanged=jQuery.Event("appearanceChanged"),InteractiveDataDisplay.Event.childrenChanged=jQuery.Event("childrenChanged"),InteractiveDataDisplay.Event.isAutoFitChanged=jQuery.Event("isAutoFitEnabledChanged"),InteractiveDataDisplay.Event.visibleRectChanged=jQuery.Event("visibleRectChanged"),InteractiveDataDisplay.Event.isVisibleChanged=jQuery.Event("visibleChanged"),InteractiveDataDisplay.Event.plotRemoved=jQuery.Event("plotRemoved"),InteractiveDataDisplay.Event.orderChanged=jQuery.Event("orderChanged"),InteractiveDataDisplay.Event.frameRendered=jQuery.Event("frameRendered");var yt=0;InteractiveDataDisplay.Plot=function(i,e,t){if(!i||!i.hasClass("idd-plot-master")&&!i.hasClass("idd-plot-dependant")){i&&(i[0].addEventListener("touchstart",function(t){t.preventDefault()},!1),i[0].addEventListener("touchmove",function(t){t.preventDefault()},!1));var a,r,n,d,c,h,o,p=void 0===e&&void 0!==i,f=e||this,u=i,s=t||u,g=p?new InteractiveDataDisplay.CoordinateTransform:void 0,l=[],v=!0,y=!1,m=!1,I=!1,D=!1,C=!0,b=!1,w=!1,A=!1,x=!0,T=!1,S="",P=0,k=InteractiveDataDisplay.Padding,M={},G=!1,N=void 0,R=!1,B=$.Deferred();if(i){S=i.attr("data-idd-name")||i.attr("id")||"",i.attr("data-idd-X-log")&&(i.removeAttr("data-idd-X-log"),a=InteractiveDataDisplay.logTransform),i.attr("data-idd-Y-log")&&(i.removeAttr("data-idd-Y-log"),r=InteractiveDataDisplay.logTransform);var V={};InteractiveDataDisplay.Utils.readStyle(i,V),V.hasOwnProperty("padding")&&(k=Number(V.padding)),V.hasOwnProperty("suppress-tooltip-coords")&&((N=N||{}).showCursorCoordinates=Boolean(V["suppress-tooltip-coords"])),V.hasOwnProperty("ignored-by-fit-to-view")&&(m=Boolean(V["ignored-by-fit-to-view"])),V.hasOwnProperty("ignored-by-fit-to-view-x")&&(I=Boolean(V["ignored-by-fit-to-view-x"])),V.hasOwnProperty("ignored-by-fit-to-view-y")&&(D=Boolean(V["ignored-by-fit-to-view-y"])),N=N||{},V.hasOwnProperty("tooltipDelay")?N.tooltipDelay=1e3*Number(V.tooltipDelay):N.tooltipDelay=1e3*InteractiveDataDisplay.TooltipDelay,i[0].plot=this,i.attr("unselectable","on").addClass("unselectable").on("selectstart",!1)}p&&(this._sharedCanvas=void 0);var F=!1;this.requestsRender=!1,this.isInAnimation=!1;var Z=this.isAnimationFrameRequested=!1;p&&(this.requestsUpdateLayout=!1);var L=void 0,z=this,U=yt++,Y=void 0,O=function(t){y!==t&&(y=t,this.onIsVisibleChanged(),this.fireVisibleChanged(this))};Object.defineProperty(this,"instanceId",{get:function(){return U},configurable:!1}),Object.defineProperty(this,"isMaster",{get:function(){return p},configurable:!1}),Object.defineProperty(this,"isRendered",{get:function(){return F},configurable:!1}),Object.defineProperty(this,"flatRendering",{get:function(){return p?T:e.flatRendering},set:function(t){p?T!==t&&(T=t,z.requestUpdateLayout()):e.flatRendering=t}}),Object.defineProperty(this,"isIgnoredByFitToView",{get:function(){return m},set:function(t){m=t,C&&this.requestUpdateLayout()}}),Object.defineProperty(this,"isIgnoredByFitToViewX",{get:function(){return I},set:function(t){I=t,C&&this.requestUpdateLayout()}}),Object.defineProperty(this,"isIgnoredByFitToViewY",{get:function(){return D},set:function(t){D=t,C&&this.requestUpdateLayout()}}),Object.defineProperty(this,"master",{get:function(){return f},configurable:!1}),Object.defineProperty(this,"host",{get:function(){return u},configurable:!1}),Object.defineProperty(this,"centralPart",{get:function(){return s},configurable:!1}),Object.defineProperty(this,"name",{get:function(){return S},set:function(t){S!==t&&(S=t,this.fireAppearanceChanged("name"))},configurable:!1}),Object.defineProperty(this,"children",{get:function(){return l.slice(0)},configurable:!1}),Object.defineProperty(this,"screenSize",{get:function(){return p?{width:d,height:c}:f.screenSize},configurable:!1}),Object.defineProperty(this,"xDataTransform",{get:function(){return a},set:function(t){a=t,this.onDataTransformChanged("x")},configurable:!1}),Object.defineProperty(this,"yDataTransform",{get:function(){return r},set:function(t){r=t,this.onDataTransformChanged("y")},configurable:!1}),Object.defineProperty(this,"coordinateTransform",{get:function(){return p?g.clone():f.coordinateTransform},configurable:!1}),Object.defineProperty(this,"doFitOnDataTransformChanged",{get:function(){return p?x:f.doFitOnDataTransformChanged},set:function(t){p?x=t:f.doFitOnDataTransformChanged=t},configurable:!1}),Object.defineProperty(this,"aspectRatio",{get:function(){return p?n:f.aspectRatio},set:function(t){p?(n=t,this.updateLayout()):f.aspectRatio=t},configurable:!1}),Object.defineProperty(this,"isAutoFitEnabled",{get:function(){return p?C:f.isAutoFitEnabled},set:function(t){if(p){if(C===t)return;if(Y=void 0,"boolean"==typeof t)C=t;else{if("object"!=typeof t)throw"value of the unknown type was assigned to the isAutoFitEnabled property";if(4!=t.length)throw"isAutoFitEnabled property can be assigned by boolean or 4-value object";t[0]=isNaN(Number(t[0]))?"auto":Number(t[0]),t[1]=isNaN(Number(t[1]))?"auto":Number(t[1]),t[2]=isNaN(Number(t[2]))?"auto":Number(t[2]),t[3]=isNaN(Number(t[3]))?"auto":Number(t[3]);for(var e=!0,i=0;i<4;i++)"auto"!=t[i]&&(e=!1);if(e)C=!0;else{var a=!1;for(i=0;i<4;i++)"auto"==t[i]&&(a=!0);if(C=!!a,t[0]>=t[1]&&"auto"!=t[0]&&"auto"!=t[1]){if(isNaN(t[0]))t[0]=t[1]-1;else if(isNaN(t[1]))t[1]=t[0]+1;else if(t[0]==t[1])t[1]=t[0]+1;else{var r=t[0];t[0]=t[1],t[1]=r}console.log("data-idd-visible-region attribute: xmax is less or equal than xmin. It's ["+t[0]+".."+t[1]+"] on x axis now")}if(t[2]>=t[3]&&"auto"!=t[2]&&"auto"!=t[3]){if(isNaN(t[2]))t[2]=t[3]-1;else if(isNaN(t[3]))t[3]=t[2]+1;else if(t[2]==t[3])t[3]=t[2]+1;else{r=t[2];t[2]=t[3],t[3]=r}console.log("data-idd-visible-region attribute: ymax is less or equal than ymin. It's ["+t[2]+".."+t[3]+"] on y axis now")}Y=t}}C||"boolean"!=typeof t?this.requestUpdateLayout():h=z.visibleRect,this.host.trigger(InteractiveDataDisplay.Event.isAutoFitChanged)}else f.isAutoFitEnabled=t},configurable:!1}),Object.defineProperty(this,"isVisible",{get:function(){return v},set:function(t){v!==t&&(v=t,this.onIsVisibleChanged(),this.fireVisibleChanged(this))},configurable:!1}),Object.defineProperty(this,"isErrorVisible",{get:function(){return y},configurable:!0}),Object.defineProperty(this,"order",{get:function(){return P},set:function(t){P!==t&&(P=t,this.fireOrderChanged())},configurable:!1}),Object.defineProperty(this,"padding",{get:function(){return p?k:f.padding},set:function(t){p?(k=t,this.updateLayout()):f.padding=t},configurable:!1}),Object.defineProperty(this,"visibleRect",{get:function(){return p?g.getPlotRect({x:0,y:0,width:d,height:c}):f.visibleRect},configurable:!1});var W=void 0;Object.defineProperty(this,"mapControl",{get:function(){return p?W:f.mapControl},configurable:!1}),Object.defineProperty(this,"tooltipSettings",{get:function(){return p?N:f.tooltipSettings},set:function(t){p?N=t:f.tooltipSettings=t},configurable:!1});var X=!0;Object.defineProperty(this,"isToolTipEnabled",{get:function(){return p?X:f.isToolTipEnabled},set:function(t){p?X=t:f.isToolTipEnabled=t},configurable:!1}),Object.defineProperty(this,"titles",{get:function(){return $.extend({},M)},set:function(t){this.setTitles(t,!1)}}),Object.defineProperty(this,"initialized",{get:function(){return p?B.promise():f.initialized},configurable:!1}),this.selfMapRefresh=function(){if(p){if(void 0!==this.map){if(void 0!==W)throw"Plot composition can have only 1 map!";W=this.map,this.requestUpdateLayout()}if(this.constraint){if(void 0!==L)throw"Plot composition can have only 1 constraint function!";L=this.constraint}}},this.getTitle=function(t){return void 0!==M&&void 0!==M[t]?M[t]:t},this.setTitles=function(t,e){M=t,e||this.fireAppearanceChanged()},this.destroy=function(){this.host.removeClass("idd-plot")},this.remove=function(){void 0!==this.map&&this.master.removeMap(),this.isMaster||this.master.removeChild(this),this.firePlotRemoved(this),this.host.remove()},this.removeMap=function(){p&&(L=W=void 0,this.navigation.animation=new InteractiveDataDisplay.PanZoomAnimation,this.fitToView())},this.addChild=function(t){if(!t)throw"Child plot is undefined";if(t.master&&t.master!==t&&t.master!==this.master)throw"Given child plot already added to another plot";if(t.master!==this.master&&t.onAddedTo(this.master),l.push(t),this.master._sharedCanvas&&(this.master._sharedCanvas.remove(),this.master._sharedCanvas=void 0),t.constraint){if(void 0!==L)throw"Plot composition can have only 1 constraint function!";L=t.constraint}if(void 0!==t.map){if(void 0!==W)throw"Plot composition can have only 1 map!";W=t.map}this.fireChildrenChanged({type:"add",plot:t}),this.requestUpdateLayout()},this.assignChildOrder=function(t){void 0===t.host.attr("data-idd-plot-order")?t.order!=InteractiveDataDisplay.MaxInteger&&(t.order=InteractiveDataDisplay.Utils.getMaxOrder(this.master)+1):(t.order=t.host.attr("data-idd-plot-order"),t.host.removeAttr("data-idd-plot-order")),t.order<InteractiveDataDisplay.MaxInteger&&t.host.css("z-index",t.order)},this.onAddedTo=function(t){p=this===(f=t);for(var e=l.length;0<=--e;)l[e].onAddedTo(t);p?i.addClass("idd-plot-master").removeClass("idd-plot-dependant"):i.removeClass("idd-plot-master").addClass("idd-plot-dependant")},this.removeChild=function(t){if(!t)throw"plot is undefined";for(var e,i=l.length;0<=--i;)if((e=l[i])===t||e.name===t)return l.splice(i,1),e.onAddedTo(e),this.master._sharedCanvas&&(this.master._sharedCanvas.remove(),this.master._sharedCanvas=void 0),void 0!==e.constraint&&(L=void 0),void 0!==e.map&&(W=void 0),this.fireChildrenChanged({type:"remove",plot:e}),this.requestUpdateLayout(),!0;for(i=l.length;0<=--i;)if((e=l[i]).removeChild(t))return!0;return!1},this.getPlotsSequence=function(){for(var e=[z],t=l.length,i=0;i<t;i++){l[i].getPlotsSequence().forEach(function(t){e.push(t)})}return e},this.getLocalBounds=function(t,e){return o=o||this.computeLocalBounds(t,e)},this.computeLocalBounds=function(t,e){},this.invalidateLocalBounds=function(){var t=o;return o=void 0,t},this.aggregateBounds=function(){for(var t=z.getPlotsSequence(),e=void 0,i=[],a=t.length,r=0;r<a;r++){if(!(l=t[r]).isIgnoredByFitToView){var n=l.getLocalBounds(1);if(l.isVisible&&!l.isErrorVisible)if(void 0===n)i.push(l);else{var o={x:n.x,y:n.y,width:n.width,height:n.height};l.isIgnoredByFitToViewX&&(o.x=NaN,o.width=NaN),l.isIgnoredByFitToViewY&&(o.y=NaN,o.height=NaN),e=InteractiveDataDisplay.Utils.unionRects(e,o)}}}a=i.length;var s=e;for(r=0;r<a;r++){var l=i[r];e=InteractiveDataDisplay.Utils.unionRects(e,l.getLocalBounds(2,s))}if(void 0!==e){if(0===e.width){var d=Math.max(.1,Math.abs(e.x));e.x=e.x-d/200,e.width=d/100}if(0===e.height){var c=Math.max(.1,Math.abs(e.y));e.y=e.y-c/200,e.height=c/100}}var h=p&&void 0===e;return h&&(e=void 0!==W?{x:-180,y:-90,width:360,height:180}:{x:0,y:0,width:1,height:1}),{bounds:e,isDefault:h}},this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.aggregatePadding=function(){for(var t=z.getLocalPadding()||{left:0,right:0,top:0,bottom:0},e=l.length,i=0;i<e;i++){var a=l[i].aggregatePadding();t={left:Math.max(t.left,a.left),right:Math.max(t.right,a.right),top:Math.max(t.top,a.top),bottom:Math.max(t.bottom,a.bottom)}}return t.left=t.left+this.padding||this.padding,t.right=t.right+this.padding||this.padding,t.top=t.top+this.padding||this.padding,t.bottom=t.bottom+this.padding||this.padding,t};var E=function(){if(f.flatRendering&&(Z=!0,f._sharedCanvas&&(f._sharedCanvas._dirty=!0)),z.requestsUpdateLayout)z.requestsUpdateLayout=!1,z.isAnimationFrameRequested=!1,Z=!0,z.updateLayout();else{z.isAnimationFrameRequested=!1;var t=z.screenSize,e=z.coordinateTransform.getPlotRect({x:0,y:0,width:t.width,height:t.height});H(Z,f,e,t),z.fireFrameRendered()}Z=!1,dt&&dt()},H=function(t,e,i,a){if(e&&e.isVisible){(t||e.requestsRender)&&(e.requestsRender=!1,e.render(i,a));for(var r=e.children,n=r.length,o=0;o<n;o++){var s=r[o];H(t,s,i,a)}}};this.requestNextFrame=function(t){t=t||this,p?(t.requestsRender=!0,this.isAnimationFrameRequested||(this.isAnimationFrameRequested=!0,Z=!1,InteractiveDataDisplay.Utils.requestAnimationFrame(E))):f.requestNextFrame(t)},this.requestUpdateLayout=function(t){p?(Z=!0,G=t&&t.suppressNotifyBoundPlots,this.requestsUpdateLayout||(t&&t.forceOnlyUpdatePlotsOutput||(this.requestsUpdateLayout=!0),this.isAnimationFrameRequested||(this.isAnimationFrameRequested=!0,InteractiveDataDisplay.Utils.requestAnimationFrame(E)))):f.requestUpdateLayout(t)},this.onIsVisibleChanged=function(){this.updateLayout()},this.onDataTranformChangedCore=function(t){},this.onDataTransformChanged=function(t){o=void 0,this.onDataTranformChangedCore(t),this.isAutoFitEnabled?this.master.requestUpdateLayout():this.doFitOnDataTransformChanged&&this.master.fitToView()},this.render=function(t,e){var i=this.getLocalBounds(),a=!1;i?InteractiveDataDisplay.Utils.intersect(i,t)?(O.call(this,!1),this.renderCore(t,e),a=!0):i.width==i.width&&i.height==i.height&&i.x==i.x&&i.y==i.y&&isFinite(i.width)&&isFinite(i.height)&&isFinite(i.y)&&isFinite(i.x)||O.call(this,!0):(this.renderCore(t,e),a=!0);a!==F&&(F=a,this.onIsRenderedChanged())},this.renderCore=function(t,e){},this.exportToSvg=function(){if(!SVG.supported)throw"SVG is not supported";var t=z.screenSize,e=z.coordinateTransform.getPlotRect({x:0,y:0,width:t.width,height:t.height}),i=document.createElementNS("http://www.w3.org/2000/svg","svg"),a=SVG(i).size(u.width(),u.height());return z.exportContentToSvg(e,t,a),a},this.exportContentToSvg=function(t,e,i){for(var a=InteractiveDataDisplay.Utils.enumPlots(this),r=a.length-1;0<=r;r--)a[r].isVisible&&a[r].renderCoreSvg(t,e,i)},this.exportLegendToSvg=function(t){if(!SVG.supported)throw"SVG is not supported";for(var e,i=z.screenSize,a=(z.coordinateTransform.getPlotRect({x:0,y:0,width:i.width,height:i.height}),document.createElementNS("http://www.w3.org/2000/svg","svg")),r=SVG(a),n=r.group(),o=InteractiveDataDisplay.Utils.enumPlots(this),s={width:170,height:0},l=0,d=0;d<o.length;d++){var c={width:170,height:0};if(null!=o[d].getLegend())if(o[d].isVisible){var h=n.group();t&&(c.legendDiv=t.children[l],l++),o[d].buildSvgLegend(c,h),h.translate(5,s.height),n.clipWith(h.rect(c.width,s.height+30)),s.height+=c.height+10,e=r.line(15,s.height,s.width,s.height).stroke({width:.3,color:"gray"}).back(),s.height+=10}else l++}return null!=e&&e.remove(),r.size(200,s.height+10),n.clipWith(n.rect(180,s.height+10)),r},this.renderCoreSvg=function(t,e,i){},this.buildSvgLegend=function(t,e){},this.onIsRenderedChanged=function(){};var j=function(t,e){var i=t;return"auto"!=e[0]&&(i.width=i.x+i.width-parseFloat(e[0]),i.width<=0&&(i.width=1),i.x=parseFloat(e[0])),"auto"!=e[1]&&(i.width=parseFloat(e[1])-i.x),"auto"!=e[2]&&(i.height=i.y+i.height-parseFloat(e[2]),i.height<=0&&(i.height=1),i.y=parseFloat(e[2])),"auto"!=e[3]&&(i.height=parseFloat(e[3])-i.y),i};this.fit=function(t,e,i){d=t.width,c=t.height;var a=void 0,r=f.aggregateBounds(),n=r.bounds,o=r.isDefault?{left:0,top:0,bottom:0,right:0}:f.aggregatePadding();if(C||b)n.x!=n.x&&(n.x=0),n.y!=n.y&&(n.y=0),n.width!=n.width&&(n.width=1),n.height!=n.height&&(n.height=1),Y&&(n=j(n,Y)),h=n,a=(g=InteractiveDataDisplay.Utils.calcCSWithPadding(h,t,o,f.aspectRatio)).getPlotRect({x:0,y:0,width:t.width,height:t.height}),void 0!==L&&!0===e&&(a=L(a,t,!0),g=new InteractiveDataDisplay.CoordinateTransform(a,{left:0,top:0,width:d,height:c},f.aspectRatio));else if(w||A){var s=void 0,l=void 0;Y&&(h=j(h,Y)),!0===w&&(h.width=n.width,h.x=n.x,s=r.isDefault?{left:0,top:0,right:0,bottom:0}:o),!0===A&&(h.height=n.height,h.y=n.y,l=r.isDefault?{left:0,top:0,right:0,bottom:0}:o),o=!Y||"auto"==Y[0]&&"auto"==Y[1]&&"auto"==Y[2]&&"auto"==Y[3]?{left:s?s.left:0,top:l?l.top:0,right:s?s.right:0,bottom:l?l.bottom:0}:{left:s?s.left:o.left,top:l?l.top:o.top,right:s?s.right:o.right,bottom:l?l.bottom:o.bottom},a=(g=InteractiveDataDisplay.Utils.calcCSWithPadding(h,t,o,f.aspectRatio)).getPlotRect({x:0,y:0,width:t.width,height:t.height}),void 0!==L&&!0===e&&(a=L(a,t,i),g=new InteractiveDataDisplay.CoordinateTransform(a,{left:0,top:0,width:d,height:c},f.aspectRatio)),h=a}else n.x!=n.x&&(n.x=0),n.y!=n.y&&(n.y=0),n.width!=n.width&&(n.width=1),n.height!=n.height&&(n.height=1),Y&&(h=j(h,Y)),a=(g=0===o.left&&0===o.top&&0===o.right&&0===o.bottom||Y?InteractiveDataDisplay.Utils.calcCSWithPadding(h,t,o,f.aspectRatio):new InteractiveDataDisplay.CoordinateTransform(h,{left:0,top:0,width:d,height:c},f.aspectRatio)).getPlotRect({x:0,y:0,width:t.width,height:t.height}),void 0!==L&&!0===e&&(a=L(a,t,i),g=new InteractiveDataDisplay.CoordinateTransform(a,{left:0,top:0,width:d,height:c},f.aspectRatio)),h=a;return e&&(h=a),a},this.updateLayout=function(){if(z.requestsUpdateLayout=!1,p){var t=z.visibleRect,e={width:u.width(),height:u.height()};if(e.width<=1||e.height<=1){var i=z.measure({width:1,height:1});return z.arrange(i),void(R||(B.resolve(),R=!0))}var a=z.screenSize.width!==e.width||z.screenSize.height!==e.height;i=z.measure(e,a);A=w=b=!1,z.arrange(i);var r=z.visibleRect;if(r.x===t.x&&r.y===t.y&&r.width===t.width&&r.height===t.height||(E(),z.fireVisibleRectChanged({visibleRect:r})),Z=!0,E(),!G){var n=InteractiveDataDisplay.Binding.getBoundPlots(z),o=n.h.length,s=n.v.length;if(0<o||0<s){var l=z.coordinateTransform.getPlotRect({x:0,y:0,width:i.width,height:i.height});n.v=n.v.slice(0);for(var d=0;d<o;d++){var c=n.h[d],h=n.v.indexOf(c);if(0<=h)n.v[h]=null,c.navigation.setVisibleRect(l,!1,{suppressNotifyBoundPlots:!0});else(g=c.visibleRect).x=l.x,g.width=l.width,c.navigation.setVisibleRect(g,!1,{suppressNotifyBoundPlots:!0})}for(d=0;d<s;d++){var g;if(null!=(c=n.v[d]))(g=c.visibleRect).y=l.y,g.height=l.height,c.navigation.setVisibleRect(g,!1,{suppressNotifyBoundPlots:!0})}}}G=!1,R||(B.resolve(),R=!0)}else f.updateLayout()},this.measure=function(t,e){return void 0!==this.mapControl&&this.mapControl.setOptions({width:t.width,height:t.height}),this.fit(t,!0,e),u&&u.children("div").each(function(){var t=$(this);t.css("top",0),t.css("left",0)}),t},this.arrange=function(t){this.isMaster||InteractiveDataDisplay.Utils.arrangeDiv(this.host,t);for(var e=this.children,i=e.length,a=0;a<i;a++){e[a].arrange(t)}};var K=function(t,e){z.isAutoFitEnabled&&(z.isAutoFitEnabled=!1),h=t,(Y=void 0)!==e&&void 0!==e.syncUpdate&&!0===e.syncUpdate?z.updateLayout():z.requestUpdateLayout(e)};this.fitToView=function(){p?(this.isAutoFitEnabled=!1,this.navigation.stop(),b=!0,Y=void 0,this.requestUpdateLayout()):f.fitToView()},this.fitToViewX=function(){p?(this.navigation.stop(),w=!0,Y?(Y[0]="auto",Y[1]="auto"):Y=void 0,this.requestUpdateLayout()):f.fitToViewX()},this.fitToViewY=function(){p?(this.navigation.stop(),A=!0,Y?(Y[2]="auto",Y[3]="auto"):Y=void 0,this.requestUpdateLayout()):f.fitToViewY()},this.requestNextFrameOrUpdate=function(){this.isAutoFitEnabled?this.master.requestUpdateLayout():this.master.requestNextFrame(this)},this.getTooltip=function(t,e,i,a){};var Q=function(t,e){for(var i=t.children,a=i.length,r=0;r<a;r++){var n=i[r];Q(n,e)}e(t)};if(i&&i.attr("data-idd-visible-region")){var J=i.attr("data-idd-visible-region").split(" ");if(4!=J.length)throw"data-idd-visible-region must contain exactly 4 numbers (xmin,xmax,ymin,ymax) separated by single space";var q=Number(J[0]),_=Number(J[1]),tt=Number(J[2]),et=Number(J[3]);if(_<q)throw"data-idd-visible-region attribute: xmax is less than xmin";if(et<tt)throw"data-idd-visible-region attribute: ymax is less than ymin";var it=this.xDataTransform&&this.xDataTransform.dataToPlot,at=this.yDataTransform&&this.yDataTransform.dataToPlot,rt=it?it(q):q,nt=it?it(_):_,ot=at?at(tt):tt;K({x:rt,width:nt-rt,y:ot,height:(at?at(et):et)-ot})}if(p){var st,lt,dt;this.enumAll=function(t,e){Q(t,e)};var ct,ht=function(t){t&&(t.fadeOutTimer&&(clearTimeout(t.fadeOutTimer),t.fadeOutTimer=void 0),t.remove(),t=void 0)},gt=function(){st&&(clearTimeout(st),st=void 0),dt=void 0,ht(lt)},pt=function(t,e){st=void 0,gt();function i(){var o,s,l=[],d=e.x,c=e.y;return Q(z,function(t){var e=t.xDataTransform?t.xDataTransform.plotToData(d):d,i=t.yDataTransform?t.yDataTransform.plotToData(c):c,a=t.getTooltip(e,i,d,c);if(a){if(e!==o||i!==s){o=e,s=i;var r=new InteractiveDataDisplay.AdaptiveFormatter(f.visibleRect.x,f.visibleRect.x+f.visibleRect.width),n=new InteractiveDataDisplay.AdaptiveFormatter(f.visibleRect.y,f.visibleRect.y+f.visibleRect.height);void 0!==N&&!1===N.showCursorCoordinates||l.push("<div class='idd-tooltip-coordinates'>"+r.toString(o)+", "+n.toString(s)+"</div>")}l.push(a)}}),l}var a=i();if(0!==a.length){lt=$("<div></div>").addClass("idd-tooltip").hide().appendTo(z.host).css("position","absolute").css("left",t.x+15).css("top",t.y+15).css("z-index",InteractiveDataDisplay.ZIndexTooltipLayer);var r=function(t){for(var e=t.length,i=0;i<e;i++)$(t[i]).appendTo(lt).addClass("idd-tooltip-item")};r(a),dt=function(){if(lt){lt.empty();var t=i();return r(t),t.length}};var n=lt,o=function(){0===N.tooltipDelay?(n.show(),n.fadeOutTimer=setTimeout(l,1e3*InteractiveDataDisplay.TooltipDuration)):n.fadeOutTimer=setTimeout(s,1e3*InteractiveDataDisplay.TooltipDuration)};0===N.tooltipDelay?o():lt.fadeIn("fast",o)}function s(){dt=void 0,n.fadeOut("fast")}function l(){n.fadeOutTimer&&(clearTimeout(n.fadeOutTimer),n.fadeOutTimer=void 0),n.remove(),n=void 0}};s.mousemove(function(t){ct=void 0;var e=InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin(u,t),i=InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin(s,t),a=z.coordinateTransform,r={x:a.screenToPlotX(i.x),y:a.screenToPlotY(i.y)};st&&(clearTimeout(st),st=void 0);var n=lt;z.master.isToolTipEnabled&&(0===N.tooltipDelay?pt(e,r):st=setTimeout(function(){pt(e,r)},N.tooltipDelay)),ht(n);var o=function(t,e,i){t.onMouseMove&&t.onMouseMove(e,i);for(var a=t.children,r=a.length,n=0;n<r;n++)o(a[n],e,i)};o(z,i,r)}),s.mousedown(function(t){gt(),ct=InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin(s,t)}),s.mouseup(function(t){gt();var e=InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin(s,t);if(ct&&ct.x==e.x&&ct.y==e.y){var i=z.coordinateTransform,a={x:i.screenToPlotX(e.x),y:i.screenToPlotY(e.y)},o=function(t,e,i){t.onClick&&t.onClick(e,i);for(var a=t.children,r=a.length,n=0;n<r;n++)o(a[n],e,i)};o(z,e,a)}}),s.mouseleave(function(t){gt()})}else this.enumAll=f.enumAll;var ft=!(this.get=function(t){var o=function(t,e){if(e.name===t||e.host[0].id===t||e.host[0]===t)return e;for(var i=e.children,a=i.length,r=0;r<a;r++){var n=o(t,i[r]);if(n)return n}};return o(t,this.master)});if(this.fireAppearanceChanged=function(t){ft||(ft=!0,setTimeout(function(){z.host.trigger(InteractiveDataDisplay.Event.appearanceChanged,t),ft=!1},20))},this.fireChildrenChanged=function(t){this.host.trigger(InteractiveDataDisplay.Event.childrenChanged,t)},this.fireFrameRendered=function(t){this.host.trigger(InteractiveDataDisplay.Event.frameRendered,t)},this.fireVisibleRectChanged=function(t){gt(),this.master.host.trigger(InteractiveDataDisplay.Event.visibleRectChanged,t)},this.fireVisibleChanged=function(t){this.host.trigger(InteractiveDataDisplay.Event.isVisibleChanged,t)},this.firePlotRemoved=function(t){this.host.trigger(InteractiveDataDisplay.Event.plotRemoved,t),Q(t,function(t){t.host.trigger(InteractiveDataDisplay.Event.plotRemoved,t)})},this.fireOrderChanged=function(t){this.host.trigger(InteractiveDataDisplay.Event.orderChanged,t)},this.polyline=function(t,e){var i=this.get(t);if(!i){var a=$("<div></div>").attr("data-idd-name",t).appendTo(this.host);i=new InteractiveDataDisplay.Polyline(a,this.master),this.addChild(i),this.assignChildOrder(i)}return void 0!==e&&i.draw(e),i},this.markers=function(t,e,i){var a=this.get(t);if(!a){var r=$("<div></div>").attr("data-idd-name",t).appendTo(this.host);a=new InteractiveDataDisplay.Markers(r,this.master),this.addChild(a),this.assignChildOrder(a)}return void 0!==e&&a.draw(e,i),a},this.area=function(t,e){var i=this.get(t);if(!i){var a=$("<div></div>").attr("data-idd-name",t).appendTo(this.host);i=new InteractiveDataDisplay.Area(a,this.master),this.addChild(i),this.assignChildOrder(i)}return void 0!==e&&i.draw(e),i},this.heatmap=function(t,e,i){var a=this.get(t);if(!a){var r=$("<div></div>").attr("data-idd-name",t).appendTo(this.host);a=new InteractiveDataDisplay.Heatmap(r,this.master),this.addChild(a),this.assignChildOrder(a)}return void 0!==e&&a.draw(e,i),a},this.labels=function(t,e){var i=this.get(t);if(!i){var a=$("<div></div>").attr("data-idd-name",t).appendTo(this.host);i=new InteractiveDataDisplay.LabelPlot(a,this.master),this.addChild(i),this.assignChildOrder(i)}return void 0!==e&&i.draw(e),i},this.boundaryLine=function(t,e){var i=this.get(t);if(!i){var a=$("<div></div>").attr("data-idd-name",t).appendTo(this.host);i=new InteractiveDataDisplay.BoundaryLinePlot(a,this.master),this.addChild(i),this.assignChildOrder(i)}return void 0!==e&&i.draw(e),i},p)var ut=new InteractiveDataDisplay.Navigation(this,K);Object.defineProperty(this,"navigation",{get:function(){return p?ut:f.navigation},configurable:!1}),u&&u.children("div").each(function(){var t=$(this);if(!t.hasClass("idd-plot-master")&&!t.hasClass("idd-plot-dependant")&&void 0!==t.attr("data-idd-plot")&&"figure"!==t.attr("data-idd-plot")&&"chart"!==t.attr("data-idd-plot")){var e=vt(t,f);z.addChild(e),z.assignChildOrder(e)}}),this.getLegend=function(){},setTimeout(function(){if(u&&u.attr("data-idd-legend")){var e=$("#"+u.attr("data-idd-legend")),t=new InteractiveDataDisplay.Legend(z,e,!0);Object.defineProperty(z,"legend",{get:function(){return t},configurable:!1}),InteractiveDataDisplay.Gestures.FullEventList.forEach(function(t){e[0].addEventListener(t,function(t){t.stopPropagation()},!1)})}},0),this.updateOrder=function(t,e){if(t&&InteractiveDataDisplay.Utils.reorder(this,t,e),!T)for(var i=InteractiveDataDisplay.Utils.enumPlots(f),a=0;a<i.length;a++)i[a].order<InteractiveDataDisplay.MaxInteger&&i[a].host.css("z-index",i[a].order)},i&&(p?("figure"!==i.attr("data-idd-plot")&&"chart"!==i.attr("data-idd-plot")&&this.updateLayout(),i.addClass("idd-plot-master")):i.addClass("idd-plot-dependant"))}};var C=[];InteractiveDataDisplay.Legend=function(n,s,l,d,t){var c=[],o=[],h=s[0].style,g=this;g.div=s;var r=!0;Object.defineProperty(this,"isVisible",{get:function(){return r},set:function(t){r=t,h.display=r?"block":"none"},configurable:!1}),Object.defineProperty(this,"Host",{get:function(){return s}});var e=t;(void 0===l&&void 0===t||!1===l&&void 0===t)&&(e=!0),l?s.addClass("idd-legend-compact"):s.addClass("idd-legend"),s.addClass("unselectable"),e&&(s.sortable({axis:"y"}),s.on("sortupdate",function(t,e){g.updateIsLegendInduced=!0;var i,a,r=e.item.data("plot");$("li",s).each(function(t,e){if(r==$(e).data("plot"))return a=$(e).prev().data("plot"),i=$(e).next().data("plot"),!1});for(var n=0;n<c.length;++n)if(c[n].plot==r){if(i){for(var o=0;o<c.length;++o)if(c[o].plot==i){r.updateOrder(c[o].plot);break}}else for(o=0;o<c.length;++o)if(c[o].plot==a){r.updateOrder(c[o].plot,!0);break}break}g.updateIsLegendInduced=!1}));function p(t){t.host.bind("visibleChanged",I),t.host.bind("childrenChanged",m),o.push(t)}function f(){for(var t=0;t<o.length;t++){var e=o[t];e.host.unbind("visibleChanged",I),e.host.unbind("childrenChanged",m)}o=[]}function u(){s.empty();for(var t=0,e=c.length;t<e;t++)y(c[t]);f(),c=[];var i=InteractiveDataDisplay.Utils.enumPlots(n);for(t=0;t<i.length;t++){var a=i[i.length-t-1];p(a),D(a)}s[0].hasChildNodes()&&r&&(h.display="block")}function a(t,e){g.updateIsLegendInduced||u()}function v(t,e){n==e&&s.remove()}var y=function(t){for(var e=0;e<C.length;e++)if(C[e]==t){C.splice(e,1);break}},m=function(t,e){if(void 0!==e)if("add"===e.type&&s[0].hasChildNodes()&&e.plot.master==n.master){if(function(t){for(var e=0,i=o.length;e<i;e++)if(o[e]===t)return!0;return!1}(e.plot))return;p(e.plot),D(e.plot)}else if("remove"===e.type){for(var a=function(t){var e=c[t];c.splice(t,1),y(e),e.onLegendRemove&&e.onLegendRemove(),e[0].innerHTML="",l?e.removeClass("idd-legend-item-compact"):e.removeClass("idd-legend-item"),s[0].removeChild(e[0]),e.plot.children.forEach(function(t){for(var e=0,i=c.length;e<i;e++)c[e].plot===t&&a(c[e])}),$(e[0]).css("display","none"),0==c.length&&(h.display="none")},i=0,r=c.length;i<r;i++)if(c[i].plot===e.plot){a(i);break}!function(t){t.host.unbind("visibleChanged",I),t.host.unbind("childrenChanged",m);for(var e=0;e<o.length;e++)o[e]===t&&o.splice(e,1)}(e.plot)}else{for(s[0].innerHTML="",h.display="none",r=c.length,i=0;i<r;i++)y(c[i]),c[i].onLegendRemove&&c[i].onLegendRemove(),c[i][0].innerHTML="",l?c[i].removeClass("idd-legend-item-compact"):c[i].removeClass("idd-legend-item");f(),c=[],u()}},I=function(t,e){for(var i,a,r,n,o=0,s=C.length;o<s;o++)C[o].plot===e&&(i=o,a=e.isVisible,r=e.isErrorVisible,n=void 0,n=C[i],r?(n[0].firstElementChild.lastElementChild.setAttribute("class","idd-legend-isselected-error"),n[0].firstElementChild.lastElementChild.setAttribute("title","The data can not be displayed.")):(n[0].firstElementChild.lastElementChild.setAttribute("title",""),a?n[0].firstElementChild.lastElementChild.setAttribute("class","idd-legend-isselected-false"):n[0].firstElementChild.lastElementChild.setAttribute("class","idd-legend-isselected-true")))},D=function(t){var e,i,a,r=t.getLegend();if(r){var n=l?$("<div class='idd-legend-item-compact'></div>"):$("<li class='idd-legend-item'></li>");l||n.data("plot",t);var o=l?$("<div class='idd-legend-item-title-compact'></div>"):$("<div class='idd-legend-item-title'></div>");r.legend&&r.legend.thumbnail&&(l?r.legend.thumbnail.addClass("idd-legend-item-title-thumb-compact").appendTo(o):r.legend.thumbnail.addClass("idd-legend-item-title-thumb").appendTo(o)),l?r.name.addClass("idd-legend-item-title-name-compact").appendTo(o):r.name.addClass("idd-legend-item-title-name").appendTo(o),e=o,i=t,a=$("<div></div>").addClass("idd-legend-isselected-false").appendTo(e),i.isErrorVisible?(a.attr("class","idd-legend-isselected-error"),a.attr("title","The data can not be displayed.")):(a.attr("title",""),i.isVisible?a.attr("class","idd-legend-isselected-false"):a.attr("class","idd-legend-isselected-true"),a.click(function(t){t.stopPropagation(),i.isErrorVisible||(i.isVisible?(a.attr("class","idd-legend-isselected-true"),i.isVisible=!1):(a.attr("class","idd-legend-isselected-false"),i.isVisible=!0))})),o.appendTo(n),r.legend&&r.legend.content&&(l?r.legend.content.addClass("idd-legend-item-info-compact").appendTo(n):r.legend.content.addClass("idd-legend-item-info").appendTo(n)),d&&$(n).bind("mouseenter",function(){var t=$(this),e=l?t.find(".idd-legend-item-title-name-compact"):t.find(".idd-legend-item-title-name");e[0].offsetWidth<e[0].scrollWidth&&void 0===t.attr("title")&&t.attr("title",e.text())}),n.prependTo(s),n.plot=t,c[c.length]=n,(C[C.length]=n).plot.updateOrder()}};this.remove=function(){for(var t=0,e=c.length;t<e;t++)y(c[t]),c[t].onLegendRemove&&c[t].onLegendRemove(),c[t][0].innerHTML="",l?c[t].removeClass("idd-legend-item-compact"):c[t].removeClass("idd-legend-item");c=[],f();var i=function(t){t.host.unbind("visibleChanged",I),t.children.forEach(function(t){i(t)})};i(n),s[0].innerHTML="",l?s.removeClass("idd-legend-compact"):s.removeClass("idd-legend"),s.removeClass("unselectable"),n.host.unbind("plotRemoved",v),n.host.unbind("orderChanged",a)},n.host.bind("plotRemoved",v),n.host.bind("orderChanged",a),s[0].legend=g,u(),s.dblclick(function(t){t.stopImmediatePropagation()})},InteractiveDataDisplay.CoordinateTransform=function(t,e,i){var a=0,r=0,n=1,o=1;void 0!==t&&void 0!==e&&(n=e.width/t.width,o=e.height/t.height,void 0!==i&&0<i&&(i*o<n?n=i*o:o=n/i),a=e.left-n*t.x,r=e.height+e.top+o*t.y),this.plotToScreenX=function(t){return t*n+a},this.plotToScreenY=function(t){return r-t*o},this.screenToPlotX=function(t){return(t-a)/n},this.screenToPlotY=function(t){return(r-t)/o},this.plotToScreenWidth=function(t){return t*n},this.plotToScreenHeight=function(t){return t*o},this.screenToPlotWidth=function(t){return t/n},this.screenToPlotHeight=function(t){return t/o},this.getPlotRect=function(t){var e=this.screenToPlotX(t.x),i=this.screenToPlotY(t.height+t.y);return{x:e,y:i,width:this.screenToPlotX(t.x+t.width)-e,height:this.screenToPlotY(t.y)-i}},this.getScale=function(){return{x:n,y:o}},this.getOffset=function(){return{x:a,y:r}},this.clone=function(){var t=new InteractiveDataDisplay.CoordinateTransform;return t.plotToScreenX=this.plotToScreenX,t.plotToScreenY=this.plotToScreenY,t.screenToPlotX=this.screenToPlotX,t.screenToPlotY=this.screenToPlotY,t.plotToScreenWidth=this.plotToScreenWidth,t.plotToScreenHeight=this.plotToScreenHeight,t.screenToPlotWidth=this.screenToPlotWidth,t.screenToPlotHeight=this.screenToPlotHeight,t.getPlotRect=this.getPlotRect,t.getScale=this.getScale,t.getOffset=this.getOffset,t}},InteractiveDataDisplay.CanvasPlot=function(t,e){if(this.base=InteractiveDataDisplay.Plot,this.base(t,e),t){var n,r=function(){e._sharedCanvas&&(e._sharedCanvas.remove(),e._sharedCanvas=void 0)};this.getContext=function(t){var e,i=this.master;if(i.flatRendering?(e=i._sharedCanvas,t=i._sharedCanvas._dirty&&t,i._sharedCanvas._dirty=!1):e=n,void 0!==e){var a=e[0].getContext("2d");if(t){var r=this.screenSize;a.clearRect(0,0,r.width,r.height)}return a}},this.destroy=function(){return InteractiveDataDisplay.CanvasPlot.prototype.destroy.call(this),this.host.children(".idd-plot-canvas").remove(),r(),this},this.arrange=function(t){var e;InteractiveDataDisplay.CanvasPlot.prototype.arrange.call(this,t);var i=this.master;i.flatRendering?(i._sharedCanvas?e=i._sharedCanvas:(n?(e=n,n=void 0):e=$("<canvas></canvas>").prependTo(this.host).addClass("idd-plot-canvas"),i._sharedCanvas=e,i._sharedCanvas._dirty=!1),n&&(n.remove(),n=void 0)):(i._sharedCanvas&&r(),e=n=n||$("<canvas></canvas>").prependTo(this.host).addClass("idd-plot-canvas"));var a=e[0];a.width=t.width,a.height=t.height},this.getTransform=function(){var t=this.coordinateTransform,e=t.plotToScreenX,i=t.plotToScreenY,a=this.xDataTransform&&this.xDataTransform.dataToPlot,r=this.yDataTransform&&this.yDataTransform.dataToPlot;return{dataToScreenX:a?function(t){return e(a(t))}:e,dataToScreenY:r?function(t){return i(r(t))}:i,dataToPlotX:a,dataToPlotY:r,plotToScreenX:e,plotToScreenY:i}},this.getScreenToDataTransform=function(){var t=this.coordinateTransform,e=t.screenToPlotX,i=t.screenToPlotY,a=this.xDataTransform&&this.xDataTransform.plotToData,r=this.yDataTransform&&this.yDataTransform.plotToData;return{screenToDataX:a?function(t){return a(e(t))}:e,screenToDataY:r?function(t){return r(i(t))}:i}}}},InteractiveDataDisplay.CanvasPlot.prototype=new InteractiveDataDisplay.Plot,InteractiveDataDisplay.Polyline=function(t,e){var k,M,f,u,v,y,G=this,i=InteractiveDataDisplay.Utils.getDataSourceFunction(t,InteractiveDataDisplay.readCsv)(t);this.base=InteractiveDataDisplay.CanvasPlot,this.base(t,e);var m="blue",I="pink",N=1,R="#4169ed",B="butt",V="miter",F=[];i&&(N=void 0!==i.thickness?i.thickness:N,R=void 0!==i.stroke?i.stroke:R,B=void 0!==i.lineCap?i.lineCap:B,V=void 0!==i.lineJoin?i.lineJoin:V,m=void 0!==i.fill68?i.fill68:m,I=void 0!==i.fill95?i.fill95:I,F=void 0!==i.lineDash?i.lineDash:F),this.draw=function(t){if(!(c=t.y.median?t.y.median:t.y))throw"Data series y is undefined";var e=c.length;if(t.x||(t.x=InteractiveDataDisplay.Utils.range(0,e-1)),e!=t.x.length)throw"Data series x and y have different lengths";k=c,M=t.x;var i=t.y.upper68;if(i&&i.length!==e)throw"Data series y_u68 and y_median have different lengths";var a=t.y.lower68;if(a&&a.length!==e)throw"Data series y_l68 and y_median have different lengths";var r=t.y.upper95;if(r&&r.length!==e)throw"Data series y_u95 and y_median have different lengths";var n=t.y.lower95;if(n&&n.length!==e)throw"Data series y_l95 and y_median have different lengths";f=i,u=a,v=r,y=n;var o=t.treatAs&&"function"==t.treatAs&&!InteractiveDataDisplay.Utils.isOrderedArray(M);if(InteractiveDataDisplay.Utils.isArray(t.y)){if(k=c,o){var s=Math.min(M.length,c.length);if(k=InteractiveDataDisplay.Utils.cutArray(c,s),M=InteractiveDataDisplay.Utils.cutArray(M,s),o){for(var l=[],d=0;d<s;d++)isNaN(M[d])||l.push({x:M[d],y:k[d]});l.sort(function(t,e){return t.x-e.x}),k=[],M=[];for(d=0;d<l.length;d++)k.push(l[d].y),M.push(l[d].x)}}}else{var c=t.y;s=Math.min(M.length,c.median.length);if(c.upper68&&c.lower68&&(s=Math.min(s,Math.min(c.upper68.length,c.lower68.length))),c.upper95&&c.lower95&&(s=Math.min(s,Math.min(c.upper95.length,c.lower95.length))),k=InteractiveDataDisplay.Utils.cutArray(c.median,s),f=InteractiveDataDisplay.Utils.cutArray(c.upper68,s),u=InteractiveDataDisplay.Utils.cutArray(c.lower68,s),v=InteractiveDataDisplay.Utils.cutArray(c.upper95,s),y=InteractiveDataDisplay.Utils.cutArray(c.lower95,s),M=InteractiveDataDisplay.Utils.cutArray(M,s),o){for(l=[],d=0;d<s;d++)isNaN(M[d])||l.push({x:M[d],y:k[d],y_u68:f[d],y_l68:u[d],y_u95:v[d],y_l95:y[d]});l.sort(function(t,e){return t.x-e.x}),k=[],f=[],u=[],v=[],y=[],M=[];for(d=0;d<l.length;d++)k.push(l[d].y),f.push(l[d].y_u68),u.push(l[d].y_l68),v.push(l[d].y_u95),y.push(l[d].y_l95),M.push(l[d].x)}}"number"!=typeof(N=void 0!==t.thickness?t.thickness:N)&&(N=parseFloat(N)||1),R=void 0!==t.stroke?t.stroke:R,B=void 0!==t.lineCap?t.lineCap:B,V=void 0!==t.lineJoin?t.lineJoin:V,m=void 0!==t.fill68?t.fill68:m,I=void 0!==t.fill95?t.fill95:I,F=void 0!==t.lineDash?t.lineDash:F,this.invalidateLocalBounds(),this.requestNextFrameOrUpdate(),this.fireAppearanceChanged()},this.computeLocalBounds=function(t,e){var i=this.xDataTransform&&this.xDataTransform.dataToPlot,a=this.yDataTransform&&this.yDataTransform.dataToPlot,r=InteractiveDataDisplay.Utils.getBoundingBoxForArrays(M,k,i,a),n=InteractiveDataDisplay.Utils.getBoundingBoxForArrays(M,f,i,a),o=InteractiveDataDisplay.Utils.getBoundingBoxForArrays(M,u,i,a),s=InteractiveDataDisplay.Utils.getBoundingBoxForArrays(M,v,i,a),l=InteractiveDataDisplay.Utils.getBoundingBoxForArrays(M,y,i,a);return InteractiveDataDisplay.Utils.unionRects(r,InteractiveDataDisplay.Utils.unionRects(n,InteractiveDataDisplay.Utils.unionRects(o,InteractiveDataDisplay.Utils.unionRects(s,l))))},this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.getTooltip=function(t,e,i,a){if(void 0!==M&&null!=k&&(0!=k.length&&this.isVisible)){var r=this.getContext(!1);if(void 0!==r){for(var n=this.getTransform(),o=n.dataToScreenX(t),s=n.dataToScreenY(e),l=r.getImageData(o-1,s-1,3,3),d=0,c=0;c<l.data.length;c++)0===l.data[c]&&d++;if(d!==l.data.length){var h=$("<div></div>");return $("<div></div>").addClass("idd-tooltip-name").text(this.name||"polyline").appendTo(h),h}}}};this.renderCore=function(t,e){InteractiveDataDisplay.Polyline.prototype.renderCore.call(this,t,e);var i=this.getContext(!0);InteractiveDataDisplay.Area.render.call(this,M,y,v,I,t,e,i,.5),InteractiveDataDisplay.Area.render.call(this,M,u,f,m,t,e,i,.5),function(t,e,i,a,r,n){if(void 0!==t&&null!=e){var o=e.length;if(0!=o){var s,l,d,c,h=G.getTransform(),g=h.dataToScreenX,p=h.dataToScreenY,f=r.width,u=r.height,v=f,y=u;n.globalAlpha=1,n.strokeStyle=i,n.fillStyle=i,n.lineWidth=a,n.lineCap=B,n.lineJoin=V,n.setLineDash(InteractiveDataDisplay.Utils.getArrayToSetLineDash(F,a)),n.beginPath();var m,I,D,C,b,w,A,x,T=0,S=function(){for(;T<o;T++)if(!isNaN(t[T])&&!isNaN(e[T])){s=g(t[T]),d=p(e[T]),m=Z(s,d,0,v,0,y);break}0==m&&n.moveTo(s,d)};S();var P=1;for(T++;T<o;T++){if(isNaN(t[T])||isNaN(e[T]))1==P?(n.stroke(),0==Z(s,d,0,v,0,y)&&(n.beginPath(),n.arc(s,d,a/2,0,2*Math.PI),n.fill())):n.stroke(),n.beginPath(),T++,S(),P=1;else if(A=l=g(t[T]),x=c=p(e[T]),!(Math.abs(s-l)<1&&Math.abs(d-c)<1)){for(D=m,C=I=Z(l,c,0,v,0,y);m|I&&!(m&I);)b=l-s,w=c-d,m?(s<0?(d+=w*(0-s)/b,s=0):v<s?(d+=w*(v-s)/b,s=v):d<0?(s+=b*(0-d)/w,d=0):y<d&&(s+=b*(y-d)/w,d=y),m=Z(s,d,0,v,0,y)):(l<0?(c+=w*(0-l)/b,l=0):v<l?(c+=w*(v-l)/b,l=v):c<0?(l+=b*(0-c)/w,c=0):y<c&&(l+=b*(y-c)/w,c=y),I=Z(l,c,0,v,0,y));m&I||(0!=D&&n.moveTo(s,d),n.lineTo(l,c),P++),s=A,d=x,m=C}}if(1==P)n.stroke(),0==Z(s,d,0,v,0,y)&&(n.beginPath(),n.arc(s,d,a/2,0,2*Math.PI),n.fill());else n.stroke()}}}(M,k,R,N,e,i)};this.renderCoreSvg=function(t,e,i){InteractiveDataDisplay.Area.renderSvg.call(this,t,e,i,M,y,v,I),InteractiveDataDisplay.Area.renderSvg.call(this,t,e,i,M,u,f,m),function(t,e){if(void 0!==M&&null!=k){var i=k.length;if(0!=i){var a,r,n,o,s,l,d,c,h,g,p,f,u,v=G.getTransform(),y=v.dataToScreenX,m=v.dataToScreenY,I=t.width,D=t.height,C=I,b=D,w=0,A=InteractiveDataDisplay.ColorPalette.colorFromString(R),x="rgb("+A.r+","+A.g+","+A.b+")",T=function(){e.polyline(s).style({fill:"none",stroke:x,"stroke-width":N,"stroke-opacity":A.a,"stroke-linecap":B}).attr("stroke-dasharray",InteractiveDataDisplay.Utils.getArrayToSetLineDash(F,N)).attr("stroke-linejoin",V)},S=function(){for(s=new Array(0);w<i;w++)if(!isNaN(M[w])&&!isNaN(k[w])){a=y(M[w]),n=m(k[w]),l=Z(a,n,0,C,0,b);break}0==l&&s.push([a,n])};S();var P=1;for(w++;w<i;w++){if(isNaN(M[w])||isNaN(k[w]))1==P?(T(),0==Z(a,n,0,C,0,b)&&(context.beginPath(),context.arc(a,n,N/2,0,2*Math.PI),context.fill())):T(),w++,S(),P=1;else if(f=r=y(M[w]),u=o=m(k[w]),!(Math.abs(a-r)<1&&Math.abs(n-o)<1)){for(c=l,h=d=Z(r,o,0,C,0,b);l|d&&!(l&d);)g=r-a,p=o-n,l?(a<0?(n+=p*(0-a)/g,a=0):C<a?(n+=p*(C-a)/g,a=C):n<0?(a+=g*(0-n)/p,n=0):b<n&&(a+=g*(b-n)/p,n=b),l=Z(a,n,0,C,0,b)):(r<0?(o+=p*(0-r)/g,r=0):C<r?(o+=p*(C-r)/g,r=C):o<0?(r+=g*(0-o)/p,o=0):b<o&&(r+=g*(b-o)/p,o=b),d=Z(r,o,0,C,0,b));l&d||(0!=c&&(T(),(s=new Array(0)).push([a,n])),s.push([r,o]),P++),a=f,n=u,l=h}}if(1==P)T(),0==Z(a,n,0,C,0,b)&&e.circle(N).translate(a,n).fill(x).opacity(A.a);else T()}}}(e,i)};var Z=function(t,e,i,a,r,n){return(t<i)<<3|(a<t)<<2|(e<r)<<1|n<e};this.onDataTransformChanged=function(t){this.invalidateLocalBounds(),InteractiveDataDisplay.Polyline.prototype.onDataTransformChanged.call(this,t)},Object.defineProperty(this,"thickness",{get:function(){return N},set:function(t){if(t!=N){if(t<=0)throw"Polyline thickness must be positive";N=t,this.fireAppearanceChanged("thickness"),this.requestNextFrameOrUpdate()}},configurable:!1}),Object.defineProperty(this,"stroke",{get:function(){return R},set:function(t){t!=R&&(R=t,this.fireAppearanceChanged("stroke"),this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"lineCap",{get:function(){return B},set:function(t){t!=B&&(B=t,this.fireAppearanceChanged("lineCap"),this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"lineJoin",{get:function(){return V},set:function(t){t!=V&&(V=t,this.fireAppearanceChanged("lineJoin"),this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"fill68",{get:function(){return m},set:function(t){t!=m&&(m=t,this.fireAppearanceChanged("fill68"),this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"fill95",{get:function(){return I},set:function(t){t!=I&&(I=t,this.fireAppearanceChanged("fill95"),this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"lineDash",{get:function(){return F},set:function(t){t!=F&&(F=t,this.fireAppearanceChanged("lineDash"),this.requestNextFrameOrUpdate())},configurable:!1}),this.getLegend=function(){var a=$("<canvas></canvas>");a[0].width=40,a[0].height=40;var r=a.get(0).getContext("2d"),t=null!=f&&null!=u;null!=v&&null!=y&&(r.globalAlpha=.5,r.strokeStyle=I,r.fillStyle=I,r.beginPath(),r.moveTo(0,0),r.lineTo(0,20),r.lineTo(20,40),r.lineTo(40,40),r.lineTo(40,20),r.lineTo(20,0),r.lineTo(0,0),r.fill(),r.stroke(),r.closePath()),t&&(r.globalAlpha=.5,r.strokeStyle=m,r.fillStyle=m,r.beginPath(),r.moveTo(0,0),r.lineTo(0,10),r.lineTo(30,40),r.lineTo(40,40),r.lineTo(40,30),r.lineTo(10,0),r.lineTo(0,0),r.fill(),r.stroke(),r.closePath()),r.strokeStyle=R,r.lineWidth=N,r.setLineDash(InteractiveDataDisplay.Utils.getArrayToSetLineDash(F,N)),r.moveTo(0,0),r.lineTo(40,40),r.stroke();function n(){i.text(e.name)}var e=this,i=$("<span></span>");n(),this.host.bind("appearanceChanged",function(t,e){e&&"name"!=e||n(),r.clearRect(0,0,a[0].width,a[0].height);var i=null!=f&&null!=u;null!=v&&null!=y&&(r.globalAlpha=.5,r.strokeStyle=I,r.fillStyle=I,r.beginPath(),r.moveTo(0,0),r.lineTo(0,20),r.lineTo(20,40),r.lineTo(40,40),r.lineTo(40,20),r.lineTo(20,0),r.lineTo(0,0),r.fill(),r.stroke(),r.closePath()),i&&(r.globalAlpha=.5,r.strokeStyle=m,r.fillStyle=m,r.beginPath(),r.moveTo(0,0),r.lineTo(0,10),r.lineTo(30,40),r.lineTo(40,40),r.lineTo(40,30),r.lineTo(10,0),r.lineTo(0,0),r.fill(),r.stroke(),r.closePath()),r.setLineDash(InteractiveDataDisplay.Utils.getArrayToSetLineDash(F,N)),r.strokeStyle=R,r.lineWidth=N,r.moveTo(0,0),r.lineTo(40,40),r.stroke()});e=this;return{name:i,legend:{thumbnail:a,content:void 0},onLegendRemove:function(){e.host.unbind("appearanceChanged")}}},this.buildSvgLegend=function(t,e){t.height=30,e.add(e.rect(t.width,t.height).fill("white").opacity(.5));var i=null!=v&&null!=y,a=null!=f&&null!=u,r=InteractiveDataDisplay.ColorPalette.colorFromString(R),n="rgb("+r.r+","+r.g+","+r.b+")",o=InteractiveDataDisplay.ColorPalette.colorFromString(I),s="rgb("+o.r+","+o.g+","+o.b+")",l=InteractiveDataDisplay.ColorPalette.colorFromString(m),d="rgb("+l.r+","+l.g+","+l.b+")";i&&e.add(e.polyline([[0,0],[0,9],[9,18],[18,18],[18,9],[9,0],[0,0]]).fill(s).opacity(o.a).translate(5,5)),a&&e.add(e.polyline([[0,0],[0,4.5],[13.5,18],[18,18],[18,13.5],[4.5,0],[0,0]]).fill(d).opacity(l.a).translate(5,5)),e.add(e.line(0,0,18,18).stroke({width:N,color:n}).translate(5,5).attr("stroke-dasharray",InteractiveDataDisplay.Utils.getArrayToSetLineDash(F,N)));var c=window.getComputedStyle(t.legendDiv.children[0].children[1],null),h=parseFloat(c.getPropertyValue("font-size")),g=c.getPropertyValue("font-family"),p=c?c.getPropertyValue("font-weight"):void 0;e.add(e.text(this.name).font({family:g,size:h,weight:p}).translate(40,0)),e.front()},i&&void 0!==i.y&&this.draw(i)},InteractiveDataDisplay.Polyline.prototype=new InteractiveDataDisplay.CanvasPlot;var h=jQuery.Event("plotClick");InteractiveDataDisplay.DOMPlot=function(t,e){this.base=InteractiveDataDisplay.Plot,this.base(t,e);function p(i,t,e,a,r,n,o,s){if("div"!==i[0].tagName.toLowerCase())throw"DOMPlot supports only DIV elements";function l(t){var e=c.coordinateTransform.screenToPlotX,i=c.coordinateTransform.screenToPlotY,a=c.xDataTransform&&c.xDataTransform.plotToData,r=c.yDataTransform&&c.yDataTransform.plotToData,n=a?function(t){return a(e(t))}:e,o=r?function(t){return r(i(t))}:i,s=t.position();t._left=s.left+t._originX*t.width(),t._top=s.top+t._originY*t.height(),t._x=n(s.left+t._originX*t.width()),t._y=o(s.top+t._originY*t.height())}i._x=e,i._y=a,i._width=r&&0<r?r:1,i._height=n&&0<n?n:1,i._originX=o||0,i._originY=s||0,i._scale=t||"element",i.on("drag",function(t,e){l(i)}),i.on("dragstop",function(t,e){l(i),c.invalidateLocalBounds(),c.requestUpdateLayout()}),i.addClass("idd-dom-marker"),i.css("display","none").css("z-index",InteractiveDataDisplay.ZIndexDOMMarkers),x.push(i)}var x=[],c=this;t.children("div[data-idd-position]").each(function(){var t=$(this),e=t.attr("data-idd-position").split(/\s+/g);if(e.length<2)throw"Position of the DOM marker should define x and y";var i,a,r,n,o=parseFloat(e[0]),s=parseFloat(e[1]),l=t.attr("data-idd-size");if(l){var d=l.split(/\s+/g);2<=d.length&&(i=parseFloat(d[0]),a=parseFloat(d[1]))}var c=t.attr("data-idd-origin");if(c){var h=c.split(/\s+/g);2<=h.length&&(r=parseFloat(h[0]),n=parseFloat(h[1]))}var g=t.attr("data-idd-scale");p(t,g,o,s,i,a,r,n)});function T(t){return{left:t._x-t._originX*t._width,top:t._y+t._originY*t._height}}this.computeLocalBounds=function(){var t;if(x){var e=x.length;if(0<e){for(var i=[],a=[],r=0,n=0;r<e;r++,n++){var o=x[r];if("none"!=o._scale){var s=T(o);i[n]=s.left,a[n]=s.top,i[++n]=s.left+o._width,a[n]=s.top-o._height}}var l=InteractiveDataDisplay.Utils.getMinMax(i),d=InteractiveDataDisplay.Utils.getMinMax(a);if(l&&d){var c=this.xDataTransform&&this.xDataTransform.dataToPlot,h=this.yDataTransform&&this.yDataTransform.dataToPlot;c&&(l.min=c(l.min),l.max=c(l.max)),h&&(d.min=h(d.min),d.max=h(d.max)),t={x:l.min,y:d.min,width:l.max-l.min,height:d.max-d.min}}}}return t},this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.arrange=function(t){InteractiveDataDisplay.CanvasPlot.prototype.arrange.call(this,t);var e=t.width,i=t.height;this.host.css("clip","rect(0px,"+e+"px,"+i+"px,0px)")},this.renderCore=function(t,e){InteractiveDataDisplay.DOMPlot.prototype.renderCore.call(this,t,e);var i=x.length;if(0<i)for(var a=e.height,r=e.width,n=this.coordinateTransform.plotToScreenX,o=this.coordinateTransform.plotToScreenY,s=this.xDataTransform&&this.xDataTransform.dataToPlot,l=this.yDataTransform&&this.yDataTransform.dataToPlot,d=s?function(t){return n(s(t))}:n,c=l?function(t){return o(l(t))}:o,h=0;h<i;h++){var g,p,f,u=x[h];if("none"==u._scale)p={x:u.width(),y:u.height()},g={x:(g={x:d(u._x),y:c(u._y)}).x-u._originX*p.x,y:g.y-u._originY*p.y};else g={x:d((f=T(u)).left),y:c(f.top)},p={x:d(f.left+u._width)-g.x,y:c(f.top-u._height)-g.y};p.y,p.x;var v,y=0,m=a,I=g.y,D=g.y+p.y,C=Math.max(y,I),b=Math.min(m,D);if((v=C<b)&&(g.y,g.y,y=0,m=r,I=g.x,D=g.x+p.x,v=(C=Math.max(y,I))<(b=Math.min(m,D))))if(g.x,g.x,u.css("left",g.x+"px"),u.css("top",g.y+"px"),u.css("display","block"),"content"===u._scale){var w=p.x/u.width(),A=p.y/u.height();u.css(InteractiveDataDisplay.CssPrefix+"-transform-origin","0% 0%"),u.css(InteractiveDataDisplay.CssPrefix+"-transform","scale("+w+","+A+")")}else"element"===u._scale&&(u.css("width",p.x+"px"),u.css("height",p.y+"px"));v||u.css("display","none")}},this.onIsRenderedChanged=function(){if(this.isRendered)for(t=x.length,e=0;e<t;e++){x[e].css("z-index",InteractiveDataDisplay.ZIndexDOMMarkers)}else for(var t=x.length,e=0;e<t;e++){x[e].css("display","none")}},this.clear=function(){for(var t=x.length,e=0;e<t;e++){x[e].remove()}x=[],this.invalidateLocalBounds(),this.requestUpdateLayout()},this.add=function(t,e,i,a,r,n,o,s){var l=$(t);return this.host[0].contains(l[0])||l.appendTo(this.host),p(l,e,i,a,r,n,o,s),this.invalidateLocalBounds(),this.requestUpdateLayout(),l.get(0)};function l(e){var t=jQuery.grep(x,function(t){return t[0]===e});if(t&&0<t.length)return t[0]}this.remove=function(t){function e(t){var e=l(t[0]);e&&x.splice(x.indexOf(e),1),t.remove()}t.jquery?e(t):e($(t)),this.invalidateLocalBounds(),this.requestUpdateLayout()},this.set=function(t,e,i,a,r,n,o){var s=l(t);if(!s)throw"Element is not found in the plot";s._x=e,s._y=i,"none"!=s.scale&&(a&&0<a&&(s._width=a),r&&0<r&&(s._height=r)),s._originX=n||s._originX,s._originY=o||s._originY,this.invalidateLocalBounds(),this.requestUpdateLayout()},this.enableClickablePanel=!1,c.master.centralPart.click(function(t){if(c.enableClickablePanel){var e=c.coordinateTransform.screenToPlotX,i=c.coordinateTransform.screenToPlotY,a=c.xDataTransform&&c.xDataTransform.plotToData,r=c.yDataTransform&&c.yDataTransform.plotToData,n=a?function(t){return a(e(t))}:e,o=r?function(t){return r(i(t))}:i,s=InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin(c.master.centralPart,t),l=n(s.x),d=o(s.y);c.host.trigger(h,{x:l,y:d})}}),Object.defineProperty(this,"domElements",{get:function(){return x.slice(0)},configurable:!1})},InteractiveDataDisplay.DOMPlot.prototype=new InteractiveDataDisplay.Plot,InteractiveDataDisplay.GridlinesPlot=function(t,e){var l,d;this.base=InteractiveDataDisplay.CanvasPlot,this.base(t,e);var c="1px",h="LightGray",i={};InteractiveDataDisplay.Utils.readStyle(this.host,i),h=void 0!==i.stroke?i.stroke:h,c=void 0!==i.thickness?i.thickness:c,Object.defineProperty(this,"xAxis",{get:function(){return l},set:function(t){t!=l&&(l=t,this.requestUpdateLayout())},configurable:!1}),Object.defineProperty(this,"yAxis",{get:function(){return d},set:function(t){t!=d&&(d=t,this.requestUpdateLayout())},configurable:!1}),Object.defineProperty(this,"thickness",{get:function(){return c},set:function(t){if(t!=c){if(t<=0)throw"GridLines thickness must be positive";c=t,this.requestNextFrameOrUpdate()}},configurable:!1}),Object.defineProperty(this,"stroke",{get:function(){return h},set:function(t){t!=h&&(h=t,this.requestNextFrameOrUpdate())},configurable:!1});function g(){var t,e;l||(t=this.host.attr("data-idd-xaxis"))&&(e=this.master.get(t))&&(l=e),d||(t=this.host.attr("data-idd-yaxis"))&&(e=this.master.get(t))&&(d=e)}this.renderCore=function(t,e){InteractiveDataDisplay.GridlinesPlot.prototype.renderCore.call(this,t,e),g.call(this);var i=this.getContext(!0);i.strokeStyle=h,i.fillStyle=h,i.lineWidth=1;var a,r=parseInt(c.slice(0,-2)),n=[];l&&(n=l.ticks);for(var o=0,s=n.length;o<s;o++)n[o].invisible||(a=l.getCoordinateFromTick(n[o].position),i.fillRect(a,0,r,e.height));n=[],d&&(n=d.ticks);for(o=0,s=n.length;o<s;o++)n[o].invisible||(a=e.height-1-d.getCoordinateFromTick(n[o].position),i.fillRect(0,a,e.width,r))},this.renderCoreSvg=function(t,e,i){g.call(this);var a,r={width:parseInt(c.slice(0,-2)),color:h},n=[];l&&(n=l.ticks);for(var o=0,s=n.length;o<s;o++)if(!n[o].invisible){if((a=l.getCoordinateFromTick(n[o].position))<0||a>e.width)continue;i.polyline([[a,0],[a,e.height-1]]).stroke(r).fill("none")}n=[],d&&(n=d.ticks);for(o=0,s=n.length;o<s;o++)if(!n[o].invisible){if((a=e.height-1-d.getCoordinateFromTick(n[o].position))<0||a>e.height)continue;i.polyline([[0,a],[e.width-1,a]]).stroke(r).fill("none")}}},InteractiveDataDisplay.GridlinesPlot.prototype=new InteractiveDataDisplay.CanvasPlot,InteractiveDataDisplay.BoundaryLinePlot=function(t,e){var d,c,h=this;this.base=InteractiveDataDisplay.CanvasPlot,this.base(t,e);var g="1px",p="Gray",f="";if(void 0===d&&void 0===c){var i=InteractiveDataDisplay.Utils.getDataSourceFunction(t,InteractiveDataDisplay.readCsv)(t);i&&(i.x?d=i.x:i.y&&(c=i.y),i.thickness&&(g=i.thickness),i.stroke&&(p=i.stroke),i.lineDash&&(f=i.lineDash))}var a={};InteractiveDataDisplay.Utils.readStyle(this.host,a),p=void 0!==a.stroke?a.stroke:p,g=void 0!==a.thickness?a.thickness:g,Object.defineProperty(this,"x",{get:function(){return d},set:function(t){t!=d&&(d=t,this.requestUpdateLayout())},configurable:!1}),Object.defineProperty(this,"y",{get:function(){return c},set:function(t){t!=c&&(c=t,this.requestUpdateLayout())},configurable:!1}),Object.defineProperty(this,"thickness",{get:function(){return g},set:function(t){if(t!=g){if(t<=0)throw"Boundary line thickness must be positive";g=t,this.requestNextFrameOrUpdate()}},configurable:!1}),Object.defineProperty(this,"stroke",{get:function(){return p},set:function(t){t!=p&&(p=t,this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"lineDash",{get:function(){return f},set:function(t){t!=f&&(f=t,this.requestNextFrameOrUpdate())},configurable:!1}),this.renderCore=function(t,e){InteractiveDataDisplay.BoundaryLinePlot.prototype.renderCore.call(this,t,e);var i=this.getContext(!0);i.strokeStyle=p,i.fillStyle=p,i.setLineDash(InteractiveDataDisplay.Utils.getArrayToSetLineDash(f,g)),i.lineWidth=parseInt(g);var a=h.getTransform(),r=a.dataToScreenX,n=a.dataToScreenY;if(i.font="10px serif",void 0!==d){var o=r(d);parseInt(g)%2&&(o+=.5),i.beginPath(),i.moveTo(o,0),i.lineTo(o,e.height),i.stroke(),i.translate(o-3,e.height-10),i.rotate(-Math.PI/2),this.name?i.fillText(this.name,0,0):i.fillText("x = "+d,0,0),i.rotate(Math.PI/2),i.translate(3-o,10-e.height)}if(void 0!==c){var s=n(c);parseInt(g)%2&&(s+=.5),i.beginPath(),i.moveTo(0,s),i.lineTo(e.width,s),i.stroke(),this.name?i.fillText(this.name,10,s-3):i.fillText("y = "+c,10,s-3)}},this.renderCoreSvg=function(t,e,i){var a=h.getTransform(),r=a.dataToScreenX,n=a.dataToScreenY,o={width:parseInt(g),color:p};if(void 0!==d){var s=r(d);0<s&&s<e.width&&(i.polyline([[s,0],[s,e.height-1]]).stroke(o).attr("stroke-dasharray",InteractiveDataDisplay.Utils.getArrayToSetLineDash(f,parseInt(g))).fill("none"),this.name?i.text(this.name,0,0).rotate(-90,0,0).translate(s-16,e.height-10).font({family:"serif",size:10,fill:p}):i.text("x = "+d,0,0).rotate(-90,0,0).translate(s-16,e.height-10).font({family:"serif",size:10,fill:p}))}if(void 0!==c){var l=n(c);0<l&&l<e.height&&(i.polyline([[0,l],[e.width-1,l]]).stroke(o).attr("stroke-dasharray",InteractiveDataDisplay.Utils.getArrayToSetLineDash(f,parseInt(g))).fill("none"),this.name?i.text(this.name).transform({x:10}).transform({y:l-18},!0).font({family:"serif",size:10,fill:p}):i.text("y = "+c).transform({x:10}).transform({y:l-18},!0).font({family:"serif",size:10,fill:p}))}},this.draw=function(t){void 0!==t.x&&(this.x=t.x),void 0!==t.y&&(this.y=t.y),void 0!==t.thickness&&(this.thickness=t.thickness),void 0!==t.stroke&&(this.stroke=t.stroke),this.invalidateLocalBounds(),this.requestNextFrameOrUpdate(),this.fireAppearanceChanged()}},InteractiveDataDisplay.BoundaryLinePlot.prototype=new InteractiveDataDisplay.CanvasPlot}();(InteractiveDataDisplay=InteractiveDataDisplay||{}).SubplotsTrapPlot=function(t,e){if(this.base=InteractiveDataDisplay.Plot,this.base(t,e),t){this.renderCallback=function(t){},this.suppressRenderCallback=!1,this.renderCore=function(t,e){if(InteractiveDataDisplay.SubplotsTrapPlot.prototype.renderCore.call(this,t,e),!this.suppressRenderCallback){var i=this.xDataTransform&&this.xDataTransform.plotToData?this.xDataTransform.plotToData:function(t){return t},a=this.yDataTransform&&this.yDataTransform.plotToData?this.yDataTransform.plotToData:function(t){return t},r=i(t.x),n=i(t.x+t.width),o=a(t.y),s=a(t.y+t.height),l={x_min:n<r?n:r,x_max:n<r?r:n,y_min:s<o?s:o,y_max:s<o?o:s};this.renderCallback(l)}},this.renderCoreSvg=function(t,e,i){}}},InteractiveDataDisplay.factory["subplots-trap"]=function(t,e){return new InteractiveDataDisplay.SubplotsTrapPlot(t,e)},InteractiveDataDisplay.SubplotsTrapPlot.prototype=new InteractiveDataDisplay.Plot,InteractiveDataDisplay.SubPlots=function(t){if(!t)throw"SubPlots must be applied to <div> element";if(1!==t.children.length&&2!==t.children.length)throw"SubPlots div must contain one or two child elements: optional element div (subplots title) and mandatory element table";var e=$(t).children().last()[0];if(!e)throw"SubPlots div should contain at least one <div> element";if(1!==e.children.length)throw"SubPlots child div must contain exactly one child element which is a <table>";var i=e.children[0];if(!i||"TABLE"!=i.nodeName)throw"SubPlots child div must contain exactly one child element which is a <table>";var R=e,B=i,V=t;if($(V).css("flex-direction","column"),$(R).addClass("idd-subplots-legendholder"),2===t.children.length){var a=$(t).children()[0];$(a).addClass("idd-subplots-title")}var F=0,Z=[],L=[],z=[],U=[],Y=[],O=[],W=[],X=void 0,E=void 0,H=$(R).attr("data-idd-horizontal-binding"),j=$(R).attr("data-idd-vertical-binding");H=void 0!==H&&("true"===H||"enabled"===H),j=void 0!==j&&("true"===j||"enabled"===j);var K=this;this.renderSVG=function(){for(var t="div[data-idd-plot='plot']",e="div[data-idd-axis]",i="div.idd-subplot-title",a="div.idd-horizontalTitle",r="div.idd-verticalTitle",n="div.idd-legend",o="div.idd-subplots-title",s=$(V).find(t+", "+e+", "+i+", "+a+", "+r+", "+n+", "+o),l=[],d=document.createElementNS("http://www.w3.org/2000/svg","svg"),c=SVG(d).size($(V).width(),$(V).height()),h=c.nested(),g=[],p=[],f=$(V).offset(),u=0;u<s.length;u++){g[u]=$(s[u]).offset().left-f.left,p[u]=$(s[u]).offset().top-f.top+1;var v=$(s[u]);if(v.is(i+", "+a+", "+r+", "+o)){var y=c.text(s[u].innerText);if(l[u]=y.font({family:$(s[u]).css("font-family"),size:$(s[u]).css("font-size"),weight:$(s[u]).css("font-weight")}),v.is(r))switch($(s[u]).css("vertical-align")){case"top":l[u].move(g[u],p[u]);break;case"bottom":l[u].move(g[u],p[u]+$(s[u]).height()-l[u].bbox().w),l[u].rotate(-90,g[u],p[u]+$(s[u]).height()-l[u].bbox().w);break;default:l[u].move(g[u],p[u]+$(s[u]).height()/2+l[u].bbox().w/2),l[u].rotate(-90,g[u],p[u]+$(s[u]).height()/2+l[u].bbox().w/2)}else switch($(s[u]).css("text-align")){case"left":l[u].move(g[u],p[u]);break;case"right":l[u].move(g[u]+$(s[u]).width()-l[u].bbox().w,p[u]);break;default:l[u].move(g[u]+$(s[u]).width()/2-l[u].bbox().w/2,p[u])}}else{if(v.is(t)){var m=$(s[u]).parent().width(),I=$(s[u]).parent().height(),D=c.polyline("0,0 "+m+",0 "+m+","+I+" 0,"+I+" 0,0").fill("none");D.stroke({color:"#808080",width:1}).move(g[u],p[u]),D.attr("shape-rendering","crispEdges"),h.add(D);var C=InteractiveDataDisplay.asPlot(v);l[u]=C.exportToSvg(),g[u]+=parseFloat($(s[u]).css("border-left-width").replace("px","")),p[u]+=parseFloat($(s[u]).css("border-top-width").replace("px",""))}else if(v.is(e))l[u]=v[0].axis.exportToSvg();else{if(!v.is(n))throw"Unexpected element type. SVG export failure";l[u]=Z[X][E].exportLegendToSvg(v[0])}l[u].move(g[u],p[u])}h.add(l[u])}return c},function(){var t=$("tr",B);F=t.length,Z=new Array(F/3),L=new Array(F/3),W=new Array(F/3),O=new Array(F/3);function l(t,e,i){var a=$("div[data-idd-axis]",i),r=a.length;if(0<r)if(1<r)console.warn("subplots: work with multiple axes in a single slot is not implemented");else{var n=InteractiveDataDisplay.InitializeAxis(a);z.push(n),Y.push([t,e]);var o=t%3==1;U.push(o);var s=Math.floor(t/3),l=Math.floor(e/3);n.associatedPlotRow=s,n.associatedPlotCol=l,o?W[s][l]=n:O[s][l]=n}}t.each(function(o){var t=$("td",this);if(_NCol=t.length,(o-1)%3==0){var s=Math.floor(o/3);Z[s]=new Array(_NCol/3),L[s]=new Array(_NCol/3),W[s]=new Array(_NCol/3),O[s]=new Array(_NCol/3),t.each(function(t){if((t-1)%3==0){var e=$("div[data-idd-plot='plot']",this);if(0<e.length){var i=Math.floor(t/3),a=InteractiveDataDisplay.asPlot(e);(Z[s][i]=a).subplotRowIdx=s,a.subplotColIdx=i,L[s][i]=InteractiveDataDisplay.asPlot($("div[data-idd-plot='subplots-trap']",this));var r={};if(InteractiveDataDisplay.Utils.readStyle(e,r),r,"true"===(void 0!==r.isLegendVisible?r.isLegendVisible:"true")){var n=$("<div style='z-index: 10;'></div>").appendTo(e);new InteractiveDataDisplay.Legend(a,n,!0);n.css("float","right"),InteractiveDataDisplay.Gestures.FullEventList.forEach(function(t){n[0].addEventListener(t,function(t){t.stopPropagation()},!1)})}}}else l(o,t,this)})}else t.each(function(t){l(o,t,this)})});var e={},i=void 0;(e=InteractiveDataDisplay.Utils.readStyle($(R),e))&&e["subplots-margin"]?(i=e["subplots-margin"],$(R).find("td div.idd-subplots-margin-left").css("padding-left",i),$(R).find("tr").find("td div.idd-subplots-margin-left:first").css("padding-left",""),$(R).find("td div.idd-subplots-margin-bottom").css("padding-bottom",i),$(R).find("tr").last().find("td div.idd-subplots-margin-bottom").css("padding-bottom","")):i=$(R).find("td div.idd-axis").parent().css("padding-left");var a=R.getAttribute("data-idd-ext-legend");if(a){var r=a.split(" ");if(3!==r.length)throw"data-idd-ext-legend attribute bust contain string in format 'placement plotRowIdx plotColIdx'";var n=r[0];X=parseInt(r[1]),E=parseInt(r[2]);var o=Z[X][E],s=$("<div></div>");switch(n.trim().toLowerCase()){case"left":case"top":s.prependTo(R);break;case"right":case"bottom":s.appendTo(R);break;default:throw"Unexpected external legend placement"}switch(n.trim().toLowerCase()){case"left":$(R).css("flex-direction","row"),i&&s.css("margin-right",i);break;case"right":$(R).css("flex-direction","row"),i&&s.css("margin-left",i);break;case"top":$(R).css("flex-direction","column"),i&&s.css("margin-bottom",i);break;case"bottom":$(R).css("flex-direction","column"),i&&s.css("margin-top",i);break;default:throw"Unexpected external legend placement"}new InteractiveDataDisplay.Legend(o,s,!1,void 0,!0)}for(var d=0;d<z.length;d++){var c=z[d],h=Y[d][0],g=Y[d][1],p=Math.floor(h/3),f=Math.floor(g/3),u=Z[p][f];c.dataTransform=h%3==1?u.yDataTransform:u.xDataTransform}$("div[data-idd-plot='grid']",B).each(function(t){var e=this.plot,i=e.master,a=i.subplotRowIdx,r=i.subplotColIdx,n=O[a][r];if(n)e.xAxis=n;else if(H){var o=function(t,e){for(var i=0;i<t.length;i++)if(t[i]&&t[i][e])return i;return-1}(O,r);-1!==o&&(e.xAxis=O[o][r])}var s=W[a][r];if(s)e.yAxis=s;else if(j){var l=function(t){for(var e=0;e<t.length;e++)if(t[e])return e;return-1}(W[a]);-1!==l&&(e.yAxis=W[a][l])}});for(d=0;d<Z.length;d++)for(var v=Z[d],y=0;y<v.length;y++){if(u=v[y]){var m=$(u.host).attr("data-idd-navigation-enabled");if(m&&"true"===m){var I=$(u.host);I.dblclick(function(){this.plot.master.fitToView()});var D=u.master.subplotRowIdx,C=u.master.subplotColIdx,b=InteractiveDataDisplay.Gestures.getGesturesStream(I),w=O[D][C];if(w){var A=w.host,x=InteractiveDataDisplay.Gestures.applyHorizontalBehavior(InteractiveDataDisplay.Gestures.getGesturesStream(A));b=b.merge(x),A.dblclick(function(){var t=this.axis;Z[t.associatedPlotRow][t.associatedPlotCol].fitToViewX()})}var T=W[D][C];if(T){A=T.host;var S=InteractiveDataDisplay.Gestures.applyVerticalBehavior(InteractiveDataDisplay.Gestures.getGesturesStream(A));b=b.merge(S),A.dblclick(function(){var t=this.axis;Z[t.associatedPlotRow][t.associatedPlotCol].fitToViewY()})}u.navigation.gestureSource=b}}}function P(t){if(!k){k=!0,yRange={min:t.y_min,max:t.y_max},xRange={min:t.x_min,max:t.x_max};var e=this.master,i=e.subplotRowIdx,a=e.subplotColIdx;if(!H){var r=O[i][a];r&&r.update(xRange)}if(!j){var n=W[i][a];n&&n.update(yRange)}for(var o=0;o<z.length;o++){var s=z[o];U[o]&&j?s.update(yRange):!U[o]&&H&&s.update(xRange)}if(H||j)for(o=0;o<Z.length;o++)for(var l=Z[o],d=0;d<l.length;d++){var c=l[d];if(c!==this.master){var h=c.visibleRect;H&&(h.x=t.x_min,h.width=t.x_max-t.x_min),j&&(h.y=t.y_min,h.height=t.y_max-t.y_min),c.navigation.setVisibleRect(h,!1,{suppressNotifyBoundPlots:!0,forceOnlyUpdatePlotsOutput:!0,syncUpdate:!0})}}k=!1}}var k=!1;for(d=0;d<L.length;d++)for(v=L[d],y=0;y<v.length;y++){var M=v[y];M&&(M.renderCallback=P)}function G(t,e){for(var i=0;i<Z.length;i++)for(var a=0;a<Z[i].length;a++)for(var r=Z[i][a].getPlotsSequence(),n=0;n<r.length;n++)0<e.name.length&&r[n].name===e.name&&r[n].isVisible!==e.isVisible&&(r[n].isVisible=e.isVisible)}var N=$(R).attr("data-idd-common-visibility");if(N&&("true"===N||"enabled"===N))for(d=0;d<Z.length;d++)for(y=0;y<Z[d].length;y++)Z[d][y]&&Z[d][y].host.bind("visibleChanged",G);V.subplots=K}()},InteractiveDataDisplay.asSubPlots=function(t){return t&&void 0!==t.subplots?t.subplots:new InteractiveDataDisplay.SubPlots(t)},InteractiveDataDisplay.readTable=function(t){var i={};InteractiveDataDisplay.Utils.readStyle(t,i);var e=t.children("table:first-child");if(e&&0<e.length){e.toggle();var a=e.children("tbody").children("tr");if(a&&0<a.length){var r=a.first(),n=[];r.children("th").each(function(t){var e=$(this).text();n[t]=e,i[e]=[]});var o=a.toArray();if(o)for(var s=o.length,l=n.length,d=1;d<s;d++)for(var c=$(o[d]).children("td").toArray(),h=0;h<l;h++)i[n[h]][d-1]=parseFloat($(c[h]).text())}}return i},InteractiveDataDisplay.Utils.getAndClearTextContent=function(t){t[0].normalize();var e=t.contents().filter(function(){return 3==this.nodeType&&!(!this.data||""==this.data.trim())})[0];if(e&&e.data){var i=e.wholeText;return void 0!==e.replaceWholeText?e.replaceWholeText(""):e.data="",i}},InteractiveDataDisplay.readCsv=function(t){var e={};InteractiveDataDisplay.Utils.readStyle(t,e);var i=InteractiveDataDisplay.Utils.getAndClearTextContent(t);if(i){function a(t){return t.split(/\s+/g)}var r=(i=i.trim()).split(/\n/g),n=r.length-1;if(0<n){for(var o=a(r[0]),s=o[0]?0:1,l=s;l<o.length;l++)e[o[l-s]]=[];for(var d=0;d<n;d++){var c=a(r[d+1]);for(l=s=c[0]?0:1;l<c.length;l++){var h=parseFloat(c[l]);isNaN(h)?e[o[l-s]][d]=c[l]:e[o[l-s]][d]=h}}for(l=0;l<o.length;l++){var g=o[l].split(".");1<g.length&&(e[g[0]]||(e[g[0]]={}),e[g[0]][g[1]]=e[o[l]],delete e[o[l]])}}}return e},InteractiveDataDisplay.readCsv2d=function(t){var e={};InteractiveDataDisplay.Utils.readStyle(t,e);var i=InteractiveDataDisplay.Utils.getAndClearTextContent(t);if(i){function a(t){return t.trim().split(/\s+/g)}var r=(i=i.trim()).split(/\n/g),n=r.length-1;if(0<n){var o=a(r[0]),s=o.length-1;if(0<s){for(var l=new Array(s),d=new Array(n),c=new Array(s),h=1;h<=s;h++)c[h-1]=new Array(n),l[h-1]=parseFloat(o[h]);for(var g=1;g<=n;g++){var p=a(r[g]);d[g-1]=parseFloat(p[0]);for(h=1;h<=s;h++)c[h-1][g-1]=parseFloat(p[h])}e.x=l,e.y=d,e.values=c}}}return e},InteractiveDataDisplay.readBase64=function(t){function e(t){var e=t[0].split("."),i=e[0];switch(e[1]){case"1D":if("string"==i)return s=t[1].split(",").map(atob);var a=InteractiveDataDisplay.Utils.base64toByteArray(t[1]);return s=InteractiveDataDisplay.Utils.byteArrayToTypedArray(a,i);case"2D":var r=parseInt(t[1]),n=(a=InteractiveDataDisplay.Utils.base64toByteArray(t[2]),InteractiveDataDisplay.Utils.byteArrayToTypedArray(a,i));if(n.length%r!=0)throw"InnerDimLen is not divisor of decoded flattened array len";for(var o=n.length/r,s=new Array(o),l=0;l<o;l++)s[l]=n.slice(l*r,(l+1)*r);return s;default:throw"Unexpected dimensionality specified ("+t[0]+")"}}var i={};InteractiveDataDisplay.Utils.readStyle(t,i);var a=InteractiveDataDisplay.Utils.getAndClearTextContent(t);if(a)for(var r=(a=a.trim()).split(/\n/g),n=r.length,o=0;o<n;o++){var s=r[o].trim().split(/\s+/g),l=s[0];s.splice(0,1);var d=e(s);i[l]=d}return i},InteractiveDataDisplay.InitializeAxis=function(t,e){if(t.hasClass("idd-axis"))throw"The div element already is initialized as an axis";switch(t.attr("data-idd-axis")){case"numeric":return t.axis=new InteractiveDataDisplay.NumericAxis(t),t.axis;case"log":return t.axis=new InteractiveDataDisplay.LogarithmicAxis(t),t.axis;case"labels":if(void 0===e)e=InteractiveDataDisplay.Utils.getDataSourceFunction(t,InteractiveDataDisplay.readCsv)(t);return t.axis=new InteractiveDataDisplay.LabelledAxis(t,e),t.axis}},InteractiveDataDisplay.TicksRenderer=function(a,t){if("undefined"!=typeof Modernizr&&a&&(Modernizr.canvas||a.replaceWith('<div">Browser does not support HTML5 canvas</div>')),!a||!a.hasClass("idd-axis")){a&&(a[0].axis=this);var T=this,S=a,P="";a&&(P=a.attr("data-idd-placement"));var k,M,G,r,N,R="top"==P||"bottom"==P,B={min:0,max:1},V=t,F=[],e=InteractiveDataDisplay.Utils.generateNextIntId(),Z=$("<canvas id='canvas_"+e+"' style='position:relative; float:left'></canvas>"),L=$("<div id='labelsDiv_"+e+"' style='position:relative; float:left'></div>");if(a){"bottom"==P||"right"==P?(a[0].appendChild(Z[0]),a[0].appendChild(L[0])):(a[0].appendChild(L[0]),a[0].appendChild(Z[0]));var z=InteractiveDataDisplay.tickLength+1;R?Z[0].height=z:(Z[0].width=z,"right"==P?L.css("left",3):Z.css("left",3))}this.updateSize=function(){var t=G;if(a){var e=a.outerWidth(!1),i=a.outerHeight(!1);R?(G=k=e)!=t&&(Z[0].width=G,L.css("width",k)):(G=M=i)!=t&&(Z[0].height=G,L.css("height",M))}r=(G-1)/(B.max-B.min),Z[0].height};var U=-1,Y=InteractiveDataDisplay.tickLength/3,O=S?S.css("color"):"Black",W=Z.get(0).getContext("2d");W.strokeStyle=O,W.fillStyle=O,W.lineWidth=1;var A=12,x=!1,i="";S&&(S[0].currentStyle?(A=S[0].currentStyle["font-size"],i=S[0].currentStyle["font-family"]):document.defaultView&&document.defaultView.getComputedStyle?(A=document.defaultView.getComputedStyle(S[0],null).getPropertyValue("font-size"),i=document.defaultView.getComputedStyle(S[0],null).getPropertyValue("font-family")):S[0].style&&(A=S[0].style["font-size"],i=S[0].style["font-family"]),W.font=A+i),Object.defineProperty(this,"host",{get:function(){return S},configurable:!1}),Object.defineProperty(this,"mode",{get:function(){return P},configurable:!1}),Object.defineProperty(this,"tickSource",{get:function(){return V},set:function(t){V=t,L.empty(),n()},configurable:!1}),Object.defineProperty(this,"range",{get:function(){return B},configurable:!1}),Object.defineProperty(this,"ticks",{get:function(){return F},configurable:!1}),Object.defineProperty(this,"DesiredSize",{get:function(){return{width:k,height:M}},configurable:!1}),Object.defineProperty(this,"axisSize",{get:function(){return G},configurable:!1}),Object.defineProperty(this,"deltaRange",{get:function(){return r},configurable:!1}),Object.defineProperty(this,"FontSize",{get:function(){return _defaultFontSize},set:function(t){x=!0,A=t+"px",W.font=A+i,V.invalidate(),T.update()},configurable:!1}),Object.defineProperty(this,"rotateAngle",{get:function(){return N/Math.PI*180},set:function(t){N=t*Math.PI/180,V.invalidate(),T.update()},configurable:!1}),this.sizeChanged=!0;var X=void 0;Object.defineProperty(this,"dataTransform",{get:function(){return X},set:function(t){X=t,n()},configurable:!1});function E(t){var e,i,a,r=t.length;j=new Array(r);for(var n=0;n<r;n++){var o=t[n];if(o.label){if(i=(e=o.label._size).width,a=e.height,0==i||0==a){var s=V.getInner(o.position);if("string"==typeof s){var l=W.measureText(s);i=l.width,a=l.height}else{var d=$("<div></div>").append($(s)).css({display:"block",visibility:"hidden",position:"absolute"}).appendTo($("body"));i=d.width(),a=d.height(),d.remove()}}var c=N?i*Math.abs(Math.cos(N))+a*Math.abs(Math.sin(N)):i,h=N?i*Math.abs(Math.sin(N))+a*Math.abs(Math.cos(N)):a;j[n]={position:T.getCoordinateFromTick(o.position),width:c,height:h,hasLabel:!0}}else j[n]={position:T.getCoordinateFromTick(o.position),width:0,height:0,hasLabel:!1}}}function H(t){var e,i,a=t.length-1;if(K(t),E(t),-1==a)return 1;for(var r=0,n=0;n<a;){for(r=n,n++;n<1+a&&!j[n].hasLabel;)n++;if(a<n)break;if(j[r].hasLabel){if((e=Math.abs(j[n].position-j[r].position))<InteractiveDataDisplay.minTickSpace)return-1;if(R?(i=(j[r].width+j[n].width)/2,0==r&&j[r].position-j[r].width/2<0?i-=j[r].width/2:n==a-1&&j[n].position-j[n].width/2>G&&(i-=j[n].width/2)):(i=(j[r].height+j[n].height)/2,0==r&&j[r].position-j[r].height/2<0?i-=j[r].height/2:n==a-1&&j[n].position-j[n].height/2>G&&(i-=j[n].height/2)),e-i<InteractiveDataDisplay.minLabelSpace)return-1}}var o=1;for(r=n=0;n<a;){for(r=n,n++;n<1+a&&!j[n].hasLabel;)n++;if(a<n)break;if(j[r].hasLabel&&(e=Math.abs(j[n].position-j[r].position),R?(i=(j[r].width+j[n].width)/2,0==r&&j[r].position-j[r].width/2<0?i-=j[r].width/2:n==a-1&&j[n].position-j[n].width/2>G&&(i-=j[n].width/2)):(i=(j[r].height+j[n].height)/2,0==r&&j[r].position-j[r].height/2<0?i-=j[r].height/2:n==a-1&&j[n].position-j[n].height/2>G&&(i-=j[n].height/2)),e-i<InteractiveDataDisplay.minLabelSpace)){o=0;break}}return o}var j=[];this.getCoordinateFromTick||(this.getCoordinateFromTick=function(t){return t});var n=function(){if(T.updateSize(),X){var t=X.plotToData(B.min),e=X.plotToData(B.max);F=V.getTicks({min:Math.min(t,e),max:Math.max(t,e)})}else F=V.getTicks(B);var i,a,r=H(F),n=0;if(-1==r)for(;n++<InteractiveDataDisplay.maxTickArrangeIterations&&(i=V.decreaseTickCount(),a=H(i),F=i,-1==a););if(1==r)for(;n++<InteractiveDataDisplay.maxTickArrangeIterations;){if(i=V.increaseTickCount(),-1==(a=H(i))){F=V.decreaseTickCount(),E(F),K(F);break}if(F=i,0==a)break}N&&(F=V.updateTransform(r,N,R)),V.getMinTicks&&(-1==a&&n>InteractiveDataDisplay.maxTickArrangeIterations||F.length<2)&&0<(i=V.getMinTicks()).length&&(K(F=i),E(F)),2==F.length&&(K(F),E(F),2!=F.length||j[1].position-j[0].position-(R?(j[0].width+j[1].width)/2:(j[0].height+j[1].height)/2)<InteractiveDataDisplay.minLabelSpace&&0);var o,s=F.length,l=U;if(U=0,this.sizeChanged=!1,R){for(var d=0;d<s;d++)U=Math.max(U,j[d].height);U!=l&&0!=U&&(L.css("height",U),Z[0].height=z,M=U+z,S.css("height",M),this.sizeChanged=!0)}else{for(d=0;d<s;d++)U=Math.max(U,j[d].width);U!=l&&0!=U&&(L.css("width",U),Z[0].width=z,k=U+z+3,S.css("width",k),this.sizeChanged=!0)}W.strokeStyle=O,W.fillStyle=O,R?(W.clearRect(0,0,G,z),"bottom"==P?W.fillRect(0,0,G,1):W.fillRect(0,InteractiveDataDisplay.tickLength,G,1)):(W.clearRect(0,0,z,G),"right"==P?W.fillRect(0,0,1,G):W.fillRect(InteractiveDataDisplay.tickLength,0,1,G));for(d=0;d<s;d++){var c=F[d],h=j[d];o=h.position;var g=void 0,p=void 0;0<d&&(p=j[d-1]),d<s-1&&(g=j[d+1]);var f=p&&g&&!p.hasLabel&&!g.hasClass&&h.hasLabel&&c.invisible;if(R){if(c.invisible||W.fillRect(o,1,1,InteractiveDataDisplay.tickLength),c.label){var u=void 0,v=h.width,y=c.label._size.width;if(f)if(p.position<0)if(g.position>=v)u=(D=.5*(0+g.position))-.5*y;else u=g.position-.5*(v+y);else if(g.position>G){if(G-p.position>=v)u=(D=.5*(p.position+G))-.5*y;else u=p.position-.5*(y-v)}else u=o-y/2;else u=o-y/2;c.label.css("left",u)}}else if(o=G-1-o,F[d].invisible||W.fillRect(1,o,InteractiveDataDisplay.tickLength,1),c.label){var m=h.height,I=c.label._size.height;if(f)if(p.position<0)if(g.position>=m){var D=.5*(0+g.position),C=G-1-(b=D+.5*I);c.label.css("top",C)}else{var b=g.position-.5*(m-I);C=G-1-b;c.label.css("top",C)}else if(g.position>G)if(G-p.position>=m){D=.5*(p.position+G),C=G-1-(b=D+.5*I);c.label.css("top",C)}else{b=p.position+.5*(m+I),C=G-1-b;c.label.css("top",C)}else c.label.css("top",o-I/2);else c.label.css("top",o-I/2)}}var w=V.getSmallTicks(F);if(0<w.length){for(var A=Math.abs(T.getCoordinateFromTick(w[1])-T.getCoordinateFromTick(w[0])),x=1;x<w.length-1;x++)A=Math.min(A,Math.abs(T.getCoordinateFromTick(w[x+1])-T.getCoordinateFromTick(w[x])));if(A>=InteractiveDataDisplay.minTickSpace)for(d=0,s=w.length;d<s;d++)o=T.getCoordinateFromTick(w[d]),"bottom"==P?W.fillRect(o,1,1,Y):"top"==P?W.fillRect(o,InteractiveDataDisplay.tickLength-Y,1,Y):"left"==P?W.fillRect(InteractiveDataDisplay.tickLength-Y,G-1-o,Y,1):"right"==P&&W.fillRect(1,G-1-o,Y,1)}};this.renderToSvg=function(t){function e(t,e,i){d+="M"+t+" "+e+"h"+i}function i(t,e,i){d+="M"+t+" "+e+"v"+i}var a,r,n,o,s=T.host.height(),l=T.host.width(),d="";if(R?(a=M-1,"bottom"==P?(e(0,0,G),InteractiveDataDisplay.tickLength):e(0,a,G)):(a=k-1,"right"==P?(i(0,0,G),InteractiveDataDisplay.tickLength):i(a,0,G)),t.size(l,s),0<(w=F.length)){var c=void 0;for(u=0;u<F.length;u++)if(F[u]&&F[u].label){c=F[u].label[0];break}o=(v=window.getComputedStyle(c,null))?v.getPropertyValue("font-family"):void 0,n=x?A:v?parseFloat(v.getPropertyValue("font-size")):void 0}for(var h=T.host.offset(),g=L.offset(),p=g.left-h.left,f=g.top-h.top,u=0;u<w;u++)if(r=j[u].position,F[u].label||!(r<0||G<r)){j[u].width;if(R){if(F[u].invisible||("top"==P?i(r,a,-InteractiveDataDisplay.tickLength):i(r,0,InteractiveDataDisplay.tickLength)),F[u].label){var v=F[u].label instanceof jQuery?window.getComputedStyle(F[u].label[0],null):window.getComputedStyle(F[u].label,null),y=parseFloat(v.getPropertyValue("Left")),m=0;F[u].label.normalShift&&(m=F[u].label.normalShift),(I=V.renderToSvg(F[u],t).font({family:o,size:n})).transform({x:y+p}),I.transform({y:m+f-1},!0),N&&I.transform({rotation:T.rotateAngle},!0)}}else if(r=G-1-r,F[u].invisible||("left"==P?e(a,r,-InteractiveDataDisplay.tickLength):e(0,r,InteractiveDataDisplay.tickLength)),F[u].label){v=F[u].label instanceof jQuery?window.getComputedStyle(F[u].label[0],null):window.getComputedStyle(F[u].label,null),y=0;F[u].label.normalShift&&(y=F[u].label.normalShift);var I;m=parseFloat(v.getPropertyValue("Top"));(I=V.renderToSvg(F[u],t).font({family:o,size:n})).transform({x:y+p}),I.transform({y:m+f},!0),N&&I.transform({rotation:T.rotateAngle},!0)}}var D=V.getSmallTicks(F);if(0<D.length){for(var C=Math.abs(T.getCoordinateFromTick(D[1])-T.getCoordinateFromTick(D[0])),b=1;b<D.length-1;b++)C=Math.min(C,Math.abs(T.getCoordinateFromTick(D[b+1])-T.getCoordinateFromTick(D[b])));if(C>=InteractiveDataDisplay.minTickSpace){u=0;for(var w=D.length;u<w;u++)r=T.getCoordinateFromTick(D[u]),"bottom"==P?i(r,0,Y):"top"==P?i(r,a,-Y):"left"==P?e(a,G-r,-Y):"right"==P&&e(.5,G-r,Y)}}t.path(d).stroke(O).fill("none")},this.exportToSvg=function(){if(!SVG.supported)throw"SVG is not supported";var t=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=SVG(t).size(S.width(),S.height());return T.renderToSvg(e),e};var K=function(t){for(var e,i=0,a=t.length;i<a;i++)if((e=t[i].label)&&!e.hasClass("idd-axis-label")){var r=e[0];L[0].appendChild(r),e.addClass("idd-axis-label"),e._size={width:r.offsetWidth,height:r.offsetHeight},x&&e.css("fontSize",A)}};this.update=function(t){t&&(B=t),n()},this.destroy=function(){S[0].innerHTML="",S.removeClass("idd-axis"),S.removeClass("unselectable")},this.remove=function(){var t=S[0].parentElement;if(t){t.removeChild(S[0]);var e=t.parentElement;e&&("idd-plot-master"==e.className||e.classList&&e.classList.contains("idd-plot-master"))&&e.plot.removeDiv(t)}this.destroy()},a&&(n(),a.addClass("idd-axis"),a.addClass("unselectable"))}},InteractiveDataDisplay.NumericAxis=function(t){this.base=InteractiveDataDisplay.TicksRenderer;t[0].axis=this;var e=!0;this.getCoordinateFromTick=function(t){var e=this.deltaRange;if(isFinite(e)){var i=t,a=this.dataTransform;return a&&(i=a.dataToPlot(t)),(i-this.range.min)*e}return this.axisSize/2};var i=t.attr("data-idd-scientific-notation");void 0!==i&&"false"!=i&&"disable"!=i&&"disabled"!=i||(e=!1),this.base(t,new InteractiveDataDisplay.NumericTickSource(e))},InteractiveDataDisplay.NumericAxis.prototype=new InteractiveDataDisplay.TicksRenderer,InteractiveDataDisplay.LogarithmicAxis=function(t){this.base=InteractiveDataDisplay.TicksRenderer,this.getCoordinateFromTick=function(t){var e=this.deltaRange;return isFinite(e)?(InteractiveDataDisplay.Utils.log10(t)-this.range.min)*e:this.axisSize/2},this.base(t,new InteractiveDataDisplay.LogarithmicTickSource)},InteractiveDataDisplay.LogarithmicAxis.prototype=new InteractiveDataDisplay.TicksRenderer,InteractiveDataDisplay.LabelledAxis=function(t,e){this.base=InteractiveDataDisplay.TicksRenderer;var l=this,i=!0;this.getCoordinateFromTick=function(t){var e=this.deltaRange;if(isFinite(e)){var i=t;return this.dataTransform&&(i=this.dataTransform.dataToPlot(t)),(i-this.range.min)*e}return this.axisSize/2},this.updateLabels=function(t){this.tickSource=new InteractiveDataDisplay.LabelledTickSource(t),this.rotateAngle=t&&t.rotateAngle?t.rotateAngle:0};var a=t.attr("data-idd-force-labels-visibility");return void 0!==a&&"false"!=a&&"disable"!=a&&"disabled"!=a||(i=!1),void 0===e&&(e={}),e.forceLabelsVisibility=i,this.base(t,new InteractiveDataDisplay.LabelledTickSource(e)),this.rotateAngle=e&&e.rotateAngle?e.rotateAngle:0,this.getToolTip=function(t){function e(t){return l.dataTransform?l.dataTransform(t):t}for(var i=e(t),a=void 0,r=void 0,n=0;n<l.ticks.length;n++){var o=l.ticks[n];if(!o.text){var s=e(o.position);i<s&&!r&&(r=n),s<i&&(a=n)}}if(r&&!a){if(l.ticks[r-1]&&l.ticks[r-1].text)return l.ticks[r-1].text}else if(a&&!r){if(l.ticks[a+1]&&l.ticks[a+1].text)return l.ticks[a+1].text}else if(a&&r&&r-a==2)return l.ticks[a+1].text},this},InteractiveDataDisplay.LabelledAxis.prototype=new InteractiveDataDisplay.TicksRenderer,InteractiveDataDisplay.TickSource=function(){var s=[],l=[],d=[],c=[],h=0;this.start,this.finish,this.precision=3,this.insertNumericTick=function(t,e,i){if(t.empty(),"string"==typeof e&&i){var a=parseFloat(e);isNaN(a)?t.text(e):Math.abs(a)<Math.pow(10,-2)||Math.abs(a)>=Math.pow(10,3)?t.append(InteractiveDataDisplay.Utils.getInScientificNotation(a)):t.text(a)}else t.append(e)},this.getDiv=function(t,e){var i,a=void 0!==e&&e,r=this.getInner(t);if(-1!=(i=d.indexOf(r))){l[i]=!0,c[i].display="block";var n=s[i][0];return s[i]._size={width:n.offsetWidth,height:n.offsetHeight},s[i]}if(-1!=(i=l.indexOf(!1))){l[i]=!0,c[i].display="block",d[i]=r;var o=s[i];this.insertNumericTick(o,r,a);n=o[0];return o._size={width:n.offsetWidth,height:n.offsetHeight},s[i]}o=$("<div></div>");return this.insertNumericTick(o,r,a),l[h]=!0,s[h]=o,d[h]=r,c[h]=o[0].style,o._size=void 0,h++,o},this.getInner=function(t){if(t)return t.toString()},this.invalidate=function(){for(var t=0;t<s.length;t++)s[t].remove();l=[],s=[],d=[],c=[],h=0},this.refreshDivs=function(){for(var t=0;t<h;t++)l[t]?l[t]=!1:c[t].display="none"},this.getTicks=function(t){this.start=t.min,this.finish=t.max},this.decreaseTickCount=function(){},this.increaseTickCount=function(){}},InteractiveDataDisplay.Utils.round=function(t,e){if(e<=0)return 15<-e?parseFloat(t.toFixed(15)):parseFloat(t.toFixed(-e));var i=Math.pow(10,e-1);return Math.round(t/i)*i},InteractiveDataDisplay.Utils.getInScientificNotation=function(t,e,i){var a=0,r=Math.abs(t),n=t<0?-1:1,o=void 0===e?3:e,s=void 0!==i&&i;if(1<r){for(var l=r;10<=l&&l%10==0;)a++,l/=10;a<o?a=0:(a=Math.floor(Math.log10(r)),r/=Math.pow(10,Math.floor(Math.log10(r))))}else if(r<=1&&0<r)if(-1*o<(a=Math.floor(Math.log10(r))))a=0;else{a=Math.floor(Math.log10(r)),r/=Math.pow(10,Math.floor(Math.log10(r)));r=Math.round(1e6*r)/1e6}var d="";return 0!=r?d+=n*r:d="0",0!=a&&(d+="&#215;10<sup>"+a+"</sup>"),s?{m:n*r,pow:a}:d},InteractiveDataDisplay.NumericTickSource=function(t){var d,c;this.base=InteractiveDataDisplay.TickSource,this.base(),this.isScientific=void 0!==t&&t;var h=this;this.getInner=function(t,e){var i=void 0===e?InteractiveDataDisplay.minNumOrder:e;return 0==t?t.toString():i<=c?InteractiveDataDisplay.Utils.round(t/Math.pow(10,c),-1)+"e+"+c:InteractiveDataDisplay.Utils.round(t,c).toString()},this.getMPow=function(t,e){return 0==t?{m:t,pow:0}:(void 0===e?3:e)<=c?{m:InteractiveDataDisplay.Utils.round(t/Math.pow(10,c),-1),pow:c}:{m:InteractiveDataDisplay.Utils.round(t,c),pow:0}},this.getTicks=function(t){return InteractiveDataDisplay.NumericTickSource.prototype.getTicks.call(this,t),d=1,c=Math.floor(InteractiveDataDisplay.Utils.log10(this.finish-this.start)),e()},this.renderToSvg=function(t,e){if(h.isScientific){var i=InteractiveDataDisplay.Utils.getInScientificNotation(t.position,3,!0);return e.text(function(t){t.tspan(i.m).dy(18),0!=i.pow&&(t.tspan(""),t.tspan("10"),t.tspan(i.pow).style("font-size","0.8em").dy(-10))})}return e.text(h.getInner(t.position))};var e=function(){var t=[];if(h.start>h.finish)return t;if(isFinite(c))for(var e,i=d*Math.pow(10,c),a=Math.floor(h.start/i),r=Math.floor(h.finish/i)-a+2,n=0,o=a*i,s=0;s<r;s++)(e=o+s*i)>=h.start&&e<=h.finish&&(t[n]={position:e,label:h.getDiv(e,h.isScientific)},n++);else t[0]={position:h.start,label:h.getDiv(h.start,h.isScientific),invisible:!0};return h.refreshDivs(),t};this.decreaseTickCount=function(){return 1==d?d=2:2==d?d=5:5==d&&(d=1,c++),e()},this.increaseTickCount=function(){return 1==d?(d=5,c--):2==d?d=1:5==d&&(d=2),e()},this.getSmallTicks=function(t){var e=[],i=0;if(1<t.length){var a=t[0].position,r=Math.abs(t[1].position-a)/10;for(a-=r;a>this.start&&i<10;)e[i]=a,i++,a-=r;for(var n=t.length,o=0;o<n-1;o++){a=t[o].position+r;for(var s=0;s<9;s++)e[i]=a,i++,a+=r}a=t[n-1].position+r;for(var l=0;a<this.finish&&l<10;)e[i]=a,i++,a+=r,l++}return e},this.getMinTicks=function(){var t=[];if(c=Math.floor(InteractiveDataDisplay.Utils.log10(this.finish-this.start)),isFinite(c)){var e=Math.pow(10,c),i=Math.floor(h.start/e)*e;i<h.start&&(i+=e);var a=Math.floor(h.finish/e)*e;if(a>h.finish&&(a-=e),i!=a)t[0]={position:i,label:h.getDiv(InteractiveDataDisplay.Utils.round(i,c))},t[1]={position:a,label:h.getDiv(InteractiveDataDisplay.Utils.round(a,c))};else{c--,e=(d=5)*Math.pow(10,c),i=Math.floor(h.start/e);for(var r,n=Math.floor(h.finish/e)-i+2,o=0,s=i*e,l=0;l<n;l++)(r=s+l*e)>=h.start&&r<=h.finish&&(t[o]={position:r,label:h.getDiv(InteractiveDataDisplay.Utils.round(r,c))},o++)}}else t[0]={position:h.start,label:h.getDiv(h.start),invisible:!0};return this.refreshDivs(),t}},InteractiveDataDisplay.NumericTickSource.prototype=new InteractiveDataDisplay.TickSource,InteractiveDataDisplay.LogarithmicTickSource=function(){this.base=InteractiveDataDisplay.TickSource,this.base();var d,c,h=this,g=1,s=10;this.getInner=function(t){if(Math.abs(t)<InteractiveDataDisplay.minLogOrder)return Math.pow(10,t).toString();var e="10<sup>"+t+"</sup>",i=document.createElement("span");return i.innerHTML=e,i},this.renderToSvg=function(t,e){var i=t.position;return e.text(i.toString())},this.getTicks=function(t){return InteractiveDataDisplay.LogarithmicTickSource.prototype.getTicks.call(this,t),d=Math.pow(10,this.start),c=Math.pow(10,this.finish),e()};var e=function(){var t=[];if(isFinite(Math.pow(10,-h.start))&&isFinite(c))if(d==c)t[0]={position:h.start,label:h.getDiv(h.start),invisible:!0};else for(var e=h.start/g|0,i=(h.finish/g|0)-e+3,a=(e-1)*g,r=Math.pow(10,a),n=0,o=0;o<i;o++)d<=r&&r<=c&&(t[n]={position:r,label:h.getDiv(a)},n++),a+=g,r*=s;return h.refreshDivs(),t};this.decreaseTickCount=function(){return g*=2,s=Math.pow(10,g),e()},this.increaseTickCount=function(){return 1<g&&(g/=2,s=Math.pow(10,g)),e()},this.getSmallTicks=function(t){var e=[],i=isFinite(Math.pow(10,-h.start))&&isFinite(c),a=0;if(0<t.length&&1==g&&i){var r=t[0].position,n=r/10;for(r-=n;d<r&&a<10;)e[a]=r,a++,r-=n;for(var o=t.length,s=0;s<o-1;s++){r=t[s].position,r+=n=(t[s+1].position-r)/10;for(var l=0;l<9;l++)e[a]=r,a++,r+=n}for(r=t[o-1].position,r+=n=r;r<c;)e[a]=r,a++,r+=n}return e},this.getMinTicks=function(){var t=[];return isFinite(Math.pow(10,-h.start))&&isFinite(c)?d==c&&(t[0]={position:h.start,label:h.getDiv(h.start),invisible:!0},this.refreshDivs()):(t[0]={position:1,label:h.getDiv(0)},this.refreshDivs()),t}},InteractiveDataDisplay.LogarithmicTickSource.prototype=new InteractiveDataDisplay.TickSource,InteractiveDataDisplay.LabelledTickSource=function(t){this.base=InteractiveDataDisplay.TickSource,this.base();var g=this,p=[],f=[],u=!1;if(t&&t.forceLabelsVisibility&&(u=t.forceLabelsVisibility),t&&t.labels){for(var e=t.labels.length,i=0;i<e;i++)p[i]=t.labels[i].toString();if(t.ticks)f=t.ticks;else for(i=0;i<e;i++)f[i]=i}var v,y,m=1,I=0<f.length-p.length;this.getInner=function(t){if("string"!=typeof t||-1===t.indexOf("\n"))return t.toString();var e=document.createElement("span");return e.title=t,e.innerText=t,$(e).css("white-space","pre"),e},this.renderToSvg=function(t,e){var i=t.text?t.text:"";return e.text(i)},this.getTicks=function(t){if(InteractiveDataDisplay.LabelledTickSource.prototype.getTicks.call(this,t),m=1,!I){var e=0,i=f.length-1,a=0|this.start;if(a>f[e])for(;1<i-e;){var r=Math.round((e+i)/2);f[r]<a?e=r:i=r}if(v=e,e=0,i=f.length-1,(a=1|this.finish)<f[i])for(;1<i-e;){r=Math.round((e+i)/2);f[r]<a?e=r:i=r}if(v<(y=i))for(var n=(f.length-1)/(y-v);m<n;)m*=2}return D()};var D=function(){var t=[];if(I){for(var e=0;f[e]<g.start;)e++;0<e&&e--;for(var i=f.length-1;f[i]>g.finish;)i--;i<f.length-1&&i++;l=i-e+1,d=0;var a=f[e];for(c=0;c<l;c++){boundPos=a,t[d]={position:boundPos},d++;a=f[++e];if(c!=l-1){var r=(boundPos+a)/2;h=g.getDiv(p[e-1]);t[d]={position:r,label:h,invisible:!0,text:p[e-1]},d++}}}else{var n=Math.floor((f.length-1)/m);u&&(n=1),n>f.length-1?n=f.length-1:n<1&&(n=1);for(var o=0,s=0|g.start;f[o]<s;)o+=n;0<=o-n&&f[o]>s&&(o-=n);for(var l=y-v+1,d=0,c=0;c<l;c++){if((s=f[o])>=g.start&&s<=g.finish){var h=g.getDiv(p[o]);t[d]={position:s,label:h,text:p[o]},d++}o+=n}}return g.refreshDivs(),t};this.decreaseTickCount=function(){return I?m++:m/=2,D()},this.increaseTickCount=function(){return I?m--:m*=2,D()},this.updateTransform=function(t,e,i){for(var a=D(),r=0;r<a.length;r++)if(a[r].label){var n=a[r].label,o=e/Math.PI*180,s=n._size.width,l=n._size.height,d=Math.abs(e),c=Math.sin(d),h=Math.cos(d),g="rotate("+o+"deg)";if(i){var p=.5*(s*c+l*h-l);g="translateY("+p+"px)"+g;n.normalShift=p}else{var f=-.5*(s-(s*h+l*c));g="translateX("+f+"px)"+g;n.normalShift=f}n.css("-webkit-transform",g),n.css("-moz-transform",g),n.css("-ms-transform",g),n.css("-o-transform",g),n.css("transform",g)}return a},this.getSmallTicks=function(t){var e=[];if(!I)for(var i=0,a=0,r=0;r<f.length;r++)t.length>a&&f[r]==t[a].position?a++:(e[i]=f[r],i++);return e},this.getMinTicks=function(){var t=[];if(u)return D();if(!I&&0<p.length){var e=g.getDiv(p[0]);t[0]={position:f[0],label:e,text:p[0]},e=g.getDiv(p[p.length-1]),t[1]={position:f[f.length-1],label:e,text:p[p.length-1]},g.refreshDivs()}return t}},InteractiveDataDisplay.LabelledTickSource.prototype=new InteractiveDataDisplay.TickSource,InteractiveDataDisplay.TicksRenderer.getAxisType=function(t){return void 0!==t&&t.type&&"log10"==t.type?"log":"numeric"},(InteractiveDataDisplay=InteractiveDataDisplay||{}).ColorPalette=function(t,e,i){var f,u,p,a=this;if(Object.defineProperty(this,"isNormalized",{get:function(){return f},configurable:!1}),Object.defineProperty(this,"range",{get:function(){return u},configurable:!1}),Object.defineProperty(this,"points",{get:function(){return p},configurable:!1}),(u=(f=t)?{min:0,max:1}:{min:e.min,max:e.max}).min>=u.max)throw"range is incorrect (min >= max)";if(null==i)throw"points are undefined";if(i.length<2)throw"Palette should have at least two points";p=i.slice(0),this.getRgba=function(t){var e=a.getHsla(t);return InteractiveDataDisplay.ColorPalette.HSLtoRGB(e)},this.getHsla=function(t){var e=p.length;if(t<=p[0].x)return p[0].leftColor;if(t>=p[e-1].x)return p[e-1].rightColor;for(var i=0,a=e-1;1<a-i;){var r=Math.round((i+a)/2);p[r].x<t?i=r:a=r}var n=p[i];n.x==t&&(a=i);var o=p[a],s=(t-n.x)/(o.x-n.x),l=n.rightColor,d=o.leftColor;0==l.h&&0==l.s&&(l.h=d.h),0==d.h&&0==d.s&&(d.h=l.h);var c=l.h,h=d.h;3<Math.abs(h-c)&&(c<h?c+=6:h+=6);var g={h:c+(h-c)*s,s:l.s+(d.s-l.s)*s,l:l.l+(d.l-l.l)*s,a:l.a+(d.a-l.a)*s};return 6<=g.h&&(g.h-=6),g},this.absolute=function(t,e){for(var i=p.length,a=(e-t)/(u.max-u.min),r=new Array(i),n=0;n<i;n++){var o=p[n];r[n]={x:a*(o.x-u.min)+t,rightColor:o.rightColor,leftColor:o.leftColor}}return new InteractiveDataDisplay.ColorPalette(!1,{min:t,max:e},r)},this.relative=function(){if(f)return this;for(var t=p.length,e=1/(u.max-u.min),i=new Array(t),a=0;a<t;a++){var r=p[a];i[a]={x:e*(r.x-u.min),rightColor:r.rightColor,leftColor:r.leftColor}}return new InteractiveDataDisplay.ColorPalette(!0,{min:0,max:1},i)},this.banded=function(t){if(!t)throw"bands is undefined";var e=!1;if("number"==typeof t){if(t<1)throw new"number of bands is less than 1";e=!0;var i=t-1,a=(u.max-u.min)/t;t=new Array(i);for(var r=0;r<i;r++)t[r]=(r+1)*a+u.min}var n=t.length+2,o=t.length+1;if(n<2)throw"number of bands is less than 1";var s,l,d=new Array(n),c=this.getHsla(u.min),h=1<o?(u.max-u.min)/(o-1):.5*(u.max-u.min);for(r=0;r<n-1;r++){if(0==r)s=u.min,l=u.min;else{if(s=r==n-2?u.max:e?u.min+r*h:(t[r-1]+t[r])/2,l>=t[r-1])throw"bands points are incorrect";l=t[r-1]}var g=this.getHsla(s),p={x:l,rightColor:g,leftColor:c};d[r]=p,c=g}if(l>=u.max)throw"bands points are incorrect";return d[n-1]={x:u.max,rightColor:c,leftColor:c},new InteractiveDataDisplay.ColorPalette(f,u,d)},this.gradientString=function(){function t(t){function e(t){for(var e=t.toString(16);e.length<2;)e="0"+e;return e}for(var i=InteractiveDataDisplay.ColorPalette.HSLtoRGB(t),a="#"+e(i.r)+e(i.g)+e(i.b),r=Object.keys(s),n=0;n<r.length;n++){var o=r[n];if(s[o]==a){a=o;break}}return a}var s=InteractiveDataDisplay.ColorPalette.getColorNames(),e="",i=p.length;f||(e=p[0].x+"=");for(var a=1;a<i;a++){var r=p[a-1],n=p[a];r.rightColor===n.leftColor?e+=t(r.rightColor):e+=t(r.rightColor)+","+t(n.leftColor),a<i-1&&(e+="="+n.x+"=")}return f||(e+="="+p[i-1].x),e}},InteractiveDataDisplay.ColorPalette.getColorNames=function(){return{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},InteractiveDataDisplay.ColorPalette.toArray=function(t,e){var i,a,r,n=new Uint8Array(e<<2),o=t.getRgba;t.isNormalized?(i=1/(e-1),a=0):(a=t.range.min,i=(t.range.max-t.range.min)/(e-1));for(var s=0,l=0;s<e;s++)r=o(s*i+a),n[l++]=r.r,n[l++]=r.g,n[l++]=r.b,n[l++]=255*r.a;return n},InteractiveDataDisplay.ColorPalette.create=function(){var t=arguments;if(!t||0==t.length)throw"colors is undefined or empty";var e=t.length;1==e&&(e++,t=[t[0],t[0]]);for(var i=new Array(e),a=1/(e-1),r=0;r<e;r++){var n=t[r],o="number"==typeof n.r?InteractiveDataDisplay.ColorPalette.RGBtoHSL(n):n;i[r]={x:r*a,rightColor:o,leftColor:o}}return new InteractiveDataDisplay.ColorPalette(!0,{min:0,max:1},i)},InteractiveDataDisplay.ColorPalette.parse=function(t){var e,i=!0,a=[];if(null==t&&(t=""),""==t)return InteractiveDataDisplay.palettes.grayscale;var r,n=new InteractiveDataDisplay.Lexer(t),o=-1;if(n.readNext()){if(a.push({x:0,rightColor:{h:0,s:0,l:0,a:1},leftColor:{h:0,s:0,l:1,a:1}}),"number"==n.currentLexeme){if(a[a.length-1].x=n.currentNumber,i=!1,n.readNext()&&("separator"!=n.currentLexeme||"equal"!=n.currentSeparator))throw n.position+": separator '=' expected";if(n.readNext()&&"color"!=n.currentLexeme)throw n.position+": color expected"}if("color"!=n.currentLexeme)throw n.position+": wrong lexeme";a[a.length-1].rightColor=n.currentColor,a[a.length-1].leftColor=n.currentColor,a.push({x:a[0].x,rightColor:n.currentColor,leftColor:n.currentColor})}for(r=a[0].x;n.readNext();){if("separator"!=n.currentLexeme)throw n.position+": separator expected";if("equal"==n.currentSeparator){if(n.readNext())if("number"==n.currentLexeme){if(n.currentNumber<r)throw n.position+": number is less than previous";if(r=n.currentNumber,-1==o)a[a.length-1].x=n.currentNumber,o=1;else{if(0!=o)throw n.position+": wrong lexeme";a[a.length-1].x=n.currentNumber,o=2}}else{if("color"!=n.currentLexeme)throw n.position+": wrong lexeme";if(1==o||2==o)a[a.length-1].rightColor=n.currentColor,o=-1;else{if(0!=o&&-1!=o)throw n.position+": wrong lexeme";a[a.length-1].x=a[0].x-1,a[a.length-1].rightColor=n.currentColor,o=-1}}}else if("comma"==n.currentSeparator&&n.readNext())if(1==o||-1==o||2==o)if("number"==n.currentLexeme){if(n.currentNumber<=r)throw n.position+": number is less than previous";if(r=n.currentNumber,!n.readNext()||"separator"!=n.currentLexeme||"equal"!=n.currentSeparator)throw n.position+": wrong lexeme";if(!n.readNext()||"color"!=n.currentLexeme)throw n.position+": color expected";-1!=o?a.push({x:n.currentNumber,rightColor:n.currentColor,leftColor:n.currentColor}):(a[a.length-1].x=n.currentNumber,a[a.length-1].rightColor=n.currentColor,a[a.length-1].leftColor=n.currentColor),o=-1}else{if("color"!=n.currentLexeme)throw n.position+": wrong lexeme";-1==o&&a.pop(),o=0}else if(0==o)if("number"==n.currentLexeme){if(n.currentNumber<=r)throw n.position+": number is less than previous";if(r=n.currentNumber,a[a.length-1].x=a[0].x-1,!n.readNext()||"separator"!=n.currentLexeme||"equal"!=n.currentSeparator)throw n.position+": wrong lexeme";if(!n.readNext()||"color"!=n.currentLexeme)throw n.position+": color expected";a.push({x:n.currentNumber,rightColor:n.currentColor,leftColor:n.currentColor}),o=-1}else{if("color"!=n.currentLexeme)throw n.position+": wrong lexeme";a[a.length-1].x=a[0].x-1,o=0}-1!=o&&0!=o||a.push({x:a[0].x,rightColor:n.currentColor,leftColor:n.currentColor})}if("separator"==n.currentLexeme)throw n.position+": wrong lexeme";if("number"==n.currentLexeme&&i||"color"==n.currentLexeme&&!i)throw n.position+": wrong ending";if(i&&(a[a.length-1].x=1,a[a.length-1].x<a[a.length-2].x))throw n.position+": number is less than previous";if(a[a.length-1].rightColor=a[a.length-1].leftColor,a[0].x>=a[a.length-1].x)throw n.position+": wrong range of palette";e={min:a[0].x,max:a[a.length-1].x};for(var s=1,l=0,d=1,c=a.length;d<c;d++)if(a[d].x==a[0].x-1)0==l&&(s=d),l++;else if(0!=l){for(var h=(a[s+l].x-a[s-1].x)/(l+1),g=0;g<l;g++)a[s+g].x=a[s-1].x+h*(g+1);l=0,s=1}return new InteractiveDataDisplay.ColorPalette(i,e,a)},InteractiveDataDisplay.Lexer=function(t){if("string"!=typeof t)throw"wrong definition of palette: must be a string";var r,n,o,s,l=t,d=0;Object.defineProperty(this,"position",{get:function(){return d},configurable:!1}),Object.defineProperty(this,"paletteString",{get:function(){return l},configurable:!1}),Object.defineProperty(this,"currentSeparator",{get:function(){return s},configurable:!1}),Object.defineProperty(this,"currentLexeme",{get:function(){return o},configurable:!1}),Object.defineProperty(this,"currentNumber",{get:function(){return n},configurable:!1}),Object.defineProperty(this,"currentColor",{get:function(){return r},configurable:!1}),this.readNext=function(){if(d>=l.length)return!1;for(;" "===l[d];)d++;if("#"===l[d]||/^[a-z]/.test(l[d].toLowerCase())){o="color";for(var t=d;d<l.length&&" "!=l[d]&&"="!=l[d]&&","!=l[d];)d++;var e=InteractiveDataDisplay.ColorPalette.colorFromString(l.substring(t,d));r=InteractiveDataDisplay.ColorPalette.RGBtoHSL(e)}else if("="===l[d]||","===l[d])o="separator",s="="==l[d]?"equal":"comma",d++;else{o="number";for(t=d;d<l.length&&" "!=l[d]&&"="!=l[d]&&","!=l[d];)d++;var i=l.substring(t,d),a=i.replace(/[^0-9+-Ee.]/g,"");if(i!=a)throw"wrong number value";n=parseFloat(l.substring(t,d))}return!0}},InteractiveDataDisplay.ColorPalette.colorFromString=function(t){var e,i,a,r,n=InteractiveDataDisplay.ColorPalette.getColorNames();if("string"!=typeof t)throw"wrong definition of color: must be a string";var o=!1;n[t.toLowerCase()]&&(t=n[t.toLowerCase()]);if("#"==t.charAt(0)){if(7==t.length)r=1,e=parseInt(t.substring(1,3),16),i=parseInt(t.substring(3,5),16),a=parseInt(t.substring(5,7),16);else{if(9!=t.length)throw"wrong definition of hex color";e=parseInt(t.substring(1,3),16),i=parseInt(t.substring(3,5),16),a=parseInt(t.substring(5,7),16),r=parseInt(t.substring(7,9),16)/255}o=!0}if(!o){null!==(s=/rgb\(\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\s*\)/.exec(t))&&(r=1,e=parseInt(s[1]),i=parseInt(s[2]),a=parseInt(s[3]),o=!0),o||null!==(s=/rgb\(\s*([0-9]|[1-8][0-9]|9[0-9]|100)%,\s*([0-9]|[1-8][0-9]|9[0-9]|100)%,\s*([0-9]|[1-8][0-9]|9[0-9]|100)%\s*\)/.exec(t))&&(r=1,e=Math.round(2.55*parseInt(s[1])),i=Math.round(2.55*parseInt(s[2])),a=Math.round(2.55*parseInt(s[3])),o=!0)}if(!o){var s;null!==(s=/rgba\(\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*([0|1]\.?\d+)\)/.exec(t))&&(e=parseInt(s[1]),i=parseInt(s[2]),a=parseInt(s[3]),r=parseFloat(s[4]),o=!0)}if(!o)throw"Unsupported color definition";if(isNaN(e)||isNaN(i)||isNaN(a)||isNaN(r))throw"wrong definition of hex color";return{r:e,g:i,b:a,a:r}},InteractiveDataDisplay.ColorPalette.RGBtoHSL=function(t){var e,i,a;a=t.a;var r=t.r/255,n=t.g/255,o=t.b/255,s=Math.max(r,n);s=Math.max(s,o);var l=Math.min(r,n);return i=(s+(l=Math.min(l,o)))/2,s==l?e=0:s==r?e=o<=n?(n-o)/(s-l):(n-o)/(s-l)+6:s==n?e=2+(o-r)/(s-l):s==o&&(e=4+(r-n)/(s-l)),{h:e,s:s==l?0:i<.5?(s-l)/(s+l):(s-l)/(2-s-l),l:i,a:a}},InteractiveDataDisplay.ColorPalette.HSLtoRGB=function(t){var e,i,a,r;r=t.a;var n=t.h,o=t.s,s=t.l,l=(1-Math.abs(2*s-1))*o,d=l*(1-Math.abs(n%2-1));n<2?(a=0,i=n<1?(e=Math.round(255*l),Math.round(255*d)):(e=Math.round(255*d),Math.round(255*l))):n<4?(e=0,a=n<3?(i=Math.round(255*l),Math.round(255*d)):(i=Math.round(255*d),Math.round(255*l))):n<6&&(i=0,a=n<5?(e=Math.round(255*d),Math.round(255*l)):(e=Math.round(255*l),Math.round(255*d)));var c=255*(s-l/2),h=e+c;return{r:e=255<h?255:h<0?0:Math.round(h),g:i=255<(h=i+c)?255:h<0?0:Math.round(h),b:a=255<(h=a+c)?255:h<0?0:Math.round(h),a:r}},InteractiveDataDisplay.ColorPaletteViewer=function(t,e,i){var a=t,n=a.width(),o=20,r=!0,s=!1,l=e,d=void 0;void 0!==i&&(void 0!==i.height&&(o=i.height),void 0!==i.width&&(n=i.width),void 0!==i.axisVisible&&(r=i.axisVisible),void 0!==i.logAxis&&(s=i.logAxis));var c=$("<canvas height='"+o+"px'width='"+n+"px' style='display: block'></canvas>");a[0].appendChild(c[0]);var h=c.get(0).getContext("2d"),g=null,p=null;function f(t){return s?{min:InteractiveDataDisplay.Utils.log10(t.min),max:InteractiveDataDisplay.Utils.log10(t.max)}:t}function u(){g=$("<div data-idd-placement='bottom' style='width: "+n+"px; color: rgb(0,0,0)'></div>"),a[0].appendChild(g[0]),p=s?new InteractiveDataDisplay.LogarithmicAxis(g):new InteractiveDataDisplay.NumericAxis(g),l&&!l.isNormalized?p.update(f({min:l.range.min,max:l.range.max})):d&&p.update(f({min:d.min,max:d.max}))}r&&u(),Object.defineProperty(this,"axisVisible",{get:function(){return r},set:function(t){r!=(t=!!t)&&((r=t)?u():(a[0].removeChild(g[0]),p=g=null))},configurable:!1}),Object.defineProperty(this,"palette",{get:function(){return l},set:function(t){t&&(l=t,!r||l.isNormalized&&d||p.update(f({min:l.range.min,max:l.range.max})),v())},configurable:!1}),Object.defineProperty(this,"dataRange",{get:function(){return d},set:function(t){t&&(d=t,!r||l&&!l.isNormalized||p.update(f({min:d.min,max:d.max})))},configurable:!1});var v=function(){for(var t,e=(l.range.max-l.range.min)/n,i=h.createLinearGradient(0,0,n,0),a=l.range.min,r=0;r<n;r++)t=l.getRgba(a),i.addColorStop(r/n,"rgba("+t.r+","+t.g+","+t.b+","+t.a+")"),a+=e;h.fillStyle=i,h.fillRect(0,0,n,o)};l&&v()},InteractiveDataDisplay.SvgColorPaletteViewer=function(t,e,i,a){var r=170,n=20,o=!0,s=e;void 0!==a&&(void 0!==a.height&&(n=a.height),void 0!==a.width&&(r=a.width),void 0!==a.axisVisible&&(o=a.axisVisible));var l=t.group();o&&(i.children[1].axis.renderToSvg(l),l.translate(0,n+.5));var d,c,h;s&&(c=(s.range.max-s.range.min)/r,h=t.gradient("linear",function(t){for(var e=s.range.min,i=0;i<r;i++)d=s.getRgba(e),t.at(i/r,"rgba("+d.r+","+d.g+","+d.b+","+d.a+")"),e+=c}),t.rect(r,n).fill(h))},InteractiveDataDisplay.SizePalette=function(t,e,i){var a,r,n;if(Object.defineProperty(this,"isNormalized",{get:function(){return a},configurable:!1}),Object.defineProperty(this,"range",{get:function(){return r},configurable:!1}),Object.defineProperty(this,"sizeRange",{get:function(){return n},configurable:!1}),r=(a=t)?{min:0,max:1}:{min:i.min,max:i.max},n={min:e.min,max:e.max},r.min>r.max)throw"valueRange is incorrect (min >= max)";var o=(n.max-n.min)/(r.max-r.min);this.getSize=function(t){return t<=r.min?n.min:t>=r.max?n.max:o*(t-r.min)+n.min}},InteractiveDataDisplay.SizePalette.Create=function(t){if(t instanceof InteractiveDataDisplay.SizePalette)return t;var e=t.sizeRange,i=t.valueRange;return new InteractiveDataDisplay.SizePalette(void 0===i,e,i)},InteractiveDataDisplay.SizePaletteViewer=function(t,e,i){var a=t,r=a.width(),n=35,o=!0,s=e;void 0!==i&&(void 0!==i.axisVisible&&(o=i.axisVisible),void 0!==i.width&&(r=i.width),void 0!==i.height&&(n=i.height));var l=$("<canvas height='"+n+"px'width='"+r+"px' style='display: block'></canvas>");a[0].appendChild(l[0]);var d=null,c=null;function h(){c=$("<div data-idd-placement='bottom' style='width: "+r+"px; margin-top: -1px; color: rgb(0,0,0)'></div>"),d=new InteractiveDataDisplay.NumericAxis(c),a[0].appendChild(c[0]),s?s.isNormalized||d.update({min:s.range.min,max:s.range.max}):g&&d.update({min:g.min,max:g.max})}o&&h(),Object.defineProperty(this,"axisVisible",{get:function(){return o},set:function(t){o!=(t=!!t)&&((o=t)?h():(a[0].removeChild(c[0]),d=c=null))},configurable:!1}),Object.defineProperty(this,"palette",{get:function(){return s},set:function(t){t&&(s=t,o&&!s.isNormalized&&d.update({min:s.range.min,max:s.range.max}),f())},configurable:!1});var g=void 0;Object.defineProperty(this,"dataRange",{get:function(){return g},set:function(t){t&&(g=t,!o||s&&!s.isNormalized||d.update({min:g.min,max:g.max}))},configurable:!1});var p=l.get(0).getContext("2d"),f=function(){p.clearRect(0,0,r,n),p.fillStyle="lightgray",p.strokeStyle="black";var t=0,e=n;s&&s.sizeRange&&(t=s.sizeRange.min,e=s.sizeRange.max);var i=n*r/Math.max(e,t);p.beginPath(),p.moveTo(0,n),0!=t&&p.lineTo(0,Math.max(0,n-t)),i<r?(p.lineTo(i,0),t<=e?p.lineTo(r,0):p.lineTo(r,Math.max(0,n-e))):p.lineTo(r,Math.max(0,n-e)),p.lineTo(r,n),p.lineTo(0,n),p.closePath(),p.fill(),p.stroke()};f()},InteractiveDataDisplay.SvgSizePaletteViewer=function(r,t,e,i){var n=170,o=75,a=!0,s=t;void 0!==i&&(void 0!==i.axisVisible&&(a=i.axisVisible),void 0!==i.width&&(n=i.width),void 0!==i.height&&(o=i.height));var l,d;a&&(l=e.children[1],d=r.group(),l.axis.renderToSvg(d),d.translate(0,o));!function(){var t=0,e=o;s.sizeRange&&(t=s.sizeRange.min,e=s.sizeRange.max);var i=o*n/Math.max(e,t),a=[];0!=t?a.push([0,Math.max(0,o-t)]):a.push([0,o]),i<n?(a.push([i,0]),t<=e?a.push([n,0]):a.push([n,Math.max(0,o-e)])):(a.push([n,Math.max(0,o-e)]),a.push([n,Math.max(0,o-e)])),r.polyline([[0,o],a[0],a[1],a[2],[n,o],[0,o]]).fill("lightgray").stroke("black")}()},InteractiveDataDisplay.UncertaintySizePaletteViewer=function(t,e){var i=t;i.width();void 0!==e&&(void 0!==e.width&&e.width,void 0!==e.height&&e.height);var a=void 0;Object.defineProperty(this,"maxDelta",{get:function(){return a},set:function(t){t&&(a=t,s())}});var r=$("<canvas height='50px'></canvas>");i[0].appendChild(r[0]);var n=r[0].getContext("2d"),o=[{x:25,y:20,min:16,max:16},{x:75,y:20,min:10,max:16},{x:125,y:20,min:0,max:16}],s=function(){for(var t=0;t<o.length;t++)InteractiveDataDisplay.Petal.drawSample(n,o[t].x,o[t].y,o[t].min,o[t].max,"#484848");n.lineWidth=1,n.beginPath(),n.moveTo(20,45.5),n.lineTo(118,45.5),n.stroke(),n.closePath(),n.beginPath(),n.moveTo(118,45.5),n.lineTo(103.5,40.5),n.lineTo(103.5,49.5),n.lineTo(118,45.5),n.stroke(),n.closePath(),n.fill(),n.strokeStyle="black",n.fillStyle="black",n.lineWidth=1,a&&(n.fillText("X",9,49),n.fillText("X",122,49),n.beginPath(),n.moveTo(134,44.5),n.lineTo(141,44.5),n.stroke(),n.closePath(),n.beginPath(),n.moveTo(134,48.5),n.lineTo(141,48.5),n.stroke(),n.closePath(),n.beginPath(),n.moveTo(137.5,41),n.lineTo(137.5,48),n.stroke(),n.closePath(),n.fillText("",round(a,{min:0,max:a},!1),145,49))};s(),$("<div style='margin-left: 30px; margin-top: -10px'>uncertainty</div>").appendTo(i)},InteractiveDataDisplay.palettes={grayscale:new InteractiveDataDisplay.ColorPalette(!0,{min:0,max:1},[{x:0,rightColor:{h:0,s:0,l:0,a:1},leftColor:{h:0,s:0,l:0,a:1}},{x:1,rightColor:{h:0,s:0,l:1,a:1},leftColor:{h:0,s:0,l:1,a:1}}])},(InteractiveDataDisplay=InteractiveDataDisplay||{}).ColorPaletteEditor=function(p,t){if(!p.hasClass("idd-colorPaletteEditor")){p.addClass("idd-colorPaletteEditor"),p[0].editor=this;var f="rgba(100,100,100,0.3)",u=t;Object.defineProperty(this,"palette",{get:function(){return u},set:function(t){u=t,D.palette=u,P()},configurable:!1});function v(t){p.trigger("paletteChanged",[t])}var y=!1,o=!1,m=p.width(),I=$("<div></div>").height(10).width(m).addClass("idd-colorPaletteEditor-bar").appendTo(p),e=$("<div></div>").height(20).width(m).addClass("idd-colorPaletteEditor-viewer").appendTo(p),i={height:20,axisVisible:!1},D=new InteractiveDataDisplay.ColorPaletteViewer(e,u,i),C=10+e.height();p.height(C);function b(t){var e=InteractiveDataDisplay.ColorPalette.HSLtoRGB(t);return"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"}function s(t){function e(t){for(var e=t.toString(16);e.length<2;)e="0"+e;return e}var i=InteractiveDataDisplay.ColorPalette.HSLtoRGB(t);return"#"+e(i.r)+e(i.g)+e(i.b)}function w(t,e,i,a,r,n){r&&(t.fillStyle=r,t.beginPath(),t.moveTo(e,i),t.lineTo(e+5,i),t.lineTo(e+5,i+10),t.fill()),n&&(t.fillStyle=n,t.beginPath(),t.moveTo(e+5,i),t.lineTo(e+10,i),t.lineTo(e+5,i+10),t.fill()),t.strokeStyle=a,t.beginPath(),t.moveTo(e,i),t.lineTo(e+10,i),t.lineTo(e+5,i+10),t.closePath(),t.stroke()}function A(){S[0].getContext("2d").clearRect(0,0,m,10)}function x(){if(o){var t=$(".idd-colorPaletteEditor-colorPicker",I);if(0<t.length){var e=$.data(t[0],"onClick");e&&$(window).off("click",e),$(".idd-colorPaletteEditor-colorPicker",I).remove()}o=!1}}function T(t,e,a){x(),o=!0;var i=$("<div></div>").addClass("idd-colorPaletteEditor-colorPicker").css({position:"absolute",left:t-30,top:10}).appendTo(I);$("<span>Color:</span>").css("margin-right",10).appendTo(i);function r(t){$(t.target).hasClass("idd-colorPaletteEditor-colorPicker")||0<i.has($(t.target)).length||(x(),t.stopPropagation())}var n=$("<input type=color></input>").width(60).height(20).val(s(e)).change(function(){var t=n.val(),e=InteractiveDataDisplay.ColorPalette.colorFromString(t),i=InteractiveDataDisplay.ColorPalette.RGBtoHSL(e);a(i),x()}).appendTo(i);$(window).click(r),$.data(i[0],"onClick",r)}function r(l,t,e,i){var a=m/(u.range.max-u.range.min),r=a*(l.x-u.range.min),n=a*(t-u.range.min),o=a*(e-u.range.min),d=$("<div style='position:absolute;'></div>").addClass("idd-colorPaletteEditor-marker").width(10).height(10).appendTo(I),s=$("<canvas height='10px'width='10px' style='display: block'></canvas>").appendTo(d);if(d.css("left",r-5),i){var c=S.offset(),h=!1;d.draggable({axis:"x",containment:[c.left+n-5,c.top,c.left+o-5,c.top+10],start:function(t){h=!(y=!0),x(),A();var e=S.offset();$(t.target).draggable("option","containment",[e.left+n-5,e.top,e.left+o-5,e.top+10])},drag:function(t){var e=p.offset(),i=t.pageY-e.top;if(i<0||C<i)h||((a=s[0].getContext("2d")).clearRect(0,0,10,10),w(a,0,0,"gray",f,f),h=!0);else if(h){var a;(a=s[0].getContext("2d")).clearRect(0,0,10,10),w(a,0,0,"black",l.leftColor&&b(l.leftColor),l.rightColor&&b(l.rightColor)),h=!1}},stop:function(t){y=!1;var e,i,a,r=p.offset(),n=t.pageY-r.top;if(n<0||C<n){for(var o=0;o<u.points.length;o++)if(u.points[o].x==l.x){u.points.splice(o,1),v(u),D.palette=u;break}}else{var s=(e=d,i=S.offset(),a=e.offset().left+e.width()/2-i.left,(u.range.max-u.range.min)/m*a+u.range.min);s>u.range.min&&s<u.range.max&&(l.x=s,v(u),D.palette=u)}P()}})}d.click(function(t){T(r,l.rightColor?l.rightColor:l.leftColor,function(t){l.leftColor&&(l.leftColor=t),l.rightColor&&(l.rightColor=t),D.palette=u,v(u),P()}),t.stopPropagation()});var g=s[0].getContext("2d");w(g,0,0,"black",l.leftColor&&b(l.leftColor),l.rightColor&&b(l.rightColor))}var S=$("<canvas height='10px'width='"+m+"px' style='display: block'></canvas>").css("position","absolute").appendTo(I),P=function(){y=!1,x();var t=$(".idd-colorPaletteEditor-marker",I);if(t.filter(".ui-draggable").each(function(){$(this).draggable("destroy")}),t.remove(),0<u.points.length){var e=u.range.min,i=u.points[1].x;r(u.points[0],e,i,!1)}if(1<u.points.length){e=u.points[u.points.length-2].x,i=u.range.max;r(u.points[u.points.length-1],e,i,!1)}for(var a=1;a<u.points.length-1;a++){e=u.points[a-1].x,i=u.points[a+1].x;r(u.points[a],e,i,!0)}};S.mousemove(function(t){if(!y&&!o){var e=S.offset(),i=t.pageX-e.left,a=S[0].getContext("2d");a.clearRect(0,0,m,10),w(a,i-5,0,"gray",f,f)}}),S.mouseleave(function(){A()}),S.click(function(t){if(!y&&!o){var e=S.offset(),i=t.pageX-e.left,a=(u.range.max-u.range.min)/m*i+u.range.min,r=u.getHsla(a);!function(t){var e=u.points;if(!(e[0].x>=t.x||e[e.length-1].x<=t.x)){for(var i,a=1;a<e.length;a++){if(t.x==e[a].x)return;if(t.x<e[a].x){(i=e.slice()).splice(a,0,t);break}}u=new InteractiveDataDisplay.ColorPalette(u.isNormalized,u.range,i),D.palette=u,v(u),P()}}({x:a,leftColor:r,rightColor:r})}}),P()}},InteractiveDataDisplay.Gestures={},InteractiveDataDisplay.Gestures.FullEventList=["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","touchcancel","gesturestart","gesturechange","gestureend","MSGestureStart","MSGestureChange","MSGestureEnd","MSGestureCancel","MSPointerDown"],InteractiveDataDisplay.Gestures.zoomLevelFactor=1.4,InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin=function(t,e){var i=function(t){for(var e=0,i=0;t;)e+=t.offsetLeft,i+=t.offsetTop,t=t.offsetParent;return{left:e,top:i}}(t[0]);return{x:e.pageX-i.left,y:e.pageY-i.top}},InteractiveDataDisplay.Gestures.PanGesture=function(t,e,i){this.Type="Pan",this.Source=i,this.xOffset=t,this.yOffset=e},InteractiveDataDisplay.Gestures.ZoomGesture=function(t,e,i,a){this.Type="Zoom",this.Source=a,this.xOrigin=t,this.yOrigin=e,this.scaleFactor=i},InteractiveDataDisplay.Gestures.PinGesture=function(t){this.Type="Pin",this.Source=t},InteractiveDataDisplay.Gestures.createPanSubject=function(t){var e=$(document),i=Rx.Observable.fromEvent(t,"mousedown"),a=Rx.Observable.fromEvent(t,"mousemove"),r=Rx.Observable.fromEvent(e,"mouseup"),n=a.skip(1).zip(a,function(t,e){return new InteractiveDataDisplay.Gestures.PanGesture(t.clientX-e.clientX,t.clientY-e.clientY,"Mouse")}),o=r;return i.selectMany(function(t){return n.takeUntil(o)})},InteractiveDataDisplay.Gestures.createPinSubject=function(t){return Rx.Observable.fromEvent(t,"mousedown").select(function(t){return new InteractiveDataDisplay.Gestures.PinGesture("Mouse")})},InteractiveDataDisplay.Gestures.createZoomSubject=function(a){a.unbind("mousewheel"),a.mousewheel(function(t,e){t.preventDefault();var i=jQuery.Event("xbrowserwheel");i.delta=e,i.origin=InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin(a,t),a.trigger(i)});var t=Rx.Observable.fromEvent(a,"xbrowserwheel"),e=t.zip(t,function(t){return new InteractiveDataDisplay.Gestures.ZoomGesture(t.origin.x,t.origin.y,0<t.delta?1/InteractiveDataDisplay.Gestures.zoomLevelFactor:+InteractiveDataDisplay.Gestures.zoomLevelFactor,"Mouse")}),i=Rx.Observable.fromEvent(a,"dblclick");i.zip(i,function(t){var e=InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin(a,t);return new InteractiveDataDisplay.Gestures.ZoomGesture(e.x,e.y,1/InteractiveDataDisplay.Gestures.zoomLevelFactor,"Mouse")});return e},InteractiveDataDisplay.Gestures.createTouchPanSubject=function(t){var e=$(document),i=Rx.Observable.fromEvent(t,"touchstart"),a=Rx.Observable.fromEvent(t,"touchmove"),r=Rx.Observable.fromEvent(e,"touchend"),n=Rx.Observable.fromEvent(e,"touchcancel");return i.selectMany(function(t){return a.takeUntil(r.merge(n)).skip(1).zip(a,function(t,e){return{left:t.originalEvent,right:e.originalEvent}}).where(function(t){return 1==t.left.targetTouches.length&&1==t.right.targetTouches.length&&1==t.left.changedTouches.length&&1==t.right.changedTouches.length}).select(function(t){return new InteractiveDataDisplay.Gestures.PanGesture(t.left.targetTouches[0].pageX-t.right.targetTouches[0].pageX,t.left.targetTouches[0].pageY-t.right.targetTouches[0].pageY,"Touch")})})},InteractiveDataDisplay.Gestures.createTouchPinSubject=function(t){return Rx.Observable.fromEvent(t,"touchstart").select(function(t){return new InteractiveDataDisplay.Gestures.PinGesture("Touch")})},InteractiveDataDisplay.Gestures.createTouchZoomSubject=function(t){var e=$(document),i=Rx.Observable.fromEvent(t,"touchstart"),a=Rx.Observable.fromEvent(t,"touchmove"),r=Rx.Observable.fromEvent(e,"touchend"),n=Rx.Observable.fromEvent(e,"touchcancel");return i.selectMany(function(t){return a.takeUntil(r.merge(n)).skip(1).zip(a,function(t,e){return{left:t.originalEvent,right:e.originalEvent}}).where(function(t){return 2==t.left.targetTouches.length&&2==t.right.targetTouches.length}).select(function(t){var e=Math.sqrt((t.left.targetTouches[0].pageX-t.left.targetTouches[1].pageX)*(t.left.targetTouches[0].pageX-t.left.targetTouches[1].pageX)+(t.left.targetTouches[0].pageY-t.left.targetTouches[1].pageY)*(t.left.targetTouches[0].pageY-t.left.targetTouches[1].pageY))/Math.sqrt((t.right.targetTouches[0].pageX-t.right.targetTouches[1].pageX)*(t.right.targetTouches[0].pageX-t.right.targetTouches[1].pageX)+(t.right.targetTouches[0].pageY-t.right.targetTouches[1].pageY)*(t.right.targetTouches[0].pageY-t.right.targetTouches[1].pageY)),i={x:Math.abs(t.right.targetTouches[1].pageX-t.right.targetTouches[0].pageX),y:Math.abs(t.right.targetTouches[1].pageY-t.right.targetTouches[0].pageY)};return new InteractiveDataDisplay.Gestures.ZoomGesture(i.x,i.y,1/e,"Touch")})})},InteractiveDataDisplay.Gestures.createTouchPanSubjectWin8=function(t){var e=Rx.Observable.fromEvent(t,"MSGestureStart"),i=Rx.Observable.fromEvent(t,"MSGestureChange"),a=Rx.Observable.fromEvent($(document),"MSGestureEnd");return e.selectMany(function(t){var e=i.startWith({originalEvent:{offsetX:t.originalEvent.offsetX,offsetY:t.originalEvent.offsetY}});return e.takeUntil(a).skip(1).zip(e,function(t,e){return{left:t.originalEvent,right:e.originalEvent}}).where(function(t){return t.left.scale===t.right.scale&&t.left.detail!=t.left.MSGESTURE_FLAG_INERTIA&&t.right.detail!=t.right.MSGESTURE_FLAG_INERTIA}).select(function(t){return new InteractiveDataDisplay.Gestures.PanGesture(t.left.offsetX-t.right.offsetX,t.left.offsetY-t.right.offsetY,"Touch")})})},InteractiveDataDisplay.Gestures.createTouchPinSubjectWin8=function(t){return Rx.Observable.fromEvent(t,"MSPointerDown").select(function(t){return new InteractiveDataDisplay.Gestures.PinGesture("Touch")})},InteractiveDataDisplay.Gestures.createTouchZoomSubjectWin8=function(t){var e=Rx.Observable.fromEvent(t,"MSGestureStart"),i=Rx.Observable.fromEvent(t,"MSGestureChange"),a=Rx.Observable.fromEvent(t,"MSGestureEnd");return e.selectMany(function(e){return i.takeUntil(a).where(function(t){return 1!==t.originalEvent.scale&&0!==t.originalEvent.scale&&t.originalEvent.detail!=t.originalEvent.MSGESTURE_FLAG_INERTIA}).select(function(t){return new InteractiveDataDisplay.Gestures.ZoomGesture(e.originalEvent.offsetX,e.originalEvent.offsetY,1/t.originalEvent.scale,"Touch")})})},InteractiveDataDisplay.Gestures.GesturesPool=function(){var t=[];this.addMSGestureSource=function(i){t.forEach(function(t){}),t.push(i),i.addEventListener("MSPointerDown",function(t){if(void 0===i.gesture){var e=new MSGesture;(e.target=i).gesture=e}i.gesture.addPointer(t.pointerId)},!1)}},InteractiveDataDisplay.Gestures.GesturesPool=new InteractiveDataDisplay.Gestures.GesturesPool,InteractiveDataDisplay.Gestures.getGesturesStream=function(t){var e,i,a;if(window.navigator.msPointerEnabled&&"undefined"!=typeof MSGesture){var r=t[0];InteractiveDataDisplay.Gestures.GesturesPool.addMSGestureSource(r),e=InteractiveDataDisplay.Gestures.createTouchPanSubjectWin8(t);var n=InteractiveDataDisplay.Gestures.createTouchZoomSubjectWin8(t),o=InteractiveDataDisplay.Gestures.createZoomSubject(t);i=n.merge(o),a=InteractiveDataDisplay.Gestures.createTouchPinSubjectWin8(t)}else e=InteractiveDataDisplay.Gestures.createPanSubject(t),i=InteractiveDataDisplay.Gestures.createZoomSubject(t),a=InteractiveDataDisplay.Gestures.createPinSubject(t);var s=a.merge(e.merge(i));return"ontouchstart"in document.documentElement&&(e=InteractiveDataDisplay.Gestures.createTouchPanSubject(t),i=InteractiveDataDisplay.Gestures.createTouchZoomSubject(t),a=InteractiveDataDisplay.Gestures.createTouchPinSubject(t),s=s.merge(a.merge(e.merge(i)))),s},InteractiveDataDisplay.Gestures.applyHorizontalBehavior=function(t){return t.select(function(t){return"Pan"==t.Type?t.yOffset=0:"Zoom"==t.Type&&(t.preventVertical=!0),t})},InteractiveDataDisplay.Gestures.applyVerticalBehavior=function(t){return t.select(function(t){return"Pan"==t.Type?t.xOffset=0:"Zoom"==t.Type&&(t.preventHorizontal=!0),t})},(InteractiveDataDisplay=void 0===InteractiveDataDisplay?{}:InteractiveDataDisplay).DataTransform=function(t,e,i,a){this.dataToPlot=t,this.plotToData=e,this.domain=i||{isInDomain:function(t){return!0}},this.type=a};var InteractiveDataDisplay,Plot,mercator_maxPhi=85.05112878,mercator_R=mercator_maxPhi/Math.log(Math.tan(mercator_maxPhi*Math.PI/360+Math.PI/4));InteractiveDataDisplay.mercatorTransform=new InteractiveDataDisplay.DataTransform(function(t){return-mercator_maxPhi<=t&&t<=mercator_maxPhi?mercator_R*Math.log(Math.tan(Math.PI*(t+90)/360)):t},function(t){return-mercator_maxPhi<=t&&t<=mercator_maxPhi?360*Math.atan(Math.exp(t/mercator_R))/Math.PI-90:t},void 0,"mercator"),Math.LOGE10=Math.log(10),InteractiveDataDisplay.logTransform=new InteractiveDataDisplay.DataTransform(function(t){return Math.log(t)/Math.LOGE10},function(t){return Math.pow(10,t)},{isInDomain:function(t){return 1e-8<t}},"log10"),InteractiveDataDisplay.identityTransform=new InteractiveDataDisplay.DataTransform(function(t){return t},function(t){return t},{isInDomain:function(t){return!0}},"identity"),InteractiveDataDisplay.AnimationBase=function(){var e=void 0,t=this;this.isInAnimation=!1;var i=Rx.Observable.create(function(t){return e=t,function(){}});Object.defineProperty(this,"currentObserver",{get:function(){return e},configurable:!1}),Object.defineProperty(this,"currentObservable",{get:function(){return i},configurable:!1}),this.targetPlotRect=void 0,this.getCurrentPlotRect=function(){},this.stop=function(){t.isInAnimation&&(t.isInAnimation=!1),e&&(e.onNext({plotRect:t.getCurrentPlotRect(),isLast:!0}),e.onCompleted(),e=void 0),this.additionalStopRutines()},this.additionalStopRutines=function(){},this.animate=function(t,e){}},InteractiveDataDisplay.PanZoomAnimation=function(){this.base=InteractiveDataDisplay.AnimationBase,this.base();var f=this,u=void 0,v=void 0,y=new Date,m=void 0,a=void 0,I=void 0,D=0,r=void 0,C=void 0,b=0,w=0;this.getCurrentPlotRect=function(){return m},Object.defineProperty(this,"previousEstimatedPlotRect",{get:function(){return a},configurable:!1});var n=function(){!function(){var t=f.currentObserver;if(t){var e=new Date,i=e.getTime()-y.getTime(),a=C*i,r=v.x-m.x,n=v.y-m.y,o=Math.max(v.width/1e3,Math.sqrt(r*r+n*n)),s=m.x+o*a*I.x,l=m.y+o*a*I.y,d=(v.width-m.width)*a+m.width,c=(v.height-m.height)*a+m.height;y=e,r=s-u.x,n=l-u.y;var h=Math.sqrt(r*r+n*n),g=d-u.width,p=c-u.height;D<=h||Math.abs(g)>Math.abs(b)||Math.abs(p)>Math.abs(w)?(f.isInAnimation=!1,m=v,f.stop()):(m={x:s,y:l,width:d,height:c},f.currentPlotRect=m,t.onNext({plotRect:m,isLast:!1}))}}(),f.isInAnimation&&(r=setTimeout(function(){n()},1e3/60))};this.animate=function(t,e){1.2!=InteractiveDataDisplay.Gestures.zoomLevelFactor&&(InteractiveDataDisplay.Gestures.zoomLevelFactor=1.2),void 0!==r&&(clearTimeout(r),r=void 0),a=e;var i=t();u=void 0===m?i.plotRect:m,m=u,I={x:(v=e).x-u.x,y:v.y-u.y},D=Math.sqrt(I.x*I.x+I.y*I.y),I=1e-10<D?{x:I.x/D,y:I.y/D}:{x:0,y:0},b=e.width-u.width,w=e.height-u.height,C=0!=b||0!=w?.008:.009,f.isInAnimation=!0,n()},this.additionalStopRutines=function(){void 0!==r&&(clearTimeout(r),r=void 0),f.isInAnimation=!1,startCS=u=void 0,v=void 0,y=new Date,startScreenCenter=void(D=0),previousFrameScreenCenter=I=a=m=void 0,endScreenCenter=void 0,r=void 0,w=b=0}},InteractiveDataDisplay.PanZoomAnimation.prototype=new InteractiveDataDisplay.AnimationBase,InteractiveDataDisplay.Utils.getPlotRectForMap=function(t,e){var i=85.05112878,a=void 0===e?{width:t.getWidth(),height:t.getHeight()}:e,r=t.getCenter(),n=a.width,o=a.height,s=t.tryLocationToPixel({latitude:0,longitude:r.longitude},Microsoft.Maps.PixelReference.control),l=t.tryLocationToPixel({latitude:0,longitude:r.longitude+30},Microsoft.Maps.PixelReference.control).x-s.x;l<0&&(l=s.x-t.tryLocationToPixel({latitude:0,longitude:r.longitude-30},Microsoft.Maps.PixelReference.control).x);var d=l/30,c=r.longitude-s.x/d,h=r.longitude+(n-s.x)/d,g=t.getBounds(),p=g.getNorth(),f=g.getSouth(),u=0;i<=p&&(p=i,u=t.tryLocationToPixel({latitude:p,longitude:r.longitude},Microsoft.Maps.PixelReference.control).y);var v=0;f<=-i&&(f=-i,v=o-t.tryLocationToPixel({latitude:f,longitude:r.longitude},Microsoft.Maps.PixelReference.control).y);var y=h-c;y<0&&(y=g.width);var m={y:f,x:c,width:y,height:p-f},I=InteractiveDataDisplay.mercatorTransform.dataToPlot(m.y),D=InteractiveDataDisplay.mercatorTransform.dataToPlot(m.y+m.height);if(m.y=I,m.height=D-I,0!=v||0!=u){var C=o-u-v,b=m.height/C,w=v*b,A=u*b,x=m.y-w,T=m.y+m.height+A;m.y=x,m.height=T-x}return m},InteractiveDataDisplay.BingMapsAnimation=function(t){this.base=InteractiveDataDisplay.AnimationBase,this.base();var g=this,p=t,h=void 0,f=void 0,u=new Date,v=void 0,y=void 0,m=void 0,I=0,r=void 0,D=void 0,C=!1;Object.defineProperty(this,"previousEstimatedPlotRect",{get:function(){return y},configurable:!1});var n=function(){!function(){if(g.currentObserver){var t=new Date,e=t.getTime()-u.getTime(),i=D*e,a=f.x-v.x,r=f.y-v.y,n=Math.max(f.width/1e3,Math.sqrt(a*a+r*r)),o=v.x+n*i*m.x,s=v.y+n*i*m.y,l=(f.width-v.width)*i+v.width,d=(f.height-v.height)*i+v.height;u=t,a=o-h.x,r=s-h.y;var c=Math.sqrt(a*a+r*r);I<=c?(g.isInAnimation=!1,A(f),g.stop()):(v={x:o,y:s,width:l,height:d},g.currentPlotRect=v,A(v))}}(),g.isInAnimation&&(r=setTimeout(function(){n()},1e3/60))};this.animate=function(t,e,i){if(1.4!=InteractiveDataDisplay.Gestures.zoomLevelFactor&&(InteractiveDataDisplay.Gestures.zoomLevelFactor=1.4),void 0!==r&&(clearTimeout(r),r=void 0),y=e,g.isInAnimation=!0,i&&i.isFirstFrame&&x(!0),i&&"Pan"==i.gestureType){C=!1;var a=t();h=void 0===v?a.plotRect:v,v=h,m={x:(f=e).x-h.x,y:f.y-h.y},I=Math.sqrt(m.x*m.x+m.y*m.y),m=1e-10<I?{x:m.x/I,y:m.y/I}:{x:0,y:0},D=.008,n()}else C=!0,A(e)};function b(t,e,i){var a=Math.max(1,Math.log(e.width/t.width*360/256)/Math.log(2)),r=InteractiveDataDisplay.mercatorTransform.plotToData(t.y),n=InteractiveDataDisplay.mercatorTransform.plotToData(t.y+t.height),o=Math.max(1,Math.log(e.height/(n-r)*180/256)/Math.log(2));return!0===i&&(a=Math.ceil(a)-1,o=Math.ceil(o)),Math.min(a,o)}this.setMapView=function(t,e){var i=e;void 0===e&&(i={width:p.getWidth(),height:p.getHeight()});var a=b(t,i,!0),r=(p.getZoom(),{x:t.x+t.width/2,y:InteractiveDataDisplay.mercatorTransform.plotToData(t.y+t.height/2)});p.setView({center:new Microsoft.Maps.Location(r.y,r.x),zoom:a,animate:!1})};var w=0,A=function(t){var e,i=p.getZoom()+w;w=0,e=C?b(t,{width:p.getWidth(),height:p.getHeight()}):i;var a,r,n={x:t.x+t.width/2,y:InteractiveDataDisplay.mercatorTransform.plotToData(t.y+t.height/2)};if(C)if(1<i||i<e){var o=Math.round(e),s=(a=o,{width:360*(r={width:p.getWidth(),height:p.getHeight()}).width/(256*Math.pow(2,a)),height:180*r.height/(256*Math.pow(2,a))});if(t.zoomOrigin)var l=t.zoomOrigin.x,d=InteractiveDataDisplay.mercatorTransform.plotToData(t.zoomOrigin.y),c=d-n.y,h={x:l-(l-n.x)*(s.width/t.width),y:d-c*(s.height/t.height)};else h=n;p.setView({center:new Microsoft.Maps.Location(h.y,h.x),zoom:e,animate:!0})}else x(),y=g.getCurrentPlotRect(),g.stop();else p.setView({center:new Microsoft.Maps.Location(n.y,n.x),zoom:e,animate:!1})};this.getCurrentPlotRect=function(){return p.getBounds(),p.getCenter(),InteractiveDataDisplay.Utils.getPlotRectForMap(p)};var x=function(t){var e=g.currentObserver;if(void 0!==e){var i={plotRect:g.getCurrentPlotRect(),isLast:!1};void 0!==t&&(i.syncUpdate=t),e.onNext(i)}};Microsoft.Maps.Events.addHandler(p,"viewchange",function(t){x()}),Microsoft.Maps.Events.addHandler(p,"viewchangeend",function(t){y=g.getCurrentPlotRect(),C||!g.isInAnimation?g.stop():x()}),this.additionalStopRutines=function(){void 0!==r&&(clearTimeout(r),r=void 0),g.isInAnimation=!1,y=f=h=void 0,u=new Date,m=v=void 0,r=void(I=0),0}},InteractiveDataDisplay.BingMapsAnimation.prototype=new InteractiveDataDisplay.AnimationBase,InteractiveDataDisplay.Event=InteractiveDataDisplay.Event||{},InteractiveDataDisplay.Event.widthScaleChanged=jQuery.Event("widthScaleChanged"),InteractiveDataDisplay.Navigation=function(t,i){var s=t,l=this;s.master.host.on("visibleRectChanged",function(t){var e=s.screenSize.width,i=s.screenSize.width;ct=s.coordinateTransform,vis=ct.getPlotRect({x:0,y:0,width:e,height:i});var a=e/vis.width;s.master.host.trigger(InteractiveDataDisplay.Event.widthScaleChanged,{widthScale:a})});function d(){var t=s.screenSize,e=s.coordinateTransform;return{plotRect:e.getPlotRect({x:0,y:0,width:t.width,height:t.height}),screenSize:t,cs:e}}function c(t,e){i(t,e)}var e=void 0,a=void 0,r=void 0,h=void 0;Object.defineProperty(this,"animation",{get:function(){return r},set:function(t){l.stop(),r=t},configurable:!1});var g=InteractiveDataDisplay.NavigationUtils.calcPannedRect,p=InteractiveDataDisplay.NavigationUtils.calcZoomedRect;Object.defineProperty(this,"widthScale",{get:function(){return s.coordinateTransform.getScale().x},set:function(t){l.stop();var e=s.visibleRect,i=s.screenSize.width/t,a=i/(e.width/e.height),r={x:e.x+.5*e.width-.5*i,y:e.y+.5*e.height-.5*a,width:i,height:a};l.setVisibleRect(r,!1,{suppressScaleChangeNotification:!0})},configurable:!1});function f(){return r&&r.currentObservable.subscribe(function(t){t.isLast&&(s.isInAnimation=!1);var e={syncUpdate:t.syncUpdate};c(t.plotRect,e)},function(t){},function(){})}this.setVisibleRect=function(t,e,i){if(l.stop(),h=t,e)l.animation.isInAnimation||f(),s.isInAnimation=!0,l.animation.animate(d,t);else{var a=t;l.animation&&l.animation.constraint&&(a=l.animation.constraint(a)),c(a,i)}};this.stop=function(){s.isInAnimation=!1,h=void 0,l.animation&&l.animation.stop()},Object.defineProperty(this,"gestureSource",{get:function(){return e},set:function(t){e!=t&&(a&&a.dispose(),void 0!==(e=t)&&(a=e.subscribe(function(t){!function(t){var e,i,a=s.screenSize,r=void 0!==l.animation?l.animation.previousEstimatedPlotRect:h;if(i=void 0!==r?(e=InteractiveDataDisplay.Utils.calcCSWithPadding(r,{width:a.width,height:a.height},{left:0,top:0,bottom:0,right:0},s.aspectRatio),r):(e=s.coordinateTransform).getPlotRect({x:0,y:0,width:a.width,height:a.height}),"Pin"!=t.Type){var n=void 0;if("Pan"==t.Type?(n=g(i,a,t),h=n):"Zoom"==t.Type&&((n=p(i,e,t)).width<1e-9&&(n.width=i.width,n.x=i.x),n.height<1e-9&&(n.height=i.height,n.y=i.y),h=n),n)if(l.animation){var o=!l.animation.isInAnimation;o&&f(),s.isInAnimation=!0,l.animation.animate(d,n,{gestureType:t.Type,isFirstFrame:o})}else c(n)}else l.animation&&l.animation.isInAnimation&&l.stop()}(t)})))},configurable:!1}),l.animation=new InteractiveDataDisplay.PanZoomAnimation},InteractiveDataDisplay.NavigationUtils={},InteractiveDataDisplay.NavigationUtils.SuppressDefaultMultitouch=function(){navigator.userAgent.match(/(iPhone|iPod|iPad)/)&&document.addEventListener("touchmove",function(t){t.preventDefault()},!1),-1!=navigator.userAgent.indexOf("Mac")&&(document.getElementsByTagName("body")[0].style.overflow="hidden")},InteractiveDataDisplay.NavigationUtils.calcPannedRect=function(t,e,i){var a=t.width/e.width,r=t.height/e.height,n=i.xOffset*a,o=-i.yOffset*r;return{x:t.x-n,y:t.y-o,width:t.width,height:t.height}},InteractiveDataDisplay.NavigationUtils.calcZoomedRect=function(t,e,i){var a=e.getScale(),r=e.plotToScreenX(t.x+t.width/2),n=e.plotToScreenY(t.y+t.height/2),o=i.preventHorizontal?0:i.xOrigin-r,s=i.preventVertical?0:i.yOrigin-n,l=t.x+o/a.x,d=t.y-s/a.y,c=t.width,h=t.height,g=t.width*(i.preventHorizontal?1:i.scaleFactor),p=t.height*(i.preventVertical?1:i.scaleFactor),f=d+h/2-p/2;return{x:l+c/2-g/2-i.scaleFactor*o/a.x,y:f+i.scaleFactor*s/a.y,width:g,height:p,zoomOrigin:{x:e.screenToPlotX(i.xOrigin),y:e.screenToPlotY(i.yOrigin)}}},InteractiveDataDisplay.SharedRenderWorker=function(e,r){var t=!!window.Worker;!t&&window.console&&console.log("Web workers are not available");var n=null;try{n=t?new Worker(e):null}catch(t){console.error("Error creating Web worker from "+e+": "+t.message)}function a(t,e){for(var i=s.length,a=0;a<i;a++)if(s[a].source==t)return s[a];if(!e){var r={source:t,pendingTask:void 0,index:i};return s.push(r),r}}var o=!1,s=[];n&&(n.onmessage=function(t){var e=t.data,i=s[e.sourceIndex],a=function(t){var e=s.length,i=0;if(t){for(var a=(i=t.index)+1;a<e;a++)if(s[a].pendingTask)return s[a];for(a=0;a<i;a++)if(s[a].pendingTask)return s[a];if(s[i].pendingTask)return s[i]}else for(a=0;a<e;a++)if(s[a].pendingTask)return s[a]}(i);a?(o=!0,n.postMessage(a.pendingTask),a.pendingTask=void 0):o=!1,r&&r(i.source,e)},n.onerror=function(t){var e=t.message+" ("+t.filename+":"+t.lineno+")";"object"==typeof console&&console.log(e)}),this.enqueue=function(t,e){var i=a(e);t.sourceIndex=i.index,o?i.pendingTask=t:(o=!0,i.pendingTask=void 0,n.postMessage(t))},this.cancelPending=function(t){var e=a(t,!0);e&&(e.pendingTask=void 0)},t||(this.enqueue=function(t,e){},this.cancelPending=function(t){})},InteractiveDataDisplay.heatmapBackgroundRendererCodeBase64="SW50ZXJhY3RpdmVEYXRhRGlzcGxheSA9IHR5cGVvZiBJbnRlcmFjdGl2ZURhdGFEaXNwbGF5ID09ICd1bmRlZmluZWQnID8ge30gOiBJbnRlcmFjdGl2ZURhdGFEaXNwbGF5Ow0KIA0KSW50ZXJhY3RpdmVEYXRhRGlzcGxheS5EYXRhVHJhbnNmb3JtID0gZnVuY3Rpb24gKGRhdGFUb1Bsb3QsIHBsb3RUb0RhdGEsIGRvbWFpbiwgdHlwZSkgew0KICAgIHRoaXMuZGF0YVRvUGxvdCA9IGRhdGFUb1Bsb3Q7DQogICAgdGhpcy5wbG90VG9EYXRhID0gcGxvdFRvRGF0YTsNCg0KICAgIHRoaXMuZG9tYWluID0gZG9tYWluIHx8IHsNCiAgICAgICAgaXNJbkRvbWFpbjogZnVuY3Rpb24gKHZhbHVlKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICB0aGlzLnR5cGUgPSB0eXBlOw0KfTsNCg0KdmFyIG1lcmNhdG9yX21heFBoaSA9IDg1LjA1MTEyODc4OyAvLzg3LjExNDc1NzYzNjMzODQ7IC8vIGRlZw0KdmFyIG1lcmNhdG9yX1IgPSBtZXJjYXRvcl9tYXhQaGkgLyBNYXRoLmxvZyhNYXRoLnRhbihtZXJjYXRvcl9tYXhQaGkgKiBNYXRoLlBJIC8gMzYwLjAgKyBNYXRoLlBJIC8gNCkpOw0KSW50ZXJhY3RpdmVEYXRhRGlzcGxheS5tZXJjYXRvclRyYW5zZm9ybSA9IG5ldyBJbnRlcmFjdGl2ZURhdGFEaXNwbGF5LkRhdGFUcmFuc2Zvcm0oDQogICAgZnVuY3Rpb24gKHBoaV9kZWcpIHsNCiAgICAgICAgaWYgKHBoaV9kZWcgPj0gLW1lcmNhdG9yX21heFBoaSAmJiBwaGlfZGVnIDw9IG1lcmNhdG9yX21heFBoaSkNCiAgICAgICAgICAgIHJldHVybiBtZXJjYXRvcl9SICogTWF0aC5sb2coTWF0aC50YW4oTWF0aC5QSSAqIChwaGlfZGVnICsgOTApIC8gMzYwKSk7DQogICAgICAgIGVsc2UgcmV0dXJuIHBoaV9kZWc7DQogICAgfSwNCiAgICBmdW5jdGlvbiAoeSkgew0KICAgICAgICBpZiAoLW1lcmNhdG9yX21heFBoaSA8PSB5ICYmIHkgPD0gbWVyY2F0b3JfbWF4UGhpKSB7DQogICAgICAgICAgICByZXR1cm4gMzYwICogTWF0aC5hdGFuKE1hdGguZXhwKHkgLyBtZXJjYXRvcl9SKSkgLyBNYXRoLlBJIC0gOTA7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHk7DQogICAgfSwNCiAgICB1bmRlZmluZWQsDQogICAgIm1lcmNhdG9yIg0KKTsNCg0KDQpNYXRoLkxPR0UxMCA9IE1hdGgubG9nKDEwKTsNCg0KSW50ZXJhY3RpdmVEYXRhRGlzcGxheS5sb2dUcmFuc2Zvcm0gPSBuZXcgSW50ZXJhY3RpdmVEYXRhRGlzcGxheS5EYXRhVHJhbnNmb3JtKA0KICAgIGZ1bmN0aW9uICh4X2QpIHsNCiAgICAgICAgcmV0dXJuIE1hdGgubG9nKHhfZCkgLyBNYXRoLkxPR0UxMDsNCiAgICB9LA0KICAgIGZ1bmN0aW9uICh4X3ApIHsNCiAgICAgICAgcmV0dXJuIE1hdGgucG93KDEwLCB4X3ApOw0KICAgIH0sDQogICAgeyBpc0luRG9tYWluOiBmdW5jdGlvbiAoeCkgeyByZXR1cm4geCA+IDAuMDAwMDAwMDE7IH0gfSwNCiAgICAibG9nMTAiDQopOw0KDQpJbnRlcmFjdGl2ZURhdGFEaXNwbGF5LmlkZW50aXR5VHJhbnNmb3JtID0gbmV3IEludGVyYWN0aXZlRGF0YURpc3BsYXkuRGF0YVRyYW5zZm9ybSgNCiAgICBmdW5jdGlvbiAoeF9kKSB7IHJldHVybiB4X2Q7IH0sDQogICAgZnVuY3Rpb24gKHhfcCkgeyByZXR1cm4geF9wOyB9LA0KICAgIHsgaXNJbkRvbWFpbjogZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHRydWUgfSB9LA0KICAgICJpZGVudGl0eSINCik7O3NlbGYub25tZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7DQogICAgdmFyIHhzY2FsZSA9IGV2ZW50LmRhdGEuc2NhbGVYLCB4b2Zmc2V0ID0gZXZlbnQuZGF0YS5vZmZzZXRYLCB5c2NhbGUgPSBldmVudC5kYXRhLnNjYWxlWSwgeW9mZnNldCA9IGV2ZW50LmRhdGEub2Zmc2V0WTsNCiAgICB2YXIgZGF0YVRvU2NyZWVuWCwgZGF0YVRvU2NyZWVuWTsNCiAgICB2YXIgaGFzZHRYLCBoYXNkdFk7DQoNCiAgICBpZiAodHlwZW9mIGV2ZW50LmRhdGEueERhdGFUcmFuc2Zvcm0gPT0gJ3N0cmluZycpIHsNCiAgICAgICAgdmFyIGR0ID0gZ2V0RGF0YVRyYW5zZm9ybShldmVudC5kYXRhLnhEYXRhVHJhbnNmb3JtKTsNCiAgICAgICAgdmFyIGYgPSBkdC5kYXRhVG9QbG90Ow0KICAgICAgICBoYXNkdFggPSB0cnVlOw0KICAgICAgICBkYXRhVG9TY3JlZW5YID0gZnVuY3Rpb24gKHgpIHsNCiAgICAgICAgICAgIHJldHVybiBmKHgpICogeHNjYWxlICsgeG9mZnNldDsNCiAgICAgICAgfTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBoYXNkdFggPSBmYWxzZTsNCiAgICAgICAgZGF0YVRvU2NyZWVuWCA9IGZ1bmN0aW9uICh4KSB7DQogICAgICAgICAgICByZXR1cm4geHNjYWxlICogeCArIHhvZmZzZXQ7DQogICAgICAgIH07DQogICAgfQ0KICAgIGlmICh0eXBlb2YgZXZlbnQuZGF0YS55RGF0YVRyYW5zZm9ybSA9PSAnc3RyaW5nJykgew0KICAgICAgICB2YXIgZHQgPSBnZXREYXRhVHJhbnNmb3JtKGV2ZW50LmRhdGEueURhdGFUcmFuc2Zvcm0pOw0KICAgICAgICB2YXIgZiA9IGR0LmRhdGFUb1Bsb3Q7DQogICAgICAgIGhhc2R0WSA9IHRydWU7DQogICAgICAgIGRhdGFUb1NjcmVlblkgPSBmdW5jdGlvbiAoeSkgew0KICAgICAgICAgICAgcmV0dXJuIHlvZmZzZXQgLSBmKHkpICogeXNjYWxlOw0KICAgICAgICB9Ow0KICAgIH0gZWxzZSB7DQogICAgICAgIGhhc2R0WSA9IGZhbHNlOw0KICAgICAgICBkYXRhVG9TY3JlZW5ZID0gZnVuY3Rpb24gKHkpIHsNCiAgICAgICAgICAgIHJldHVybiB5b2Zmc2V0IC0geSAqIHlzY2FsZTsNCiAgICAgICAgfTsNCiAgICB9DQoNCiAgICB2YXIgd2lkdGggPSBldmVudC5kYXRhLndpZHRoOw0KICAgIHZhciBoZWlnaHQgPSBldmVudC5kYXRhLmhlaWdodDsNCg0KICAgIGlmIChldmVudC5kYXRhLngubGVuZ3RoICE9IGV2ZW50LmRhdGEuZi5sZW5ndGgpIHsNCiAgICAgICAgcmVuZGVyTWF0cml4KGV2ZW50LmRhdGEuaW1hZ2UsIHdpZHRoLCBoZWlnaHQsIGV2ZW50LmRhdGEueCwgZXZlbnQuZGF0YS55LCBldmVudC5kYXRhLmYsIGV2ZW50LmRhdGEuZm1pbiwgZXZlbnQuZGF0YS5mbWF4LCBldmVudC5kYXRhLnBhbGV0dGUsIGV2ZW50LmRhdGEucGxvdFJlY3QsIGRhdGFUb1NjcmVlblgsIGRhdGFUb1NjcmVlblksIGhhc2R0WCwgaGFzZHRZKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICB2YXIgc2NyZWVuVG9EYXRhWCwgc2NyZWVuVG9EYXRhWTsNCiAgICAgICAgeHNjYWxlX3IgPSAxIC8geHNjYWxlOw0KICAgICAgICB5c2NhbGVfciA9IDEgLyB5c2NhbGU7DQogICAgICAgIGlmIChoYXNkdFgpIHsNCiAgICAgICAgICAgIHZhciBwbG90VG9EYXRhID0gZHQucGxvdFRvRGF0YTsNCiAgICAgICAgICAgIHNjcmVlblRvRGF0YVggPSBmdW5jdGlvbiAoeHMpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gcGxvdFRvRGF0YSgoeHMgLSB4b2Zmc2V0KSAqIHhzY2FsZV9yKTsNCiAgICAgICAgICAgIH07DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzY3JlZW5Ub0RhdGFYID0gZnVuY3Rpb24gKHhzKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICh4cyAtIHhvZmZzZXQpICogeHNjYWxlX3I7DQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQogICAgICAgIGlmIChoYXNkdFkpIHsNCiAgICAgICAgICAgIHZhciBwbG90VG9EYXRhID0gZHQucGxvdFRvRGF0YTsNCiAgICAgICAgICAgIHNjcmVlblRvRGF0YVkgPSBmdW5jdGlvbiAoeXMpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gcGxvdFRvRGF0YSgoeW9mZnNldCAtIHlzKSAqIHlzY2FsZV9yKTsNCiAgICAgICAgICAgIH07DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzY3JlZW5Ub0RhdGFZID0gZnVuY3Rpb24gKHlzKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICh5b2Zmc2V0IC0geXMpICogeXNjYWxlX3I7DQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQogICAgICAgIHJlbmRlckdyYWRpZW50KGV2ZW50LmRhdGEuaW1hZ2UsIHdpZHRoLCBoZWlnaHQsIGV2ZW50LmRhdGEueCwgZXZlbnQuZGF0YS55LCBldmVudC5kYXRhLmYsIGV2ZW50LmRhdGEuZm1pbiwgZXZlbnQuZGF0YS5mbWF4LCBldmVudC5kYXRhLnBhbGV0dGUsIGV2ZW50LmRhdGEucGxvdFJlY3QsIGRhdGFUb1NjcmVlblgsIHNjcmVlblRvRGF0YVgsIGRhdGFUb1NjcmVlblksIHNjcmVlblRvRGF0YVksIGhhc2R0WCwgaGFzZHRZKTsNCiAgICB9DQogICAgZXZlbnQuZGF0YS54ID0gdW5kZWZpbmVkOw0KICAgIGV2ZW50LmRhdGEueSA9IHVuZGVmaW5lZDsNCiAgICBldmVudC5kYXRhLmYgPSB1bmRlZmluZWQ7DQogICAgZXZlbnQuZGF0YS5wYWxldHRlID0gdW5kZWZpbmVkOw0KICAgIHNlbGYucG9zdE1lc3NhZ2UoZXZlbnQuZGF0YSk7DQp9Ow0KDQp2YXIgZ2V0RGF0YVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0eXBlKSB7DQogICAgaWYgKHR5cGUgPT0gJ21lcmNhdG9yJykNCiAgICAgICAgcmV0dXJuIEludGVyYWN0aXZlRGF0YURpc3BsYXkubWVyY2F0b3JUcmFuc2Zvcm07DQogICAgdGhyb3cgJ1Vua25vd24gZGF0YSB0cmFuc2Zvcm0nOw0KfTsNCg0KDQp2YXIgcmVuZGVyTWF0cml4ID0gZnVuY3Rpb24gKGltYWdlLCB3aWR0aCwgaGVpZ2h0LCB4LCB5LCBmLCBmbWluLCBmbWF4LCBwYWxldHRlLCBwbG90UmVjdCwgZGF0YVRvU2NyZWVuWCwgZGF0YVRvU2NyZWVuWSwgaGFzRGF0YVRyYW5zZm9ybVgsIGhhc0RhdGFUcmFuc2Zvcm1ZKSB7DQogICAgdmFyIG4gPSB4Lmxlbmd0aDsNCiAgICB2YXIgbSA9IHkubGVuZ3RoOw0KICAgIHZhciBpbWFnZURhdGEgPSBpbWFnZS5kYXRhOw0KICAgIHZhciB3ID0gd2lkdGg7DQogICAgdmFyIGggPSBoZWlnaHQ7DQoNCiAgICB2YXIgaTAsIGowOw0KICAgIHZhciB4MCwgeTA7IC8vIGluIGRhdGEgc3BhY2UNCg0KDQogICAgLy8gcHJlY29tcHV0aW5nIHkgaW4gc2NyZWVuIGNvb3JkaW5hdGVzOg0KICAgIHZhciB5c2NyID0gbmV3IEZsb2F0MzJBcnJheShtKTsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG07IGkrKykNCiAgICAgICAgeXNjcltpXSA9IGRhdGFUb1NjcmVlblkoeVtpXSkgfCAwOyAvLyBmbG9vcjsNCg0KICAgIC8vIHN0YXJ0IGNlbGwNCiAgICB2YXIgbGVmdHAgPSBwbG90UmVjdC54Ow0KICAgIHZhciByaWdodHAgPSBsZWZ0cCArIHBsb3RSZWN0LndpZHRoOw0KICAgIGlmIChoYXNEYXRhVHJhbnNmb3JtWCkgew0KICAgICAgICBmb3IgKGkwID0gMDsgaTAgPCBuOyBpMCsrKSB7DQogICAgICAgICAgICBpZiAoZGF0YVRvU2NyZWVuWCh4W2kwXSkgPj0gMCkgew0KICAgICAgICAgICAgICAgIGlmIChpMCA9PSAwKSBpMCsrOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgZm9yIChpMCA9IDA7IGkwIDwgbjsgaTArKykgew0KICAgICAgICAgICAgaWYgKHhbaTBdID49IGxlZnRwKSB7DQogICAgICAgICAgICAgICAgaWYgKGkwID09IDApIGkwKys7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKGkwID09IG4pIHJldHVybjsNCg0KICAgIHZhciBib3R0b21wID0gcGxvdFJlY3QueTsNCiAgICB2YXIgdG9wcCA9IGJvdHRvbXAgKyBwbG90UmVjdC5oZWlnaHQ7DQogICAgZm9yIChqMCA9IDA7IGowIDwgbTsgajArKykgew0KICAgICAgICBpZiAoeXNjcltqMF0gPCBoKSB7DQogICAgICAgICAgICBpZiAoajAgPT0gMCkgajArKzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChqMCA9PSBtKSByZXR1cm47DQoNCiAgICAvLyByZW5kZXJpbmcgZnJvbSBsZWZ0IHRvIHJpZ2h0LCBib3R0b20gdG8gdG9wDQogICAgdmFyIGNlbGxMZWZ0X3MgPSAwLCBjZWxsUmlnaHRfcyA9IDA7DQoNCiAgICB2YXIgaXNOb3JtYWxpemVkID0gcGFsZXR0ZS5pc05vcm1hbGl6ZWQ7DQogICAgdmFyIGNvbG9ycyA9IHBhbGV0dGUuY29sb3JzOw0KICAgIHZhciBjb2xOID0gKGNvbG9ycy5sZW5ndGggPj4gMikgLSAxOw0KICAgIGlmICghaXNOb3JtYWxpemVkKSB7DQogICAgICAgIGZtYXggPSBwYWxldHRlLnJhbmdlLm1heDsNCiAgICAgICAgZm1pbiA9IHBhbGV0dGUucmFuZ2UubWluOw0KICAgIH0NCiAgICB2YXIgcGFsZXR0ZUsgPSBmbWF4ICE9PSBmbWluID8gMS4wIC8gKGZtYXggLSBmbWluKSA6IDA7DQoNCiAgICBmb3IgKHZhciBpID0gaTA7IGkgPCBuICYmIGNlbGxSaWdodF9zIDwgdzsgaSsrKSB7DQogICAgICAgIC8vIGkwIGlzIHRoZSByaWdodCB2aXNpYmxlIGVkZ2Ugb2YgdGhlIGNlbGwNCiAgICAgICAgeDAgPSB4W2kgLSAxXTsNCiAgICAgICAgdmFyIHgxID0geFtpXTsNCg0KICAgICAgICBpZiAoeDAgIT0geDAgfHwgeDEgIT0geDEpIHsNCiAgICAgICAgICAgIGNlbGxSaWdodF9zID0gdW5kZWZpbmVkOw0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoY2VsbFJpZ2h0X3MpDQogICAgICAgICAgICBjZWxsTGVmdF9zID0gY2VsbFJpZ2h0X3M7DQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIGNlbGxMZWZ0X3MgPSBNYXRoLmNlaWwoZGF0YVRvU2NyZWVuWCh4MCkpOw0KDQogICAgICAgIGNlbGxSaWdodF9zID0gTWF0aC5jZWlsKGRhdGFUb1NjcmVlblgoeDEpKTsNCiAgICAgICAgaWYgKGNlbGxMZWZ0X3MgPCAwKSBjZWxsTGVmdF9zID0gMDsNCiAgICAgICAgaWYgKGNlbGxSaWdodF9zID49IHcpIGNlbGxSaWdodF9zID0gdzsNCg0KICAgICAgICAvL2lmIChpID09IG4gLSAxKSBjZWxsUmlnaHRfcysrOw0KICAgICAgICBpZiAoY2VsbFJpZ2h0X3MgLSBjZWxsTGVmdF9zID09IDApIGNvbnRpbnVlOw0KDQogICAgICAgIHkwID0geVtqMCAtIDFdOw0KICAgICAgICB2YXIgY2VsbEJvdHRvbV9zID0gMCwNCiAgICAgICAgICAgIGNlbGxUb3BfcyA9IHlzY3JbajAgLSAxXTsNCiAgICAgICAgZm9yICh2YXIgaiA9IGowOyBqIDwgbSAmJiBjZWxsQm90dG9tX3MgPj0gMDsgaisrKSB7DQogICAgICAgICAgICB5MCA9IHlbaiAtIDFdOw0KICAgICAgICAgICAgdmFyIHkxID0geVtqXTsNCg0KICAgICAgICAgICAgaWYgKHkwICE9IHkwIHx8IHkxICE9IHkxKSB7DQogICAgICAgICAgICAgICAgY2VsbFRvcF9zID0gdW5kZWZpbmVkOw0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoY2VsbFRvcF9zKQ0KICAgICAgICAgICAgICAgIGNlbGxCb3R0b21fcyA9IGNlbGxUb3BfczsNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICBjZWxsQm90dG9tX3MgPSB5c2NyW2ogLSAxXTsNCiAgICAgICAgICAgIGNlbGxUb3BfcyA9IHlzY3Jbal07DQogICAgICAgICAgICBpZiAoY2VsbFRvcF9zIDwgMCkgY2VsbFRvcF9zID0gLTE7DQogICAgICAgICAgICBpZiAoY2VsbEJvdHRvbV9zID49IGgpIGNlbGxCb3R0b21fcyA9IGggLSAxOw0KDQogICAgICAgICAgICBpZiAoY2VsbFRvcF9zIC0gY2VsbEJvdHRvbV9zID09IDApIGNvbnRpbnVlOw0KDQogICAgICAgICAgICB2YXIgX2YgPSBmW2kgLSAxXVtqIC0gMV07DQogICAgICAgICAgICBpZiAoX2YgIT0gX2YpIGNvbnRpbnVlOw0KICAgICAgICAgICAgdmFyIHBhbGV0dGVWYWwgPSBwYWxldHRlSyAqIChfZiAtIGZtaW4pOw0KICAgICAgICAgICAgdmFyIGsgPSAocGFsZXR0ZVZhbCAqIGNvbE4pIHwgMDsNCiAgICAgICAgICAgIGlmIChrIDwgMCkgayA9IDA7DQogICAgICAgICAgICBlbHNlIGlmIChrID4gY29sTikgayA9IGNvbE47DQogICAgICAgICAgICBrID0gayA8PCAyOw0KDQogICAgICAgICAgICAvLyBmaWxscyB0aGUgY2VsbCB3aXRoIHNhbWUgY29sb3INCiAgICAgICAgICAgIGZvciAodmFyIHlzID0gY2VsbFRvcF9zICsgMTsgeXMgPD0gY2VsbEJvdHRvbV9zOyB5cysrKSB7DQogICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gKHcgKiB5cyArIGNlbGxMZWZ0X3MpIDw8IDI7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgeHMgPSBjZWxsTGVmdF9zOyB4cyA8IGNlbGxSaWdodF9zOyB4cysrKSB7DQogICAgICAgICAgICAgICAgICAgIGltYWdlRGF0YVtpbmRleCsrXSA9IGNvbG9yc1trXTsNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2luZGV4KytdID0gY29sb3JzW2sgKyAxXTsNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2luZGV4KytdID0gY29sb3JzW2sgKyAyXTsNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2luZGV4KytdID0gY29sb3JzW2sgKyAzXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoY2VsbFRvcF9zIDw9IDApIGJyZWFrOw0KICAgICAgICB9DQogICAgICAgIGlmIChjZWxsUmlnaHRfcyA+PSB3KSBicmVhazsNCiAgICB9DQp9Ow0KDQoNCnZhciByZW5kZXJHcmFkaWVudCA9IGZ1bmN0aW9uIChpbWFnZSwgd2lkdGgsIGhlaWdodCwgeCwgeSwgZiwgZm1pbiwgZm1heCwgcGFsZXR0ZSwgcGxvdFJlY3QsIGRhdGFUb1NjcmVlblgsIHNjcmVlblRvRGF0YVgsIGRhdGFUb1NjcmVlblksIHNjcmVlblRvRGF0YVksIGhhc0RhdGFUcmFuc2Zvcm1YLCBoYXNEYXRhVHJhbnNmb3JtWSkgew0KICAgIHZhciBuID0geC5sZW5ndGg7DQogICAgdmFyIG0gPSB5Lmxlbmd0aDsNCiAgICB2YXIgaW1hZ2VEYXRhID0gaW1hZ2UuZGF0YTsNCiAgICB2YXIgdyA9IHdpZHRoOw0KICAgIHZhciBoID0gaGVpZ2h0Ow0KDQogICAgLy8gcHJlY29tcHV0aW5nIHkgaW4gc2NyZWVuIGNvb3JkaW5hdGVzOg0KICAgIHZhciB5c2NyID0gbmV3IEZsb2F0MzJBcnJheShtKTsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG07IGkrKykNCiAgICAgICAgeXNjcltpXSA9IGRhdGFUb1NjcmVlblkoeVtpXSkgfCAwOyAvLyBmbG9vcjsNCg0KICAgIC8vIHByZXBhcmluZyBzY3JlZW4gdG8gZGF0YSBtYXBwaW5nDQogICAgdmFyIG1hcFNjcmVlblRvRGF0YVggPSBuZXcgRmxvYXQzMkFycmF5KHcpOw0KICAgIGZvciAodmFyIHhzID0gMDsgeHMgPCB3OyB4cysrKSB7DQogICAgICAgIG1hcFNjcmVlblRvRGF0YVhbeHNdID0gc2NyZWVuVG9EYXRhWCh4cyArIDAuNSk7IC8vIHRvZG86IG1ha2UgaW5saW5lIHRyYW5zZm9ybSBmb3IgbGluZWFyIGNhc2UNCiAgICB9DQogICAgdmFyIG1hcFNjcmVlblRvRGF0YVkgPSBuZXcgRmxvYXQzMkFycmF5KGgpOw0KICAgIGZvciAodmFyIHlzID0gMDsgeXMgPCBoOyB5cysrKSB7DQogICAgICAgIG1hcFNjcmVlblRvRGF0YVlbeXNdID0gc2NyZWVuVG9EYXRhWSh5cyArIDAuNSk7IC8vIHRvZG86IG1ha2UgaW5saW5lIHRyYW5zZm9ybSBmb3IgbGluZWFyIGNhc2UNCiAgICB9DQoNCiAgICB2YXIgaTAsIGowOw0KICAgIHZhciB4MCwgeTA7IC8vIGluIGRhdGEgc3BhY2UNCg0KICAgIC8vIHN0YXJ0IGNlbGwNCiAgICB2YXIgbGVmdHAgPSBwbG90UmVjdC54Ow0KICAgIHZhciByaWdodHAgPSBsZWZ0cCArIHBsb3RSZWN0LndpZHRoOw0KICAgIGlmIChoYXNEYXRhVHJhbnNmb3JtWCkgew0KICAgICAgICBmb3IgKGkwID0gMDsgaTAgPCBuOyBpMCsrKSB7DQogICAgICAgICAgICBpZiAoZGF0YVRvU2NyZWVuWCh4W2kwXSkgPj0gMCkgew0KICAgICAgICAgICAgICAgIGlmIChpMCA9PSAwKSBpMCsrOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgZm9yIChpMCA9IDA7IGkwIDwgbjsgaTArKykgew0KICAgICAgICAgICAgaWYgKHhbaTBdID49IGxlZnRwKSB7DQogICAgICAgICAgICAgICAgaWYgKGkwID09IDApIGkwKys7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKGkwID09IG4pIHJldHVybjsNCg0KICAgIHZhciBib3R0b21wID0gcGxvdFJlY3QueTsNCiAgICB2YXIgdG9wcCA9IGJvdHRvbXAgKyBwbG90UmVjdC5oZWlnaHQ7DQogICAgZm9yIChqMCA9IDA7IGowIDwgbTsgajArKykgew0KICAgICAgICBpZiAoeXNjcltqMF0gPCBoKSB7DQogICAgICAgICAgICBpZiAoajAgPT0gMCkgajArKzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChqMCA9PSBtKSByZXR1cm47DQoNCiAgICAvLyByZW5kZXJpbmcgZnJvbSBsZWZ0IHRvIHJpZ2h0LCBib3R0b20gdG8gdG9wDQogICAgdmFyIGNlbGxMZWZ0X3MgPSAwLCBjZWxsUmlnaHRfcyA9IDA7DQoNCiAgICB2YXIgaXNOb3JtYWxpemVkID0gcGFsZXR0ZS5pc05vcm1hbGl6ZWQ7DQogICAgdmFyIGNvbG9ycyA9IHBhbGV0dGUuY29sb3JzOw0KICAgIHZhciBjb2xOID0gKGNvbG9ycy5sZW5ndGggPj4gMikgLSAxOw0KICAgIGlmICghaXNOb3JtYWxpemVkKSB7DQogICAgICAgIGZtYXggPSBwYWxldHRlLnJhbmdlLm1heDsNCiAgICAgICAgZm1pbiA9IHBhbGV0dGUucmFuZ2UubWluOw0KICAgIH0NCiAgICB2YXIgcGFsZXR0ZUsgPSBmbWF4ICE9PSBmbWluID8gMS4wIC8gKGZtYXggLSBmbWluKSA6IDA7DQoNCiAgICB2YXIgZmxiLCBmbHQsIGZydCwgZnJiOw0KICAgIHZhciBmaSwgZmkxOw0KDQogICAgLy8gcmVuZGVyaW5nIHRoZSBpbWFnZQ0KICAgIGZvciAodmFyIGkgPSBpMDsgaSA8IG4gJiYgY2VsbFJpZ2h0X3MgPCB3OyBpKyspIHsNCiAgICAgICAgLy8gaTAgaXMgdGhlIHJpZ2h0IHZpc2libGUgZWRnZSBvZiB0aGUgY2VsbA0KICAgICAgICB4MCA9IHhbaSAtIDFdOw0KICAgICAgICB2YXIgeDEgPSB4W2ldOw0KICAgICAgICBpZiAoeDAgIT0geDAgfHwgeDEgIT0geDEpIHsgLy8gYSAhPSBhICBlcXVpdi4gaXNOYU4oYSkNCiAgICAgICAgICAgIGNlbGxSaWdodF9zID0gdW5kZWZpbmVkOw0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoY2VsbFJpZ2h0X3MpDQogICAgICAgICAgICBjZWxsTGVmdF9zID0gY2VsbFJpZ2h0X3M7DQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIGNlbGxMZWZ0X3MgPSBNYXRoLmNlaWwoZGF0YVRvU2NyZWVuWCh4MCkpOw0KICAgICAgICBjZWxsUmlnaHRfcyA9IE1hdGguY2VpbChkYXRhVG9TY3JlZW5YKHgxKSk7DQogICAgICAgIGlmIChjZWxsTGVmdF9zIDwgMCkgY2VsbExlZnRfcyA9IDA7DQogICAgICAgIGlmIChjZWxsUmlnaHRfcyA+PSB3KSBjZWxsUmlnaHRfcyA9IHc7DQogICAgICAgIGlmIChjZWxsUmlnaHRfcyAtIGNlbGxMZWZ0X3MgPT0gMCkgY29udGludWU7DQoNCiAgICAgICAgdmFyIGNlbGxCb3R0b21fcyA9IDAsIGNlbGxUb3BfcyA9IDA7DQogICAgICAgIGZpID0gZltpXTsNCiAgICAgICAgZmkxID0gZltpIC0gMV07DQogICAgICAgIGZvciAodmFyIGogPSBqMDsgaiA8IG0gJiYgY2VsbEJvdHRvbV9zID49IDA7IGorKykgew0KICAgICAgICAgICAgeTAgPSB5W2ogLSAxXTsNCiAgICAgICAgICAgIHZhciB5MSA9IHlbal07DQogICAgICAgICAgICBpZiAoeTAgIT0geTAgfHwgeTEgIT0geTEpIHsNCiAgICAgICAgICAgICAgICBjZWxsVG9wX3MgPSB1bmRlZmluZWQ7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChjZWxsVG9wX3MpDQogICAgICAgICAgICAgICAgY2VsbEJvdHRvbV9zID0gY2VsbFRvcF9zOw0KICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIGNlbGxCb3R0b21fcyA9IHlzY3JbaiAtIDFdOw0KICAgICAgICAgICAgY2VsbFRvcF9zID0geXNjcltqXTsNCiAgICAgICAgICAgIGlmIChjZWxsVG9wX3MgPCAwKSBjZWxsVG9wX3MgPSAtMTsNCiAgICAgICAgICAgIGlmIChjZWxsQm90dG9tX3MgPj0gaCkgY2VsbEJvdHRvbV9zID0gaCAtIDE7DQogICAgICAgICAgICBpZiAoY2VsbEJvdHRvbV9zIC0gY2VsbFRvcF9zID09IDApIGNvbnRpbnVlOw0KDQogICAgICAgICAgICAvLyBmaWxscyB0aGUgY2VsbA0KICAgICAgICAgICAgZmx0ID0gZmkxW2pdOw0KICAgICAgICAgICAgZmxiID0gZmkxW2ogLSAxXTsNCiAgICAgICAgICAgIGZydCA9IGZpW2pdOw0KICAgICAgICAgICAgZnJiID0gZmlbaiAtIDFdOw0KDQogICAgICAgICAgICBpZiAoZmx0ICE9IGZsdCB8fCBmbGIgIT0gZmxiIHx8IGZydCAhPSBmcnQgfHwgZnJiICE9IGZyYikNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCg0KICAgICAgICAgICAgdmFyIGt5TGVmdCA9IChmbHQgLSBmbGIpIC8gKHkxIC0geTApOw0KICAgICAgICAgICAgdmFyIGt5UmlnaHQgPSAoZnJ0IC0gZnJiKSAvICh5MSAtIHkwKTsNCiAgICAgICAgICAgIGZvciAodmFyIHlzID0gY2VsbFRvcF9zICsgMTsgeXMgPD0gY2VsbEJvdHRvbV9zOyB5cysrKSB7DQogICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gKHcgKiB5cyArIGNlbGxMZWZ0X3MpIDw8IDI7DQogICAgICAgICAgICAgICAgdmFyIF95ID0gbWFwU2NyZWVuVG9EYXRhWVt5c107DQogICAgICAgICAgICAgICAgdmFyIGZsZWZ0ID0ga3lMZWZ0ICogKF95IC0geTApICsgZmxiOw0KICAgICAgICAgICAgICAgIHZhciBmcmlnaHQgPSBreVJpZ2h0ICogKF95IC0geTApICsgZnJiOw0KICAgICAgICAgICAgICAgIHZhciBreCA9IChmcmlnaHQgLSBmbGVmdCkgLyAoeDEgLSB4MCk7DQoNCiAgICAgICAgICAgICAgICBmb3IgKHZhciB4cyA9IGNlbGxMZWZ0X3M7IHhzIDwgY2VsbFJpZ2h0X3M7IHhzKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIF94ID0gbWFwU2NyZWVuVG9EYXRhWFt4c107DQogICAgICAgICAgICAgICAgICAgIHZhciBfZiA9IGt4ICogKF94IC0geDApICsgZmxlZnQ7DQogICAgICAgICAgICAgICAgICAgIHZhciBwYWxldHRlVmFsID0gcGFsZXR0ZUsgKiAoX2YgLSBmbWluKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGsgPSAocGFsZXR0ZVZhbCAqIGNvbE4pIHwgMDsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGsgPCAwKSBrID0gMDsNCiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoayA+IGNvbE4pIGsgPSBjb2xOOw0KICAgICAgICAgICAgICAgICAgICBrID0gayA8PCAyOw0KDQogICAgICAgICAgICAgICAgICAgIC8vdmFyIGNvbG9yID0gZ2V0Q29sb3IocGFsZXR0ZVZhbCk7DQogICAgICAgICAgICAgICAgICAgIC8vaWYgKHhzID09IGNlbGxMZWZ0X3MgfHwgeHMgPT0gY2VsbFJpZ2h0X3MgLSAxIHx8ICAvKiB1bmNvbW1lbnQgdG8gZHJhdyB0aGUgYm9yZGVyIG9mIGNlbGxzICovDQogICAgICAgICAgICAgICAgICAgIC8vICAgIHlzID09IGNlbGxUb3BfcyArIDEgfHwgeXMgPT0gY2VsbEJvdHRvbV9zKQ0KICAgICAgICAgICAgICAgICAgICAvLyAgICBjb2xvciA9IHsgYTogMSwgcjogMCwgZzogMCwgYjogMjU1IH07DQoNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2luZGV4KytdID0gY29sb3JzW2srK107DQogICAgICAgICAgICAgICAgICAgIGltYWdlRGF0YVtpbmRleCsrXSA9IGNvbG9yc1trKytdOw0KICAgICAgICAgICAgICAgICAgICBpbWFnZURhdGFbaW5kZXgrK10gPSBjb2xvcnNbaysrXTsNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2luZGV4KytdID0gY29sb3JzW2tdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChjZWxsVG9wX3MgPD0gMCkgYnJlYWs7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGNlbGxSaWdodF9zID49IHcpIGJyZWFrOw0KICAgIH0NCn07DQo=",InteractiveDataDisplay.Figure=function(t,e){if(void 0!==e)throw"Figure cannot be a dependent plot";if(t){var i;t&&(i=$("<div data-idd-plot='plot' data-idd-placement='center'></div>")).css("z-index",InteractiveDataDisplay.ZIndexNavigationLayer).css("background-color","rgba(0,0,0,0)");var a=t.children().toArray();i.appendTo(t),this.base=InteractiveDataDisplay.Plot,this.base(t,e,i);var C=this;i.dblclick(function(){C.master.fitToView()});function o(t){var e=t.css("position");return"static"!=e&&"inherit"!=e||t.css("position","relative"),void 0!==e&&""!=e||t.css("position","relative"),"relative"==t.css("position")}function n(t,e){if(t.attr("data-idd-axis")){var i=InteractiveDataDisplay.InitializeAxis(t,e);t.axis=i,t.dblclick(function(){var t=this.getAttribute("data-idd-placement");"bottom"==t||"top"==t?C.master.fitToViewX():C.master.fitToViewY()})}}function s(t,e,i){var a=$("<div></div>");a.appendTo(C.host).addClass("idd-figure-container"),(a.content=t).appendTo(a);function r(t){if(i){var e=h(i,t);t.splice(e.index,0,a)}else t.push(a)}var n=t.attr("data-idd-placement");"left"==n?r(b):"bottom"==n?r(w):"center"==n?r(A):"right"==n?r(T):"top"==n&&r(x),n&&a.attr("data-idd-placement",n)}var b=[],w=[],A=[],x=[],T=[];this.getAxes=function(e){if(e){if("top"==e?t=jQuery.grep(x,function(t){if(t.content&&t.content.axis&&t.content.axis.mode==e)return t.content.axis}):"bottom"==e?t=jQuery.grep(w,function(t){if(t.content&&t.content.axis&&t.content.axis.mode==e)return t.content.axis}):"left"==e?t=jQuery.grep(b,function(t){if(t.content&&t.content.axis&&t.content.axis.mode==e)return t.content.axis}):"right"==e&&(t=jQuery.grep(T,function(t){if(t.content&&t.content.axis&&t.content.axis.mode==e)return t.content.axis})),t&&0<t.length){for(a=0;a<t.length;a++)t[a]=t[a].content.axis;return t}}else{var t,i=b.concat(w).concat(T).concat(x);if((t=jQuery.grep(i,function(t){if(t.content&&t.content.axis)return t.content.axis}))&&0<t.length){for(var a=0;a<t.length;a++)t[a]=t[a].content.axis;return t}}},this.get=function(t){var e=InteractiveDataDisplay.Figure.prototype.get.call(this,t);if(e)return e;var i=this.getAxes();if(i)for(var a=0;a<i.length;a++)if(i[a].host[0].id==t||i[a].host[0]==t)return i[a]},a.forEach(function(t){var e=$(t);o(e)&&(s(e),n(e))});function l(t,e,i,a,r){var n=$(t);if(!n.is("div"))throw"Only DIVs can be added to figure!";if(void 0!==e){if("top"!=e&&"bottom"!=e&&"center"!=e&&"left"!=e&&"right"!=e)throw"Placement is incorrect!";n.attr("data-idd-placement",e)}return o(n)&&void 0!==n.attr("data-idd-placement")?s(n,0,r):r?n.insertBefore(r):n.appendTo(C.host),void 0!==a&&a||C.requestUpdateLayout(),n}this.addDiv=function(t,e){return l(t,e)[0]};function d(t){var e=[],i=[];return t.forEach(function(t){0==t.children().toArray().length?e.push(t):i.push(t)}),e.forEach(function(t){t.remove()}),i}function c(e,t){var i=jQuery.grep(t,function(t){return t.content[0]==e});return i&&0<i.length}var h=function(t,e){for(var i=0;i<e.length;i++)if(e[i].content[0]==t)return{pack:t,index:i};throw"Pack not found"};if(this.removeDiv=function(t){if(void 0===t)throw"Unable to remove undefined object!";var e,i,a,r=this.host.children().toArray();if(e=t,i=r,!((a=jQuery.grep(i,function(t){return t==e}))&&0<a.length||c(t,b)||c(t,w)||c(t,A)||c(t,T)||c(t,x)))throw"Specified div doesn't belong to figure!";var n=$(t);n.remove(),n.attr("data-idd-placement")&&("left"==n.attr("data-idd-placement")?b=d(b):"bottom"==n.attr("data-idd-placement")?w=d(w):"center"==n.attr("data-idd-placement")?A=d(A):"right"==n.attr("data-idd-placement")?T=d(T):"top"==n.attr("data-idd-placement")&&(x=d(x))),C.requestUpdateLayout()},this.addAxis=function(t,e,i,a){var r=l('<div data-idd-axis="'+(void 0===e?"numeric":e)+'"></div>',t,0,!1,a);return n(r,i),r},this.getTooltip=function(t,e,i,a){var r=C.getAxes(),n=!1,o=new Array;if(r)for(var s=0;s<r.length;s++){if(r[s].getToolTip){var l;n=!0,l="left"==r[s].mode||"right"==r[s].mode?e:t;var d=r[s].getToolTip(l);d&&o.push(d)}}if(n){var c=$("<div></div>").addClass("idd-tooltip-compositevalue");return c.append($("<div>"+o.join(", ")+"</div>")),c}},this.measure=function(e){C.screenSize.width!==e.width||(C.screenSize.height,e.height);var t=this.fit(e);e.width,e.height;function i(t,e,i,a,r,n){for(var o=0,s=t.length-1;0<=s;s--){var l=t[s],d=l.content;if(l.width(e),n&&l.css("top",a(o)),l.css("left",r),void 0!==d.axis){d.width(e),d.axis.update(i);var c=d.height();l.height()!==c&&l.height(c),o+=l.height()}else o+=l.height();n||l.css("top",a(o))}return o}function a(t,e,i,a,r,n){for(var o=0,s=t.length-1;0<=s;s--){var l=t[s],d=l.content;if(l.height(e),d.height(e),n&&l.css("left",a(o)),l.css("top",r),void 0!==d.axis){d.height(e),d.axis.update(i);var c=d.width();l.width()!==c&&l.width(c),o+=l.width()}else o+=l.width();n||l.css("left",a(o))}return o}var r,n,o;n=i(x,e.width,{min:t.x,max:t.x+t.width},function(t){return t},0,!0),o=i(w,e.width,{min:t.x,max:t.x+t.width},function(t){return e.height-t},0,!1),r=n+o;var s,l,d;l=a(b,e.height-r,{min:t.y,max:t.y+t.height},function(t){return t},n,!0),d=a(T,e.height-r,{min:t.y,max:t.y+t.height},function(t){return e.width-t},n,!1),s=l+d;var c={width:e.width-s,height:e.height-r};c.width<0&&(c.width=0),c.height<0&&(c.height=0),void 0!==C.mapControl&&C.mapControl.setOptions({width:c.width,height:c.height}),t=this.fit(c,!0),A.forEach(function(t){t.width(c.width),t.height(c.height),t.css("top",n),t.css("left",l)}),this.children.forEach(function(t){var e=t.host;e.width(c.width),e.height(c.height),e.css("top",n),e.css("left",l)});var h,g;if(h=i(x,c.width,{min:t.x,max:t.x+t.width},function(t){return t},l,!0),g=i(w,c.width,{min:t.x,max:t.x+t.width},function(t){return e.height-t},l,!1),h!=n)for(var p=n/h,f=0,u=0;u<x.length;u++){var v="scaleY("+p+") translate(0px,"+f+"px)",y="0% 0%";(D=x[u]).css("-webkit-transform",v),D.css("-webkit-transform-origin",y),D.css("-moz-transform",v),D.css("-moz-transform-origin",y),D.css("-o-transform",v),D.css("-o-transform-origin",y),D.css("-ms-transform",v),D.css("-ms-transform-origin",y),D.css("transform",v),D.css("transform-origin",y),f+=D.height()*(p-1)}else x.forEach(function(t){t.css("-ms-transform",""),t.css("-webkit-transform",""),t.css("-moz-transform",""),t.css("-o-transform",""),t.css("transform","")});if(o!=g)for(p=o/g,f=0,u=0;u<w.length;u++){v="scaleY("+p+") translate(0px,"+-f+"px)",y="0% 0%";(D=w[u]).css("-webkit-transform",v),D.css("-webkit-transform-origin",y),D.css("-moz-transform",v),D.css("-moz-transform-origin",y),D.css("-o-transform",v),D.css("-o-transform-origin",y),D.css("-ms-transform",v),D.css("-ms-transform-origin",y),D.css("transform",v),D.css("transform-origin",y),f+=D.height()*(p-1)}else w.forEach(function(t){t.css("-ms-transform",""),t.css("-webkit-transform",""),t.css("-moz-transform",""),t.css("-o-transform",""),t.css("transform","")});var m,I;if(m=a(b,e.height-r,{min:t.y,max:t.y+t.height},function(t){return t},n,!0),I=a(T,e.height-r,{min:t.y,max:t.y+t.height},function(t){return e.width-t},n,!1),l!=m)for(p=l/m,f=0,u=0;u<b.length;u++){v="scaleX("+p+") translate("+f+"px, 0px)",y="0% 0%";(D=b[u]).css("-webkit-transform",v),D.css("-webkit-transform-origin",y),D.css("-moz-transform",v),D.css("-moz-transform-origin",y),D.css("-o-transform",v),D.css("-o-transform-origin",y),D.css("-ms-transform",v),D.css("-ms-transform-origin",y),D.css("transform",v),D.css("transform-origin",y),f+=D.width()*(p-1)}else b.forEach(function(t){t.css("-ms-transform",""),t.css("-webkit-transform",""),t.css("-moz-transform",""),t.css("-o-transform",""),t.css("transform","")});if(d!=I)for(p=d/I,f=0,u=0;u<T.length;u++){var D;v="scaleX("+p+") translate("+-f+"px, 0px)",y="100% 0%";(D=T[u]).css("-webkit-transform",v),D.css("-webkit-transform-origin",y),D.css("-moz-transform",v),D.css("-moz-transform-origin",y),D.css("-o-transform",v),D.css("-o-transform-origin",y),D.css("-ms-transform",v),D.css("-ms-transform-origin",y),D.css("transform",v),D.css("transform-origin",y),f+=D.width()*(p-1)}else T.forEach(function(t){t.css("-ms-transform",""),t.css("-webkit-transform",""),t.css("-moz-transform",""),t.css("-o-transform",""),t.css("transform","")});return c},this.arrange=function(t){InteractiveDataDisplay.Figure.prototype.arrange.call(this,t)},this.exportContentToSvg=function(t,e,i){function a(t,e){var i,a,r=t instanceof jQuery?window.getComputedStyle(t[0],null):window.getComputedStyle(t,null),n=r?r.getPropertyValue("transform"):void 0,o=r?r.getPropertyValue("padding-bottom"):void 0,s=r?parseFloat(r.getPropertyValue("font-size")):void 0,l=r?r.getPropertyValue("font-family"):void 0,d=r?r.getPropertyValue("font-weight"):void 0,c=r?r.getPropertyValue("text-align"):void 0;"center"==c&&(c="middle"),"left"==c&&(c="start"),"right"==c&&(c="end"),a=$(t).hasClass("idd-verticalTitle-inner")?(i=$(t).parent().width(),$(t).parent().height()):(i=$(t).width(),$(t).height());var h=$(t).text().trim(),g=e.text(h).font({family:l,size:s,weight:d,anchor:c});"middle"==c?g.translate(i/2,-a/2):"end"==c?g.translate(i,-a/2):g.translate(0,-a/2),"none"!=n&&null!=n&&(o=null!=o?parseFloat(o.substring(0,o.length-2)):0,g.attr({transform:n}),g.translate(-o,a/2))}for(var r=i.group(),n=0,o=b.length;0<=--o;){var s=b[o];if((v=r.group()).translate(n,0),n+=s.width(),s.content)if(s.content.axis)s.content.axis.renderToSvg(v);else{var l=$("div.idd-verticalTitle-inner",s.content);(h=1===l.length&&0===l[0].children.length)&&a(l,v)}}var d=i.group(),c=0;for(o=x.length;0<=--o;){s=x[o];if((v=d.group()).translate(n,c),c+=s.height(),s.content)if(s.content.axis)s.content.axis.renderToSvg(v);else{var h=!0;$(s.content).contents().each(function(){3!=this.nodeType&&(h=!1)}),h&&a(s.content,v)}}r.translate(0,c);var g=i.group(),p=c+e.height;for(o=0;o<w.length;o++){s=w[o];if((v=g.group()).translate(n,p),p+=s.height(),s.content)if(s.content.axis)s.content.axis.renderToSvg(v);else{h=!0;$(s.content).contents().each(function(){3!=this.nodeType&&(h=!1)}),h&&a(s.content,v)}}var f=i.group(),u=n+e.width;for(o=0;o<T.length;o++){var v;s=T[o];if((v=f.group()).translate(u,c),u+=s.width(),s.content)if(s.content.axis)s.content.axis.renderToSvg(v);else{l=$("div.idd-verticalTitle-inner",s.content);(h=1===l.length&&0===l[0].children.length)&&a(l,v)}}var y=i.group();y.viewbox(0,0,e.width,e.height).translate(n,c),InteractiveDataDisplay.Figure.prototype.exportContentToSvg.call(this,t,e,y)},this.requestUpdateLayout(),"true"===t.attr("data-idd-navigation-enabled")){var r=InteractiveDataDisplay.Gestures.getGesturesStream(this.centralPart);this.navigation.gestureSource=r}var g=$("<div></div>").prependTo(this.centralPart),p=new InteractiveDataDisplay.Legend(this,g,!0);g.css("float","right"),Object.defineProperty(this,"legend",{get:function(){return p},configurable:!1}),InteractiveDataDisplay.Gestures.FullEventList.forEach(function(t){g[0].addEventListener(t,function(t){t.stopPropagation()},!1)});var f={};InteractiveDataDisplay.Utils.readStyle(t,f);var u=f.isLegendVisible;u?"true"==u?p.isVisible=!0:"false"==u&&(p.isVisible=!1):p.isVisible=!1}},InteractiveDataDisplay.Figure.prototype=new InteractiveDataDisplay.Plot,InteractiveDataDisplay.Chart=function(s,t){if(s){if(void 0!==t)throw"Chart cannot be a dependent plot";var e=$("<div data-idd-plot='grid' data-idd-placement='center'></div>").prependTo(s),a=$('<div data-idd-axis="numeric" data-idd-placement="left"></div>').prependTo(s),r=$('<div data-idd-axis="numeric" data-idd-placement="bottom"></div>').prependTo(s);this.base=InteractiveDataDisplay.Figure,this.base(s,t);var l=this,n=this.get(e[0]);r.axis=n.xAxis=this.get(r[0]),a.axis=n.yAxis=this.get(a[0]);this.changeXAxis=function(t,e){var i=r;r=l.addAxis("bottom",t,e,r[0]),l.removeDiv(i[0]),i.axis.destroy(),n.xAxis=this.get(r[0]),r.axis.dataTransform=l.xDataTransform},this.changeYAxis=function(t,e){var i=a;a=l.addAxis("left",t,e,a[0]),l.removeDiv(i[0]),i.axis.destroy(),n.yAxis=this.get(a[0]),a.axis.dataTransform=l.yDataTransform},this.onDataTranformChangedCore=function(t){if("y"==t){var e=InteractiveDataDisplay.TicksRenderer.getAxisType(l.yDataTransform);if(a.axis.host.attr("data-idd-axis")==e)"log"!=e&&(a.axis.dataTransform=l.yDataTransform);else{var i=a;a=l.addAxis("left",e,!0,a[0]),l.removeDiv(i[0]),i.axis.destroy(),n.yAxis=this.get(a[0])}l.enumAll(l,function(t){t!=l&&(t.yDataTransform=l.yDataTransform)})}else if("x"==t){e=InteractiveDataDisplay.TicksRenderer.getAxisType(l.xDataTransform);if(r.axis.host.attr("data-idd-axis")==e)"log"!=e&&(r.axis.dataTransform=l.xDataTransform);else{i=r;r=l.addAxis("bottom",e,!0,r[0]),l.removeDiv(i[0]),i.axis.destroy(),n.xAxis=this.get(r[0])}l.enumAll(l,function(t){t!=l&&(t.xDataTransform=l.xDataTransform)})}},this.fireChildrenChanged=function(t){"add"==t.type&&(l.xDataTransform&&(t.plot.xDataTransform=l.xDataTransform),l.yDataTransform&&(t.plot.yDataTransform=l.yDataTransform)),this.host.trigger(InteractiveDataDisplay.Event.childrenChanged,t)},this.exportToSvg=function(t,e,i){if(!SVG.supported)throw"SVG is not supported";e=this.screenSize,t=this.coordinateTransform.getPlotRect({x:0,y:0,width:e.width,height:e.height});var a=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=(i=SVG(a).size(s.width(),s.height())).group();this.exportContentToSvg(t,e,r);var n=i.group(),o=s.width()+20;return l.legend.isVisible&&(n.add(this.exportLegendToSvg(l.legend.Host[0])).translate(o,20),i.size(200+o,s.height())),i};var i,o,d,c={};InteractiveDataDisplay.Utils.readStyle(s,c),c.isLegendVisible||(l.legend.isVisible=!0),i=InteractiveDataDisplay.Gestures.getGesturesStream(l.centralPart),o=InteractiveDataDisplay.Gestures.applyHorizontalBehavior(InteractiveDataDisplay.Gestures.getGesturesStream(r)),d=InteractiveDataDisplay.Gestures.applyVerticalBehavior(InteractiveDataDisplay.Gestures.getGesturesStream(a)),l.navigation.gestureSource=i.merge(o.merge(d))}},InteractiveDataDisplay.Chart.prototype=new InteractiveDataDisplay.Figure,InteractiveDataDisplay.LabelPlot=function(t,e){this.base=InteractiveDataDisplay.CanvasPlot,this.base(t,e);var b=[],w=[],A=[],x=[],T=120,S=25,P=[];this.getData=function(){for(var t=[],e=b.length,i=0;i<e;i++)t.push({text:b[i],position:{x:w[i],y:A[i]},placement:x[i]});return t},this.draw=function(t){if(t){for(var e=t.length,i=[],a=[],r=[],n=[],o=0;o<e;o++)i.push(t[o].text),a.push(t[o].position.x),r.push(t[o].position.y),t[o].placement?n.push(t[o].placement):n.push("center"),P.push(0);b=i,w=a,A=r,x=n}this.invalidateLocalBounds(),this.requestNextFrameOrUpdate(),this.fireAppearanceChanged()},this.computeLocalBounds=function(){var t=this.xDataTransform&&this.xDataTransform.dataToPlot,e=this.yDataTransform&&this.yDataTransform.dataToPlot;if(0<w.length&&0<A.length){var i=InteractiveDataDisplay.Utils.getMinMax(w),a=InteractiveDataDisplay.Utils.getMinMax(A),r=i.min-.2,n=i.max+.2,o=a.min,s=a.max;return t&&(r=t(r),n=t(n)),e&&(o=e(o),s=e(s)),{x:r,y:o,width:n-r,height:s-o}}},this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.renderCore=function(t,e){InteractiveDataDisplay.LabelPlot.prototype.renderCore.call(this,t,e);var i=this.getContext(!0),a=b.length;if(0!=a)for(var r=this.getTransform(),n=r.dataToScreenX,o=r.dataToScreenY,s=0;s<a;s++){var l={x:n(w[s]),y:o(A[s])};"left"==x[s]?l={x:n(w[s])-T,y:o(A[s])}:"right"==x[s]?l={x:n(w[s])+T,y:o(A[s])}:"top"==x[s]?l={x:n(w[s]),y:o(A[s])-S}:"bottom"==x[s]&&(l={x:n(w[s]),y:o(A[s])+S});var d=window.getComputedStyle(document.body,null),c=d?parseFloat(d.getPropertyValue("font-size")):void 0,h=d?d.getPropertyValue("font-family"):void 0,g=d?d.getPropertyValue("font-weight"):void 0,p=l.x-.5*T,f=l.y;i.fillStyle="black",i.font=g+" "+c+"px "+h,i.textALign="center";for(var u=b[s],v=i.measureText(u).width;T<v;)u=u.substring(0,u.length-1),v=i.measureText(u).width;P[s]=(T-v)/2,i.fillText(u,p+P[s],f)}},this.renderCoreSvg=function(t,e,i){var a=b.length;if(0<a){for(var r=e.height,n=e.width,o=this.coordinateTransform.plotToScreenX,s=this.coordinateTransform.plotToScreenY,l=this.xDataTransform&&this.xDataTransform.dataToPlot,d=this.yDataTransform&&this.yDataTransform.dataToPlot,c=l?function(t){return o(l(t))}:o,h=d?function(t){return s(d(t))}:s,g=i.group(),p=0;p<a;p++){var f=window.getComputedStyle(document.body,null),u=f?parseFloat(f.getPropertyValue("font-size")):void 0,v=f?f.getPropertyValue("font-family"):void 0,y=f?f.getPropertyValue("font-weight"):void 0,m={x:c(w[p]),y:h(A[p])};"left"==x[p]?m={x:c(w[p])-T,y:h(A[p])}:"right"==x[p]?m={x:c(w[p])+T,y:h(A[p])}:"top"==x[p]?m={x:c(w[p]),y:h(A[p])-S}:"bottom"==x[p]&&(m={x:c(w[p]),y:h(A[p])+S});var I=m.x-.5*T,D=m.y-.9*S,C=g.group();C.size(T,S);C.text(b[p]).font({family:v,size:u,weight:y});C.translate(I+P[p],D),C.clipWith(C.rect(T,S))}g.clipWith(g.rect(n,r))}}},InteractiveDataDisplay.LabelPlot.prototype=new InteractiveDataDisplay.CanvasPlot,InteractiveDataDisplay.MaxMarkersPerAnimationFrame=3e3,InteractiveDataDisplay.Markers=function(t,e){if(this.base=InteractiveDataDisplay.CanvasPlot,this.base(t,e),t){function m(t){var e={},i={},a=-1;for(var r in t){var n=t[r];InteractiveDataDisplay.Utils.isArray(n)?((n.length<a||-1===a)&&(a=n.length),e[r]=n):i[r]=n}return{arrays:e,scalars:i,length:-1===a?0:a}}var y={},I=void 0,D={},C={},h=void 0,g=!1,b={},w=this;this.getDataCopy=function(){return y},this.draw=function(t,e){if(null==t||null==t)throw"The argument 'data' is undefined or null";var i;if(void 0===(y=t).shape||null==t.shape)i=InteractiveDataDisplay.Markers.shapes.box;else if("string"==typeof t.shape){if(null==(i=InteractiveDataDisplay.Markers.shapes[t.shape]))throw"The given marker shape is unknown"}else{if("object"!=typeof t.shape||null==t.shape||"function"!=typeof t.shape.draw)throw"The argument 'data' is incorrect: value of the property 'shape' must be a string, a MarkerShape object, undefined or null";i=t.shape}I=i;var a=$.extend({},t);null!=i.prepare&&i.prepare(a),null!=w.mapControl&&null!=h&&(h.forEach(function(t){var e=w.mapControl.entities.indexOf(t);0<=e&&w.mapControl.entities.removeAt(e)}),h=void 0),D=a,C={},this.invalidateLocalBounds(),this.requestNextFrameOrUpdate(),this.setTitles(e,!0),this.fireAppearanceChanged()},this.computeLocalBounds=function(t,e){var i=this.xDataTransform&&this.xDataTransform.dataToPlot,a=this.yDataTransform&&this.yDataTransform.dataToPlot;if(I&&(void 0!==I.getBoundingBox||void 0!==I.getPlotBoundingBox)&&D){if(0==D.x.length)return;var r=m(D),n=r.length,o=r.arrays,s=r.scalars,l=void 0;if(I.hasOwnProperty("getBoundingBox")){for(var d=0;d<n;d++){for(var c in o)s[c]=o[c][d];var h=I.getBoundingBox(s);l=InteractiveDataDisplay.Utils.unionRects(l,h)}if(i){var g=i(l.x),p=i(l.x+l.width);l.x=g,l.width=p-g}if(a){var f=a(l.y),u=a(l.y+l.height);l.y=f,l.height=u-f}}else{if(!I.hasOwnProperty("getPlotBoundingBox"))throw"Shape does not have neither getBoundingBox nor getPlotBoundingBox";var v=w.getTransform();for(d=0;d<n;d++){for(var c in o)s[c]=o[c][d];var y=I.getPlotBoundingBox(s,v);l=InteractiveDataDisplay.Utils.unionRects(l,y)}}return l}if(void 0!==D.x&&void 0!==D.y)return InteractiveDataDisplay.Utils.getBoundingBoxForArrays(D.x,D.y,i,a)},this.getLocalPadding=function(){if(I&&void 0!==I.getPadding)return I.getPadding(D);return{left:0,right:0,top:0,bottom:0}},this.renderCore=function(t,e){if(InteractiveDataDisplay.Markers.prototype.renderCore.call(this,t,e),null!=I){var i=this.getTransform(),a=!w.master.isInAnimation||void 0===w.master.mapControl;if(void 0!==w.mapControl&&(void 0===h&&function(){if(void 0!==D.x&&void 0!==D.y){var t=D.x,e=D.y;if(InteractiveDataDisplay.Utils.isArray(t)&&InteractiveDataDisplay.Utils.isArray(e)){var i=Math.min(t.length,e.length);if(i<=InteractiveDataDisplay.MaxMarkersPerAnimationFrame){h=new Array(i);for(var a=0;a<i;a++){var r=new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(e[a],t[a]),{visible:!1,htmlContent:'<div style="background-color: white; opacity: 0.5; width: 10px; height: 10px"></div>',anchor:new Microsoft.Maps.Point(5,5)});h[a]=r,w.mapControl.entities.push(r)}}}}}(),void 0!==h&&(w.master.isInAnimation&&!g?(h.forEach(function(t){t.setOptions({visible:!0})}),g=!0):!w.master.isInAnimation&&g&&(h.forEach(function(t){t.setOptions({visible:!1})}),g=!1))),a){var r=this.getContext(!0);C=D,void 0!==I.preRender&&(C=I.preRender(D,t,e,i,r));for(var n=m(C),o=n.length,s=n.arrays,l=n.scalars,d=0;d<o;d++){for(var c in s)l[c]=s[c][d];I.draw(l,t,e,i,r,d)}}}},this.renderCoreSvg=function(t,e,i){if(null!=I&&null!=I.renderSvg){var a=this.getTransform();I.renderSvg(t,e,i,D,a)}},this.findToolTipMarkers=function(t,e,i,a){if(null==I||void 0===I.hitTest||null==C)return[];for(var r=this.getTransform(),n={x:r.dataToScreenX(t),y:r.dataToScreenY(e)},o={x:t,y:e},s=m(C),l=s.length,d=s.arrays,c=s.scalars,h=[],g=0;g<l;g++){for(var p in d)c[p]=d[p][g];if(I.hitTest(c,r,n,o)&&"number"==typeof c.indices){var f=c.indices,u={};if(I.getTooltipData)u=I.getTooltipData(y,f);else{for(var p in y){var v=y[p];InteractiveDataDisplay.Utils.isArray(v)&&f<v.length&&(b[p]=new InteractiveDataDisplay.AdaptiveFormatter(v),u[p]=b[p].toString(v[f]))}u.index=f}h.push(u)}}return h},this.getTooltip=function(t,e,i,a){var n=this;if(this.isVisible&&!this.isErrorVisible){var r=n.findToolTipMarkers(t,e,i,a),o=function(t){var e=$("<div></div>").addClass("idd-tooltip-compositevalue");for(var i in t)if(t.hasOwnProperty(i)){var a=n.getTitle(i),r=void 0;"object"==typeof t[i]&&(r=o(t[i])),r?e.append($("<div>"+a+":</div>")).append(r):e.append($("<div>"+a+": "+t[i]+"</div>"))}return e};if(0<r.length){var s=$("<div></div>");return $("<div></div>").addClass("idd-tooltip-name").text(n.name||"markers").appendTo(s),r.forEach(function(t){o(t).addClass("idd-tooltip-itemvalues").appendTo(s)}),s}}},this.getLegend=function(){function t(){e.empty(),I&&void 0!==I.getLegend&&(i.content.empty(),I.getLegend(D,w.getTitle,i)),e.text(w.name)}var e=$("<span></span>"),i={thumbnail:$("<canvas></canvas>"),content:$("<div></div>")};this.host.bind("appearanceChanged",t),t();return{name:e,legend:i,onLegendRemove:function(){w.host.unbind("appearanceChanged",t),e.empty()}}},this.buildSvgLegend=function(t,e){var i={thumbnail:e.group(),content:e.group()};t.height=30,I&&void 0!==I.buildSvgLegendElements&&(i=I.buildSvgLegendElements(t,e,D,this.getTitle)),e.rect(t.width,t.height).fill({color:"white",opacity:0}),e.add(i.thumbnail.translate(5,5));var a=window.getComputedStyle(t.legendDiv.children[0].children[1],null),r=parseFloat(a.getPropertyValue("font-size")),n=a.getPropertyValue("font-family");e.add(e.text(this.name).font({family:n,size:r}).translate(40,0)),e.add(i.content.translate(5,30))},this.onDataTransformChanged=function(t){this.invalidateLocalBounds(),InteractiveDataDisplay.Markers.prototype.onDataTransformChanged.call(this,t)};var i=InteractiveDataDisplay.Utils.getDataSourceFunction(t,InteractiveDataDisplay.readCsv)(t);i&&void 0!==i.y&&("bars"==i.shape&&(barWidthFloat=parseFloat(i.barWidth),isNaN(barWidthFloat)?(void 0===i.barWidth?console.error("barWidth parameter of BarChart plot should be set"):console.error("barWidth parameter of BarChart plot should be a number"),i.barWidth=void 0):i.barWidth=barWidthFloat),this.draw(i))}},InteractiveDataDisplay.Markers.prototype=new InteractiveDataDisplay.CanvasPlot,InteractiveDataDisplay.Markers.defaults={color:"#4169ed",colorPalette:InteractiveDataDisplay.palettes.grayscale,border:"#000000",size:10},InteractiveDataDisplay.Markers.shapes=InteractiveDataDisplay.Markers.shapes||{},function(){var t={prepare:function(t){var e=t.shape?t.shape.toLowerCase():"box";if("box"==e)t.shape=1;else if("circle"==e)t.shape=2;else if("diamond"==e)t.shape=3;else if("cross"==e)t.shape=4;else{if("triangle"!=e)throw"Unexpected value of property 'shape'";t.shape=5}if(null==t.y||null==t.y)throw"The mandatory property 'y' is undefined or null";if(!InteractiveDataDisplay.Utils.isArray(t.y))throw"The property 'y' must be an array of numbers";var i=t.y.length,a=new Int8Array(i);if(InteractiveDataDisplay.Utils.maskNaN(a,t.y),null==t.x)t.x=InteractiveDataDisplay.Utils.range(0,i-1);else{if(!InteractiveDataDisplay.Utils.isArray(t.x))throw"The property 'x' must be an array of numbers";if(t.x.length!=i)throw"Length of the array which is a value of the property 'x' differs from lenght of 'y'";InteractiveDataDisplay.Utils.maskNaN(a,t.x)}if(null!=t.border&&"none"!=t.border||(t.border=null),null==t.color&&(t.color=InteractiveDataDisplay.Markers.defaults.color),InteractiveDataDisplay.Utils.isArray(t.color)){if(t.color.length!=i)throw"Length of the array 'color' is different than length of the array 'y'";if(0<i&&"string"!=typeof t.color[0]){if(null==(c=t.colorPalette)&&(c=InteractiveDataDisplay.Markers.defaults.colorPalette),"string"==typeof c&&(c=new InteractiveDataDisplay.ColorPalette.parse(c)),null!=c&&c.isNormalized){var r=InteractiveDataDisplay.Utils.getMinMax(t.color);r=InteractiveDataDisplay.Utils.makeNonEqual(r),c=c.absolute(r.min,r.max)}t.colorPalette=c;for(var n=new Array(i),o=0;o<i;o++){var s=t.color[o];if(s!=s)a[o]=1;else{var l=c.getRgba(s);n[o]="rgba("+l.r+","+l.g+","+l.b+","+l.a+")"}}t.color=n}t.individualColors=!0}else t.individualColors=!1;var d=new Array(i);if(null==t.size&&(t.size=InteractiveDataDisplay.Markers.defaults.size),InteractiveDataDisplay.Utils.isArray(t.size)){if(t.size.length!=i)throw"Length of the array 'size' is different than length of the array 'y'";if(null!=t.sizePalette){var c;if((c=InteractiveDataDisplay.SizePalette.Create(t.sizePalette)).isNormalized){r=InteractiveDataDisplay.Utils.getMinMax(t.size);r=InteractiveDataDisplay.Utils.makeNonEqual(r),c=new InteractiveDataDisplay.SizePalette(!1,c.sizeRange,r)}t.sizePalette=c;for(o=0;o<i;o++){var h=t.size[o];h!=h?a[o]=1:d[o]=c.getSize(h)}}else d=t.size,t.sizeMax=InteractiveDataDisplay.Utils.getMax(t.size)}else{for(o=0;o<i;o++)d[o]=t.size;t.sizeMax=t.size}t.size=d;var g=0;for(o=0;o<i;o++)1===a[o]&&g++;if(0<g){g=i-g,t.x=InteractiveDataDisplay.Utils.applyMask(a,t.x,g),t.y=InteractiveDataDisplay.Utils.applyMask(a,t.y,g),t.size=InteractiveDataDisplay.Utils.applyMask(a,t.size,g),t.individualColors&&(t.color=InteractiveDataDisplay.Utils.applyMask(a,t.color,g));for(var p=Array(g),f=(o=0,0);o<i;o++)0===a[o]&&(p[f++]=o);t.indices=p}else t.indices=InteractiveDataDisplay.Utils.range(0,i-1)},preRender:function(t,e,i,a,r){return t.individualColors||(r.fillStyle=t.color),null!=t.border&&(r.strokeStyle=t.border),t},draw:function(t,e,i,a,r,n){t.individualColors&&(r.fillStyle=t.color);var o=null!=t.border,s=a.dataToScreenX(t.x),l=a.dataToScreenY(t.y),d=i.width,c=i.height,h=t.size,g=h/2;if(!(d<s-g||s+g<0||c<l-g||l+g<0))switch(t.shape){case 1:r.fillRect(s-g,l-g,h,h),o&&r.strokeRect(s-g,l-g,h,h);break;case 2:r.beginPath(),r.arc(s,l,g,0,2*Math.PI),r.fill(),o&&r.stroke();break;case 3:r.beginPath(),r.moveTo(s-g,l),r.lineTo(s,l-g),r.lineTo(s+g,l),r.lineTo(s,l+g),r.closePath(),r.fill(),o&&r.stroke();break;case 4:var p=h/3,f=p/2;o?(r.beginPath(),r.moveTo(s-g,l-f),r.lineTo(s-f,l-f),r.lineTo(s-f,l-g),r.lineTo(s+f,l-g),r.lineTo(s+f,l-f),r.lineTo(s+g,l-f),r.lineTo(s+g,l+f),r.lineTo(s+f,l+f),r.lineTo(s+f,l+g),r.lineTo(s-f,l+g),r.lineTo(s-f,l+f),r.lineTo(s-g,l+f),r.closePath(),r.fill(),r.stroke()):(r.fillRect(s-f,l-g,p,h),r.fillRect(s-g,l-f,h,p));break;case 5:r.beginPath(),r.moveTo(s-g,l+g),r.lineTo(s,l-g),r.lineTo(s+g,l+g),r.closePath(),r.fill(),o&&r.stroke()}},getPadding:function(t){var e=t.sizeMax/2;return{left:e,right:e,top:e,bottom:e}},hitTest:function(t,e,i,a){function r(t,e){for(var i,a,r,n,o,s,l,d=e.length,c=0;c<d;c++)if(1!=(i=t,a=e[c],r=e[(c+1)%d],s=o=n=void 0,n=r.x-a.x,o=r.y-a.y,s=i.x-a.x,0<(l=n*(i.y-a.y)-o*s)?1:l<0?2:0))return!1;return!0}var n=e.dataToScreenX(t.x),o=e.dataToScreenY(t.y),s=i.x,l=i.y,d=t.size,c=d/2;if(i.x>=n-c&&i.x<=n+c&&i.y>=o-c&&i.y<=o+c)switch(t.shape){case 1:return!0;case 2:return(n-s)*(n-s)+(o-l)*(o-l)<=c*c;case 3:return r({x:s,y:l},[{x:n-c,y:o},{x:n,y:o-c},{x:n+c,y:o},{x:n,y:o+c}]);case 4:var h=d/3/2;return r({x:s,y:l},[{x:n-h,y:o+c},{x:n-h,y:o-c},{x:n+h,y:o-c},{x:n+h,y:o+c}])||r({x:s,y:l},[{x:n-c,y:o+h},{x:n-c,y:o-h},{x:n+c,y:o-h},{x:n+c,y:o+h}]);case 5:return r({x:s,y:l},[{x:n-c,y:o+c},{x:n,y:o-c},{x:n+c,y:o+c}])}},getLegend:function(i,a,t){var r=t.content,e=14;document.defaultView&&document.defaultView.getComputedStyle&&(e=parseFloat(document.defaultView.getComputedStyle(r[0],null).getPropertyValue("font-size"))),!isNaN(e)&&0!=e||(e=14);var n=t.thumbnail,o=!0,s=1.5*e,l=s/2+1,d=l;n[0].width=n[0].height=2+s;var c=n[0].style,h=n.get(0).getContext("2d");h.clearRect(0,0,n[0].width,n[0].height);var g,p,f,u,v,y,m,I,D,C,b,w,A=0,x=0,T=0;!function(){if(f=!1,i.individualColors&&i.colorPalette){var t=a("color");if(0==x){u=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(r),w=$("<div class='idd-legend-item-property'></div>").text(t).appendTo(u),v=u[0].style;var e=$("<div style='width: 170px; color: rgb(0,0,0); '></div>").appendTo(u);y=new InteractiveDataDisplay.ColorPaletteViewer(e),x=2}else w.text(t);y.palette=i.colorPalette,1==x&&(v.display="block",x=2)}else 2==x&&(v.display="none",x=1);i.individualColors?(p="#000000",g="#ffffff",f=!0):(g=i.color,p=g,null!=i.border&&(f=!0,p=i.border))}(),function(){if(m=s,i.sizePalette){var t=a("size");if(0==T){D=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(r),b=$("<div class='idd-legend-item-property'></div>").text(t).appendTo(D),D[0].style;var e=$("<div style='width: 170px; color: rgb(0,0,0)'></div>").appendTo(D);C=new InteractiveDataDisplay.SizePaletteViewer(e),T=2}else b.text(t);C.palette=InteractiveDataDisplay.SizePalette.Create(i.sizePalette)}I=m/2}(),function(){switch(2==A&&((void 0).display="none",A=1),h.clearRect(0,0,2+s,2+s),h.strokeStyle=p,h.fillStyle=g,i.shape){case 1:h.fillRect(l-I,d-I,m,m),f&&h.strokeRect(l-I,d-I,m,m);break;case 2:h.beginPath(),h.arc(l,d,I,0,2*Math.PI),h.fill(),f&&h.stroke();break;case 3:h.beginPath(),h.moveTo(l-I,d),h.lineTo(l,d-I),h.lineTo(l+I,d),h.lineTo(l,d+I),h.closePath(),h.fill(),f&&h.stroke();break;case 4:var t=m/3,e=t/2;f?(h.beginPath(),h.moveTo(l-I,d-e),h.lineTo(l-e,d-e),h.lineTo(l-e,d-I),h.lineTo(l+e,d-I),h.lineTo(l+e,d-e),h.lineTo(l+I,d-e),h.lineTo(l+I,d+e),h.lineTo(l+e,d+e),h.lineTo(l+e,d+I),h.lineTo(l-e,d+I),h.lineTo(l-e,d+e),h.lineTo(l-I,d+e),h.closePath(),h.fill(),h.stroke()):(h.fillRect(l-e,d-I,t,m),h.fillRect(l-I,d-e,m,t));break;case 5:h.beginPath(),h.moveTo(l-I,d+I),h.lineTo(l,d-I),h.lineTo(l+I,d+I),h.closePath(),h.fill(),f&&h.stroke()}o||(c.display="inline-block",o=!0)}()},renderSvg:function(t,e,i,o,a){var s=o.y.length;if(0!=s){var l,d,c=i.group(),h=a.dataToScreenX,g=a.dataToScreenY,p=e.width,f=e.height,u=0;!function(){for(var t=null==o.border?"none":o.border;u<s;u++){l=h(o.x[u]),d=g(o.y[u]);var e=o.size[u],i=e/2;c1=p<l-i||l+i<0||f<d-i||d+i<0;var a=o.individualColors?o.color[u]:o.color;if(!c1)if(1==o.shape)c.rect(o.size[u],o.size[u]).translate(l-i,d-i).fill(a).style({stroke:t});else if(2==o.shape)c.circle(o.size[u]).translate(l-i,d-i).style({fill:a,stroke:t});else if(3==o.shape)c.rect(o.size[u]/Math.sqrt(2),o.size[u]/Math.sqrt(2)).translate(l,d-i).style({fill:a,stroke:t}).rotate(45);else if(4==o.shape){var r=e/6;c.polyline([[-i,-r],[-r,-r],[-r,-i],[r,-i],[r,-r],[i,-r],[i,r],[r,r],[r,i],[-r,i],[-r,r],[-i,r],[-i,-r]]).translate(l,d).style({fill:a,stroke:t})}else if(5==o.shape){var n=Math.sqrt(3)/6*e;c.polyline([[l-i,d+n],[l,d-2*n],[l+i,d+n],[l-i,d+n]]).style({fill:a,stroke:t})}}c.clipWith(c.rect(p,f))}()}},buildSvgLegendElements:function(t,e,i,a){var r=e.group(),n=e.group(),o=12,s=1.5*o,l=s/2+1,d=l,c=s/2;switch(i.individualColors?(border="#000000",color="#ffffff"):(color=i.color,border="none",null!=i.border&&(border=i.border)),i.shape){case 1:r.rect(s,s).translate(l-c,d-c).fill({color:color,opacity:1}).stroke(border);break;case 2:r.circle(s).translate(l-c,d-c).fill(color).stroke(border);break;case 3:r.rect(s/Math.sqrt(2),s/Math.sqrt(2)).translate(l,d-c).fill(color).stroke(border).rotate(45);break;case 4:var h=s/6;r.polyline([[-c,-h],[-h,-h],[-h,-c],[h,-c],[h,-h],[c,-h],[c,h],[h,h],[h,c],[-h,c],[-h,h],[-c,h],[-c,-h]]).translate(l,d).fill(color).stroke(border);break;case 5:var g=Math.sqrt(3)/6*s;r.polyline([[l-c,d+g],[l,d-2*g],[l+c,d+g],[l-c,d+g]]).fill(color).stroke(border)}var p=0,f=t.legendDiv.children[1],u=i.individualColors&&i.colorPalette,v=(i.sizePalette,f&&t.legendDiv.children[1].children[0]&&t.legendDiv.children[1].children[0].children[0]?window.getComputedStyle(t.legendDiv.children[1].children[0].children[0],null):void 0);o=v?parseFloat(v.getPropertyValue("font-size")):void 0,fontFamily=v?v.getPropertyValue("font-family"):void 0;var y=v?v.getPropertyValue("font-weight"):void 0;if(u){var m=a("color");n.text(m).font({family:fontFamily,size:o,weight:y});var I=e.group(),D=t.width,C=20;InteractiveDataDisplay.SvgColorPaletteViewer(I,i.colorPalette,t.legendDiv.children[1].children[0].children[1],{width:D,height:C}),I.translate(5,50),p=50+C,t.height+=50+C}if(i.sizePalette){var b=a("size");n.add(e.text(b).font({family:fontFamily,size:o,weight:y}).translate(0,p));var w=e.group(),A=(D=t.width,C=35,u?t.legendDiv.children[1].children[1].children[1]:t.legendDiv.children[1].children[0].children[1]);InteractiveDataDisplay.SvgSizePaletteViewer(w,i.sizePalette,A,{width:D,height:C}),w.translate(5,50+p),t.height+=50+C}return e.front(),{thumbnail:r,content:n}}};InteractiveDataDisplay.Markers.shapes.box=t,InteractiveDataDisplay.Markers.shapes.circle=t,InteractiveDataDisplay.Markers.shapes.diamond=t,InteractiveDataDisplay.Markers.shapes.cross=t,InteractiveDataDisplay.Markers.shapes.triangle=t}(),InteractiveDataDisplay.Petal={prepare:function(t){if(!t.maxDelta){for(var e=0;isNaN(t.size.upper95[e])||isNaN(t.size.lower95[e]);)e++;var i=t.size.upper95[e]-t.size.lower95[e];for(e++;e<t.size.upper95.length;e++)isNaN(t.size.upper95[e])||isNaN(t.size.lower95[e])||(i=Math.max(i,t.size.upper95[e]-t.size.lower95[e]));t.maxDelta=i}if(null==t.y||null==t.y)throw"The mandatory property 'y' is undefined or null";if(!InteractiveDataDisplay.Utils.isArray(t.y))throw"The property 'y' must be an array of numbers";var a=t.y.length,r=new Int8Array(a);if(InteractiveDataDisplay.Utils.maskNaN(r,t.y),null==t.x)t.x=InteractiveDataDisplay.Utils.range(0,a-1);else{if(!InteractiveDataDisplay.Utils.isArray(t.x))throw"The property 'x' must be an array of numbers";if(t.x.length!=a)throw"Length of the array which is a value of the property 'x' differs from lenght of 'y'";InteractiveDataDisplay.Utils.maskNaN(r,t.x)}if(null!=t.border&&"none"!=t.border||(t.border=null),null==t.color&&(t.color=InteractiveDataDisplay.Markers.defaults.color),InteractiveDataDisplay.Utils.isArray(t.color)){if(t.color.length!=a)throw"Length of the array 'color' is different than length of the array 'y'";if(0<a&&"string"!=typeof t.color[0]){var n=t.colorPalette;if(null==n&&(n=InteractiveDataDisplay.Markers.defaults.colorPalette),"string"==typeof n&&(n=new InteractiveDataDisplay.ColorPalette.parse(n)),null!=n&&n.isNormalized){var o=InteractiveDataDisplay.Utils.getMinMax(t.color);o=InteractiveDataDisplay.Utils.makeNonEqual(o),n=n.absolute(o.min,o.max)}t.colorPalette=n;var s=new Array(a);for(e=0;e<a;e++){var l=t.color[e];if(l!=l)r[e]=1;else{var d=n.getRgba(l);s[e]="rgba("+d.r+","+d.g+","+d.b+","+d.a+")"}}t.color=s}t.individualColors=!0}else t.individualColors=!1;var c=new Array(a);if(InteractiveDataDisplay.Utils.isArray(t.size.lower95)&&InteractiveDataDisplay.Utils.isArray(t.size.upper95)){if(t.size.lower95.length!=a&&t.size.upper95.length!=a)throw"Length of the array 'size' is different than length of the array 'y'";if(0<a&&"number"==typeof t.size.lower95[0]&&"number"==typeof t.size.upper95[0]){var h=[],g=[];for(e=0;e<a;e++){var p=t.size.upper95[e],f=t.size.lower95[e];p!=p||f!=f?r[e]=1:(h[e]=t.size.upper95[e],g[e]=t.size.lower95[e])}t.upper95=h,t.lower95=g}}t.size="15.0";for(e=0;e<a;e++)c[e]=t.size;t.sizeMax=t.size,t.size=c;var u=0;for(e=0;e<a;e++)1===r[e]&&u++;if(0<u){u=a-u,t.x=InteractiveDataDisplay.Utils.applyMask(r,t.x,u),t.y=InteractiveDataDisplay.Utils.applyMask(r,t.y,u),t.size=InteractiveDataDisplay.Utils.applyMask(r,t.size,u),t.upper95=InteractiveDataDisplay.Utils.applyMask(r,t.upper95,u),t.lower95=InteractiveDataDisplay.Utils.applyMask(r,t.lower95,u),t.individualColors&&(t.color=InteractiveDataDisplay.Utils.applyMask(r,t.color,u));for(var v=Array(u),y=(e=0,0);e<a;e++)0===r[e]&&(v[y++]=e);t.indices=v}else t.indices=InteractiveDataDisplay.Utils.range(0,a-1)},preRender:function(t,e,i,a,r){return t.individualColors||(r.fillStyle=t.color),null!=t.border&&(r.strokeStyle=t.border),t},draw:function(t,e,i,a,r){var n=a.dataToScreenX(t.x),o=a.dataToScreenY(t.y);if(!(n>i.width||n<0||o>i.height||o<0)){var s=t.size/2,l=s*(1-(t.upper95-t.lower95)/t.maxDelta);t.maxDelta<=0&&(l=NaN),InteractiveDataDisplay.Petal.drawSample(r,n,o,l,s,t.color)}},drawSample:function(t,e,i,a,r,n){var o,s,l=Math.random()*Math.PI*2;isNaN(a)?(o=0,s=r,t.fillStyle="rgba(0, 0, 0, 0.2)"):(o=(r-a)/2,s=(r+a)/2,t.fillStyle=n),t.strokeStyle="black",t.beginPath();for(var d=2*Math.PI/200,c=0;c<200;c++){var h=d*c,g=o*Math.sin(6*h+l)+s;0==c?t.moveTo(e+g*Math.cos(h),i+g*Math.sin(h)):t.lineTo(e+g*Math.cos(h),i+g*Math.sin(h))}t.stroke(),t.closePath(),t.fill(),t.strokeStyle="gray",t.beginPath(),t.arc(e,i,1,0,2*Math.PI),t.stroke(),t.closePath()},hitTest:function(t,e,i,a){var r=e.dataToScreenX(t.x),n=e.dataToScreenY(t.y),o=t.size/2;return!(i.x<r-o||i.x>r+o)&&!(i.y<n-o||i.y>n+o)},getLegend:function(i,a,t){var r=t.content,e=14;document.defaultView&&document.defaultView.getComputedStyle&&(e=parseFloat(document.defaultView.getComputedStyle(r[0],null).getPropertyValue("font-size"))),!isNaN(e)&&0!=e||(e=14);var n=t.thumbnail,o=1.5*e,s=o/2+1,l=o/2+1;n[0].width=n[0].height=2+o;n[0].style;var d,c,h,g=n.get(0).getContext("2d");g.clearRect(0,0,n[0].width,n[0].height);var p,f,u,v,y,m=0,I=0;!function(){if(i.individualColors&&i.colorPalette){var t=a("color");if(0==m){d=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(r),y=$("<div class='idd-legend-item-property'></div>").text(t).appendTo(d),c=d[0].style;var e=$("<div style='width: 170px;'></div>").appendTo(d);h=new InteractiveDataDisplay.ColorPaletteViewer(e),m=2}else y.text(t);h.palette=i.colorPalette,1==m&&(c.display="block",m=2)}else 2==m&&(c.display="none",m=1);i.individualColors?0:(i.color,null!=i.border&&i.border)}(),function(){p=o;var t=a("size");if(0==I){u=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(r),v=$("<div class='idd-legend-item-property'></div>").text(t).appendTo(u),u[0].style;var e=$("<div style='width: 170px;'></div>").appendTo(u);new InteractiveDataDisplay.UncertaintySizePaletteViewer(e),I=2}else v.text(t);f=p/2}(),InteractiveDataDisplay.Petal.drawSample(g,s,l,f/2,f,"gray")},getTooltipData:function(t,e){var i={},a={};return InteractiveDataDisplay.Utils.isArray(t.x)&&e<t.x.length&&(a.x=new InteractiveDataDisplay.AdaptiveFormatter(t.x),i.x=a.x.toString(t.x[e])),InteractiveDataDisplay.Utils.isArray(t.y)&&e<t.y.length&&(a.y=new InteractiveDataDisplay.AdaptiveFormatter(t.y),i.y=a.y.toString(t.y[e])),InteractiveDataDisplay.Utils.isArray(t.color)&&e<t.color.length&&(a.color=new InteractiveDataDisplay.AdaptiveFormatter(t.color),i.color=a.color.toString(t.color[e])),t.size&&(i.size={},InteractiveDataDisplay.Utils.isArray(t.size.lower95)&&e<t.size.lower95.length&&(a.lower95=new InteractiveDataDisplay.AdaptiveFormatter(t.size.lower95),i.size["lower 95%"]=a.lower95.toString(t.size.lower95[e])),InteractiveDataDisplay.Utils.isArray(t.size.upper95)&&e<t.size.upper95.length&&(a.upper95=new InteractiveDataDisplay.AdaptiveFormatter(t.size.upper95),i.size["upper 95%"]=a.upper95.toString(t.size.upper95[e]))),i.index=e,i},renderSvg:function(t,e,i,a,r){var n=a.y.length;if(0!=n){var o,s,l=i.group(),d=r.dataToScreenX,c=r.dataToScreenY,h=e.width,g=e.height,p=0,f=a.size[0];for(null==a.border||a.border;p<n;p++){o=d(a.x[p]),s=c(a.y[p]);var u=f/2,v=u*(1-(a.upper95[p]-a.lower95[p])/a.maxDelta),y=a.color[p];if(c1=h<o||o<0||g<s||s<0,!c1){var m,I,D=Math.random()*Math.PI*2;m=(u-v)/2,I=(u+v)/2;for(var C=2*Math.PI/200,b=[],w=0;w<200;w++){var A=C*w,x=m*Math.sin(6*A+D)+I;b.push([o+x*Math.cos(A),s+x*Math.sin(A)])}l.polyline(b).fill(y).stroke("black"),l.circle(2).translate(o-1,s-1).fill("gray").stroke({width:2,color:"gray"})}}l.clipWith(l.rect(h,g))}}},InteractiveDataDisplay.BullEye={prepare:function(t){if(t.bullEyeShape=t.bullEyeShape?t.bullEyeShape.toLowerCase():"circle",null==t.y||null==t.y)throw"The mandatory property 'y' is undefined or null";if(!InteractiveDataDisplay.Utils.isArray(t.y))throw"The property 'y' must be an array of numbers";var e=t.y.length,i=new Int8Array(e);if(InteractiveDataDisplay.Utils.maskNaN(i,t.y),null==t.x)t.x=InteractiveDataDisplay.Utils.range(0,e-1);else{if(!InteractiveDataDisplay.Utils.isArray(t.x))throw"The property 'x' must be an array of numbers";if(t.x.length!=e)throw"Length of the array which is a value of the property 'x' differs from lenght of 'y'";InteractiveDataDisplay.Utils.maskNaN(i,t.x)}if(null!=t.border&&"none"!=t.border||(t.border=null),InteractiveDataDisplay.Utils.isArray(t.color.lower95)&&InteractiveDataDisplay.Utils.isArray(t.color.upper95)){if(t.color.lower95.length!=e&&t.color.upper95.length!=e)throw"Length of the array 'color' is different than length of the array 'y'";if(0<e&&void 0!==t.color.lower95[0]&&"string"!=typeof t.color.upper95[0]){if(null==(g=t.colorPalette)&&(g=InteractiveDataDisplay.Markers.defaults.colorPalette),"string"==typeof g&&(g=new InteractiveDataDisplay.ColorPalette.parse(g)),null!=g&&g.isNormalized){var a={min:InteractiveDataDisplay.Utils.getMin(t.color.lower95),max:InteractiveDataDisplay.Utils.getMax(t.color.upper95)};a=InteractiveDataDisplay.Utils.makeNonEqual(a),g=g.absolute(a.min,a.max)}t.colorPalette=g;for(var r=[],n=[],o=0;o<e;o++){var s=t.color.upper95[o],l=t.color.lower95[o];if(s!=s||l!=l)i[o]=1;else{var d=g.getRgba(s),c=g.getRgba(l);r[o]="rgba("+d.r+","+d.g+","+d.b+","+d.a+")",n[o]="rgba("+c.r+","+c.g+","+c.b+","+c.a+")"}}t.upper95=r,t.lower95=n}t.individualColors=!0}else t.individualColors=!1;var h=new Array(e);if(null==t.size&&(t.size=InteractiveDataDisplay.Markers.defaults.size),InteractiveDataDisplay.Utils.isArray(t.size)){if(t.size.length!=e)throw"Length of the array 'size' is different than length of the array 'y'";if(null!=t.sizePalette){var g;if((g=InteractiveDataDisplay.SizePalette.Create(t.sizePalette)).isNormalized){a=InteractiveDataDisplay.Utils.getMinMax(t.size);a=InteractiveDataDisplay.Utils.makeNonEqual(a),g=new InteractiveDataDisplay.SizePalette(!1,g.sizeRange,a)}t.sizePalette=g;for(o=0;o<e;o++){var p=t.size[o];p!=p?i[o]=1:h[o]=g.getSize(p)}}else t.sizeMax=InteractiveDataDisplay.Utils.getMax(t.size)}else{for(o=0;o<e;o++)h[o]=t.size;t.sizeMax=t.size}t.size=h;var f=0;for(o=0;o<e;o++)1===i[o]&&f++;if(0<f){f=e-f,t.x=InteractiveDataDisplay.Utils.applyMask(i,t.x,f),t.y=InteractiveDataDisplay.Utils.applyMask(i,t.y,f),t.size=InteractiveDataDisplay.Utils.applyMask(i,t.size,f),t.individualColors&&(t.upper95=InteractiveDataDisplay.Utils.applyMask(i,t.upper95,f),t.lower95=InteractiveDataDisplay.Utils.applyMask(i,t.lower95,f));for(var u=Array(f),v=(o=0,0);o<e;o++)0===i[o]&&(u[v++]=o);t.indices=u}else t.indices=InteractiveDataDisplay.Utils.range(0,e-1)},preRender:function(t,e,i,a,r){return null!=t.border&&(r.strokeStyle=t.border),t},draw:function(t,e,i,a,r){t.y_mean;var n=t.upper95,o=t.lower95,s=t.size,l=s/2,d=a.dataToScreenX(t.x),c=a.dataToScreenY(t.y);d+l<0||d-l>i.width||c+l<0||c-l>i.height||(InteractiveDataDisplay.BullEye.drawBullEye(r,t.bullEyeShape,d,c,s,s,n),InteractiveDataDisplay.BullEye.drawBullEye(r,t.bullEyeShape,d,c,l,l,o))},drawBullEye:function(t,e,i,a,r,n,o,s){var l=r,d=n,c="none"!==s;t.strokeStyle=void 0!==s?s:"black",t.fillStyle=void 0!==o?o:"black";var h=i,g=a,p=Math.min(l,d),f=.5*p;switch(t.clearRect(0,0,l,d),e){case"box":c&&t.strokeRect(h-f,g-f,p,p),t.fillRect(h-f,g-f,p,p);break;case"circle":t.beginPath(),t.arc(h,g,f,0,2*Math.PI),c&&t.stroke(),t.fill();break;case"diamond":t.beginPath(),t.moveTo(h-f,g),t.lineTo(h,g-f),t.lineTo(h+f,g),t.lineTo(h,g+f),t.closePath(),c&&t.stroke(),t.fill();break;case"cross":var u=p/3/2;t.beginPath(),t.moveTo(h-f,g-u),t.lineTo(h-u,g-u),t.lineTo(h-u,g-f),t.lineTo(h+u,g-f),t.lineTo(h+u,g-u),t.lineTo(h+f,g-u),t.lineTo(h+f,g+u),t.lineTo(h+u,g+u),t.lineTo(h+u,g+f),t.lineTo(h-u,g+f),t.lineTo(h-u,g+u),t.lineTo(h-f,g+u),t.closePath(),c&&t.stroke(),t.fill();break;case"triangle":var v=Math.sqrt(3)/6*p;t.beginPath(),t.moveTo(h-f,g+v),t.lineTo(h,g-2*v),t.lineTo(h+f,g+v),t.closePath(),c&&t.stroke(),t.fill()}},hitTest:function(t,e,i,a){var r=e.dataToScreenX(t.x),n=e.dataToScreenY(t.y);return i.x>r-t.size/2&&i.x<r+t.size/2&&i.y>n-t.size/2&&i.y<n+t.size/2},getPadding:function(t){return{left:0,right:0,top:0,bottom:0}},getLegend:function(i,a,t){var r=t.content,e=14;document.defaultView&&document.defaultView.getComputedStyle&&(e=parseFloat(document.defaultView.getComputedStyle(r[0],null).getPropertyValue("font-size"))),!isNaN(e)&&0!=e||(e=14);var n=t.thumbnail,o=1.5*e,s=o/2+1,l=o/2+1;n[0].width=n[0].height=2+o;n[0].style;var d,c,h,g=n.get(0).getContext("2d");g.clearRect(0,0,n[0].width,n[0].height);var p,f,u,v,y,m=0,I=0;!function(){if(i.individualColors&&i.colorPalette){var t=a("color");if(0==m){d=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(r),y=$("<div class='idd-legend-item-property'></div>").text(t).appendTo(d),c=d[0].style;var e=$("<div style='width: 170px;'></div>").appendTo(d);h=new InteractiveDataDisplay.ColorPaletteViewer(e),m=2}else y.text(t);h.palette=i.colorPalette,1==m&&(c.display="block",m=2)}else 2==m&&(c.display="none",m=1);i.individualColors?0:(i.color,null!=i.border&&i.border)}(),function(){if(p=o,i.sizePalette){var t=a("size");if(0==I){f=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(r),v=$("<div class='idd-legend-item-property'></div>").text(t).appendTo(f),f[0].style;var e=$("<div style='width: 170px;'></div>").appendTo(f);u=new InteractiveDataDisplay.SizePaletteViewer(e),I=2}else v.text(t);u.palette=InteractiveDataDisplay.SizePalette.Create(i.sizePalette)}0}(),InteractiveDataDisplay.BullEye.drawBullEye(g,i.bullEyeShape,s,l,p,p,"gray","gray")},getTooltipData:function(t,e){var i={},a={};return InteractiveDataDisplay.Utils.isArray(t.x)&&e<t.x.length&&(a.x=new InteractiveDataDisplay.AdaptiveFormatter(t.x),i.x=a.x.toString(t.x[e])),InteractiveDataDisplay.Utils.isArray(t.y)&&e<t.y.length&&(a.y=new InteractiveDataDisplay.AdaptiveFormatter(t.y),i.y=a.y.toString(t.y[e])),t.color&&(i.color={},InteractiveDataDisplay.Utils.isArray(t.color.lower95)&&e<t.color.lower95.length&&(a.lower95=new InteractiveDataDisplay.AdaptiveFormatter(t.color.lower95),i.color["lower 95%"]=a.lower95.toString(t.color.lower95[e])),InteractiveDataDisplay.Utils.isArray(t.color.upper95)&&e<t.color.upper95.length&&(a.upper95=new InteractiveDataDisplay.AdaptiveFormatter(t.color.upper95),i.color["upper 95%"]=a.upper95.toString(t.color.upper95[e]))),InteractiveDataDisplay.Utils.isArray(t.size)&&e<t.size.length&&(a.size=new InteractiveDataDisplay.AdaptiveFormatter(t.size),i.size=a.size.toString(t.size[e])),i.index=e,i},renderSvg:function(t,e,i,a,r){var n=a.y.length;if(0!=n){for(var o,s,l=i.group(),d=r.dataToScreenX,c=r.dataToScreenY,h=e.width,g=e.height,p=0,f=a.size[0],u=.5*f,v=.5*u;p<n;p++){o=d(a.x[p]),s=c(a.y[p]),c1=o+u<0||h<o-u||s+u<0||g<s-u;var y=a.individualColors?a.upper95[p]:a.upper95,m=a.individualColors?a.lower95[p]:a.lower95;if(!c1)switch(a.bullEyeShape){case"box":l.rect(f,f).translate(o-u,s-u).fill(y).stroke({width:.5,color:"black"}),l.rect(u,u).translate(o-v,s-v).fill(m).stroke({width:.5,color:"black"});break;case"circle":l.circle(f).translate(o-u,s-u).fill(y).stroke({width:.5,color:"black"}),l.circle(u).translate(o-v,s-v).fill(m).stroke({width:.5,color:"black"});break;case"diamond":l.rect(f/Math.sqrt(2),f/Math.sqrt(2)).translate(o,s-u).fill(y).stroke({width:.5,color:"black"}).rotate(45),l.rect(u/Math.sqrt(2),u/Math.sqrt(2)).translate(o,s-v).fill(m).stroke({width:.5,color:"black"}).rotate(45);break;case"cross":var I=f/6,D=u/6;l.polyline([[-u,-I],[-I,-I],[-I,-u],[I,-u],[I,-I],[u,-I],[u,I],[I,I],[I,u],[-I,u],[-I,I],[-u,I],[-u,-I]]).translate(o,s).fill(y).stroke({width:.5,color:"black"}),l.polyline([[-v,-D],[-D,-D],[-D,-v],[D,-v],[D,-D],[v,-D],[v,D],[D,D],[D,v],[-D,v],[-D,D],[-v,D],[-v,-D]]).translate(o,s).fill(m).stroke({width:.5,color:"black"});break;case"triangle":var C=Math.sqrt(3)/6*f,b=Math.sqrt(3)/6*u;l.polyline([[-u,C],[0,2*-C],[u,C],[-u,C]]).translate(o,s).fill(y).stroke({width:.5,color:"black"}),l.polyline([[-v,b],[0,2*-b],[v,b],[-v,b]]).translate(o,s).fill(m).stroke({width:.5,color:"black"})}}l.clipWith(l.rect(h,g))}}},InteractiveDataDisplay.BoxWhisker={prepare:function(t){if(null==t.y.median||null==t.y.median)throw"The mandatory property 'y' is undefined or null";if(!InteractiveDataDisplay.Utils.isArray(t.y.median))throw"The property 'y' must be an array of numbers";var e=t.y.median.length,i=new Int8Array(e);if(InteractiveDataDisplay.Utils.maskNaN(i,t.y.median),null==t.x)t.x=InteractiveDataDisplay.Utils.range(0,e-1);else{if(!InteractiveDataDisplay.Utils.isArray(t.x))throw"The property 'x' must be an array of numbers";if(t.x.length!=e)throw"Length of the array which is a value of the property 'x' differs from lenght of 'y'";InteractiveDataDisplay.Utils.maskNaN(i,t.x)}null!=t.border&&"none"!=t.border||(t.border=null),null!=t.thickness&&"none"!=t.thickness||(t.thickness=2),null==t.color&&(t.color=InteractiveDataDisplay.Markers.defaults.color);var a=new Array(e);if(null==t.size&&(t.size=InteractiveDataDisplay.Markers.defaults.size),InteractiveDataDisplay.Utils.isArray(t.y.lower95)&&InteractiveDataDisplay.Utils.isArray(t.y.upper95)){if(t.y.lower95.length!=e&&t.y.upper95.length!=e)throw"Length of the array 'y' is different than length of the array 'y'";if(0<e&&"number"==typeof t.y.lower95[0]&&"number"==typeof t.y.upper95[0]){for(var r=[],n=[],o=0;o<e;o++){var s=t.y.upper95[o],l=t.y.lower95[o];s!=s||l!=l?i[o]=1:(r[o]=t.y.upper95[o],n[o]=t.y.lower95[o])}t.upper95=r,t.lower95=n}}if(InteractiveDataDisplay.Utils.isArray(t.y.lower68)&&InteractiveDataDisplay.Utils.isArray(t.y.upper68)){if(t.y.lower68.length!=e&&t.y.upper68.length!=e)throw"Length of the array 'y' is different than length of the array 'y'";if(0<e&&"number"==typeof t.y.lower68[0]&&"number"==typeof t.y.upper68[0]){var d=[],c=[];for(o=0;o<e;o++){var h=t.y.upper68[o],g=t.y.lower68[o];h!=h||g!=g?i[o]=1:(d[o]=t.y.upper68[o],c[o]=t.y.lower68[o])}t.upper68=d,t.lower68=c}}for(o=0;o<e;o++)a[o]=t.size;t.sizeMax=t.size,t.size=a;var p=0;for(o=0;o<e;o++)1===i[o]&&p++;if(0<p){p=e-p,t.x=InteractiveDataDisplay.Utils.applyMask(i,t.x,p),t.y=InteractiveDataDisplay.Utils.applyMask(i,t.y.median,p),t.size=InteractiveDataDisplay.Utils.applyMask(i,t.size,p),t.upper95=InteractiveDataDisplay.Utils.applyMask(i,t.upper95,p),t.lower95=InteractiveDataDisplay.Utils.applyMask(i,t.lower95,p),t.upper68=InteractiveDataDisplay.Utils.applyMask(i,t.upper68,p),t.lower68=InteractiveDataDisplay.Utils.applyMask(i,t.lower68,p);for(var f=Array(p),u=(o=0,0);o<e;o++)0===i[o]&&(f[u++]=o);t.indices=f}else t.y=t.y.median,t.indices=InteractiveDataDisplay.Utils.range(0,e-1)},preRender:function(t,e,i,a,r){return r.fillStyle=t.color,null!=t.border&&(r.strokeStyle=t.border),t},draw:function(t,e,i,a,r){var n=t.size,o=n/2,s=a.dataToScreenX(t.x),l=a.dataToScreenY(t.upper68),d=a.dataToScreenY(t.lower68),c=a.dataToScreenY(t.upper95),h=a.dataToScreenY(t.lower95),g=a.dataToScreenY(t.y);r.beginPath(),r.strokeStyle=void 0===t.border?"black":t.border,r.lineWidth=t.thickness,t.color&&r.fillRect(s-o,d,n,l-d),r.strokeRect(s-o,d,n,l-d),r.moveTo(s-o,c),r.lineTo(s+o,c),r.moveTo(s,c),r.lineTo(s,l),r.moveTo(s,d),r.lineTo(s,h),r.moveTo(s-o,h),r.lineTo(s+o,h),r.moveTo(s-o,g),r.lineTo(s+o,g),r.stroke(),void 0!==t.y_min&&(r.beginPath(),r.arc(s,a.dataToScreenY(t.y_min),o/2,0,2*Math.PI),r.stroke()),void 0!==t.y_max&&(r.beginPath(),r.arc(s,a.dataToScreenY(t.y_max),o/2,0,2*Math.PI),r.stroke())},hitTest:function(t,e,i,a){var r=e.dataToScreenX(t.x),n=e.dataToScreenY(void 0===t.y_min?t.lower95:t.y_min),o=e.dataToScreenY(void 0===t.y_max?t.upper95:t.y_max);return i.x>r-t.size/2&&i.x<r+t.size/2&&i.y>o&&i.y<n},getBoundingBox:function(t){t.size;var e=t.x,i=t.lower95?t.lower95:t.lower68?t.lower68:t.y,a=t.upper95?t.upper95:t.upper68?t.upper68:t.y;return{x:e,y:i,width:0,height:Math.abs(a-i)}},getPadding:function(t){return{left:0,right:0,top:0,bottom:0}},getLegend:function(n,i,t){var a=t.content,e=14;document.defaultView&&document.defaultView.getComputedStyle&&(e=parseFloat(document.defaultView.getComputedStyle(a[0],null).getPropertyValue("font-size"))),!isNaN(e)&&0!=e||(e=14);var r=t.thumbnail,o=1.5*e,s=o/2+1,l=o/2+1;r[0].width=r[0].height=2+o;r[0].style;var d,c,h,g,p,f,u,v,y=r.get(0).getContext("2d"),m=0,I=0;!function(){if(n.individualColors&&n.colorPalette){var t=i("color");if(0==m){d=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(a),v=$("<div class='idd-legend-item-property'></div>").text(t).appendTo(d),c=d[0].style;var e=$("<div style='width: 170px;'></div>").appendTo(d);h=new InteractiveDataDisplay.ColorPaletteViewer(e),m=2}else v.text(t);h.palette=n.colorPalette,1==m&&(c.display="block",m=2)}else 2==m&&(c.display="none",m=1);n.individualColors?0:(n.color,null!=n.border&&n.border)}(),function(){if(g=o,n.sizePalette){var t=i("size");if(0==I){p=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(a),u=$("<div class='idd-legend-item-property'></div>").text(t).appendTo(p),p[0].style;var e=$("<div style='width: 170px;'></div>").appendTo(p);f=new InteractiveDataDisplay.SizePaletteViewer(e),I=2}else u.text(t);f.palette=InteractiveDataDisplay.SizePalette.Create(n.sizePalette)}0}(),function(){var t="string"==typeof n.color?n.color:"gray",e="string"==typeof n.border?n.border:"gray",i="none"!==e;y.strokeStyle=void 0!==e?e:"black",y.fillStyle=void 0!==t?t:"black";var a=.5*g,r=.5*a;y.clearRect(0,0,g,g),y.fillRect(s-a,l-r,g,a),i&&y.strokeRect(s-a,l-r,g,a),y.beginPath(),y.moveTo(s-a,l+a),y.lineTo(s+a,l+a),y.moveTo(s-a,l-a),y.lineTo(s+a,l-a),y.moveTo(s,l+a),y.lineTo(s,l+r),y.moveTo(s,l-a),y.lineTo(s,l-r),y.closePath(),i&&y.stroke(),i&&(y.beginPath(),y.moveTo(s-a,l),y.lineTo(s+a,l),y.stroke())}()},getTooltipData:function(t,e){var i={},a={};return InteractiveDataDisplay.Utils.isArray(t.x)&&e<t.x.length&&(a.x=new InteractiveDataDisplay.AdaptiveFormatter(t.x),i.x=a.x.toString(t.x[e])),t.y&&(i.y={},InteractiveDataDisplay.Utils.isArray(t.y.median)&&e<t.y.median.length&&(a.median=new InteractiveDataDisplay.AdaptiveFormatter(t.y.median),i.y.median=a.median.toString(t.y.median[e])),InteractiveDataDisplay.Utils.isArray(t.y.lower95)&&e<t.y.lower95.length&&(a.lower95=new InteractiveDataDisplay.AdaptiveFormatter(t.y.lower95),i.y["lower 95%"]=a.lower95.toString(t.y.lower95[e])),InteractiveDataDisplay.Utils.isArray(t.y.upper95)&&e<t.y.upper95.length&&(a.upper95=new InteractiveDataDisplay.AdaptiveFormatter(t.y.upper95),i.y["upper 95%"]=a.upper95.toString(t.y.upper95[e])),InteractiveDataDisplay.Utils.isArray(t.y.lower68)&&e<t.y.lower68.length&&(a.lower68=new InteractiveDataDisplay.AdaptiveFormatter(t.y.lower68),i.y["lower 68%"]=a.lower68.toString(t.y.lower68[e])),InteractiveDataDisplay.Utils.isArray(t.y.upper68)&&e<t.y.upper68.length&&(a.upper68=new InteractiveDataDisplay.AdaptiveFormatter(t.y.upper68),i.y["upper 68%"]=a.upper68.toString(t.y.upper68[e]))),InteractiveDataDisplay.Utils.isArray(t.size)&&e<t.size.length&&(a.size=new InteractiveDataDisplay.AdaptiveFormatter(t.size),i.size=a.size.toString(t.size[e])),i.index=e,i},renderSvg:function(t,e,i,a,r){var n=a.y.length;if(0!=n){for(var o,s,l,d,c,h,g,p=i.group(),f=r.dataToScreenX,u=r.dataToScreenY,v=e.width,y=e.height,m=0,I=a.size[0],D=I/2,C=a.color,b=null==a.border?"none":a.border,w=a.thickness;m<n;m++)o=f(a.x[m]),s=u(a.y[m]),l=a.upper68?u(a.upper68[m]):void 0,d=a.lower68?u(a.lower68[m]):void 0,c=a.upper95?u(a.upper95[m]):void 0,h=a.lower95?u(a.lower95[m]):void 0,g=u(a.y[m]),c1=o<0||v<o||s<0||y<s,c1||(null!=c&&null!=h&&(p.polyline([[o-D,c],[o+D,c]]).style({fill:"none",stroke:b,"stroke-width":w}),p.polyline([[o,c],[o,h]]).style({fill:"none",stroke:b,"stroke-width":w}),p.polyline([[o-D,h],[o+D,h]]).style({fill:"none",stroke:b,"stroke-width":w})),null!=l&&null!=d&&p.rect(I,Math.abs(l-d)).translate(o-D,l).fill(C).style({fill:C,stroke:b,"stroke-width":w}),p.polyline([[o-D,g],[o+D,g]]).style({fill:"none",stroke:b,"stroke-width":w}));p.clipWith(p.rect(v,y))}}},InteractiveDataDisplay.Bars={prepare:function(t){var e,i;if("h"==t.orientation){if(null==t.x||null==t.x)throw"The mandatory property 'x' is undefined or null";if(!InteractiveDataDisplay.Utils.isArray(t.x))throw"The property 'x' must be an array of numbers";if(e=t.x.length,i=new Int8Array(e),InteractiveDataDisplay.Utils.maskNaN(i,t.x),null==t.y)t.y=InteractiveDataDisplay.Utils.range(0,e-1);else{if(!InteractiveDataDisplay.Utils.isArray(t.y))throw"The property 'x' must be an array of numbers";if(t.y.length!=e)throw"Length of the array which is a value of the property 'x' differs from length of 'y'";InteractiveDataDisplay.Utils.maskNaN(i,t.y)}}else{if(null==t.y||null==t.y)throw"The mandatory property 'y' is undefined or null";if(!InteractiveDataDisplay.Utils.isArray(t.y))throw"The property 'y' must be an array of numbers";if(e=t.y.length,i=new Int8Array(e),InteractiveDataDisplay.Utils.maskNaN(i,t.y),null==t.x)t.x=InteractiveDataDisplay.Utils.range(0,e-1);else{if(!InteractiveDataDisplay.Utils.isArray(t.x))throw"The property 'x' must be an array of numbers";if(t.x.length!=e)throw"Length of the array which is a value of the property 'x' differs from length of 'y'";InteractiveDataDisplay.Utils.maskNaN(i,t.x)}}if(null!=t.border&&"none"!=t.border||(t.border=null),null!=t.shadow&&"none"!=t.shadow||(t.shadow=null),null==t.color&&(t.color=InteractiveDataDisplay.Markers.defaults.color),InteractiveDataDisplay.Utils.isArray(t.color)){if(t.color.length!=e)throw"Length of the array 'color' is different than length of the array 'y'";if(0<e&&"string"!=typeof t.color[0]){var a=t.colorPalette;if(null==a&&(a=InteractiveDataDisplay.Markers.defaults.colorPalette),"string"==typeof a&&(a=new InteractiveDataDisplay.ColorPalette.parse(a)),null!=a&&a.isNormalized){var r=InteractiveDataDisplay.Utils.getMinMax(t.color);r=InteractiveDataDisplay.Utils.makeNonEqual(r),a=a.absolute(r.min,r.max)}t.colorPalette=a;for(var n=new Array(e),o=0;o<e;o++){var s=t.color[o];if(s!=s)i[o]=1;else{var l=a.getRgba(s);n[o]="rgba("+l.r+","+l.g+","+l.b+","+l.a+")"}}t.color=n}t.individualColors=!0}else t.individualColors=!1;var d=0;for(o=0;o<e;o++)1===i[o]&&d++;if(0<d){d=e-d,t.x=InteractiveDataDisplay.Utils.applyMask(i,t.x,d),t.y=InteractiveDataDisplay.Utils.applyMask(i,t.y,d),t.individualColors&&(t.color=InteractiveDataDisplay.Utils.applyMask(i,t.color,d));for(var c=Array(d),h=(o=0,0);o<e;o++)0===i[o]&&(c[h++]=o);t.indices=c}else t.indices=InteractiveDataDisplay.Utils.range(0,e-1)},draw:function(t,e,i,a,r){var n,o,s,l,d,c;if("h"==t.orientation){if(n=a.dataToScreenX(0),(o=a.dataToScreenX(t.x))<n){var h=o;o=n,n=h}if(n>i.width||o<0)return;if(c=a.plotToScreenY(t.barWidth)-a.plotToScreenY(0),l=a.dataToScreenY(t.y)-c/2,(s=a.dataToScreenY(t.y)+c/2)>i.height||l<0)return}else{if(d=a.plotToScreenX(t.barWidth)-a.plotToScreenX(0),n=a.dataToScreenX(t.x)-d/2,o=a.dataToScreenX(t.x)+d/2,n>i.width||o<0)return;if((l=a.dataToScreenY(0))<(s=a.dataToScreenY(t.y))){h=l;l=s,s=h}if(s>i.height||l<0)return}t.shadow&&(r.fillStyle=t.shadow,r.fillRect(n+2,s+2,o-n,l-s)),r.fillStyle=t.color,r.fillRect(n,s,o-n,l-s),t.border&&(r.strokeStyle=t.border,r.strokeRect(n,s,o-n,l-s))},getPlotBoundingBox:function(t,e){var i,a,r,n,o=t.barWidth,s=e.dataToPlotX,l=e.dataToPlotY;return void 0===s&&(s=function(t){return t}),void 0===l&&(l=function(t){return t}),n="h"==t.orientation?(i=s(Math.min(0,t.x)),a=l(t.y)-o/2,r=s(Math.abs(t.x)),o):(i=s(t.x)-o/2,a=l(Math.min(0,t.y)),r=o,l(Math.abs(t.y))),{x:i,y:a,width:r,height:n}},hitTest:function(t,e,i,a){var r=t.barWidth,n="h"==t.orientation?Math.min(0,t.x):t.x-r/2,o="h"==t.orientation?t.y-r/2:Math.min(0,t.y);return"h"==t.orientation?!(a.x<n||a.x>n+Math.abs(t.x))&&!(a.y<o||a.y>o+r):!(a.x<n||a.x>n+r)&&!(a.y<o||a.y>o+Math.abs(t.y))},getLegend:function(i,a,t){var r=t.content,e=14;document.defaultView&&document.defaultView.getComputedStyle&&(e=parseFloat(document.defaultView.getComputedStyle(r[0],null).getPropertyValue("font-size"))),!isNaN(e)&&0!=e||(e=14);var n=t.thumbnail,o=1.5*e,s=o/3-.5,l=o/3*2,d=o,c=o/2,h=o/3;n[0].width=n[0].height=2+o;n[0].style;var g,p,f,u,v,y,m,I,D=n.get(0).getContext("2d"),C=0;!function(){if(0,i.individualColors&&i.colorPalette){var t=a("color");if(0==C){g=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(r),u=$("<div class='idd-legend-item-property'></div>").text(t).appendTo(g),p=g[0].style;var e=$("<div style='width: 170px;'></div>").appendTo(g);f=new InteractiveDataDisplay.ColorPaletteViewer(e),C=2}else u.text(t);f.palette=i.colorPalette,1==C&&(p.display="block",C=2)}else 2==C&&(p.display="none",C=1);i.individualColors?0:(i.color,null!=i.border&&i.border,null!=i.shadow&&i.shadow)}(),v="string"==typeof i.color?i.color:"lightgray",y="string"==typeof i.border?i.border:"gray",m="string"==typeof i.shadow?i.shadow:"gray",I="none"!==y,D.clearRect(0,0,o,o),m&&(D.fillStyle=m,D.fillRect(1,1+c,s,o-c),s+=1,D.fillRect(s+1,1,l-s,o),l+=1,D.fillRect(l+1,1+h,d-l,o-h)),D.strokeStyle=void 0!==y?y:"black",D.fillStyle=void 0!==v?v:"black",D.fillStyle=v,D.fillRect(0,c,s,o-c),D.fillRect(s,0,l-s,o),D.fillRect(l,h,d-l,o-h),I&&(D.strokeStyle=y,D.strokeRect(0,c,s,o-c),D.strokeRect(s,0,l-s,o),D.strokeRect(l,h,d-l,o-h))},renderSvg:function(t,e,i,a,r){var n=a.y.length;if(0!=n){for(var o,s,l,d,c,h=i.group(),g=r.dataToScreenX,p=r.dataToScreenY,f=e.width,u=e.height,v=0,y=a.barWidth/2,m=null==a.border?"none":a.border,I=null==a.shadow?"none":a.shadow;v<n;v++){if("h"==a.orientation){if(o=g(0),s=g(a.x[v]),l=p(a.y[v]+y),d=p(a.y[v]-y),s<o){var D=s;s=o,o=D}}else if(o=g(a.x[v]-y),s=g(a.x[v]+y),l=p(a.y[v]),(d=p(0))<l){D=d;d=l,l=D}c=a.individualColors?a.color[v]:a.color,c1=s<0||f<o||d<0||u<l,c1||(h.polyline([[o+2,d+2],[o+2,l+2],[s+2,l+2],[s+2,d+2],[o+2,d+2]]).fill(I),h.polyline([[o,d],[o,l],[s,l],[s,d],[o,d]]).fill(c).stroke({width:1,color:m}))}h.clipWith(h.rect(f,u))}},buildSvgLegendElements:function(t,e,i,a){var r=e.group(),n=e.group(),o=1.5*(v=12),s=o/3-.5,l=o/3*2,d=o,c=o/2,h=o/3,g="none";i.individualColors?(border="#000000",color="lightgrey",g="grey"):(color=i.color,border="none",null!=i.border&&(border=i.border),null!=i.shadow&&(g=i.shadow)),r.polyline([[1,1+o],[1,1+c],[s+1,1+c],[s+1,1+o],[1,1+o]]).fill(g),r.polyline([[0,o],[0,c],[s,c],[s,o],[0,o]]).fill(color).stroke({width:.2,color:border}),s+=1,r.polyline([[s+1,1+o],[s+1,1],[l+1,1],[l+1,1+o],[s+1,1+o]]).fill(g),r.polyline([[s,o],[s,0],[l,0],[l,o],[s,o]]).fill(color).stroke({width:.2,color:border}),l+=1,r.polyline([[l+1,1+o],[l+1,1+h],[1+d,1+h],[1+d,1+o],[l+1,1+o]]).fill(g),r.polyline([[l,o],[l,h],[d,h],[d,o],[l,o]]).fill(color).stroke({width:.2,color:border});var p=t.legendDiv.children[1],f=i.individualColors&&i.colorPalette,u=p&&t.legendDiv.children[1].children[0]&&t.legendDiv.children[1].children[0].children[0]?window.getComputedStyle(t.legendDiv.children[1].children[0].children[0],null):void 0,v=u?parseFloat(u.getPropertyValue("font-size")):void 0,y=u?u.getPropertyValue("font-family"):void 0,m=u?u.getPropertyValue("font-weight"):void 0;if(f){var I=a("color");n.text(I).font({family:y,size:v,weight:m});var D=e.group(),C=t.width;InteractiveDataDisplay.SvgColorPaletteViewer(D,i.colorPalette,t.legendDiv.children[1].children[0].children[1],{width:C,height:20}),D.translate(5,50),shiftsizePalette=70,t.height+=70}return e.front(),{thumbnail:r,content:n}}},InteractiveDataDisplay.Markers.shapes.boxwhisker=InteractiveDataDisplay.BoxWhisker,InteractiveDataDisplay.Markers.shapes.petals=InteractiveDataDisplay.Petal,InteractiveDataDisplay.Markers.shapes.bulleye=InteractiveDataDisplay.BullEye,InteractiveDataDisplay.Markers.shapes.bars=InteractiveDataDisplay.Bars,InteractiveDataDisplay.Area=function(t,e){var g,p,f,n="rgba(65, 105, 237, 0.4)",i=InteractiveDataDisplay.Utils.getDataSourceFunction(t,InteractiveDataDisplay.readCsv)(t);this.base=InteractiveDataDisplay.CanvasPlot,this.base(t,e);var l=n;i&&(l=void 0!==i.fill?i.fill:n),this.draw=function(t){var e=t.y1;if(!e)throw"Data series y1 is undefined";var i=e.length,a=t.y2;if(!a)throw"Data series y2 is undefined";if(a.length!==i)throw"Data series y1 and y2 have different lengths";var r=t.x;if((r=r||InteractiveDataDisplay.Utils.range(0,i-1)).length!==i)throw"Data series x and y1, y2 have different lengths";p=e,f=a,g=r,l=void 0!==t.fill?t.fill:n,this.invalidateLocalBounds(),this.requestNextFrameOrUpdate(),this.fireAppearanceChanged()},this.computeLocalBounds=function(){var t=this.xDataTransform&&this.xDataTransform.dataToPlot,e=this.yDataTransform&&this.yDataTransform.dataToPlot,i=InteractiveDataDisplay.Utils.getBoundingBoxForArrays(g,p,t,e),a=InteractiveDataDisplay.Utils.getBoundingBoxForArrays(g,f,t,e);return InteractiveDataDisplay.Utils.unionRects(i,a)},this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.getTooltip=function(t,e,i,a){if(void 0!==g&&null!=p&&null!=f&&(0!=p.length&&this.isVisible)){var r=this.getContext(!1);if(void 0!==r){for(var n=this.getTransform(),o=n.dataToScreenX(t),s=n.dataToScreenY(e),l=r.getImageData(o-1,s-1,3,3),d=0,c=0;c<l.data.length;c++)0===l.data[c]&&d++;if(d!==l.data.length){var h=$("<div></div>");return $("<div></div>").addClass("idd-tooltip-name").text(this.name||"area").appendTo(h),h}}}},this.renderCore=function(t,e){InteractiveDataDisplay.Area.prototype.renderCore.call(this,t,e);var i=this.getContext(!0);InteractiveDataDisplay.Area.render.call(this,g,p,f,l,t,e,i)},this.renderCoreSvg=function(t,e,i){InteractiveDataDisplay.Area.renderSvg.call(this,t,e,i,g,p,f,l)};this.onDataTransformChanged=function(t){this.invalidateLocalBounds(),InteractiveDataDisplay.Area.prototype.onDataTransformChanged.call(this,t)},Object.defineProperty(this,"fill",{get:function(){return l},set:function(t){t!=l&&(l=t,this.fireAppearanceChanged("fill"),this.requestNextFrameOrUpdate())},configurable:!1}),this.getLegend=function(){var t=this,i=$("<canvas></canvas>");i[0].width=40,i[0].height=40;var a=i.get(0).getContext("2d");a.globalAlpha=1,a.strokeStyle=l,a.fillStyle=l,a.beginPath(),a.moveTo(0,0),a.lineTo(0,10),a.lineTo(30,40),a.lineTo(40,40),a.lineTo(40,30),a.lineTo(10,0),a.lineTo(0,0),a.fill(),a.stroke(),a.closePath();function r(){e.text(t.name)}var e=$("<span></span>");r(),this.host.bind("appearanceChanged",function(t,e){e&&"name"!=e||r(),a.clearRect(0,0,i[0].width,i[0].height),a.strokeStyle=l,a.fillStyle=l,a.beginPath(),a.moveTo(0,0),a.lineTo(0,10),a.lineTo(30,40),a.lineTo(40,40),a.lineTo(40,30),a.lineTo(10,0),a.lineTo(0,0),a.fill(),a.stroke(),a.closePath()});t=this;return{name:e,legend:{thumbnail:i,content:void 0},onLegendRemove:function(){t.host.unbind("appearanceChanged")}}},this.buildSvgLegend=function(t,e){t.height=30,e.add(e.rect(t.width,t.height).fill("white").opacity(.5));var i=InteractiveDataDisplay.ColorPalette.colorFromString(l),a="rgb("+i.r+","+i.g+","+i.b+")";e.add(e.polyline([[0,0],[0,4.5],[13.5,18],[18,18],[18,13.5],[4.5,0],[0,0]]).fill(a).opacity(i.a).translate(5,5));var r=window.getComputedStyle(t.legendDiv.children[0].children[1],null),n=parseFloat(r.getPropertyValue("font-size")),o=r.getPropertyValue("font-family"),s=r?r.getPropertyValue("font-weight"):void 0;e.add(e.text(this.name).font({family:o,size:n,weight:s}).translate(40,0)),e.front()},i&&i.x&&i.y1&&i.y2&&this.draw(i)},InteractiveDataDisplay.Area.prototype=new InteractiveDataDisplay.CanvasPlot,InteractiveDataDisplay.Area.render=function(t,e,i,a,r,n,o){if(void 0!==t&&null!=e&&null!=i){var s=e.length;if(0!=s){var l=this.getTransform(),d=l.dataToScreenX,c=l.dataToScreenY;o.fillStyle=a;for(var h=[],g=void 0,p=0;p<s;p++)isNaN(t[p])||isNaN(e[p])||isNaN(i[p])?g=void 0===g?p:void h.push([g,p]):void 0===g?g=p:p===s-1&&(h.push([g,p]),g=void 0);var f=h.length;for(p=0;p<f;p++){o.beginPath();var u=h[p];o.moveTo(d(t[u[0]]),c(e[u[0]]));for(var v=u[0]+1;v<=u[1];v++)o.lineTo(d(t[v]),c(e[v]));for(v=u[1];v>=u[0];v--)o.lineTo(d(t[v]),c(i[v]));o.fill()}}}},InteractiveDataDisplay.Area.renderSvg=function(t,e,i,a,r,n,o){if(void 0!==a&&null!=r&&null!=n){var s=r.length;if(0!=s){for(var l=this.getTransform(),d=l.dataToScreenX,c=l.dataToScreenY,h=i.group(),g=e.width,p=e.height,f=[],u=void 0,v=0;v<s;v++)isNaN(a[v])||isNaN(r[v])||isNaN(n[v])?void 0!==u&&(f.push([u,v-1]),u=void 0):void 0===u?u=v:v===s-1&&(f.push([u,v]),u=void 0);var y=[],m=f.length,I=InteractiveDataDisplay.ColorPalette.colorFromString(o),D="rgb("+I.r+","+I.g+","+I.b+")";for(v=0;v<m;v++){var C=f[v];(y=[]).push([d(a[C[0]]),c(r[C[0]])]);for(var b=C[0]+1;b<=C[1];b++)y.push([d(a[b]),c(r[b])]);for(b=C[1];b>=C[0];b--)y.push([d(a[b]),c(n[b])]);y.push([d(a[C[0]]),c(r[C[0]])]),h.polyline(y).fill(D).opacity(I.a)}h.clipWith(h.rect(g,p))}}},InteractiveDataDisplay.heatmapBackgroundRenderer=void 0,InteractiveDataDisplay.Heatmap=function(t,b){var e=InteractiveDataDisplay.Utils.getDataSourceFunction(t,InteractiveDataDisplay.readCsv2d)(t);if(e&&void 0!==e.y&&void 0!==e.values){var i=e.y,a=e.values,r=i.length,n=a.length;if(1<r&&0<n&&i[0]>i[1]){i.reverse();for(var o=0;o<r;o++)a[o].reverse()}}if(this.base=InteractiveDataDisplay.CanvasPlot,this.base(t,b),t){null==InteractiveDataDisplay.heatmapBackgroundRenderer&&(InteractiveDataDisplay.heatmapBackgroundRenderer=new InteractiveDataDisplay.SharedRenderWorker(function(){var t;if(void 0===InteractiveDataDisplay.heatmapBackgroundRendererCodeBase64||/PhantomJS/.test(window.navigator.userAgent)||0<InteractiveDataDisplay.Utils.getIEVersion())t=InteractiveDataDisplay.HeatmapworkerPath?InteractiveDataDisplay.HeatmapworkerPath+"idd.heatmapworker.js":"idd.heatmapworker.js";else{var e=new Blob([window.atob(InteractiveDataDisplay.heatmapBackgroundRendererCodeBase64)],{type:"text/javascript"});t=window.URL.createObjectURL(e)}return t}(),function(t,e){t.onRenderTaskCompleted(e)}));function v(t){if(t)try{V="string"==typeof t?InteractiveDataDisplay.ColorPalette.parse(t):t,Z=InteractiveDataDisplay.ColorPalette.toArray(V,512)}catch(t){window.console&&console.error("Failed to initialize the palette")}}function y(t){R=Math.min(1,Math.max(0,t))}var w,A,x,T,m,I,D,S,P,k,C,M,G,N,R,B,V,F,Z,L,z,U,Y,O,W,X,f,E=document.createElement("canvas");y(e&&void 0!==e.opacity?parseFloat(e.opacity):1),v(e&&void 0!==e.colorPalette?e.colorPalette:InteractiveDataDisplay.palettes.grayscale);function H(t){var e=t.length;if(!(e<1)){var i=t[0].length;if(!(i<1)){var a,r;a=r=t[0][0];for(var n=0;n<e;n++)for(var o=t[n],s=0;s<i;s++){var l=o[s];l==l&&((r<l||isNaN(r))&&(r=l),(l<a||isNaN(a))&&(a=l))}return{min:a,max:r}}}}function j(t,e,i,a){if(!t||!e||!i)return{};if(!t.length||!e.length||i.v&&!i.v.length||i.m&&(!i.m.length||!i.lb68.length||!i.ub68.length))return{};t=Array.prototype.slice.call(t),e=Array.prototype.slice.call(e),i.v?i.v=Array.prototype.slice.call(i.v):i.m&&(i.m=Array.prototype.slice.call(i.m),i.lb68=Array.prototype.slice.call(i.lb68),i.ub68=Array.prototype.slice.call(i.ub68)),!i.v||t.length===e.length&&t.length===i.v.length&&e.length===i.v.length?!i.m||t.length===e.length&&t.length===i.m.length&&e.length===i.m.length&&i.m.length===i.lb68.length&&i.m.length===i.ub68.length||(t.length=e.length=i.m.length=i.lb68.length=i.ub68.length=Math.min(t.length,e.length,i.m.length,i.lb68.length,i.ub68.length)):t.length=e.length=i.v.length=Math.min(t.length,e.length,i.v.length);var r,n,o,s,l=t.map(function(t,e){return{v:t,i:e}}),d=e.map(function(t,e){return{v:t,i:e}}),c=l.sort(function(t,e){return t.v<e.v?-1:t.v>e.v?1:0}),h=d.sort(function(t,e){return t.v<e.v?-1:t.v>e.v?1:0}),g=c.filter(function(t,e){return!e||t.v!=c[e-1].v}).map(function(t){return t.v}),p=h.filter(function(t,e){return!e||t.v!=h[e-1].v}).map(function(t){return t.v}),f=[],u=[];r=0,c.forEach(function(t,e){return f[t.i]=e?t.v!=c[e-1].v?++r:r:0}),r=0,h.forEach(function(t,e){return u[t.i]=e?t.v!=h[e-1].v?++r:r:0});function v(t,e){for(var i=[],a=0;a<t;++a){i[a]=[];for(var r=0;r<e;++r)i[a][r]=NaN}return i}if(i.v)for(n=v(g.length,p.length),r=0;r<i.v.length;++r)n[f[r]][u[r]]=i.v[r];else for(y=v(g.length,p.length),o=v(g.length,p.length),s=v(g.length,p.length),r=0;r<i.m.length;++r)y[f[r]][u[r]]=i.m[r],o[f[r]][u[r]]=i.lb68[r],s[f[r]][u[r]]=i.ub68[r];if(a){if(2<=g.length){var y,m=[];for(m.push(g[0]-(g[1]-g[0])/2),y=1;y<g.length;y++)m.push(g[y]-(g[y]-g[y-1])/2);m.push(g[g.length-1]+(g[g.length-1]-g[g.length-2])/2),g=m}if(2<=p.length){var I,D=[];for(D.push(p[0]-(p[1]-p[0])/2),I=1;I<p.length;I++)D.push(p[I]-(p[I]-p[I-1])/2);D.push(p[p.length-1]+(p[p.length-1]-p[p.length-2])/2),p=D}}return{x:g,y:p,values:n,m:y,l68:o,u68:s}}function K(){var t=H(T);S=t.min,P=t.max,k&&(S=Math.max(S,C),P=Math.max(P,C),G=InteractiveDataDisplay.Utils.log10(S),N=InteractiveDataDisplay.Utils.log10(P))}var Q,s=this;if(this.onRenderTaskCompleted=function(t){Q=t,E.width===Q.width&&E.height===Q.height||(E.width=Q.width,E.height=Q.height),E.getContext("2d").putImageData(Q.image,0,0),s.requestNextFrame()},this.draw=function(t,e){var i=t.values;if(!i)throw"Data series f is undefined";var a=void 0!==i.median&&!InteractiveDataDisplay.Utils.isArray(i.median[0])||!InteractiveDataDisplay.Utils.isArray(i[0]),r=t.x,n=t.y;if(null==z&&null==L&&(z=t.interval),L=t.interval,k=void 0!==t.logPalette&&t.logPalette,C=t.logTolerance?t.logTolerance:1e-12,i.median){if(null==U){var o=$("<div></div>").attr("data-idd-name","heatmap__nav_").appendTo(this.host);(U=new InteractiveDataDisplay.Heatmap(o,this.master)).getLegend=function(){},this.addChild(U),U.getTooltip=function(t,e,i,a){}}if(a){var s=j(r,n,{v:void 0,m:i.median,lb68:i.lower68,ub68:i.upper68},"discrete"===t.treatAs);x=s.x,A=s.y,T=s.m,D=s.m,I=s.l68,m=s.u68,U.x=s.x,U.y=s.y,U.f_median=s.m,U.f_l68=s.l68,U.f_u68=s.u68}else x=r,A=n,T=i.median,D=i.median,I=i.lower68,m=i.upper68,U.x=s.x,U.y=s.y,U.f_median=i.median68,U.f_l68=i.lower68,U.f_u68=i.upper68;L&&_()}else if(U&&U.remove(),U=void 0,a){s=j(r,n,{v:i},"discrete"===t.treatAs);x=s.x,A=s.y,T=s.values}else T=i,x=r,A=n;if(k){M=new Array(T.length);for(var l=0;l<T.length;l++)for(var d=T[l],c=M[l]=new Float32Array(d.length),h=0;h<d.length;h++)c[h]=InteractiveDataDisplay.Utils.log10(d[h])}X=W=O=Y=void 0;var g=D?D.length:T.length,p=D?D[0].length:T[0].length;if(x){if(x.length!=g&&x.length!=g+1)throw"Data series x must have length equal or one more than length of data series f by first dimension"}else x=InteractiveDataDisplay.Utils.range(0,g);if(A){if(A.length!=p&&A.length!=p+1)throw"Data series y must have length equal or one more than length of data series f by second dimension"}else A=InteractiveDataDisplay.Utils.range(0,p);if(x.length==g){if(A.length!=p)throw"Data series y must have length equal to length of data series f by second dimension";B="gradient"}else{if(A.length!=p+1)throw"Data series y must have length equal to one more than length of data series f by second dimension";B="matrix"}if(x.length<2)throw"Data series x must have at least 2 elements by each dimension";if(A.length<2)throw"Data series y must have at least 2 elements by each dimension";t&&void 0!==t.opacity&&y(parseFloat(t.opacity)),t&&void 0!==t.colorPalette&&v(t.colorPalette),V.isNormalized&&K(),F=!0;var f=this.invalidateLocalBounds(),u=this.getLocalBounds();InteractiveDataDisplay.Utils.equalRect(f,u)?this.requestNextFrame():this.requestNextFrameOrUpdate(),this.setTitles(e,!0),this.fireAppearanceChanged()},this.computeLocalBounds=function(){var t;if(x&&A){var e,i,a,r,n,o=x.length,s=A.length;for(n=0;n<o&&(e=x[n])!=e;n++);for(n=o;0<=--n&&(i=x[n])!=i;);for(n=0;n<s&&(a=A[n])!=a;n++);for(n=s;0<=--n&&(r=A[n])!=r;);var l=this.xDataTransform&&this.xDataTransform.dataToPlot,d=this.yDataTransform&&this.yDataTransform.dataToPlot;l&&(e=l(e),i=l(i)),d&&(a=d(a),r=d(r)),t={x:Math.min(e,i),y:Math.min(a,r),width:Math.abs(i-e),height:Math.abs(r-a)}}return t},"undefined"==typeof Modernizr||!t||Modernizr.webworkers&&Modernizr.postmessage){var J=void 0,q=void 0;this.renderCore=function(t,e){InteractiveDataDisplay.Heatmap.prototype.renderCore.call(this,t,e);var i=this.getContext(!0);if(null!=x&&null!=A&&null!=T){var a=this.coordinateTransform,r=a.plotToScreenX,n=a.plotToScreenY,o=this.getLocalBounds(),s=InteractiveDataDisplay.Utils.intersect(o,t);if(s){var l=!0;if(void 0!==b.mapControl){var d=o.x,c=o.x+o.width/2,h=o.x+o.width;if(void 0===J){var g={fillColor:new Microsoft.Maps.Color(120,120,120,120),strokeColor:new Microsoft.Maps.Color(120,120,120,120),strokeThickness:0};J=new Microsoft.Maps.Polygon([new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y),d),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y),c),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y+o.height),c),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y+o.height),d)],g),q=new Microsoft.Maps.Polygon([new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y),c),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y),h),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y+o.height),h),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y+o.height),c)],g),b.mapControl.entities.push(J),b.mapControl.entities.push(q)}F&&(J.setLocations([new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y),d),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y),c),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y+o.height),c),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y+o.height),d)]),q.setLocations([new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y),c),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y),h),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y+o.height),h),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(o.y+o.height),c)])),l=!b.isInAnimation,J.setOptions({visible:b.isInAnimation}),q.setOptions({visible:b.isInAnimation})}if(l){var p={left:Math.floor(r(s.x)),width:Math.ceil(a.plotToScreenWidth(s.width)),top:Math.floor(n(s.y+s.height)),height:Math.ceil(a.plotToScreenHeight(s.height))},f=a.getScale(),u=a.getOffset();if(i.fillStyle="rgba(200,200,200,0.3)",i.fillRect(p.left,p.top,p.width,p.height),Q)if(InteractiveDataDisplay.Utils.intersect(Q.plotRect,t)){var v,y=r(Q.plotRect.x),m=n(Q.plotRect.y+Q.plotRect.height);if(1!=R&&(v=i.globalAlpha,i.globalAlpha=R),f.x!=Q.scaleX||f.y!=Q.scaleY){var I=f.x/Q.scaleX,D=f.y/Q.scaleY;i.drawImage(E,0,0,Q.image.width,Q.image.height,y,m,I*Q.image.width,D*Q.image.height)}else i.drawImage(E,y,m);1!=R&&(i.globalAlpha=v)}if((F||!this.master.isInAnimation&&(!Q||Q.scaleX!=f.x||Q.scaleY!=f.y||!InteractiveDataDisplay.Utils.includes(Q.plotRect,s)))&&0!==p.width&&0!==p.heigh){w&&w.width===p.width&&w.height===p.height||(w=i.createImageData(p.width,p.height));var C={image:w,width:w.width,height:w.height,x:x,y:A,f:k?M:T,fmin:k?G:S,fmax:k?N:P,plotRect:s,scaleX:f.x,scaleY:f.y,offsetX:u.x-p.left,offsetY:u.y-p.top,palette:{isNormalized:V.isNormalized,range:V.range,points:V.points,colors:Z},xDataTransform:this.xDataTransform&&this.xDataTransform.type,yDataTransform:this.yDataTransform&&this.yDataTransform.type};InteractiveDataDisplay.heatmapBackgroundRenderer.enqueue(C,this),F=!1}}}}},this.renderCoreSvg=function(t,e,i){var a=i.group();if(null!=x&&null!=A&&null!=T){e.width,e.height;var r=this.coordinateTransform,n=r.plotToScreenX,o=r.plotToScreenY,s=this.getLocalBounds(),l=InteractiveDataDisplay.Utils.intersect(s,t);if(l){var d={left:Math.floor(n(l.x)),width:Math.ceil(r.plotToScreenWidth(l.width)),top:Math.floor(o(l.y+l.height)),height:Math.ceil(r.plotToScreenHeight(l.height))},c=E.toDataURL("image/png");a.image(c,w.width,w.height).opacity(R).clipWith(a.rect(d.width,d.height)),a.translate(d.left,d.top)}}},this.onIsRenderedChanged=function(){this.isRendered||InteractiveDataDisplay.heatmapBackgroundRenderer.cancelPending(this)},this.onDataTransformChanged=function(t){this.invalidateLocalBounds(),InteractiveDataDisplay.Heatmap.prototype.onDataTransformChanged.call(this,t)};this.getValue=function(t,e,i){var a=x.length,r=A.length;if(0==a||0==r)return null;var n,o,s,l,d,c=function(t,e){var i=x.length,a=A.length;if(0!=i&&0!=a&&!(t<x[0]||e<A[0]||t>x[i-1]||e>A[a-1])){var r,n;for(r=1;r<i;r++)if(t<=x[r]){if(isNaN(x[r-1]))return NaN;break}for(n=1;n<a;n++)if(e<=A[n]){if(isNaN(A[n-1]))return NaN;break}return i<=r||a<=n?NaN:{iLeft:r-1,jBottom:n-1}}}(t,e);if(null==c)return null;if(c!=c)return"<div>"+(this.name||"heatmap")+": (unknown value)</div>";if("gradient"===B)if(s=i[c.iLeft][c.jBottom+1],o=i[c.iLeft][c.jBottom],l=i[c.iLeft+1][c.jBottom+1],d=i[c.iLeft+1][c.jBottom],isNaN(s)||isNaN(o)||isNaN(l)||isNaN(d))n=NaN;else{var h=A[c.jBottom],g=A[c.jBottom+1],p=(s-o)/(g-h)*(e-h)+o,f=(l-d)/(g-h)*(e-h)+d,u=x[c.iLeft];n=(f-p)/(x[c.iLeft+1]-u)*(t-u)+p}else n=i[c.iLeft][c.jBottom];return n};var _=function(){for(var t=U.f_median,e=new Array(t.length),i=0;i<t.length;i++){var a=t[i];e[i]=new Array(a.length);for(var r=0;r<a.length;r++)e[i][r]=U.f_l68[i][r]<L.max&&U.f_u68[i][r]>L.min?0:1}U.draw({x:U.x,y:U.y,values:e,opacity:.5,colorPalette:InteractiveDataDisplay.ColorPalette.parse("0=#00000000=#00000080=1")}),U.isVisible=!0};this.getTooltip=function(t,e,i,a,r){if(void 0!==T){var n=this;if(this.isVisible&&!this.IsErrorVisible){var o={x:t,y:e};if(void 0===m||void 0===I||void 0===D){var s=H(T);Y=InteractiveDataDisplay.AdaptiveFormatter(s.min,s.max);var l=$("<div></div>");$("<div></div>").addClass("idd-tooltip-name").text(this.name||"heatmap").appendTo(l);var d=this.getValue(o.x,o.y,T,B);if(null==d)return;var c=this.getTitle("values");return $("<div>"+c+": "+Y.toString(d)+"</div>").appendTo(l),l}s=H(D);O=InteractiveDataDisplay.AdaptiveFormatter(s.min,s.max),s=H(I),W=InteractiveDataDisplay.AdaptiveFormatter(s.min,s.max),s=H(m),X=InteractiveDataDisplay.AdaptiveFormatter(s.min,s.max);l=$("<div></div>");$("<div></div>").addClass("idd-tooltip-name").text(this.name||"heatmap").appendTo(l);var h=this.getValue(o.x,o.y,I),g=this.getValue(o.x,o.y,m),p=this.getValue(o.x,o.y,D);if(null!=h&&null!=g&&null!=p){c=this.getTitle("values");var f=$("<div></div>").addClass("idd-tooltip-compositevalue");f.append($("<div>median: "+O.toString(p)+"</div>")),f.append($("<div>lower 68%: "+W.toString(h)+"</div>")),f.append($("<div>upper 68%: "+X.toString(g)+"</div>"));var u=$("<div></div>");u.append($("<div>"+c+":</div>")).append(f),u.appendTo(l);var v=$("<div></div>").css("display","inline-block").appendTo(l),y=$("<div></div>").addClass("checkButton").appendTo(v);return L&&(r?L!=z?(L={min:h,max:g},$(".checkButton").removeClass("checkButton-checked"),y.addClass("checkButton-checked"),this.fireAppearanceChanged("interval")):$(".checkButton").removeClass("checkButton-checked"):($(".checkButton").removeClass("checkButton-checked"),y.addClass("checkButton-checked")),_()),y.click(function(){y.hasClass("checkButton-checked")?(y.removeClass("checkButton-checked"),z?(L=z,_()):(L=void 0,U.isVisible=!1)):($(".checkButton").removeClass("checkButton-checked"),y.addClass("checkButton-checked"),L={min:h,max:g},_()),n.fireAppearanceChanged("interval")}),$($("<span style='margin-left:3px;'>highlight similar</span>")).appendTo(v),l}}}},Object.defineProperty(this,"palette",{get:function(){return V},set:function(t){if(t!=V){if(!t)throw"Heatmap palette is undefined";V&&t.isNormalized&&!V.isNormalized&&T&&K(),v(t),Q=void 0,this.fireAppearanceChanged("palette"),this.requestNextFrame()}},configurable:!1}),Object.defineProperty(this,"opacity",{get:function(){return R},set:function(t){if(!t)throw"Heatmap opacity is undefined";t!=R&&(y(t),this.fireAppearanceChanged("opacity"),this.requestNextFrame())},configurable:!1}),Object.defineProperty(this,"mode",{get:function(){return B},configurable:!1}),this.getLegend=function(){function a(){r.text(i.name)}var t=$("<canvas></canvas>"),e=$("<div></div>"),i=this,r=$("<span></span>");a();var n,o,s,l,d,c=0;o=$("<div class='idd-legend-item-palette'></div>").appendTo(e);function h(){l=i.getTitle("values"),0==c?(o.empty(),d=$("<div class='idd-legend-item-property'></div>").text(l).appendTo(o),s=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px;'></div>").appendTo(o),n=new InteractiveDataDisplay.ColorPaletteViewer(s,V,{logAxis:k}),c=2):d.text(l),V&&V.isNormalized&&(n.dataRange={min:S,max:P})}var g;h();function p(){null==L&&g?g.empty():L&&(f=InteractiveDataDisplay.AdaptiveFormatter(L.min,L.max),g?g.text("highlighted interval: "+f.toString(L.min)+", "+f.toString(L.max)):g=$("<div style='font-size:14px;'>highlighted interval: "+f.toString(L.min)+", "+f.toString(L.max)+"</div>").appendTo(e))}p(),this.host.bind("appearanceChanged",function(t,e){e&&"name"!=e||a(),e&&"interval"!=e||p(),e&&"values"!=e&&"colorPalette"!=e||(c=0,h()),e&&"palette"!=e||(n.palette=V);var i=n.dataRange;V&&V.isNormalized&&(null==i||i.min!=S||i.max!=P)&&(n.dataRange={min:S,max:P})});return{name:r,legend:{thumbnail:t,content:e},onLegendRemove:function(){i.host.unbind("appearanceChanged")}}},this.buildSvgLegend=function(t,e){t.height=30,e.add(e.rect(t.width,t.height).fill("white").opacity(.5));var i=window.getComputedStyle(t.legendDiv.children[0].children[1],null),a=parseFloat(i.getPropertyValue("font-size")),r=i.getPropertyValue("font-family"),n=i?i.getPropertyValue("font-weight"):void 0;e.add(e.text(this.name).font({family:r,size:a,weight:n}).translate(40,0));var o=t.legendDiv.children[1];a=(i=o&&t.legendDiv.children[1].children[0]&&t.legendDiv.children[1].children[0].children[0]?window.getComputedStyle(t.legendDiv.children[1].children[0].children[0],null):void 0)?parseFloat(i.getPropertyValue("font-size")):void 0,r=i?i.getPropertyValue("font-family"):void 0,n=i?i.getPropertyValue("font-weight"):void 0;var s=e.group(),l=this.getTitle("values");s.text(l).font({family:r,size:a,weight:n}),s.translate(5,30);var d=e.group(),c=t.width,h=20;if(InteractiveDataDisplay.SvgColorPaletteViewer(d,V,t.legendDiv.children[1].children[0].children[1],{width:c,height:h}),d.translate(5,50),t.height+=50+h,L){a=(i=o&&t.legendDiv.children[1].children[1]&&t.legendDiv.children[1].children[1]?window.getComputedStyle(t.legendDiv.children[1].children[1],null):void 0)?parseFloat(i.getPropertyValue("font-size")):void 0,r=i?i.getPropertyValue("font-family"):void 0,n=i?i.getPropertyValue("font-weight"):void 0;var g=e.group(),p=$(t.legendDiv.children[1].children[1]).text();g.add(g.text(p).font({family:r,size:a,weight:n}));c=t.width,h=25;g.translate(5,100),t.height+=50+h}e.front()},e&&void 0!==e.values&&this.draw(e)}else{var l=t[0].parentElement;if(l){var d=!1;for(o=0;o<l.childNodes.length;o++)if($(l.childNodes[o]).hasClass("nowebworkers")){d=!0;break}t[0].removeAttribute("data-idd-plot"),t[0].innerText="",d?t[0].innerText="":(t[0].innerText=" Heatmap cannot be rendered: browser does not support web workers.",t.addClass("nowebworkers"))}}}},InteractiveDataDisplay.Heatmap.prototype=new InteractiveDataDisplay.CanvasPlot,InteractiveDataDisplay.register("heatmap",function(t,e){return new InteractiveDataDisplay.Heatmap(t,e)}),InteractiveDataDisplay.NavigationPanel=function(a,t,e){if(t.attr("tabindex","0"),t.addClass("idd-navigation-container"),a.legend){var i=$("<div></div>").appendTo(t);a.legend.isVisible?i.addClass("idd-onscreennavigation-showlegend"):i.addClass("idd-onscreennavigation-hidelegend"),i.click(function(){a.legend.isVisible?(a.legend.isVisible=!1,i.removeClass("idd-onscreennavigation-showlegend").addClass("idd-onscreennavigation-hidelegend")):(a.legend.isVisible=!0,i.removeClass("idd-onscreennavigation-hidelegend").addClass("idd-onscreennavigation-showlegend"))})}e?$('<a style="display:block" target="_blank"></div>').addClass("idd-onscreennavigation-help").appendTo(t).attr("href",e):$('<a href="https://github.com/predictionmachines/InteractiveDataDisplay/wiki/UI-Guidelines" style="display:block" target="_blank"></div>').addClass("idd-onscreennavigation-help").appendTo(t);var r=$("<div></div>").addClass("idd-onscreennavigation-exportsvg").appendTo(t),n=$("<div></div>").addClass("idd-onscreennavigation-navigationlockpressed").appendTo(t),o=$("<div style='overflow: hidden; height: 0px'></div>").appendTo(t),s=$("<div></div>").addClass("idd-onscreennavigation-panner").appendTo(o),l=$("<div></div>").addClass("idd-onscreennavigation-zoomin").appendTo(o),d=$("<div></div>").addClass("idd-onscreennavigation-zoomout").appendTo(o),c=$("<div></div>").addClass("idd-onscreennavigation-fit").appendTo(o),h=$("<div></div>").addClass("idd-onscreennavigation-logscale").appendTo(o),g=void 0,p=Rx.Observable.create(function(t){return g=t,function(){g=void 0}});r.click(function(){try{new Blob;var t=a.exportToSvg(),e=new Blob([t.svg()]);saveAs(e,"chart.svg")}catch(t){throw t.message}});var f=new function(e){var i=void 0;this.switch=function(){if(!e.mapControl){var t=(1+((e.xDataTransform?1:0)|(e.yDataTransform?2:0)))%4;return function(t){if(t!==i){switch(t){case 0:e.xDataTransform=void 0,e.yDataTransform=void 0;break;case 1:e.xDataTransform=InteractiveDataDisplay.logTransform,e.yDataTransform=void 0;break;case 2:e.xDataTransform=void 0,e.yDataTransform=InteractiveDataDisplay.logTransform;break;case 3:e.xDataTransform=InteractiveDataDisplay.logTransform,e.yDataTransform=InteractiveDataDisplay.logTransform}i=t}}(t),e.isAutoFitEnabled=!0,t}}}(a);h.click(function(t){var e=f.switch(),i=a.navigation.gestureSource;a.navigation.gestureSource=i?p.merge(i):p,$(this).trigger("axisChanged",[e])});var u=void 0;u=void 0!==a.navigation.gestureSource?p.merge(a.navigation.gestureSource):p,a.navigation.gestureSource=u;function v(){return void 0===a.mapControl?InteractiveDataDisplay.Gestures.zoomLevelFactor:3}function y(){g&&g.onNext(new InteractiveDataDisplay.Gestures.ZoomGesture(a.centralPart.width()/2,a.centralPart.height()/2,1/v(),"Mouse"))}function m(){g&&g.onNext(new InteractiveDataDisplay.Gestures.ZoomGesture(a.centralPart.width()/2,a.centralPart.height()/2,v(),"Mouse"))}var I,D=a.navigation.gestureSource;a.navigation.gestureSource=void 0,n.click(function(){void 0!==a.navigation.gestureSource?(a.navigation.gestureSource=void 0,n.removeClass("idd-onscreennavigation-navigationlock").addClass("idd-onscreennavigation-navigationlockpressed"),o.animate({height:0},200)):(a.navigation.gestureSource=D,n.removeClass("idd-onscreennavigation-navigationlockpressed").addClass("idd-onscreennavigation-navigationlock"),o.animate({height:225},200)),$(this).trigger("classChanged")}),d.dblclick(function(t){t.stopPropagation()}),d.click(function(t){t.stopPropagation(),m()}),l.dblclick(function(t){t.stopPropagation()}),l.click(function(t){t.stopPropagation(),y()}),a.isAutoFitEnabled&&c.attr("class","idd-onscreennavigation-fit-pressed"),c.click(function(){a.isAutoFitEnabled=!a.isAutoFitEnabled}),a.host.on("isAutoFitEnabledChanged",function(){a.isAutoFitEnabled?c.attr("class","idd-onscreennavigation-fit-pressed"):c.attr("class","idd-onscreennavigation-fit")}),t.keydown(function(t){var e=t.which;37==e?(g&&g.onNext(new InteractiveDataDisplay.Gestures.PanGesture(10,0,"Mouse")),t.preventDefault()):38==e?(g&&g.onNext(new InteractiveDataDisplay.Gestures.PanGesture(0,10,"Mouse")),t.preventDefault()):39==e?(g&&g.onNext(new InteractiveDataDisplay.Gestures.PanGesture(-10,0,"Mouse")),t.preventDefault()):40==e?(g&&g.onNext(new InteractiveDataDisplay.Gestures.PanGesture(0,-10,"Mouse")),t.preventDefault()):107==e||187==e?(y(),t.preventDefault()):109!=e&&189!=e||(m(),t.preventDefault())});var C={x:0,y:0};s.mousedown(function(t){var e=s.offset(),i=s.outerWidth()/2;C.x=(t.pageX-e.left-i)/i,C.y=(t.pageY-e.top-i)/i,1<C.x*C.x+C.y*C.y||($(document).on("mousemove",b),s.removeClass("idd-onscreennavigation-panner").addClass("idd-onscreennavigation-panner-moved"),I=setInterval(function(){g.onNext(new InteractiveDataDisplay.Gestures.PanGesture(-10*C.x,-10*C.y,"Mouse"))},25))}),$(document).mouseup(function(){$(document).off("mousemove",b),I&&clearInterval(I),s.removeClass("idd-onscreennavigation-panner-moved").addClass("idd-onscreennavigation-panner")});var b=function(t){var e=s.offset(),i=s.outerWidth()/2;C.x=(t.pageX-e.left-i)/i,C.y=(t.pageY-e.top-i)/i};this.remove=function(){a.navigation.gestureSource=D,t.removeClass("idd-navigation-container"),t[0].innerHTML=""}},InteractiveDataDisplay.BingMaps=InteractiveDataDisplay.BingMaps||{},InteractiveDataDisplay.BingMaps.ESRI=InteractiveDataDisplay.BingMaps.ESRI||{},InteractiveDataDisplay.BingMaps.ESRI.GetWorldTopo=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(t){return"http://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/"+t.levelOfDetail+"/"+t.y+"/"+t.x}})},InteractiveDataDisplay.BingMaps.ESRI.GetDeLorme=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(t){return"http://server.arcgisonline.com/ArcGIS/rest/services/Specialty/DeLorme_World_Base_Map/MapServer/tile/"+t.levelOfDetail+"/"+t.y+"/"+t.x}})},InteractiveDataDisplay.BingMaps.ESRI.GetWorldImagery=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(t){return"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/"+t.levelOfDetail+"/"+t.y+"/"+t.x}})},InteractiveDataDisplay.BingMaps.ESRI.GetOceanBasemap=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(t){return"http://services.arcgisonline.com/ArcGIS/rest/services/Ocean_Basemap/MapServer/tile/"+t.levelOfDetail+"/"+t.y+"/"+t.x}})},InteractiveDataDisplay.BingMaps.ESRI.GetNationalGeographicMap=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(t){return"http://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/"+t.levelOfDetail+"/"+t.y+"/"+t.x}})},InteractiveDataDisplay.BingMaps.ESRI.GetWorldShadedRelief=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(t){return"http://services.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/"+t.levelOfDetail+"/"+t.y+"/"+t.x}})},InteractiveDataDisplay.BingMaps.ESRI.GetWorldTerrainBase=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(t){return"http://services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/"+t.levelOfDetail+"/"+t.y+"/"+t.x}})},InteractiveDataDisplay.BingMaps.OpenStreetMap=InteractiveDataDisplay.BingMaps.OpenStreet||{},InteractiveDataDisplay.BingMaps.OpenStreetMap.GetTileSource=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(t){return"http://tile.openstreetmap.org/"+t.levelOfDetail+"/"+t.x+"/"+t.y+".png"}})},InteractiveDataDisplay.BingMapsPlot=function(t,e){if(t){var i=$('<div style="position: absolute"></div>').prependTo(t);this.base=InteractiveDataDisplay.Plot,this.base(t,e);if("undefined"==typeof Microsoft)$("<p></p>").css("margin",15).css("word-wrap","break-word").text("BingMaps script is unavailable. Check your internet connection.").appendTo(t);else{var a=void 0,r=void 0;0===this.children.length&&((a=$('<div style="position: absolute;"></div>').appendTo(t)).css("z-index",InteractiveDataDisplay.ZIndexNavigationLayer),r=$("<canvas></canvas>").appendTo(a));this.mapKey=t.attr("data-idd-mapKey");var n=new Microsoft.Maps.Map(i[0],{credentials:this.mapKey,mapTypeId:Microsoft.Maps.MapTypeId.aerial,enableClickableLogo:!1,enableSearchLogo:!1,showCopyright:!1,showDashboard:!1,showLogo:!1,disablePanning:!0,disableZooming:!0,width:t.width(),height:t.height()});Object.defineProperty(this,"map",{get:function(){return n},configurable:!1});var o=new InteractiveDataDisplay.BingMapsAnimation(n);this.arrange=function(t){InteractiveDataDisplay.BingMapsPlot.prototype.arrange.call(this,t),n.width=t.width,n.height=t.height},this.setMap=function(t){if(n.setMapType(Microsoft.Maps.MapTypeId.mercator),n.entities.clear(),t)if(t instanceof Microsoft.Maps.TileSource){var e=new Microsoft.Maps.TileLayer({mercator:t,opacity:1});n.entities.push(e)}else n.setMapType(t)},this.constraint=function(t,e,i){if(!0!==i)return t;var a=n.getWidth(),r=n.getHeight();return a<=1||r<=1?t:(o.setMapView(t,e),mapRect=InteractiveDataDisplay.Utils.getPlotRectForMap(n),mapRect)},this.arrange=function(t){InteractiveDataDisplay.CanvasPlot.prototype.arrange.call(this,t),void 0!==a&&(a.width(t.width),a.height(t.height),r[0].width=t.width,r[0].height=t.height)},o.constraint=this.constraint,this.navigation.animation=o,this.selfMapRefresh()}}},InteractiveDataDisplay.BingMapsPlot.prototype=new InteractiveDataDisplay.Plot,function(x){x.PersistentViewState=function(){var a=this,r=[];function e(t,e){for(var i=0;i<r.length;++i)r[i](a,t,e)}function t(t){return null!=t&&null!=t&&"undefined"!=t}this.subscribe=function(e){return r.push(e),function(){var t=r.indexOf(e);0<=t&&r.splice(t,1)}};var i=sessionStorage.getItem("plotRect"),n=t(i)?JSON.parse(i):void 0;Object.defineProperty(this,"plotRect",{get:function(){return n},set:function(t){t!=n&&(n=t,sessionStorage.setItem("plotRect",JSON.stringify(n)),e("plotRect"))},configurable:!1,enumerable:!0});var o=sessionStorage.getItem("isAutoFit"),s=!t(o)||JSON.parse(o);Object.defineProperty(this,"isAutoFit",{get:function(){return s},set:function(t){t!=s&&(s=t,sessionStorage.setItem("isAutoFit",JSON.stringify(s)),e("isAutoFit"))},configurable:!1,enumerable:!0});var l=sessionStorage.getItem("selectedPlots"),d=t(l)?JSON.parse(l):[];Object.defineProperty(this,"selectedPlots",{get:function(){return d},set:function(t){t!=d&&(d=t,sessionStorage.setItem("selectedPlots",JSON.stringify(d)),e("selectedPlots"))},configurable:!1,enumerable:!0});var c=sessionStorage.getItem("probes"),h=t(c)?new x.ProbesVM(JSON.parse(c)):new x.ProbesVM(void 0);h.subscribe(function(t){sessionStorage.setItem("probes",JSON.stringify(h.getProbes())),e("probes")}),Object.defineProperty(this,"probesViewModel",{get:function(){return h},configurable:!1,enumerable:!0});var g=sessionStorage.getItem("isLegendShown"),p=!!t(g)&&JSON.parse(g);Object.defineProperty(this,"isLegendShown",{get:function(){return p},set:function(t){t!=p&&(p=t,sessionStorage.setItem("isLegendShown",JSON.stringify(p)),e("isLegendShown"))},configurable:!1,enumerable:!0});var f=sessionStorage.getItem("isNavigationPanelOpen"),u=!!t(f)&&JSON.parse(f);Object.defineProperty(this,"isNavigationPanelOpen",{get:function(){return u},set:function(t){t!=u&&(u=t,sessionStorage.setItem("isNavigationPanelOpen",JSON.stringify(u)),e("isNavigationPanelOpen"))},configurable:!1,enumerable:!0});var v=sessionStorage.getItem("isLogAxis"),y=t(v)?JSON.parse(v):0;Object.defineProperty(this,"isLogAxis",{get:function(){return y},set:function(t){t!=y&&(y=t,sessionStorage.setItem("isLogAxis",JSON.stringify(y)),e("isLogAxis"))},configurable:!1,enumerable:!0});var m=sessionStorage.getItem("mapType"),I=t(m)?JSON.parse(m):void 0;Object.defineProperty(this,"mapType",{get:function(){return I},set:function(t){t!=I&&(I=t,sessionStorage.setItem("mapType",JSON.stringify(I)),e("mapType"))},configurable:!1,enumerable:!0});var D=sessionStorage.getItem("xDataTransform"),C=t(D)?JSON.parse(D):void 0;Object.defineProperty(this,"xDataTransform",{get:function(){return C},set:function(t){t!=C&&(C=t,sessionStorage.setItem("xDataTransform",JSON.stringify(C)),e("xDataTransform"))},configurable:!1,enumerable:!0});var b=sessionStorage.getItem("yDataTransform"),w=t(b)?JSON.parse(b):void 0;Object.defineProperty(this,"yDataTransform",{get:function(){return w},set:function(t){t!=w&&(w=t,sessionStorage.setItem("yDataTransform",JSON.stringify(w)),e("yDataTransform"))},configurable:!1,enumerable:!0});var A={};Object.defineProperty(this,"uncertaintyRange",{get:function(){return A},set:function(t){t!=A&&(A=t,e("uncertaintyRange"))},configurable:!1,enumerable:!0})},x.TransientViewState=function(){var a=this,r=[];function i(t,e){for(var i=0;i<r.length;++i)r[i](a,t,e)}this.subscribe=function(t){r.push(t)},this.unsubscribe=function(e){r=r.filter(function(t){return t!==e})};var n={};Object.defineProperty(this,"ranges",{get:function(){return n},configurable:!1,enumerable:!0});var e=new x.AdaptiveFormatter(0,1);Object.defineProperty(this,"plotXFormatter",{get:function(){return e},set:function(t){t!=e&&(e=t,i("plotXFormatter"))},configurable:!1,enumerable:!0});var o=new x.AdaptiveFormatter(0,1);Object.defineProperty(this,"plotYFormatter",{get:function(){return o},set:function(t){t!=o&&(o=t,i("plotYFormatter"))},configurable:!1,enumerable:!0}),this.setRangesForPlot=function(t,e){n[t]=e,i("ranges",{id:t})}}}(InteractiveDataDisplay=InteractiveDataDisplay||{}),(InteractiveDataDisplay||(InteractiveDataDisplay={})).PlotRegistry={},function(s){function r(t,i,e,a){t.empty();var r=void 0!==a?a:1,n=$("<canvas width='"+40*r+"' height='"+40*r+"'></canvas>").appendTo(t).get(0).getContext("2d");n.globalAlpha=.9;var o=new Image;o.onload=function(){if(n.drawImage(o,0,0,40*r,40*r),void 0!==i){n.fillStyle="white";var t=(i<10?14:11)*r;n.font=t+"px Arial";var e=(i<10?16:13)*r;n.fillText(i,e,20*r)}},o.src=e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC45bDN+TgAAApdJREFUaEPtWc1KW0EUDrjL+9RVN2ZVNC1SaBdREewmYkW00NI+QVEkxJ+2/iBq1KX2CVrJM3Tj1ifIG9yebzhnvFxO4iR3Zm4C94Nvk8yc7zs/czOXVEower3eFLHqyCneVjxghk11iYkjsbbYRCDOJqzxfw+Pyf5NdyCxRtbz3viJQJDFrfG9624yv36STC8eDiTWYK2SSJwkIMSCxkSrc5/MrOyrZgextnKQtK/u04mETwICLGSEl75equaG4fK3TpwkEJgFjGB97ZdqaBS++XgcNgkE5MDezQuDJkHB8KQwAj7Gph8z41Rl+XxAJYim+jiwmrBP4mBzAn66QEFs9Ud52gzL2ocDf11ABYim+nh2a4IhCC1OIF8XaLOtvsuPlOXCnttnffh249RPFyQBXAE0oZCEZvwEHKr8wrETxSTgkWUCQJlADhaTQHmIn+g1Afyo4LaoCWnUquxaeTBzM82VgL1K7F78UcVCsHX5V8znv9BRgOhj5GV8BJIAWvpu60wV9EloeBkfAQWxYxSjC6nq5x8fAQWyXXjV/KEK+yBie62+AJUgmi6EfC/w9h6ggQLaLsyu+n+pR8wg1RegIsRgZyHI7GdBgW0XGp/PVSOjsPHlImz1BagM0XsXolRfQAK2C5vbd6qhYYgYUaovQIWIpgsQrq8dqcZciL0p8+GrL4AQC+YapaijkwUJ2lHa2vmtGhxE7Ik6OlmgYkQ7Su8/ud+TsLaQ0ckCwmzAGHq5/PydH2vGwrwABtiI0zWj0LnvBzJiz8PG91vVOIjvUtWPP/f9gEoS7Shp/yHgs7EanSxgiI0Zo3OrP615/KMz1uYFMMYGjeHXzbbhRJgXwCAbFdOTY14Ao0Qc7DQnw3yJoVCp/AcXkU+yAO498gAAAABJRU5ErkJggg==":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC45bDN+TgAAAylJREFUaEPVmdtOMjEUhX0Wn9CHwkPQeIxwwQ0SD1eaqIkHghEidxD1Dfrvb0KT+ScLpu0UEy6+xL1ou9fedGbKuNVqtTYaKW4SUkzl9/d329ipYVvNTUWKsWBqYW5guBoYk60QKYaCiYWZwc/PjxuNRu729tZdXl66drvtdnd3C/gbjc8+Pj4cY5mzmNuoECmGQGJv/PHx0R0fHzvTg2Ds09NTuZDkIqRYhzf/9fXlzs/PpckQLi4u3HQ6bVSEFFfhzb+/v7v9/X1pLAbWGA6HyUVIcRll8+xt07LAWqlFSFHhzbNtcnS+CmumbCcpKmzRHS66Jnu+Dq6JxYW9Y7H0UUWKVegIneFuY/FaeX5+jvoWpFiFjtCZmFtlKicnJ1HfghTL0Ak6wkPK4iAODg6CtGXwsCMnuS2WvjxSLEMnjOIpavGfcHd3RwFB34IUy/gCOApYvJKQLoeM6XQ6+QvgPGPxn3B4eJi/gJwPrjrIlb2Avb09mWwdkCt7AUdHRzLZOiBX9gK63a5MVibXRUyu7AVwa7P4T8h9Gy0eZJwWLQ5CdTmk856Yk6kUq9CJ7+/vKBOpkINc5LRY+ikjxSosZrh+vy+T5oQc5MpdQLGNPj8/ZdKckINc5LRY+ikjRQUdMYozu8VrgbXJQS6LpY8qUlTQEWPw8vIik+fg9fU1qvsgxWXQGc7qp6en0kATzs7Oon+NgRSXQWfo0NvbmzTRBF4UsDY5LJb5FVJcBR0yiiOvxVmIOT5XkeIq6JAxmEwm0kwKrMWarG2xzLsMKdZBpwx3fX0tDcVwc3OT3H2QYh10yhjM5/NGp1TmsgZrsaZpMt8qpBiCLyLmjFSlyStFjxRDscTFVrq6upIGV8Ec5rKGxXL9EKQYCp0ziq0U+3q96dbxSDEGXwRnmJDfzYwZj8dZzIMUY/FF3N/fS9NlGJPLPEgxBTNUHDN6vZ40Dnxm4xrv+zJSTIGOGoPZbFa83zTtP9D4jDGMZU4OpJiKL6L6PwT+RsttHqTYBF8EhzOLC1IPaiFIsSm+iIeHBwfrMg9SzMGiCB50sBbzIMVNQoqbhBQ3h9bWP/HfsYvIwP9AAAAAAElFTkSuQmCC"}s.createSmallProbe=r,s.ProbePull=function(t,e){var i=t,a=$("<div></div>").addClass("dragPoint").addClass("probe").appendTo(i);a.draggable({containment:"document",scroll:!1,zIndex:2500,helper:function(){var t=$("<div></div>").addClass("dragPoint");return r(t),t},appendTo:e}),a.mousedown(function(t){t.stopPropagation()})},s.OnScreenNavigation=function(t,e,i){s.NavigationPanel(e,t,"https://github.com/predictionmachines/InteractiveDataDisplay/wiki/UI-Guidelines#chartviewer");var a=t.find(".idd-onscreennavigation-showlegend");a.remove(),(a=t.find(".idd-onscreennavigation-hidelegend")).remove(),$("<div></div>").addClass("idd-onscreennavigation-hidelegend").prependTo(t);var r=t.find(".idd-onscreennavigation-navigationlockpressed");i.isNavigationPanelOpen&&$(r).click(),$(r).bind("classChanged",function(){i.isNavigationPanelOpen=$(this).hasClass("idd-onscreennavigation-navigationlock")});for(var n=t.find(".idd-onscreennavigation-logscale"),o=0;o<i.isLogAxis;o++)$(n).click();$(n).on("axisChanged",function(t,e){i.isLogAxis=e})}}(InteractiveDataDisplay=InteractiveDataDisplay||{}),function(f){var t=(e.prototype.setupPlotsVisibility=function(){for(var t in this.currentPlots){var e=this.currentPlots[t],i=e.Plots;if(i)for(var a=-1==this.initiallySelectedPlots.indexOf(e.Id),r=0;r<i.length;++r)i[r].isVisible=a}},e.prototype.checkLatLon=function(t){var e,i,a,r;return void 0!==t.x&&(a=f.getTitle(t,"x"),"lon"===(r=a.toLowerCase())||"longitude"===r)&&void 0!==t.y&&(e=f.getTitle(t,"y"),"lat"===(i=e.toLowerCase())||"latitude"===i)},e.prototype.addPlot=function(e){var i=f.PlotRegistry[e.Definition.kind]?f.PlotRegistry[e.Definition.kind]:f.PlotRegistry.fallback;e.Plots=i.initialize(e.Definition,this.persistentViewState,this.iddChart);try{i.draw(e.Plots,e.Definition)}catch(t){void 0!==e.Plots&&e.Plots.forEach(function(t){t.remove()}),i=f.PlotRegistry.fallback,e.Definition.error=t.message,e.Plots=i.initialize(e.Definition,this.persistentViewState,this.iddChart),i.draw(e.Plots,e.Definition)}},e.prototype.updateAxes=function(){var t="",e="",i=[],a=[];for(var r in this.currentPlots){var n=this.currentPlots[r].Definition;if(n.x){for(var o=f.getTitle(n,"x"),s=!1,l=0;l<i.length;l++)if(i[l]===o){s=!0;break}s||(i.push(o),""!==t&&(t+=", "),t+=o)}if(n.y){var d=f.getTitle(n,"y");for(s=!1,l=0;l<a.length;l++)if(a[l]===d){s=!0;break}s||(a.push(d),""!==e&&(e+=", "),e+=d)}}""!==t?(void 0===this.xAxisTitle&&(this.xAxisTitle=$(this.iddChart.addDiv('<div style="font-size: larger; text-align: center"></div>',"bottom"))),this.xAxisTitle.text(t)):void 0!==this.xAxisTitle&&(this.iddChart.removeDiv(this.xAxisTitle[0]),this.xAxisTitle.remove(),this.xAxisTitle=void 0),""!==e?(void 0===this.yAxisTitle&&(this.yAxisTitle=$(this.iddChart.addDiv('<div class="idd-verticalTitle" style="font-size: larger;"></div>',"left"))),this.yAxisTitle.text(e)):void 0!==this.yAxisTitle&&(this.iddChart.removeDiv(this.yAxisTitle[0]),this.yAxisTitle.remove(),this.yAxisTitle=void 0)},e.prototype.createMap=function(){var t=$("<div></div>").attr("data-idd-name","bingMaps").css("z-index",0).prependTo(this.iddChart.host),e=new f.BingMapsPlot(t,this.iddChart);return e.order=9007199254740991,this.iddChart.addChild(e),e},e.prototype.updateMap=function(){var t=!1,e=!0;for(var i in this.currentPlots){var a=this.currentPlots[i];t=(e||t)&&this.checkLatLon(a.Definition),e=!1}t&&"undefined"!=typeof Microsoft?(void 0===this.bingMapsPlot?(this.bingMapsPlot=this.createMap(),this.persistentViewState.mapType?this.bingMapsPlot.setMap(this.persistentViewState.mapType):this.bingMapsPlot.setMap(Microsoft.Maps.MapTypeId.road)):this.persistentViewState.mapType&&this.bingMapsPlot.setMap(this.persistentViewState.mapType),this.iddChart.yDataTransform=f.mercatorTransform,this.iddChart.xDataTransform=void 0,this.bingMapsPlot.navigation.animation.setMapView(this.persistentViewState.plotRect,this.iddChart.screenSize)):void 0!==this.bingMapsPlot&&(this.bingMapsPlot.remove(),this.bingMapsPlot=void 0,this.iddChart.yDataTransform=void 0)},e.prototype.draw=function(t){var a=this;this.currentPlots=f.updateBag(this.currentPlots,t,function(t,e,i){return e.Definition.kind==i.Definition.kind?(f.syncProps(e.Definition,i.Definition)&&f.PlotRegistry[e.Definition.kind].draw(e.Plots,e.Definition),e):(void 0!==e.Plots&&e.Plots.forEach(function(t){t.remove()}),a.addPlot(i),i)},function(t,e){return a.addPlot(e),e},function(t,e){void 0!==e.Plots&&e.Plots.forEach(function(t){t.remove()})}),this.updateAxes(),this.updateMap(),this.persistentViewState.probesViewModel.refresh();var e=0;for(var i in this.currentPlots)(r=this.currentPlots[i]).ZIndex&&(e=Math.max(r.ZIndex,e));for(var i in this.currentPlots){var r;if((r=this.currentPlots[i]).ZIndex||(r.ZIndex=++e),r.Plots)for(var n=0;n<r.Plots.length;++n){var o=r.Plots[n];o.host.css("z-index",r.ZIndex),o.requestNextFrameOrUpdate()}}return this.persistentViewState.selectedPlots&&(this.initiallySelectedPlots=this.persistentViewState.selectedPlots,this.setupPlotsVisibility()),this.currentPlots},e.prototype.updateLayout=function(){this.iddDiv.width(this.div.width()),this.iddDiv.height(this.div.height()),this.iddChart.updateLayout(),void 0!==this.bingMapsPlot&&this.iddChart.navigation.setVisibleRect(this.iddChart.visibleRect,!1)},e);function e(t,e,s,i){this.currentPlots={},this.div=t;var r=this,a=this.iddDiv=$("<div data-idd-plot='chart'></div>").appendTo(t);a.width(t.width()),a.height(t.height());var d=this.iddChart=f.asPlot(a);d.legend.isVisible=!1,d.isToolTipEnabled=!0,d.doFitOnDataTransformChanged=!1;var n=$("<div></div>").addClass("dsv-onscreennavigationcontainer").attr("data-idd-placement","center").appendTo(e),o=$("<div></div>").addClass("dsv-onscreennavigation").appendTo(n),l=(new f.OnScreenNavigation(o,d,s),$("<div></div>").attr("data-idd-name","draggableMarkers").appendTo(d.host)),c=new f.DOMPlot(l,d);c.order=9007199254740991,d.addChild(c),this.persistentViewState=s,d.navigation.setVisibleRect(this.persistentViewState.plotRect,!1,{suppressNotifyBoundPlots:!0}),d.isAutoFitEnabled=this.persistentViewState.isAutoFit,s.probesViewModel.getProbeContent=function(t){for(var e=d.children,i=[],a=0;a<e.length;a++)if(e[a].isVisible){var r=e[a].xDataTransform&&e[a].xDataTransform.domain&&e[a].xDataTransform.domain.isInDomain&&e[a].xDataTransform.domain.isInDomain(t.location.x)?e[a].xDataTransform.dataToPlot(t.location.x):t.location.x,n=e[a].yDataTransform&&e[a].yDataTransform.domain&&e[a].yDataTransform.domain.isInDomain&&e[a].yDataTransform.domain.isInDomain(t.location.y)?e[a].yDataTransform.dataToPlot(t.location.y):t.location.y,o=e[a].getTooltip(t.location.x,t.location.y,r,n,!0);void 0!==o&&i.push(o)}return 0<i.length?i:void 0};function h(t){var a=t.id,e=t.location.x,i=t.location.y,r=$("<div></div>");r.addClass("dragPoint"),c.add(r[0],"none",e,i,void 0,void 0,.5,.92);var n=c.domElements,o=n[n.length-1];o.id=a,r.draggable({containment:c.master.centralPart[0],scroll:!1,opacity:.9,stop:function(t,e){var i={x:o._x,y:o._y};s.probesViewModel.updateProbe(a,i)}}),t.selected?f.createSmallProbe(r,a,"#365C95"):f.createSmallProbe(r,a)}c.host.droppable({accept:".probe",tolerance:"fit",drop:function(t,e){$(this).offset();var i={x:e.position.left+e.draggable.width()/2,y:e.position.top+e.draggable.height()},a=c.coordinateTransform,r=d.xDataTransform?d.xDataTransform.plotToData(a.screenToPlotX(i.x)):a.screenToPlotX(i.x),n=d.yDataTransform?d.yDataTransform.plotToData(a.screenToPlotY(i.y)):a.screenToPlotY(i.y),o=s.probesViewModel.addProbe({x:r,y:n});h({id:o,location:{x:r,y:n}})}}),s.probesViewModel.subscribe(function(t){var e=t.probe;switch(t.status){case"fit":for(var i=c.domElements,a=0;a<i.length;a++){if((s=i[a]).id===e.id){var r=d.visibleRect,n=d.xDataTransform?d.xDataTransform.dataToPlot(s._x):s._x,o=d.yDataTransform?d.yDataTransform.dataToPlot(s._y):s._y;(1e-7<Math.abs(n-r.x-r.width/2)||1e-7<Math.abs(o-r.y-r.height/2))&&d.navigation.setVisibleRect({x:n-r.width/2,y:o-r.height/2,width:r.width,height:r.height},!0);break}}break;case"remove":for(i=c.domElements,a=0;a<i.length;a++){var s;if((s=i[a]).id===e.id){c.remove(s);break}}break;case"unselected":for(i=c.domElements,a=0;a<i.length;a++){var l=i[a];f.createSmallProbe(l,l.id)}break;case"selected":for(i=c.domElements,a=0;a<i.length;a++){(l=i[a]).id===e.id?f.createSmallProbe(l,l.id,"#365C95"):f.createSmallProbe(l,l.id)}}});for(var g=s.probesViewModel.getProbes(),p=0;p<g.length;p++)h(g[p]);a.on("visibleChanged",function(){var t=[];for(var e in r.currentPlots){var i=r.currentPlots[e],a=i.Plots;a&&0<a.length&&(a[0].isVisible||t.push(i.Id))}r.persistentViewState.selectedPlots=t}),a.on("isAutoFitEnabledChanged",function(){s.isAutoFit=d.isAutoFitEnabled}),a.on("visibleRectChanged",function(){var t=d.visibleRect;i.plotXFormatter=new f.AdaptiveFormatter(t.x,t.x+t.width),i.plotYFormatter=new f.AdaptiveFormatter(t.y,t.y+t.height),s.plotRect=t,void 0!==s.probesViewModel&&s.probesViewModel.refresh()})}f.PlotViewer=t}(InteractiveDataDisplay=InteractiveDataDisplay||{}),function(h){h.PlotList=function(t,e,i,a){t.addClass("dsv-plotlist");var r=$("<div></div>").appendTo(t),n=new h.Legend(e.iddChart,r,!1,!0);e.iddChart.host.bind("visibleChanged",function(){i.probesViewModel.refresh(i.probesViewModel.getProbes())}),i.probesViewModel.refresh(i.probesViewModel.getProbes());var o=$("<div></div>").addClass("probes").appendTo(t),s=$("<div style='width:240px; margin-bottom: 16px'></div>").appendTo(o),l=$("<div></div>").addClass("dsv-onscreennavigation-probepull").appendTo(s),d=(new h.ProbePull(l,e.iddChart.centralPart),$("<div style='width: 195px; display:inline-block'></div>").appendTo(s));$("<div style='width:180px; height:1px; margin-bottom:6px; float:right; margin-top: 8px; background-color:lightgrey'></div>").appendTo(d),$("<div style='float:left; margin-left:15px;font-family: Segoe UI;font-size: 12px;color:grey; margin-bottom:16px'>Probes</div>").appendTo(d);var c=$("<div></div>").addClass("probes-list").appendTo(o);c[0].style.display="none",new h.ProbesControl(o,c,i,a),this.remove=function(){e.iddChart.host.bind("visibleChanged"),n.remove()}}}(InteractiveDataDisplay=InteractiveDataDisplay||{}),function(v){var t=(e.prototype.update=function(t){var e={};for(var i in t){var a=t[i];null!=a?(e[i]={Id:i,Definition:a},null!==a.displayName&&void 0!==a.displayName||(e[(a=$.extend(!1,{},a)).displayName=i].Definition=a)):e[i]=null}e=this.plotViewer.draw(e)},e.prototype.updateLayout=function(){var t=0;this.controlDiv.width()<this.minWidthToShowLeftPanel&&void 0!==this.leftPanelContainer?this.leftPanelContainer.hide():void 0!==this.leftPanelContainer&&(this.leftPanelContainer.show(),t=this.leftPanelContainer.width()),this.rightpanel.width(this.controlDiv.width()-t-this.rightPanelExtraShift-this.navigationPanelShift),this.plotViewer.updateLayout(),this.persistentViewState.probesViewModel.refresh()},e.prototype.dispose=function(){this.plotList.remove(),this.controlDiv.children().remove()},e);function e(t){this.rightPanelExtraShift=3,this.navigationPanelShift=65,this.minWidthToShowLeftPanel=540,this.plotList=void 0,this.viewState=void 0;var e=this,i=this.controlDiv=$(t);this.persistentViewState=this.viewState=new v.PersistentViewState,this.transientViewState=new v.TransientViewState;var a=i.width(),r=i.height();0===a&&i.width(400),0===r&&i.height(400);var n=$("<div class='dsv-visualizaition-control'></div>");i.append(n);var o=$("<div class='dsv-leftpanelcontainer'></div>");n.append(o);var s=$("<div class='dsv-rightpanel'></div>");n.append(s);var l=$("<div class='dsv-leftpanel'></div>");o.append(l),l.append($("<div class='plotlist'></div>")),s.append($("<div class='dsv-visualization-preview'></div>"));var d=$("<div class='dsv-navigation-container'></div>").appendTo(n);d.addClass("no-print");var c=this.rightpanel=i.find(".dsv-rightpanel"),h=i.find(".dsv-leftpanel"),g=this.leftPanelContainer=i.find(".dsv-leftpanelcontainer"),p=this.persistentViewState.isLegendShown;this.plotViewer=new v.PlotViewer(i.find(".dsv-visualization-preview"),d,this.persistentViewState,this.transientViewState);var f=i.find(".plotlist");this.plotList=new v.PlotList(f,this.plotViewer,this.persistentViewState,this.transientViewState),this.plotList.isEditable=!1,this.plotViewer.iddChart.exportToSvg=function(t,e,i){if(!SVG.supported)throw"SVG is not supported";e=this.screenSize,t=this.coordinateTransform.getPlotRect({x:0,y:0,width:e.width,height:e.height});var a=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=(i=SVG(a).size(this.host.width(),this.host.height())).group();this.exportContentToSvg(t,e,r);var n=i.group(),o=this.host.width();return p&&(n.add(this.exportLegendToSvg(this.legend.div[0])).translate(o,30),i.size(200+o,this.host.height())),i};var u=d[0].children[0].firstChild.firstChild;$(u).click(function(){p?(p=!1,e.persistentViewState.isLegendShown=!1,h.hide(),$(u).removeClass("idd-onscreennavigation-showlegend").addClass("idd-onscreennavigation-hidelegend")):(p=!0,e.persistentViewState.isLegendShown=!0,h.show(),$(u).removeClass("idd-onscreennavigation-hidelegend").addClass("idd-onscreennavigation-showlegend")),c.width(i.width()-g.width()-e.rightPanelExtraShift-e.navigationPanelShift),e.plotViewer.updateLayout(),e.persistentViewState.probesViewModel.refresh()}),p?(h.show(),$(u).removeClass("idd-onscreennavigation-hidelegend").addClass("idd-onscreennavigation-showlegend")):h.hide(),c.width(i.width()-g.width()-this.rightPanelExtraShift-this.navigationPanelShift),$(window).resize(function(){e.updateLayout()}),this.updateLayout()}v.ChartViewerControl=t}(InteractiveDataDisplay=InteractiveDataDisplay||{}),function(u){u.ProbesVM=function(t){function n(t,e){if(0<r.length)for(var i=0;i<r.length;i++)r[i]({probe:t,status:e})}var i=this,a=0,r=[],o=[];if(this.subscribe=function(t){r.push(t)},this.clear=function(){for(var t=o.slice(0),e=0;e<t.length;e++)i.removeProbe(t[e].id)},this.addProbe=function(t){var e={id:++a,location:t,selected:!1};return o.push(e),n(e,"add"),e.id},this.removeProbe=function(t){for(var e=void 0,i=0;i<o.length;i++){var a=o[i];if(a.id==t){e=a;break}}void 0!==e&&(o=o.filter(function(t){return t!==e}),n(e,"remove"))},this.updateProbe=function(t,e){for(var i=void 0,a=0;a<o.length;a++){var r=o[a];if(r.id==t){i=r;break}}void 0!==i&&(i.location=e,n(i,"update"))},this.selectProbe=function(t){if(-1!==t){var e=void 0;for(i=0;i<o.length;i++){(a=o[i]).id==t?(e=a).selected=!0:a.selected=!1}void 0!==e&&n(e,"selected")}else{for(var i=0;i<o.length;i++){var a;(a=o[i]).selected=!1}n(void 0,"unselected")}},this.fitToProbe=function(t){for(var e=0;e<o.length;e++){var i=o[e];i.id==t&&n(i,"fit")}},this.getProbes=function(){return o.slice(0)},this.getProbeContent=function(t){},this.refresh=function(){void 0!==i.onRefresh&&i.onRefresh(o.slice(0))},void 0!==t)for(var e=0;e<t.length;e++){var s={id:t[e].id,location:{x:t[e].location.x,y:t[e].location.y},selected:t[e].selected};o.push(s),a<s.id&&(a=s.id)}},u.ProbesControl=function(l,d,c,h){function o(t){l[0].style.display="block";var e=$("<div></div>").addClass("probeCard");!0===t.selected&&e.addClass("probeCard-selected");var i=$("<div></div>").addClass("probeHeader").appendTo(e).height(24),a=$("<div></div>").addClass("probe").css("float","left").css("margin-right",3).width(24).height(24).appendTo(i);t.selected?u.createSmallProbe(a,t.id,"#365C95",.6):u.createSmallProbe(a,t.id,void 0,.6),$("<div></div>").addClass("probeHeader-name").text(h.plotXFormatter.toString(t.location.x)+", "+h.plotYFormatter.toString(t.location.y)).appendTo(i);var r=$("<div></div>").addClass("probeActionPanel").appendTo(e);$("<div></div>").addClass("probeCard-remove").appendTo(r).click(function(){g.removeProbe(t.id),void 0!==c.uncertaintyRange&&c.uncertaintyRange.probeid===t.id&&(c.uncertaintyRange=void 0),0==d[0].childNodes.length&&(d[0].style.display="none")}),$("<div></div>").addClass("probeCard-fit").appendTo(r).click(function(){g.fitToProbe(t.id)});var n=g.getProbeContent(t);if(void 0!==n)for(var o=0;o<n.length;o++){var s=$(n[o]);s.addClass("probecard-record"),s.appendTo(e)}return e}function s(t){p.empty(),f=[];for(var e=0;e<t.length;e++){var i=t[e],a=o(i),r=$("<div></div>").css("display","inline").appendTo(p);a.appendTo(r),f.push({id:i.id,div:a,host:r})}0<t.length&&(d[0].style.display="block")}var g=c.probesViewModel,p=d,f=[];s(g.getProbes()),g.subscribe(function(t){var e=t.probe;switch(t.status){case"add":d[0].style.display="block";var i=o(t.probe),a=$("<div></div>").css("display","inline").appendTo(p);i.appendTo(a),f.push({id:e.id,div:i,host:a});break;case"remove":for(var r=0;r<f.length;r++){if((n=f[r]).id===e.id){n.host.remove(),f=f.filter(function(t){return t.id!==e.id}),0==d[0].childNodes.length&&(d[0].style.display="none");break}}break;case"update":for(r=0;r<f.length;r++){var n;if((n=f[r]).id===e.id){n.host.empty(),(i=o(t.probe)).appendTo(n.host),n.div=i;break}}break;case"selected":case"unselected":s(g.getProbes())}}),g.onRefresh=function(t){s(t)}},u.show=function(t,e,i){if(i)throw"viewState argument is not supported";var a=new u.ChartViewerControl(t);return a.update(e),a}}(InteractiveDataDisplay=InteractiveDataDisplay||{}),function(n){function c(t,e,i){return e[t]===i[t]||(e[t]=i[t],!1)}function e(t){return!isNaN(parseFloat(t))&&isFinite(t)}function i(t){return t===t+""}function h(t){return e(t)||i(t)}function g(t){if("object"!=typeof t||null==t)return t;if(n.Utils.isArray(t)){for(var e=[],i=0;i<t.length;i++)e.push(g(t[i]));return e}var a={};for(var r in t)a[r]=g(t[r]);return a}n.updateBag=function(t,e,i,a,r){var n={};for(var o in e){var s=t[o];void 0!==(l=e[o])&&(n[o]=void 0!==s?null==l?s:i(o,s,l):a(o,l))}for(var o in t){s=t[o];var l=e[o];void 0!==s&&void 0===l&&r(o,s)}return n},n.getTitle=function(t,e){return t.titles&&void 0!==t.titles[e]?t.titles[e]:e},n.updateProp=c,n.isNumber=e,n.isString=i,n.isStringOrNumber=h,n.deepCopyJS=g,n.syncProps=function t(e,i){var a=!1;for(var r in i)if(void 0===e[r]||h(e[r])&&!h(i[r]))e[r]=g(i[r]),a=a||!0;else if(h(i[r])){var n=!c(r,e,i);a=a||n}else n=t(e[r],i[r]),a=a||n;var o=[];for(var s in e)if("d3Graphs"!==s&&"isPresented"!==s){var l=!1;for(var r in i)if(r===s){l=!0;break}l||(o.push(s),a=a||!0)}o.forEach(function(t){delete e[t]});for(var d=0;d<e.length;d++)null==e[d]&&"function"!=typeof e&&(e.splice(d,1),d--);return a}}(InteractiveDataDisplay=InteractiveDataDisplay||{}),function(n){n.PlotRegistry.area={initialize:function(t,e,i){var a=$("<div></div>").attr("data-idd-name",t.displayName).appendTo(i.host),r=new n.Area(a,i.master);return i.addChild(r),i.assignChildOrder(r),[r]},draw:function(t,e){var i=e;t[0].draw(i)}}}(InteractiveDataDisplay=InteractiveDataDisplay||{}),function(i){function r(n,t){var o,s,e=i.Utils.getDataSourceFunction(n,i.readCsv)(n);this.base=i.CanvasPlot,this.base(n,t),e&&(o=e.kind),this.draw=function(t){o=t.kind,s=t.error,this.fireAppearanceChanged("error")},Object.defineProperty(this,"isErrorVisible",{get:function(){return!0},configurable:!0}),this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.renderCore=function(t,e){},this.getLegend=function(){function i(){e.text(t.name)}var t=this,e=$("<span></span>"),a=$("<div class='plotcard-error'></div>");i();function r(){var t="";t=s||(o?'kind "'+o+'" is unknown':"Error plot definition!"),a.text(t)}r(),this.host.bind("appearanceChanged",function(t,e){e&&"error"!=e||r(),e&&"name"!=e||i()});t=this;return{name:e,legend:{thumbnail:void 0,content:a},onLegendRemove:function(){t.host.unbind("appearanceChanged"),n[0].innerHTML="",n.removeClass("idd-legend-item")}}}}i.PlotRegistry.fallback={initialize:function(t,e,i){var a=new r($("<div></div>").attr("data-idd-name",t.displayName).appendTo(i.host),i.master);return i.addChild(a),i.assignChildOrder(a),[a]},draw:function(t,e){var i={kind:e.kind,error:e.error};t[0].draw(i)}},(i.FallbackPlot=r).prototype=new i.CanvasPlot}(InteractiveDataDisplay=InteractiveDataDisplay||{}),function(n){n.PlotRegistry.heatmap={initialize:function(t,e,i){var a=$("<div></div>").attr("data-idd-name",t.displayName).appendTo(i.host),r=new n.Heatmap(a,i.master);return i.addChild(r),i.assignChildOrder(r),[r]},draw:function(t,e){t[0].draw(e,e.titles)}}}(InteractiveDataDisplay=InteractiveDataDisplay||{}),function(n){n.PlotRegistry.line={initialize:function(t,e,i){var a=$("<div></div>").attr("data-idd-name",t.displayName).appendTo(i.host),r=new n.Polyline(a,i.master);return i.addChild(r),i.assignChildOrder(r),[r]},draw:function(t,e){var i=e;t[0].draw(i)}}}(InteractiveDataDisplay=InteractiveDataDisplay||{}),function(n){n.PlotRegistry.markers={initialize:function(t,e,i){var a=$("<div></div>").attr("data-idd-name",t.displayName).appendTo(i.host),r=new n.Markers(a,i.master);return i.addChild(r),i.assignChildOrder(r),[r]},draw:function(t,e){t[0].draw(e,e.titles)}}}(InteractiveDataDisplay=InteractiveDataDisplay||{}),function(t){var e,i,a;(e=t.MarkerShape||(t.MarkerShape={})).Box="box",e.Circle="circle",e.Diamond="diamond",e.Cross="cross",e.Triangle="triangle",(i=t.HeatmapRenderType||(t.HeatmapRenderType={})).Gradient="gradient",i.Discrete="discrete",(a=t.LineTreatAs||(t.LineTreatAs={})).Function="function",a.Trajectory="trajectory",t.line=function(t){var e=t;return e.kind="line",e},t.area=function(t){var e=t;return e.kind="area",e},t.boxplot=function(t){var e=t;return e.kind="markers",e.shape="boxwhisker",e},t.markers=function(t){var e=t;return e.kind="markers",e},t.heatmap=function(t){var e=t;return e.kind="heatmap",e}}(Plot=Plot||{});
//# sourceMappingURL=idd.min.js.map