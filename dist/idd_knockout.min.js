function IDD(me,A,I,ye,x){function h(e,t,i){for(var r=0,o=e.length;r<o;r++){var n=e[r];if(!(n.plot1!==t&&n.plot1!==i||n.plot2!==t&&n.plot2!==i))return r}return-1}function s(e,t){var i=[];t=t.slice(0);for(var r=[e];0<r.length;){var o=r.shift();o!=e&&i.indexOf(o)<0&&i.push(o);for(var n=t.length;0<=--n;){var a=t[n],s=null;a.plot1===o?s=a.plot2:a.plot2===o&&(s=a.plot1),s&&(r.push(s),t.splice(n,1))}}return i}function g(e,t){for(var i=[],r=0,o=e.length;r<o;r++){var n=e[r];i.indexOf(n.plot1)<0&&i.push(n.plot1),i.indexOf(n.plot2)<0&&i.push(n.plot2)}for(t.splice(0),r=0,o=i.length;r<o;r++){var a=s(i[r],e);t.push({plot:i[r],reachable:a})}}var c,u,f,p;null==Number.MAX_SAFE_INTEGER&&(Number.MAX_SAFE_INTEGER=9007199254740991),(be=(be={MinSizeToShow:1,Padding:20,maxTickArrangeIterations:5,tickLength:10,minLabelSpace:60,minTickSpace:5,minLogOrder:4,minNumOrder:8,TooltipDelay:1,TooltipDuration:10,CssPrefix:"",ZIndexNavigationLayer:1e3,ZIndexDOMMarkers:1500,ZIndexTooltipLayer:2e3,MaxInteger:9007199254740991,HeatmapworkerPath:void 0,factory:{}})||{}).Utils={logE10neg:1/Math.log(10),log10:void 0!==Math.log10?Math.log10:function(e){return Math.log(e)*be.Utils.logE10neg},applyMask:function(e,t,i){for(var r=e.length,o=new Array(i),n=0,a=0;n<r;n++)0===e[n]&&(o[a++]=t[n]);return o},maskNaN:function(e,t){for(var i=e.length;0<=--i;){var r=t[i];r!=r&&(e[i]=1)}},isArray:function(e){return e instanceof Array||e instanceof Float64Array||e instanceof Float32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array},isOrderedArray:function(e){if(e.length<=1)return!0;if(isNaN(e[1]))return!1;if(isNaN(e[2]))return!1;for(var t=e[1]-e[0],i=2;i<e.length;i++){if(t*(e[i]-e[i-1])<0)return!1}return!0},cutArray:function(e,t){if(null==e)return e;if(e.length>t){for(var i=new Array(t),r=0;r<t;r++)i[r]=e[r];return i}return e},intersect:function(e,t){if(e&&t){var i=Math.max(e.x,t.x),r=Math.min(e.x+e.width,t.x+t.width),o=Math.max(e.y,t.y),n=Math.min(e.y+e.height,t.y+t.height);return i<=r&&o<=n?{x:i,y:o,width:r-i,height:n-o}:void 0}},includes:function(e,t){return!(!e||!t)&&(e.x<=t.x&&e.x+e.width>=t.x+t.width&&e.y<=t.y&&e.y+e.height>=t.y+t.height)},equalRect:function(e,t){return!(!e||!t)&&(e.x==t.x&&e.width==t.width&&e.y==t.y&&e.height==t.height)},calcCSWithPadding:function(e,t,i,r){var o={left:i.left,top:i.top,width:t.width-i.left-i.right,height:t.height-i.top-i.bottom};return new be.CoordinateTransform(e,o,r)},requestAnimationFrame:function(e,t){setTimeout(e,1e3/60,t)},range:function(e,t){var i=t-e+1;if(i<=0)return[];for(var r=new Array(i),o=0;o<i;o++)r[o]=o;return r},arrangeDiv:function(e,t){e.width(t.width),e.height(t.height)},unionRects:function(e,t){if(void 0===e)return void 0===t?void 0:{x:t.x,y:t.y,width:t.width,height:t.height};if(void 0===t)return void 0===e?void 0:{x:e.x,y:e.y,width:e.width,height:e.height};var i=0,r=0;r=isNaN(e.x)&&isNaN(t.x)?i=0:isNaN(e.x)?(i=t.x,t.x+t.width):isNaN(t.x)?(i=e.x,e.x+e.width):(i=Math.min(e.x,t.x),Math.max(e.x+e.width,t.x+t.width));var o=0,n=0;return n=isNaN(e.y)&&isNaN(t.y)?o=0:isNaN(e.y)?(o=t.y,t.y+t.height):isNaN(t.y)?(o=e.y,e.y+e.height):(o=Math.min(e.y,t.y),Math.max(e.y+e.height,t.y+t.height)),{x:i,y:o,width:r-i,height:n-o}},readStyle:function(e,t){var i=e.attr("data-idd-style");if(i){for(var r=i.split(";"),o=r.length,n=0;n<o;n++){var a=r[n].split(":",2);if(a&&2===a.length){var s=a[0].trim(),l=a[1].trim();t[s]=l}}return t}},updateStyle:function(e,t,i,r){(t=(t=be.Utils.readStyle(e,t))||{})[i]=r;var o="";me.each(t,function(e,t){o+=e+": "+t+"; "}),e.attr("data-idd-style",o)},getDataSourceFunction:function(e,t){var i=e.attr("data-idd-datasource");return"InteractiveDataDisplay.readTable"==i?be.readTable:"InteractiveDataDisplay.readCsv"==i?be.readCsv:"InteractiveDataDisplay.readCsv2d"==i?be.readCsv2d:"InteractiveDataDisplay.readBase64"==i?be.readBase64:i?function(){return JSON.parse(i,function(e,t){return null===t?NaN:t})}:t},makeNonEqual:function(e){return e.min==e.max?0==e.min?{min:-1,max:1}:0<e.min?{min:.9*e.min,max:1.1*e.min}:{min:1.1*e.min,max:.9*e.min}:e},getMinMax:function(e){if(e&&0!==e.length){for(var t,i,r,o=e.length,n=0;n<o;n++)if((r=e[n])==r){t=i=r;break}for(n++;n<o;n++)(r=e[n])==r&&(r<t?t=r:i<r&&(i=r));return{min:t,max:i}}},getMin:function(e){if(e&&0!==e.length){for(var t,i,r=e.length,o=0;o<r;o++)if((i=e[o])==i){t=i;break}for(o++;o<r;o++)(i=e[o])==i&&i<t&&(t=i);return t}},getMax:function(e){if(e&&0!==e.length){for(var t,i,r=e.length,o=0;o<r;o++)if((i=e[o])==i){t=i;break}for(o++;o<r;o++)(i=e[o])==i&&t<i&&(t=i);return t}},getMinMaxForPair:function(e,t){if(e&&0!==e.length){if(!t||e.length!==t.length)throw"Arrays should be equal";for(var i,r,o,n,a,s,l=e.length,d=0;d<l;d++)if(a=e[d],s=t[d],!isNaN(a)&&!isNaN(s)){i=r=a,o=n=s;break}for(d++;d<l;d++)a=e[d],s=t[d],isNaN(a)||isNaN(s)||(a<i?i=a:r<a&&(r=a),s<o?o=s:n<s&&(n=s));return{minx:i,maxx:r,miny:o,maxy:n}}},enumPlots:function(e){var t=[],i=function(e,t){t.push(e),e.children&&e.children.forEach(function(e){i(e,t)})};return i(e,t),t.sort(function(e,t){return t.order-e.order}),t},reorder:function(e,t,i){e.order=i?t.order:t.order+1;var r=function(e,t){e.order>=t.order&&e!=t&&e.order<be.MaxInteger&&(e.order+=1),e.children&&e.children.forEach(function(e){r(e,t)})};r(e.master,e)},getMaxOrder:function(e){var i=e&&e.order!=be.MaxInteger?e.order:0;return e&&e.children&&e.children.forEach(function(e){var t=be.Utils.getMaxOrder(e);t!=be.MaxInteger&&(i=Math.max(i,t))}),i},getBoundingBoxForArrays:function(e,t,i,r){var o=void 0;if(e&&t){var n=be.Utils.getMinMaxForPair(e,t);if(n){i&&(n.minx=i(n.minx),n.maxx=i(n.maxx)),r&&(n.miny=r(n.miny),n.maxy=r(n.maxy));var a=Math.min(n.minx,n.maxx),s=Math.abs(n.maxx-n.minx);o={x:a,y:Math.min(n.miny,n.maxy),width:s,height:Math.abs(n.maxy-n.miny)}}}return o},getIEVersion:function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE");return 0<t?parseInt(e.substring(t+5,e.indexOf(".",t))):navigator.userAgent.match(/Trident\/7\./)?11:0},lastUsedIntId:0,generateNextIntId:function(){return this.lastUsedIntId++},resetLastUsedIntId:function(){return this.lastUsedIntId=0,this.lastUsedIntId},base64toByteArray:function(e){for(var t=atob(e),i=new Array(t.length),r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return new Uint8Array(i)},byteArrayToTypedArray:function(e,t){var i,r=e.buffer;switch(t){case"uint8":return e;case"float32":i=new Float32Array(r);break;case"float64":i=new Float64Array(r);break;case"int16":i=new Int16Array(r);break;case"int32":i=new Int32Array(r);break;default:throw"Unexpected array type: "+t}return i},getArrayToSetLineDash:function(e,t){var i=t;switch(t||(i=1),i=(i=parseInt(i))||1,e){case"dot":e=[i,2*i];break;case"dash":e=[3*i,2*i];break;case"dash dot":e=[3*i,2*i,i,2*i];break;case"long dash":e=[8*i,2*i];break;case"long dash dot":e=[8*i,2*i,i,2*i];break;case"long dash dot dot":e=[8*i,2*i,i,2*i,i,2*i]}for(var r=[],o=0;o<e.length;o+=2)"number"==typeof e[o]&&"number"==typeof e[o+1]&&(r.push(e[o]),r.push(e[o+1]));return r}},(be=be||{}).Binding=be.Binding||{},c=[],u=[],f=[],p=[],be.Binding.bindPlots=function(t,i,e){if(null==e||"vh"==e){var r=be.Binding.bindPlots(t,i,"v"),o=be.Binding.bindPlots(t,i,"h"),n=!1;return{destroy:function(){n||(r.destroy(),o.destroy(),n=!0)}}}if("v"!=e&&"h"!=e)throw"Parameter filter is incorrect";if(!t)throw"plot1 is incorrect";if(!i)throw"plot2 is incorrect";if(t=t.master,i=i.master,t===i)throw"plot1 equals plot2";var a="v"==e?u:c,s=h(a,t,i);if(0<=s)return a[s].binding;var l="v"==e?p:f,d=(n=!1,{plot1:t,plot2:i,binding:{destroy:function(){if(!n){var e=h(a,t,i);e&&a.splice(e,1),g(a,l),n=!0}}}});return a.push(d),g(a,l),t.requestUpdateLayout(),d.binding},be.Binding.getBoundPlots=function(e){for(var t={h:[],v:[]},i=0,r=f.length;i<r;i++)if(f[i].plot===e){t.h=f[i].reachable;break}for(i=0,r=p.length;i<r;i++)if(p[i].plot===e){t.v=p[i].reachable;break}return t},be.AdaptiveFormatter=function(e,t){function h(e){if(0<=e){for(var t=1,i=0;i<e;i++)t*=10;return t}for(t=1,i=0;i<-e;i++)t*=.1;return t}var i,r,o,n,a,s,l,d=function(e){for(var t=0,i=0,r=0;r<e.length;r++)isNaN(e[r])||(t+=e[r],++i);return 0!=i?t/i:NaN};if(this.getPrintFormat=function(e,t,i){var r=Math.max(Math.abs(e),Math.abs(t));if(r===1/0||i===1/0||i===-1/0||isNaN(r)||isNaN(i))return{toString:function(e){return e}};var o,n=Math.LN10,a=1e-12<r?Math.log(r)/n:0;if((o=1e-12<i?Math.floor(Math.log(i)/n)-2:Math.floor(a-2))<0){var s=Math.floor(a);if(o<=-2&&s<=-4){var l=h(-s),d=s;return{toString:function(e){return 0<d?(e*l).toFixed(-o+s)+"e+"+d:(e*l).toFixed(-o+s)+"e"+d},exponent:s}}return{toString:function(e){return e.toFixed(-o)}}}if(2<=o&&5<a){l=h(-o-2),d=o+2;return{toString:function(e){return 0<d?(e*l).toFixed(2)+"e+"+d:(e*l).toFixed(2)+"e"+d},exponent:o+2}}return{toString:function(e){var t=e.toFixed();return e!=t&&(t+="."),t}}},void 0!==e&&void 0!==t)i=((o=t)-(r=e))/4;else if(void 0!==e&&void 0===t){var g=be.Utils.getMinMax(e);r=g.min,o=g.max,a=d(n=e),s=n.map(function(e){var t=e-a;return t*t}),l=d(s),i=Math.sqrt(l)}return this.getPrintFormat(r,o,i)},be.register=function(e,t){if(!e)throw"key is undefined";if(!t)throw"factory is undefined";be.factory[e]=t};!function(){"use strict";var e=navigator.userAgent.toLowerCase();0<=e.indexOf("firefox")?be.CssPrefix="-moz":(0<=e.indexOf("chrome")||0<=e.indexOf("safari"))&&(be.CssPrefix="-webkit"),window.requestAnimationFrame?be.Utils.requestAnimationFrame=function(e){return window.requestAnimationFrame(e)}:window.msRequestAnimationFrame?be.Utils.requestAnimationFrame=function(e){return window.msRequestAnimationFrame(e)}:window.webkitRequestAnimationFrame?be.Utils.requestAnimationFrame=function(e){return window.webkitRequestAnimationFrame(e)}:window.mozRequestAnimationFrame?be.Utils.requestAnimationFrame=function(e){return window.mozRequestAnimationFrame(e)}:window.oRequestAnimationFrame&&(be.Utils.requestAnimationFrame=function(e){return window.oRequestAnimationFrame(e)});var pe=function(e,s){if("undefined"!=typeof Modernizr&&e&&(Modernizr.canvas?Modernizr.borderradius?Modernizr.boxshadow?Modernizr.csstransforms?Modernizr.hsla?Modernizr.rgba||e.replaceWith('<div">Browser does not support rgba colors</div>'):e.replaceWith('<div">Browser does not support hsla colors</div>'):e.replaceWith('<div">Browser does not support 2d css transformations</div>'):e.replaceWith('<div">Browser does not support "box-shadow" style property</div>'):e.replaceWith('<div">Browser does not support "border-radius" style property</div>'):e.replaceWith('<div">Browser does not support HTML5 canvas</div>')),e.hasClass("idd-plot-master")||e.hasClass("idd-plot-dependant"))throw"The div element already is initialized as a plot";var l=void 0,t=e.attr("data-idd-plot");switch(t){case"plot":(l=new be.Plot(e,s)).order=be.MaxInteger;break;case"polyline":l=new be.Polyline(e,s);break;case"dom":(l=new be.DOMPlot(e,s)).order=be.MaxInteger;break;case"label":(l=new be.LabelPlot(e,s)).order=be.MaxInteger;break;case"figure":l=new be.Figure(e,s);break;case"chart":l=new be.Chart(e,s);break;case"grid":l=new be.GridlinesPlot(e,s);break;case"markers":l=new be.Markers(e,s);break;case"area":l=new be.Area(e,s);break;case"bingMaps":l=new be.BingMapsPlot(e,s);break;case"boundaryLine":l=new be.BoundaryLinePlot(e,s)}var i=window.MutationObserver||window.WebKitMutationObserver;i?new i(function(e,t){e.forEach(function(e){var t=e.addedNodes,i=e.removedNodes;if(0<t.length)for(var r=0;r<t.length;r++){var o=me(t[r]);if(o.attr("data-idd-plot")){o.removeClass("idd-plot-master").removeClass("idd-plot-dependant");var n=pe(o,s);l.addChild(n),l.assignChildOrder(n)}}if(0<i.length)for(r=0;r<i.length;r++){var a=i[r];if("function"==typeof a.getAttribute)null!=a.getAttribute("data-idd-plot")&&l.removeChild(a.plot)}})}).observe(e[0],{subtree:!1,characterData:!1,attributes:!1,childList:!0,attributeOldValue:!1,characterDataOldValue:!1}):console.warn("MutationObservers are not supported by the browser. DOM changes are not tracked by IDD");if(l)return l;var r=be.factory[t];if(r)return r(e,s);throw"Unknown plot type"};be.asPlot=function(e){if(!e)throw"Plot must be attached to div!";var t;if(void 0!==e.tagName&&"div"===e.tagName.toLowerCase())t=me(e);else if("string"==typeof e){if(0===(t=me("#"+e)).length)throw"There is no element with id "+e;e=t[0]}else{if(!(e instanceof jQuery&&e.is("div")))throw"Invalid input parameter! It should be div or id of div or jQuery of single div";e=(t=e)[0]}return void 0!==e.plot?e.plot:pe(t)},be.tryGetMasterPlot=function(e){if(e&&e.hasClass("idd-plot-master")){var t=e.get(0);return"plot"in t?t.plot:null}return null},be.updateLayouts=function(e){var t=be.tryGetMasterPlot(e);if(t)t.updateLayout();else for(var i=e.children(),r=0;r<i.length;r++)be.updateLayouts(i.eq(r))},be.Event=be.Event||{},be.Event.appearanceChanged=jQuery.Event("appearanceChanged"),be.Event.childrenChanged=jQuery.Event("childrenChanged"),be.Event.isAutoFitChanged=jQuery.Event("isAutoFitEnabledChanged"),be.Event.visibleRectChanged=jQuery.Event("visibleRectChanged"),be.Event.isVisibleChanged=jQuery.Event("visibleChanged"),be.Event.plotRemoved=jQuery.Event("plotRemoved"),be.Event.orderChanged=jQuery.Event("orderChanged"),be.Event.frameRendered=jQuery.Event("frameRendered");var ve=0;be.Plot=function(i,t,e){if(!i||!i.hasClass("idd-plot-master")&&!i.hasClass("idd-plot-dependant")){i&&(i[0].addEventListener("touchstart",function(e){e.preventDefault()},!1),i[0].addEventListener("touchmove",function(e){e.preventDefault()},!1));var r,o,n,d,h,g,a,u=void 0===t&&void 0!==i,f=t||this,p=i,s=e||p,c=u?new be.CoordinateTransform:void 0,l=[],v=!0,m=!1,y=!1,b=!1,C=!1,w=!0,I=!1,A=!1,x=!1,T=!0,S=!1,P="",k=0,M=be.Padding,D={},G=!1,N=void 0,R=!1,B=me.Deferred();if(i){P=i.attr("data-idd-name")||i.attr("id")||"",i.attr("data-idd-X-log")&&(i.removeAttr("data-idd-X-log"),r=be.logTransform),i.attr("data-idd-Y-log")&&(i.removeAttr("data-idd-Y-log"),o=be.logTransform);var F={};be.Utils.readStyle(i,F),F.hasOwnProperty("padding")&&(M=Number(F.padding)),F.hasOwnProperty("suppress-tooltip-coords")&&((N=N||{}).showCursorCoordinates=Boolean(F["suppress-tooltip-coords"])),F.hasOwnProperty("ignored-by-fit-to-view")&&(y=Boolean(F["ignored-by-fit-to-view"])),F.hasOwnProperty("ignored-by-fit-to-view-x")&&(b=Boolean(F["ignored-by-fit-to-view-x"])),F.hasOwnProperty("ignored-by-fit-to-view-y")&&(C=Boolean(F["ignored-by-fit-to-view-y"])),N=N||{},F.hasOwnProperty("tooltipDelay")?N.tooltipDelay=1e3*Number(F.tooltipDelay):N.tooltipDelay=1e3*be.TooltipDelay,i[0].plot=this,i.attr("unselectable","on").addClass("unselectable").on("selectstart",!1)}u&&(this._sharedCanvas=void 0);var V=!1;this.requestsRender=!1,this.isInAnimation=!1;var L=this.isAnimationFrameRequested=!1;u&&(this.requestsUpdateLayout=!1);var Z=void 0,z=this,Y=ve++,U=void 0,O=function(e){m!==e&&(m=e,this.onIsVisibleChanged(),this.fireVisibleChanged(this))};Object.defineProperty(this,"instanceId",{get:function(){return Y},configurable:!1}),Object.defineProperty(this,"isMaster",{get:function(){return u},configurable:!1}),Object.defineProperty(this,"isRendered",{get:function(){return V},configurable:!1}),Object.defineProperty(this,"flatRendering",{get:function(){return u?S:t.flatRendering},set:function(e){u?S!==e&&(S=e,z.requestUpdateLayout()):t.flatRendering=e}}),Object.defineProperty(this,"isIgnoredByFitToView",{get:function(){return y},set:function(e){y=e,w&&this.requestUpdateLayout()}}),Object.defineProperty(this,"isIgnoredByFitToViewX",{get:function(){return b},set:function(e){b=e,w&&this.requestUpdateLayout()}}),Object.defineProperty(this,"isIgnoredByFitToViewY",{get:function(){return C},set:function(e){C=e,w&&this.requestUpdateLayout()}}),Object.defineProperty(this,"master",{get:function(){return f},configurable:!1}),Object.defineProperty(this,"host",{get:function(){return p},configurable:!1}),Object.defineProperty(this,"centralPart",{get:function(){return s},configurable:!1}),Object.defineProperty(this,"name",{get:function(){return P},set:function(e){P!==e&&(P=e,this.fireAppearanceChanged("name"))},configurable:!1}),Object.defineProperty(this,"children",{get:function(){return l.slice(0)},configurable:!1}),Object.defineProperty(this,"screenSize",{get:function(){return u?{width:d,height:h}:f.screenSize},configurable:!1}),Object.defineProperty(this,"xDataTransform",{get:function(){return r},set:function(e){r=e,this.onDataTransformChanged("x")},configurable:!1}),Object.defineProperty(this,"yDataTransform",{get:function(){return o},set:function(e){o=e,this.onDataTransformChanged("y")},configurable:!1}),Object.defineProperty(this,"coordinateTransform",{get:function(){return u?c.clone():f.coordinateTransform},configurable:!1}),Object.defineProperty(this,"doFitOnDataTransformChanged",{get:function(){return u?T:f.doFitOnDataTransformChanged},set:function(e){u?T=e:f.doFitOnDataTransformChanged=e},configurable:!1}),Object.defineProperty(this,"aspectRatio",{get:function(){return u?n:f.aspectRatio},set:function(e){u?(n=e,this.updateLayout()):f.aspectRatio=e},configurable:!1}),Object.defineProperty(this,"isAutoFitEnabled",{get:function(){return u?w:f.isAutoFitEnabled},set:function(e){if(u){if(w===e)return;if(U=void 0,"boolean"==typeof e)w=e;else{if("object"!=typeof e)throw"value of the unknown type was assigned to the isAutoFitEnabled property";if(4!=e.length)throw"isAutoFitEnabled property can be assigned by boolean or 4-value object";e[0]=isNaN(Number(e[0]))?"auto":Number(e[0]),e[1]=isNaN(Number(e[1]))?"auto":Number(e[1]),e[2]=isNaN(Number(e[2]))?"auto":Number(e[2]),e[3]=isNaN(Number(e[3]))?"auto":Number(e[3]);for(var t=!0,i=0;i<4;i++)"auto"!=e[i]&&(t=!1);if(t)w=!0;else{var r=!1;for(i=0;i<4;i++)"auto"==e[i]&&(r=!0);if(w=!!r,e[0]>=e[1]&&"auto"!=e[0]&&"auto"!=e[1]){if(isNaN(e[0]))e[0]=e[1]-1;else if(isNaN(e[1]))e[1]=e[0]+1;else if(e[0]==e[1])e[1]=e[0]+1;else{var o=e[0];e[0]=e[1],e[1]=o}console.log("data-idd-visible-region attribute: xmax is less or equal than xmin. It's ["+e[0]+".."+e[1]+"] on x axis now")}if(e[2]>=e[3]&&"auto"!=e[2]&&"auto"!=e[3]){if(isNaN(e[2]))e[2]=e[3]-1;else if(isNaN(e[3]))e[3]=e[2]+1;else if(e[2]==e[3])e[3]=e[2]+1;else{o=e[2];e[2]=e[3],e[3]=o}console.log("data-idd-visible-region attribute: ymax is less or equal than ymin. It's ["+e[2]+".."+e[3]+"] on y axis now")}U=e}}w||"boolean"!=typeof e?this.requestUpdateLayout():g=z.visibleRect,this.host.trigger(be.Event.isAutoFitChanged)}else f.isAutoFitEnabled=e},configurable:!1}),Object.defineProperty(this,"isVisible",{get:function(){return v},set:function(e){v!==e&&(v=e,this.onIsVisibleChanged(),this.fireVisibleChanged(this))},configurable:!1}),Object.defineProperty(this,"isErrorVisible",{get:function(){return m},configurable:!0}),Object.defineProperty(this,"order",{get:function(){return k},set:function(e){k!==e&&(k=e,this.fireOrderChanged())},configurable:!1}),Object.defineProperty(this,"padding",{get:function(){return u?M:f.padding},set:function(e){u?(M=e,this.updateLayout()):f.padding=e},configurable:!1}),Object.defineProperty(this,"visibleRect",{get:function(){return u?c.getPlotRect({x:0,y:0,width:d,height:h}):f.visibleRect},configurable:!1});var W=void 0;Object.defineProperty(this,"mapControl",{get:function(){return u?W:f.mapControl},configurable:!1}),Object.defineProperty(this,"tooltipSettings",{get:function(){return u?N:f.tooltipSettings},set:function(e){u?N=e:f.tooltipSettings=e},configurable:!1});var X=!0;Object.defineProperty(this,"isToolTipEnabled",{get:function(){return u?X:f.isToolTipEnabled},set:function(e){u?X=e:f.isToolTipEnabled=e},configurable:!1}),Object.defineProperty(this,"titles",{get:function(){return me.extend({},D)},set:function(e){this.setTitles(e,!1)}}),Object.defineProperty(this,"initialized",{get:function(){return u?B.promise():f.initialized},configurable:!1}),this.selfMapRefresh=function(){if(u){if(void 0!==this.map){if(void 0!==W)throw"Plot composition can have only 1 map!";W=this.map,this.requestUpdateLayout()}if(this.constraint){if(void 0!==Z)throw"Plot composition can have only 1 constraint function!";Z=this.constraint}}},this.getTitle=function(e){return void 0!==D&&void 0!==D[e]?D[e]:e},this.setTitles=function(e,t){D=e,t||this.fireAppearanceChanged()},this.destroy=function(){this.host.removeClass("idd-plot")},this.remove=function(){void 0!==this.map&&this.master.removeMap(),this.isMaster||this.master.removeChild(this),this.firePlotRemoved(this),this.host.remove()},this.removeMap=function(){u&&(Z=W=void 0,this.navigation.animation=new be.PanZoomAnimation,this.fitToView())},this.addChild=function(e){if(!e)throw"Child plot is undefined";if(e.master&&e.master!==e&&e.master!==this.master)throw"Given child plot already added to another plot";if(e.master!==this.master&&e.onAddedTo(this.master),l.push(e),this.master._sharedCanvas&&(this.master._sharedCanvas.remove(),this.master._sharedCanvas=void 0),e.constraint){if(void 0!==Z)throw"Plot composition can have only 1 constraint function!";Z=e.constraint}if(void 0!==e.map){if(void 0!==W)throw"Plot composition can have only 1 map!";W=e.map}this.fireChildrenChanged({type:"add",plot:e}),this.requestUpdateLayout()},this.assignChildOrder=function(e){void 0===e.host.attr("data-idd-plot-order")?e.order!=be.MaxInteger&&(e.order=be.Utils.getMaxOrder(this.master)+1):(e.order=e.host.attr("data-idd-plot-order"),e.host.removeAttr("data-idd-plot-order")),e.order<be.MaxInteger&&e.host.css("z-index",e.order)},this.onAddedTo=function(e){u=this===(f=e);for(var t=l.length;0<=--t;)l[t].onAddedTo(e);u?i.addClass("idd-plot-master").removeClass("idd-plot-dependant"):i.removeClass("idd-plot-master").addClass("idd-plot-dependant")},this.removeChild=function(e){if(!e)throw"plot is undefined";for(var t,i=l.length;0<=--i;)if((t=l[i])===e||t.name===e)return l.splice(i,1),t.onAddedTo(t),this.master._sharedCanvas&&(this.master._sharedCanvas.remove(),this.master._sharedCanvas=void 0),void 0!==t.constraint&&(Z=void 0),void 0!==t.map&&(W=void 0),this.fireChildrenChanged({type:"remove",plot:t}),this.requestUpdateLayout(),!0;for(i=l.length;0<=--i;)if((t=l[i]).removeChild(e))return!0;return!1},this.getPlotsSequence=function(){for(var t=[z],e=l.length,i=0;i<e;i++){l[i].getPlotsSequence().forEach(function(e){t.push(e)})}return t},this.getLocalBounds=function(e,t){return a=a||this.computeLocalBounds(e,t)},this.computeLocalBounds=function(e,t){},this.invalidateLocalBounds=function(){var e=a;return a=void 0,e},this.aggregateBounds=function(){for(var e=z.getPlotsSequence(),t=void 0,i=[],r=e.length,o=0;o<r;o++){if(!(l=e[o]).isIgnoredByFitToView){var n=l.getLocalBounds(1);if(l.isVisible&&!l.isErrorVisible)if(void 0===n)i.push(l);else{var a={x:n.x,y:n.y,width:n.width,height:n.height};l.isIgnoredByFitToViewX&&(a.x=NaN,a.width=NaN),l.isIgnoredByFitToViewY&&(a.y=NaN,a.height=NaN),t=be.Utils.unionRects(t,a)}}}r=i.length;var s=t;for(o=0;o<r;o++){var l=i[o];t=be.Utils.unionRects(t,l.getLocalBounds(2,s))}if(void 0!==t){if(0===t.width){var d=Math.max(.1,Math.abs(t.x));t.x=t.x-d/200,t.width=d/100}if(0===t.height){var h=Math.max(.1,Math.abs(t.y));t.y=t.y-h/200,t.height=h/100}}var g=u&&void 0===t;return g&&(t=void 0!==W?{x:-180,y:-90,width:360,height:180}:{x:0,y:0,width:1,height:1}),{bounds:t,isDefault:g}},this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.aggregatePadding=function(){for(var e=z.getLocalPadding()||{left:0,right:0,top:0,bottom:0},t=l.length,i=0;i<t;i++){var r=l[i].aggregatePadding();e={left:Math.max(e.left,r.left),right:Math.max(e.right,r.right),top:Math.max(e.top,r.top),bottom:Math.max(e.bottom,r.bottom)}}return e.left=e.left+this.padding||this.padding,e.right=e.right+this.padding||this.padding,e.top=e.top+this.padding||this.padding,e.bottom=e.bottom+this.padding||this.padding,e};var E=function(){if(f.flatRendering&&(L=!0,f._sharedCanvas&&(f._sharedCanvas._dirty=!0)),z.requestsUpdateLayout)z.requestsUpdateLayout=!1,z.isAnimationFrameRequested=!1,L=!0,z.updateLayout();else{z.isAnimationFrameRequested=!1;var e=z.screenSize,t=z.coordinateTransform.getPlotRect({x:0,y:0,width:e.width,height:e.height});H(L,f,t,e),z.fireFrameRendered()}L=!1,le&&le()},H=function(e,t,i,r){if(t&&t.isVisible){(e||t.requestsRender)&&(t.requestsRender=!1,t.render(i,r));for(var o=t.children,n=o.length,a=0;a<n;a++){var s=o[a];H(e,s,i,r)}}};this.requestNextFrame=function(e){e=e||this,u?(e.requestsRender=!0,this.isAnimationFrameRequested||(this.isAnimationFrameRequested=!0,L=!1,be.Utils.requestAnimationFrame(E))):f.requestNextFrame(e)},this.requestUpdateLayout=function(e){u?(L=!0,G=e&&e.suppressNotifyBoundPlots,this.requestsUpdateLayout||(e&&e.forceOnlyUpdatePlotsOutput||(this.requestsUpdateLayout=!0),this.isAnimationFrameRequested||(this.isAnimationFrameRequested=!0,be.Utils.requestAnimationFrame(E)))):f.requestUpdateLayout(e)},this.onIsVisibleChanged=function(){this.updateLayout()},this.onDataTranformChangedCore=function(e){},this.onDataTransformChanged=function(e){a=void 0,this.onDataTranformChangedCore(e),this.isAutoFitEnabled?this.master.requestUpdateLayout():this.doFitOnDataTransformChanged&&this.master.fitToView()},this.render=function(e,t){var i=this.getLocalBounds(),r=!1;i?be.Utils.intersect(i,e)?(O.call(this,!1),this.renderCore(e,t),r=!0):i.width==i.width&&i.height==i.height&&i.x==i.x&&i.y==i.y&&isFinite(i.width)&&isFinite(i.height)&&isFinite(i.y)&&isFinite(i.x)||O.call(this,!0):(this.renderCore(e,t),r=!0);r!==V&&(V=r,this.onIsRenderedChanged())},this.renderCore=function(e,t){},this.exportToSvg=function(){if(!ye.supported)throw"SVG is not supported";var e=z.screenSize,t=z.coordinateTransform.getPlotRect({x:0,y:0,width:e.width,height:e.height}),i=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=ye(i).size(p.width(),p.height());return z.exportContentToSvg(t,e,r),r},this.exportContentToSvg=function(e,t,i){for(var r=be.Utils.enumPlots(this),o=r.length-1;0<=o;o--)r[o].isVisible&&r[o].renderCoreSvg(e,t,i)},this.exportLegendToSvg=function(e){if(!ye.supported)throw"SVG is not supported";for(var t,i=z.screenSize,r=(z.coordinateTransform.getPlotRect({x:0,y:0,width:i.width,height:i.height}),document.createElementNS("http://www.w3.org/2000/svg","svg")),o=ye(r),n=o.group(),a=be.Utils.enumPlots(this),s={width:170,height:0},l=0,d=0;d<a.length;d++){var h={width:170,height:0};if(null!=a[d].getLegend())if(a[d].isVisible){var g=n.group();e&&(h.legendDiv=e.children[l],l++),a[d].buildSvgLegend(h,g),g.translate(5,s.height),n.clipWith(g.rect(h.width,s.height+30)),s.height+=h.height+10,t=o.line(15,s.height,s.width,s.height).stroke({width:.3,color:"gray"}).back(),s.height+=10}else l++}return null!=t&&t.remove(),o.size(200,s.height+10),n.clipWith(n.rect(180,s.height+10)),o},this.renderCoreSvg=function(e,t,i){},this.buildSvgLegend=function(e,t){},this.onIsRenderedChanged=function(){};var K=function(e,t){var i=e;return"auto"!=t[0]&&(i.width=i.x+i.width-parseFloat(t[0]),i.width<=0&&(i.width=1),i.x=parseFloat(t[0])),"auto"!=t[1]&&(i.width=parseFloat(t[1])-i.x),"auto"!=t[2]&&(i.height=i.y+i.height-parseFloat(t[2]),i.height<=0&&(i.height=1),i.y=parseFloat(t[2])),"auto"!=t[3]&&(i.height=parseFloat(t[3])-i.y),i};this.fit=function(e,t,i){d=e.width,h=e.height;var r=void 0,o=f.aggregateBounds(),n=o.bounds,a=o.isDefault?{left:0,top:0,bottom:0,right:0}:f.aggregatePadding();if(w||I)n.x!=n.x&&(n.x=0),n.y!=n.y&&(n.y=0),n.width!=n.width&&(n.width=1),n.height!=n.height&&(n.height=1),U&&(n=K(n,U)),g=n,r=(c=be.Utils.calcCSWithPadding(g,e,a,f.aspectRatio)).getPlotRect({x:0,y:0,width:e.width,height:e.height}),void 0!==Z&&!0===t&&(r=Z(r,e,!0),c=new be.CoordinateTransform(r,{left:0,top:0,width:d,height:h},f.aspectRatio));else if(A||x){var s=void 0,l=void 0;U&&(g=K(g,U)),!0===A&&(g.width=n.width,g.x=n.x,s=o.isDefault?{left:0,top:0,right:0,bottom:0}:a),!0===x&&(g.height=n.height,g.y=n.y,l=o.isDefault?{left:0,top:0,right:0,bottom:0}:a),a=!U||"auto"==U[0]&&"auto"==U[1]&&"auto"==U[2]&&"auto"==U[3]?{left:s?s.left:0,top:l?l.top:0,right:s?s.right:0,bottom:l?l.bottom:0}:{left:s?s.left:a.left,top:l?l.top:a.top,right:s?s.right:a.right,bottom:l?l.bottom:a.bottom},r=(c=be.Utils.calcCSWithPadding(g,e,a,f.aspectRatio)).getPlotRect({x:0,y:0,width:e.width,height:e.height}),void 0!==Z&&!0===t&&(r=Z(r,e,i),c=new be.CoordinateTransform(r,{left:0,top:0,width:d,height:h},f.aspectRatio)),g=r}else n.x!=n.x&&(n.x=0),n.y!=n.y&&(n.y=0),n.width!=n.width&&(n.width=1),n.height!=n.height&&(n.height=1),U&&(g=K(g,U)),r=(c=0===a.left&&0===a.top&&0===a.right&&0===a.bottom||U?be.Utils.calcCSWithPadding(g,e,a,f.aspectRatio):new be.CoordinateTransform(g,{left:0,top:0,width:d,height:h},f.aspectRatio)).getPlotRect({x:0,y:0,width:e.width,height:e.height}),void 0!==Z&&!0===t&&(r=Z(r,e,i),c=new be.CoordinateTransform(r,{left:0,top:0,width:d,height:h},f.aspectRatio)),g=r;return t&&(g=r),r},this.updateLayout=function(){if(z.requestsUpdateLayout=!1,u){var e=z.visibleRect,t={width:p.width(),height:p.height()};if(t.width<=1||t.height<=1){var i=z.measure({width:1,height:1});return z.arrange(i),void(R||(B.resolve(),R=!0))}var r=z.screenSize.width!==t.width||z.screenSize.height!==t.height;i=z.measure(t,r);x=A=I=!1,z.arrange(i);var o=z.visibleRect;if(o.x===e.x&&o.y===e.y&&o.width===e.width&&o.height===e.height||(E(),z.fireVisibleRectChanged({visibleRect:o})),L=!0,E(),!G){var n=be.Binding.getBoundPlots(z),a=n.h.length,s=n.v.length;if(0<a||0<s){var l=z.coordinateTransform.getPlotRect({x:0,y:0,width:i.width,height:i.height});n.v=n.v.slice(0);for(var d=0;d<a;d++){var h=n.h[d],g=n.v.indexOf(h);if(0<=g)n.v[g]=null,h.navigation.setVisibleRect(l,!1,{suppressNotifyBoundPlots:!0});else(c=h.visibleRect).x=l.x,c.width=l.width,h.navigation.setVisibleRect(c,!1,{suppressNotifyBoundPlots:!0})}for(d=0;d<s;d++){var c;if(null!=(h=n.v[d]))(c=h.visibleRect).y=l.y,c.height=l.height,h.navigation.setVisibleRect(c,!1,{suppressNotifyBoundPlots:!0})}}}G=!1,R||(B.resolve(),R=!0)}else f.updateLayout()},this.measure=function(e,t){return void 0!==this.mapControl&&this.mapControl.setOptions({width:e.width,height:e.height}),this.fit(e,!0,t),p&&p.children("div").each(function(){var e=me(this);e.css("top",0),e.css("left",0)}),e},this.arrange=function(e){this.isMaster||be.Utils.arrangeDiv(this.host,e);for(var t=this.children,i=t.length,r=0;r<i;r++){t[r].arrange(e)}};var j=function(e,t){z.isAutoFitEnabled&&(z.isAutoFitEnabled=!1),g=e,(U=void 0)!==t&&void 0!==t.syncUpdate&&!0===t.syncUpdate?z.updateLayout():z.requestUpdateLayout(t)};this.fitToView=function(){u?(this.isAutoFitEnabled=!1,this.navigation.stop(),I=!0,U=void 0,this.requestUpdateLayout()):f.fitToView()},this.fitToViewX=function(){u?(this.navigation.stop(),A=!0,U?(U[0]="auto",U[1]="auto"):U=void 0,this.requestUpdateLayout()):f.fitToViewX()},this.fitToViewY=function(){u?(this.navigation.stop(),x=!0,U?(U[2]="auto",U[3]="auto"):U=void 0,this.requestUpdateLayout()):f.fitToViewY()},this.requestNextFrameOrUpdate=function(){this.isAutoFitEnabled?this.master.requestUpdateLayout():this.master.requestNextFrame(this)},this.getTooltip=function(e,t,i,r){};var Q=function(e,t){for(var i=e.children,r=i.length,o=0;o<r;o++){var n=i[o];Q(n,t)}t(e)};if(i&&i.attr("data-idd-visible-region")){var J=i.attr("data-idd-visible-region").split(" ");if(4!=J.length)throw"data-idd-visible-region must contain exactly 4 numbers (xmin,xmax,ymin,ymax) separated by single space";var q=Number(J[0]),_=Number(J[1]),$=Number(J[2]),ee=Number(J[3]);if(_<q)throw"data-idd-visible-region attribute: xmax is less than xmin";if(ee<$)throw"data-idd-visible-region attribute: ymax is less than ymin";var te=this.xDataTransform&&this.xDataTransform.dataToPlot,ie=this.yDataTransform&&this.yDataTransform.dataToPlot,re=te?te(q):q,oe=te?te(_):_,ne=ie?ie($):$;j({x:re,width:oe-re,y:ne,height:(ie?ie(ee):ee)-ne})}if(u){var ae,se,le;this.enumAll=function(e,t){Q(e,t)};var de,he=function(e){e&&(e.fadeOutTimer&&(clearTimeout(e.fadeOutTimer),e.fadeOutTimer=void 0),e.remove(),e=void 0)},ge=function(){ae&&(clearTimeout(ae),ae=void 0),le=void 0,he(se)},ce=function(e,t){ae=void 0,ge();function i(){var a,s,l=[],d=t.x,h=t.y;return Q(z,function(e){var t=e.xDataTransform?e.xDataTransform.plotToData(d):d,i=e.yDataTransform?e.yDataTransform.plotToData(h):h,r=e.getTooltip(t,i,d,h);if(r){if(t!==a||i!==s){a=t,s=i;var o=new be.AdaptiveFormatter(f.visibleRect.x,f.visibleRect.x+f.visibleRect.width),n=new be.AdaptiveFormatter(f.visibleRect.y,f.visibleRect.y+f.visibleRect.height);void 0!==N&&!1===N.showCursorCoordinates||l.push("<div class='idd-tooltip-coordinates'>"+o.toString(a)+", "+n.toString(s)+"</div>")}l.push(r)}}),l}var r=i();if(0!==r.length){se=me("<div></div>").addClass("idd-tooltip").hide().appendTo(z.host).css("position","absolute").css("left",e.x+15).css("top",e.y+15).css("z-index",be.ZIndexTooltipLayer);var o=function(e){for(var t=e.length,i=0;i<t;i++)me(e[i]).appendTo(se).addClass("idd-tooltip-item")};o(r),le=function(){if(se){se.empty();var e=i();return o(e),e.length}};var n=se,a=function(){0===N.tooltipDelay?(n.show(),n.fadeOutTimer=setTimeout(l,1e3*be.TooltipDuration)):n.fadeOutTimer=setTimeout(s,1e3*be.TooltipDuration)};0===N.tooltipDelay?a():se.fadeIn("fast",a)}function s(){le=void 0,n.fadeOut("fast")}function l(){n.fadeOutTimer&&(clearTimeout(n.fadeOutTimer),n.fadeOutTimer=void 0),n.remove(),n=void 0}};s.mousemove(function(e){de=void 0;var t=be.Gestures.getXBrowserMouseOrigin(p,e),i=be.Gestures.getXBrowserMouseOrigin(s,e),r=z.coordinateTransform,o={x:r.screenToPlotX(i.x),y:r.screenToPlotY(i.y)};ae&&(clearTimeout(ae),ae=void 0);var n=se;z.master.isToolTipEnabled&&(0===N.tooltipDelay?ce(t,o):ae=setTimeout(function(){ce(t,o)},N.tooltipDelay)),he(n);var a=function(e,t,i){e.onMouseMove&&e.onMouseMove(t,i);for(var r=e.children,o=r.length,n=0;n<o;n++)a(r[n],t,i)};a(z,i,o)}),s.mousedown(function(e){ge(),de=be.Gestures.getXBrowserMouseOrigin(s,e)}),s.mouseup(function(e){ge();var t=be.Gestures.getXBrowserMouseOrigin(s,e);if(de&&de.x==t.x&&de.y==t.y){var i=z.coordinateTransform,r={x:i.screenToPlotX(t.x),y:i.screenToPlotY(t.y)},a=function(e,t,i){e.onClick&&e.onClick(t,i);for(var r=e.children,o=r.length,n=0;n<o;n++)a(r[n],t,i)};a(z,t,r)}}),s.mouseleave(function(e){ge()})}else this.enumAll=f.enumAll;var ue=!(this.get=function(e){var a=function(e,t){if(t.name===e||t.host[0].id===e||t.host[0]===e)return t;for(var i=t.children,r=i.length,o=0;o<r;o++){var n=a(e,i[o]);if(n)return n}};return a(e,this.master)});if(this.fireAppearanceChanged=function(e){ue||(ue=!0,setTimeout(function(){z.host.trigger(be.Event.appearanceChanged,e),ue=!1},20))},this.fireChildrenChanged=function(e){this.host.trigger(be.Event.childrenChanged,e)},this.fireFrameRendered=function(e){this.host.trigger(be.Event.frameRendered,e)},this.fireVisibleRectChanged=function(e){ge(),this.master.host.trigger(be.Event.visibleRectChanged,e)},this.fireVisibleChanged=function(e){this.host.trigger(be.Event.isVisibleChanged,e)},this.firePlotRemoved=function(e){this.host.trigger(be.Event.plotRemoved,e),Q(e,function(e){e.host.trigger(be.Event.plotRemoved,e)})},this.fireOrderChanged=function(e){this.host.trigger(be.Event.orderChanged,e)},this.polyline=function(e,t){var i=this.get(e);if(!i){var r=me("<div></div>").attr("data-idd-name",e).appendTo(this.host);i=new be.Polyline(r,this.master),this.addChild(i),this.assignChildOrder(i)}return void 0!==t&&i.draw(t),i},this.markers=function(e,t,i){var r=this.get(e);if(!r){var o=me("<div></div>").attr("data-idd-name",e).appendTo(this.host);r=new be.Markers(o,this.master),this.addChild(r),this.assignChildOrder(r)}return void 0!==t&&r.draw(t,i),r},this.area=function(e,t){var i=this.get(e);if(!i){var r=me("<div></div>").attr("data-idd-name",e).appendTo(this.host);i=new be.Area(r,this.master),this.addChild(i),this.assignChildOrder(i)}return void 0!==t&&i.draw(t),i},this.heatmap=function(e,t,i){var r=this.get(e);if(!r){var o=me("<div></div>").attr("data-idd-name",e).appendTo(this.host);r=new be.Heatmap(o,this.master),this.addChild(r),this.assignChildOrder(r)}return void 0!==t&&r.draw(t,i),r},this.labels=function(e,t){var i=this.get(e);if(!i){var r=me("<div></div>").attr("data-idd-name",e).appendTo(this.host);i=new be.LabelPlot(r,this.master),this.addChild(i),this.assignChildOrder(i)}return void 0!==t&&i.draw(t),i},this.boundaryLine=function(e,t){var i=this.get(e);if(!i){var r=me("<div></div>").attr("data-idd-name",e).appendTo(this.host);i=new be.BoundaryLinePlot(r,this.master),this.addChild(i),this.assignChildOrder(i)}return void 0!==t&&i.draw(t),i},u)var fe=new be.Navigation(this,j);Object.defineProperty(this,"navigation",{get:function(){return u?fe:f.navigation},configurable:!1}),p&&p.children("div").each(function(){var e=me(this);if(!e.hasClass("idd-plot-master")&&!e.hasClass("idd-plot-dependant")&&void 0!==e.attr("data-idd-plot")&&"figure"!==e.attr("data-idd-plot")&&"chart"!==e.attr("data-idd-plot")){var t=pe(e,f);z.addChild(t),z.assignChildOrder(t)}}),this.getLegend=function(){},setTimeout(function(){if(p&&p.attr("data-idd-legend")){var t=me("#"+p.attr("data-idd-legend")),e=new be.Legend(z,t,!0);Object.defineProperty(z,"legend",{get:function(){return e},configurable:!1}),be.Gestures.FullEventList.forEach(function(e){t[0].addEventListener(e,function(e){e.stopPropagation()},!1)})}},0),this.updateOrder=function(e,t){if(e&&be.Utils.reorder(this,e,t),!S)for(var i=be.Utils.enumPlots(f),r=0;r<i.length;r++)i[r].order<be.MaxInteger&&i[r].host.css("z-index",i[r].order)},i&&(u?("figure"!==i.attr("data-idd-plot")&&"chart"!==i.attr("data-idd-plot")&&this.updateLayout(),i.addClass("idd-plot-master")):i.addClass("idd-plot-dependant"))}};var w=[];be.Legend=function(n,s,l,d,e){var h=[],a=[],g=s[0].style,c=this;c.div=s;var o=!0;Object.defineProperty(this,"isVisible",{get:function(){return o},set:function(e){o=e,g.display=o?"block":"none"},configurable:!1}),Object.defineProperty(this,"Host",{get:function(){return s}});var t=e;(void 0===l&&void 0===e||!1===l&&void 0===e)&&(t=!0),l?s.addClass("idd-legend-compact"):s.addClass("idd-legend"),s.addClass("unselectable"),t&&(s.sortable({axis:"y"}),s.on("sortupdate",function(e,t){c.updateIsLegendInduced=!0;var i,r,o=t.item.data("plot");me("li",s).each(function(e,t){if(o==me(t).data("plot"))return r=me(t).prev().data("plot"),i=me(t).next().data("plot"),!1});for(var n=0;n<h.length;++n)if(h[n].plot==o){if(i){for(var a=0;a<h.length;++a)if(h[a].plot==i){o.updateOrder(h[a].plot);break}}else for(a=0;a<h.length;++a)if(h[a].plot==r){o.updateOrder(h[a].plot,!0);break}break}c.updateIsLegendInduced=!1}));function u(e){e.host.bind("visibleChanged",b),e.host.bind("childrenChanged",y),a.push(e)}function f(){for(var e=0;e<a.length;e++){var t=a[e];t.host.unbind("visibleChanged",b),t.host.unbind("childrenChanged",y)}a=[]}function p(){s.empty();for(var e=0,t=h.length;e<t;e++)m(h[e]);f(),h=[];var i=be.Utils.enumPlots(n);for(e=0;e<i.length;e++){var r=i[i.length-e-1];u(r),C(r)}s[0].hasChildNodes()&&o&&(g.display="block")}function r(e,t){c.updateIsLegendInduced||p()}function v(e,t){n==t&&s.remove()}var m=function(e){for(var t=0;t<w.length;t++)if(w[t]==e){w.splice(t,1);break}},y=function(e,t){if(void 0!==t)if("add"===t.type&&s[0].hasChildNodes()&&t.plot.master==n.master){if(function(e){for(var t=0,i=a.length;t<i;t++)if(a[t]===e)return!0;return!1}(t.plot))return;u(t.plot),C(t.plot)}else if("remove"===t.type){for(var r=function(e){var t=h[e];h.splice(e,1),m(t),t.onLegendRemove&&t.onLegendRemove(),t[0].innerHTML="",l?t.removeClass("idd-legend-item-compact"):t.removeClass("idd-legend-item"),s[0].removeChild(t[0]),t.plot.children.forEach(function(e){for(var t=0,i=h.length;t<i;t++)h[t].plot===e&&r(h[t])}),me(t[0]).css("display","none"),0==h.length&&(g.display="none")},i=0,o=h.length;i<o;i++)if(h[i].plot===t.plot){r(i);break}!function(e){e.host.unbind("visibleChanged",b),e.host.unbind("childrenChanged",y);for(var t=0;t<a.length;t++)a[t]===e&&a.splice(t,1)}(t.plot)}else{for(s[0].innerHTML="",g.display="none",o=h.length,i=0;i<o;i++)m(h[i]),h[i].onLegendRemove&&h[i].onLegendRemove(),h[i][0].innerHTML="",l?h[i].removeClass("idd-legend-item-compact"):h[i].removeClass("idd-legend-item");f(),h=[],p()}},b=function(e,t){for(var i,r,o,n,a=0,s=w.length;a<s;a++)w[a].plot===t&&(i=a,r=t.isVisible,o=t.isErrorVisible,n=void 0,n=w[i],o?(n[0].firstElementChild.lastElementChild.setAttribute("class","idd-legend-isselected-error"),n[0].firstElementChild.lastElementChild.setAttribute("title","The data can not be displayed.")):(n[0].firstElementChild.lastElementChild.setAttribute("title",""),r?n[0].firstElementChild.lastElementChild.setAttribute("class","idd-legend-isselected-false"):n[0].firstElementChild.lastElementChild.setAttribute("class","idd-legend-isselected-true")))},C=function(e){var t,i,r,o=e.getLegend();if(o){var n=me(l?"<div class='idd-legend-item-compact'></div>":"<li class='idd-legend-item'></li>");l||n.data("plot",e);var a=me(l?"<div class='idd-legend-item-title-compact'></div>":"<div class='idd-legend-item-title'></div>");o.legend&&o.legend.thumbnail&&(l?o.legend.thumbnail.addClass("idd-legend-item-title-thumb-compact").appendTo(a):o.legend.thumbnail.addClass("idd-legend-item-title-thumb").appendTo(a)),l?o.name.addClass("idd-legend-item-title-name-compact").appendTo(a):o.name.addClass("idd-legend-item-title-name").appendTo(a),t=a,i=e,r=me("<div></div>").addClass("idd-legend-isselected-false").appendTo(t),i.isErrorVisible?(r.attr("class","idd-legend-isselected-error"),r.attr("title","The data can not be displayed.")):(r.attr("title",""),i.isVisible?r.attr("class","idd-legend-isselected-false"):r.attr("class","idd-legend-isselected-true"),r.click(function(e){e.stopPropagation(),i.isErrorVisible||(i.isVisible?(r.attr("class","idd-legend-isselected-true"),i.isVisible=!1):(r.attr("class","idd-legend-isselected-false"),i.isVisible=!0))})),a.appendTo(n),o.legend&&o.legend.content&&(l?o.legend.content.addClass("idd-legend-item-info-compact").appendTo(n):o.legend.content.addClass("idd-legend-item-info").appendTo(n)),d&&me(n).bind("mouseenter",function(){var e=me(this),t=l?e.find(".idd-legend-item-title-name-compact"):e.find(".idd-legend-item-title-name");t[0].offsetWidth<t[0].scrollWidth&&void 0===e.attr("title")&&e.attr("title",t.text())}),n.prependTo(s),n.plot=e,h[h.length]=n,(w[w.length]=n).plot.updateOrder()}};this.remove=function(){for(var e=0,t=h.length;e<t;e++)m(h[e]),h[e].onLegendRemove&&h[e].onLegendRemove(),h[e][0].innerHTML="",l?h[e].removeClass("idd-legend-item-compact"):h[e].removeClass("idd-legend-item");h=[],f();var i=function(e){e.host.unbind("visibleChanged",b),e.children.forEach(function(e){i(e)})};i(n),s[0].innerHTML="",l?s.removeClass("idd-legend-compact"):s.removeClass("idd-legend"),s.removeClass("unselectable"),n.host.unbind("plotRemoved",v),n.host.unbind("orderChanged",r)},n.host.bind("plotRemoved",v),n.host.bind("orderChanged",r),s[0].legend=c,p(),s.dblclick(function(e){e.stopImmediatePropagation()})},be.CoordinateTransform=function(e,t,i){var r=0,o=0,n=1,a=1;void 0!==e&&void 0!==t&&(n=t.width/e.width,a=t.height/e.height,void 0!==i&&0<i&&(i*a<n?n=i*a:a=n/i),r=t.left-n*e.x,o=t.height+t.top+a*e.y),this.plotToScreenX=function(e){return e*n+r},this.plotToScreenY=function(e){return o-e*a},this.screenToPlotX=function(e){return(e-r)/n},this.screenToPlotY=function(e){return(o-e)/a},this.plotToScreenWidth=function(e){return e*n},this.plotToScreenHeight=function(e){return e*a},this.screenToPlotWidth=function(e){return e/n},this.screenToPlotHeight=function(e){return e/a},this.getPlotRect=function(e){var t=this.screenToPlotX(e.x),i=this.screenToPlotY(e.height+e.y);return{x:t,y:i,width:this.screenToPlotX(e.x+e.width)-t,height:this.screenToPlotY(e.y)-i}},this.getScale=function(){return{x:n,y:a}},this.getOffset=function(){return{x:r,y:o}},this.clone=function(){var e=new be.CoordinateTransform;return e.plotToScreenX=this.plotToScreenX,e.plotToScreenY=this.plotToScreenY,e.screenToPlotX=this.screenToPlotX,e.screenToPlotY=this.screenToPlotY,e.plotToScreenWidth=this.plotToScreenWidth,e.plotToScreenHeight=this.plotToScreenHeight,e.screenToPlotWidth=this.screenToPlotWidth,e.screenToPlotHeight=this.screenToPlotHeight,e.getPlotRect=this.getPlotRect,e.getScale=this.getScale,e.getOffset=this.getOffset,e}},be.CanvasPlot=function(e,t){if(this.base=be.Plot,this.base(e,t),e){var n,o=function(){t._sharedCanvas&&(t._sharedCanvas.remove(),t._sharedCanvas=void 0)};this.getContext=function(e){var t,i=this.master;if(i.flatRendering?(t=i._sharedCanvas,e=i._sharedCanvas._dirty&&e,i._sharedCanvas._dirty=!1):t=n,void 0!==t){var r=t[0].getContext("2d");if(e){var o=this.screenSize;r.clearRect(0,0,o.width,o.height)}return r}},this.destroy=function(){return be.CanvasPlot.prototype.destroy.call(this),this.host.children(".idd-plot-canvas").remove(),o(),this},this.arrange=function(e){var t;be.CanvasPlot.prototype.arrange.call(this,e);var i=this.master;i.flatRendering?(i._sharedCanvas?t=i._sharedCanvas:(n?(t=n,n=void 0):t=me("<canvas></canvas>").prependTo(this.host).addClass("idd-plot-canvas"),i._sharedCanvas=t,i._sharedCanvas._dirty=!1),n&&(n.remove(),n=void 0)):(i._sharedCanvas&&o(),t=n=n||me("<canvas></canvas>").prependTo(this.host).addClass("idd-plot-canvas"));var r=t[0];r.width=e.width,r.height=e.height},this.getTransform=function(){var e=this.coordinateTransform,t=e.plotToScreenX,i=e.plotToScreenY,r=this.xDataTransform&&this.xDataTransform.dataToPlot,o=this.yDataTransform&&this.yDataTransform.dataToPlot;return{dataToScreenX:r?function(e){return t(r(e))}:t,dataToScreenY:o?function(e){return i(o(e))}:i,dataToPlotX:r,dataToPlotY:o,plotToScreenX:t,plotToScreenY:i}},this.getScreenToDataTransform=function(){var e=this.coordinateTransform,t=e.screenToPlotX,i=e.screenToPlotY,r=this.xDataTransform&&this.xDataTransform.plotToData,o=this.yDataTransform&&this.yDataTransform.plotToData;return{screenToDataX:r?function(e){return r(t(e))}:t,screenToDataY:o?function(e){return o(i(e))}:i}}}},be.CanvasPlot.prototype=new be.Plot,be.Polyline=function(e,t){var M,D,f,p,v,m,G=this,i=be.Utils.getDataSourceFunction(e,be.readCsv)(e);this.base=be.CanvasPlot,this.base(e,t);var y="blue",b="pink",N=1,R="#4169ed",B="butt",F="miter",V=[];i&&(N=void 0!==i.thickness?i.thickness:N,R=void 0!==i.stroke?i.stroke:R,B=void 0!==i.lineCap?i.lineCap:B,F=void 0!==i.lineJoin?i.lineJoin:F,y=void 0!==i.fill68?i.fill68:y,b=void 0!==i.fill95?i.fill95:b,V=void 0!==i.lineDash?i.lineDash:V),this.draw=function(e){if(!(h=e.y.median?e.y.median:e.y))throw"Data series y is undefined";var t=h.length;if(e.x||(e.x=be.Utils.range(0,t-1)),t!=e.x.length)throw"Data series x and y have different lengths";M=h,D=e.x;var i=e.y.upper68;if(i&&i.length!==t)throw"Data series y_u68 and y_median have different lengths";var r=e.y.lower68;if(r&&r.length!==t)throw"Data series y_l68 and y_median have different lengths";var o=e.y.upper95;if(o&&o.length!==t)throw"Data series y_u95 and y_median have different lengths";var n=e.y.lower95;if(n&&n.length!==t)throw"Data series y_l95 and y_median have different lengths";f=i,p=r,v=o,m=n;var a=e.treatAs&&"function"==e.treatAs&&!be.Utils.isOrderedArray(D);if(be.Utils.isArray(e.y)){if(M=h,a){var s=Math.min(D.length,h.length);if(M=be.Utils.cutArray(h,s),D=be.Utils.cutArray(D,s),a){for(var l=[],d=0;d<s;d++)isNaN(D[d])||l.push({x:D[d],y:M[d]});l.sort(function(e,t){return e.x-t.x}),M=[],D=[];for(d=0;d<l.length;d++)M.push(l[d].y),D.push(l[d].x)}}}else{var h=e.y;s=Math.min(D.length,h.median.length);if(h.upper68&&h.lower68&&(s=Math.min(s,Math.min(h.upper68.length,h.lower68.length))),h.upper95&&h.lower95&&(s=Math.min(s,Math.min(h.upper95.length,h.lower95.length))),M=be.Utils.cutArray(h.median,s),f=be.Utils.cutArray(h.upper68,s),p=be.Utils.cutArray(h.lower68,s),v=be.Utils.cutArray(h.upper95,s),m=be.Utils.cutArray(h.lower95,s),D=be.Utils.cutArray(D,s),a){for(l=[],d=0;d<s;d++)isNaN(D[d])||l.push({x:D[d],y:M[d],y_u68:f[d],y_l68:p[d],y_u95:v[d],y_l95:m[d]});l.sort(function(e,t){return e.x-t.x}),M=[],f=[],p=[],v=[],m=[],D=[];for(d=0;d<l.length;d++)M.push(l[d].y),f.push(l[d].y_u68),p.push(l[d].y_l68),v.push(l[d].y_u95),m.push(l[d].y_l95),D.push(l[d].x)}}"number"!=typeof(N=void 0!==e.thickness?e.thickness:N)&&(N=parseFloat(N)||1),R=void 0!==e.stroke?e.stroke:R,B=void 0!==e.lineCap?e.lineCap:B,F=void 0!==e.lineJoin?e.lineJoin:F,y=void 0!==e.fill68?e.fill68:y,b=void 0!==e.fill95?e.fill95:b,V=void 0!==e.lineDash?e.lineDash:V,this.invalidateLocalBounds(),this.requestNextFrameOrUpdate(),this.fireAppearanceChanged()},this.computeLocalBounds=function(e,t){var i=this.xDataTransform&&this.xDataTransform.dataToPlot,r=this.yDataTransform&&this.yDataTransform.dataToPlot,o=be.Utils.getBoundingBoxForArrays(D,M,i,r),n=be.Utils.getBoundingBoxForArrays(D,f,i,r),a=be.Utils.getBoundingBoxForArrays(D,p,i,r),s=be.Utils.getBoundingBoxForArrays(D,v,i,r),l=be.Utils.getBoundingBoxForArrays(D,m,i,r);return be.Utils.unionRects(o,be.Utils.unionRects(n,be.Utils.unionRects(a,be.Utils.unionRects(s,l))))},this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.getTooltip=function(e,t,i,r){if(void 0!==D&&null!=M&&(0!=M.length&&this.isVisible)){var o=this.getContext(!1);if(void 0!==o){for(var n=this.getTransform(),a=n.dataToScreenX(e),s=n.dataToScreenY(t),l=o.getImageData(a-1,s-1,3,3),d=0,h=0;h<l.data.length;h++)0===l.data[h]&&d++;if(d!==l.data.length){var g=me("<div></div>");return me("<div></div>").addClass("idd-tooltip-name").text(this.name||"polyline").appendTo(g),g}}}};this.renderCore=function(e,t){be.Polyline.prototype.renderCore.call(this,e,t);var i=this.getContext(!0);be.Area.render.call(this,D,m,v,b,e,t,i,.5),be.Area.render.call(this,D,p,f,y,e,t,i,.5),function(e,t,i,r,o,n){if(void 0!==e&&null!=t){var a=t.length;if(0!=a){var s,l,d,h,g=G.getTransform(),c=g.dataToScreenX,u=g.dataToScreenY,f=o.width,p=o.height,v=f,m=p;n.globalAlpha=1,n.strokeStyle=i,n.fillStyle=i,n.lineWidth=r,n.lineCap=B,n.lineJoin=F,n.setLineDash(be.Utils.getArrayToSetLineDash(V,r)),n.beginPath();var y,b,C,w,I,A,x,T,S=0,P=function(){for(;S<a;S++)if(!isNaN(e[S])&&!isNaN(t[S])){s=c(e[S]),d=u(t[S]),y=L(s,d,0,v,0,m);break}0==y&&n.moveTo(s,d)};P();var k=1;for(S++;S<a;S++){if(isNaN(e[S])||isNaN(t[S]))1==k?(n.stroke(),0==L(s,d,0,v,0,m)&&(n.beginPath(),n.arc(s,d,r/2,0,2*Math.PI),n.fill())):n.stroke(),n.beginPath(),S++,P(),k=1;else if(x=l=c(e[S]),T=h=u(t[S]),!(Math.abs(s-l)<1&&Math.abs(d-h)<1)){for(C=y,w=b=L(l,h,0,v,0,m);y|b&&!(y&b);)I=l-s,A=h-d,y?(s<0?(d+=A*(0-s)/I,s=0):v<s?(d+=A*(v-s)/I,s=v):d<0?(s+=I*(0-d)/A,d=0):m<d&&(s+=I*(m-d)/A,d=m),y=L(s,d,0,v,0,m)):(l<0?(h+=A*(0-l)/I,l=0):v<l?(h+=A*(v-l)/I,l=v):h<0?(l+=I*(0-h)/A,h=0):m<h&&(l+=I*(m-h)/A,h=m),b=L(l,h,0,v,0,m));y&b||(0!=C&&n.moveTo(s,d),n.lineTo(l,h),k++),s=x,d=T,y=w}}if(1==k)n.stroke(),0==L(s,d,0,v,0,m)&&(n.beginPath(),n.arc(s,d,r/2,0,2*Math.PI),n.fill());else n.stroke()}}}(D,M,R,N,t,i)};this.renderCoreSvg=function(e,t,i){be.Area.renderSvg.call(this,e,t,i,D,m,v,b),be.Area.renderSvg.call(this,e,t,i,D,p,f,y),function(e,t){if(void 0!==D&&null!=M){var i=M.length;if(0!=i){var r,o,n,a,s,l,d,h,g,c,u,f,p,v=G.getTransform(),m=v.dataToScreenX,y=v.dataToScreenY,b=e.width,C=e.height,w=b,I=C,A=0,x=be.ColorPalette.colorFromString(R),T="rgb("+x.r+","+x.g+","+x.b+")",S=function(){t.polyline(s).style({fill:"none",stroke:T,"stroke-width":N,"stroke-opacity":x.a,"stroke-linecap":B}).attr("stroke-dasharray",be.Utils.getArrayToSetLineDash(V,N)).attr("stroke-linejoin",F)},P=function(){for(s=new Array(0);A<i;A++)if(!isNaN(D[A])&&!isNaN(M[A])){r=m(D[A]),n=y(M[A]),l=L(r,n,0,w,0,I);break}0==l&&s.push([r,n])};P();var k=1;for(A++;A<i;A++){if(isNaN(D[A])||isNaN(M[A]))1==k?(S(),0==L(r,n,0,w,0,I)&&(context.beginPath(),context.arc(r,n,N/2,0,2*Math.PI),context.fill())):S(),A++,P(),k=1;else if(f=o=m(D[A]),p=a=y(M[A]),!(Math.abs(r-o)<1&&Math.abs(n-a)<1)){for(h=l,g=d=L(o,a,0,w,0,I);l|d&&!(l&d);)c=o-r,u=a-n,l?(r<0?(n+=u*(0-r)/c,r=0):w<r?(n+=u*(w-r)/c,r=w):n<0?(r+=c*(0-n)/u,n=0):I<n&&(r+=c*(I-n)/u,n=I),l=L(r,n,0,w,0,I)):(o<0?(a+=u*(0-o)/c,o=0):w<o?(a+=u*(w-o)/c,o=w):a<0?(o+=c*(0-a)/u,a=0):I<a&&(o+=c*(I-a)/u,a=I),d=L(o,a,0,w,0,I));l&d||(0!=h&&(S(),(s=new Array(0)).push([r,n])),s.push([o,a]),k++),r=f,n=p,l=g}}if(1==k)S(),0==L(r,n,0,w,0,I)&&t.circle(N).translate(r,n).fill(T).opacity(x.a);else S()}}}(t,i)};var L=function(e,t,i,r,o,n){return(e<i)<<3|(r<e)<<2|(t<o)<<1|n<t};this.onDataTransformChanged=function(e){this.invalidateLocalBounds(),be.Polyline.prototype.onDataTransformChanged.call(this,e)},Object.defineProperty(this,"thickness",{get:function(){return N},set:function(e){if(e!=N){if(e<=0)throw"Polyline thickness must be positive";N=e,this.fireAppearanceChanged("thickness"),this.requestNextFrameOrUpdate()}},configurable:!1}),Object.defineProperty(this,"stroke",{get:function(){return R},set:function(e){e!=R&&(R=e,this.fireAppearanceChanged("stroke"),this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"lineCap",{get:function(){return B},set:function(e){e!=B&&(B=e,this.fireAppearanceChanged("lineCap"),this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"lineJoin",{get:function(){return F},set:function(e){e!=F&&(F=e,this.fireAppearanceChanged("lineJoin"),this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"fill68",{get:function(){return y},set:function(e){e!=y&&(y=e,this.fireAppearanceChanged("fill68"),this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"fill95",{get:function(){return b},set:function(e){e!=b&&(b=e,this.fireAppearanceChanged("fill95"),this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"lineDash",{get:function(){return V},set:function(e){e!=V&&(V=e,this.fireAppearanceChanged("lineDash"),this.requestNextFrameOrUpdate())},configurable:!1}),this.getLegend=function(){var r=me("<canvas></canvas>");r[0].width=40,r[0].height=40;var o=r.get(0).getContext("2d"),e=null!=f&&null!=p;null!=v&&null!=m&&(o.globalAlpha=.5,o.strokeStyle=b,o.fillStyle=b,o.beginPath(),o.moveTo(0,0),o.lineTo(0,20),o.lineTo(20,40),o.lineTo(40,40),o.lineTo(40,20),o.lineTo(20,0),o.lineTo(0,0),o.fill(),o.stroke(),o.closePath()),e&&(o.globalAlpha=.5,o.strokeStyle=y,o.fillStyle=y,o.beginPath(),o.moveTo(0,0),o.lineTo(0,10),o.lineTo(30,40),o.lineTo(40,40),o.lineTo(40,30),o.lineTo(10,0),o.lineTo(0,0),o.fill(),o.stroke(),o.closePath()),o.strokeStyle=R,o.lineWidth=N,o.setLineDash(be.Utils.getArrayToSetLineDash(V,N)),o.moveTo(0,0),o.lineTo(40,40),o.stroke();function n(){i.text(t.name)}var t=this,i=me("<span></span>");n(),this.host.bind("appearanceChanged",function(e,t){t&&"name"!=t||n(),o.clearRect(0,0,r[0].width,r[0].height);var i=null!=f&&null!=p;null!=v&&null!=m&&(o.globalAlpha=.5,o.strokeStyle=b,o.fillStyle=b,o.beginPath(),o.moveTo(0,0),o.lineTo(0,20),o.lineTo(20,40),o.lineTo(40,40),o.lineTo(40,20),o.lineTo(20,0),o.lineTo(0,0),o.fill(),o.stroke(),o.closePath()),i&&(o.globalAlpha=.5,o.strokeStyle=y,o.fillStyle=y,o.beginPath(),o.moveTo(0,0),o.lineTo(0,10),o.lineTo(30,40),o.lineTo(40,40),o.lineTo(40,30),o.lineTo(10,0),o.lineTo(0,0),o.fill(),o.stroke(),o.closePath()),o.setLineDash(be.Utils.getArrayToSetLineDash(V,N)),o.strokeStyle=R,o.lineWidth=N,o.moveTo(0,0),o.lineTo(40,40),o.stroke()});t=this;return{name:i,legend:{thumbnail:r,content:void 0},onLegendRemove:function(){t.host.unbind("appearanceChanged")}}},this.buildSvgLegend=function(e,t){e.height=30,t.add(t.rect(e.width,e.height).fill("white").opacity(.5));var i=null!=v&&null!=m,r=null!=f&&null!=p,o=be.ColorPalette.colorFromString(R),n="rgb("+o.r+","+o.g+","+o.b+")",a=be.ColorPalette.colorFromString(b),s="rgb("+a.r+","+a.g+","+a.b+")",l=be.ColorPalette.colorFromString(y),d="rgb("+l.r+","+l.g+","+l.b+")";i&&t.add(t.polyline([[0,0],[0,9],[9,18],[18,18],[18,9],[9,0],[0,0]]).fill(s).opacity(a.a).translate(5,5)),r&&t.add(t.polyline([[0,0],[0,4.5],[13.5,18],[18,18],[18,13.5],[4.5,0],[0,0]]).fill(d).opacity(l.a).translate(5,5)),t.add(t.line(0,0,18,18).stroke({width:N,color:n}).translate(5,5).attr("stroke-dasharray",be.Utils.getArrayToSetLineDash(V,N)));var h=window.getComputedStyle(e.legendDiv.children[0].children[1],null),g=parseFloat(h.getPropertyValue("font-size")),c=h.getPropertyValue("font-family"),u=h?h.getPropertyValue("font-weight"):void 0;t.add(t.text(this.name).font({family:c,size:g,weight:u}).translate(40,0)),t.front()},i&&void 0!==i.y&&this.draw(i)},be.Polyline.prototype=new be.CanvasPlot;var g=jQuery.Event("plotClick");be.DOMPlot=function(e,t){this.base=be.Plot,this.base(e,t);function u(i,e,t,r,o,n,a,s){if("div"!==i[0].tagName.toLowerCase())throw"DOMPlot supports only DIV elements";function l(e){var t=h.coordinateTransform.screenToPlotX,i=h.coordinateTransform.screenToPlotY,r=h.xDataTransform&&h.xDataTransform.plotToData,o=h.yDataTransform&&h.yDataTransform.plotToData,n=r?function(e){return r(t(e))}:t,a=o?function(e){return o(i(e))}:i,s=e.position();e._left=s.left+e._originX*e.width(),e._top=s.top+e._originY*e.height(),e._x=n(s.left+e._originX*e.width()),e._y=a(s.top+e._originY*e.height())}i._x=t,i._y=r,i._width=o&&0<o?o:1,i._height=n&&0<n?n:1,i._originX=a||0,i._originY=s||0,i._scale=e||"element",i.on("drag",function(e,t){l(i)}),i.on("dragstop",function(e,t){l(i),h.invalidateLocalBounds(),h.requestUpdateLayout()}),i.addClass("idd-dom-marker"),i.css("display","none").css("z-index",be.ZIndexDOMMarkers),T.push(i)}var T=[],h=this;e.children("div[data-idd-position]").each(function(){var e=me(this),t=e.attr("data-idd-position").split(/\s+/g);if(t.length<2)throw"Position of the DOM marker should define x and y";var i,r,o,n,a=parseFloat(t[0]),s=parseFloat(t[1]),l=e.attr("data-idd-size");if(l){var d=l.split(/\s+/g);2<=d.length&&(i=parseFloat(d[0]),r=parseFloat(d[1]))}var h=e.attr("data-idd-origin");if(h){var g=h.split(/\s+/g);2<=g.length&&(o=parseFloat(g[0]),n=parseFloat(g[1]))}var c=e.attr("data-idd-scale");u(e,c,a,s,i,r,o,n)});function S(e){return{left:e._x-e._originX*e._width,top:e._y+e._originY*e._height}}this.computeLocalBounds=function(){var e;if(T){var t=T.length;if(0<t){for(var i=[],r=[],o=0,n=0;o<t;o++,n++){var a=T[o];if("none"!=a._scale){var s=S(a);i[n]=s.left,r[n]=s.top,i[++n]=s.left+a._width,r[n]=s.top-a._height}}var l=be.Utils.getMinMax(i),d=be.Utils.getMinMax(r);if(l&&d){var h=this.xDataTransform&&this.xDataTransform.dataToPlot,g=this.yDataTransform&&this.yDataTransform.dataToPlot;h&&(l.min=h(l.min),l.max=h(l.max)),g&&(d.min=g(d.min),d.max=g(d.max)),e={x:l.min,y:d.min,width:l.max-l.min,height:d.max-d.min}}}}return e},this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.arrange=function(e){be.CanvasPlot.prototype.arrange.call(this,e);var t=e.width,i=e.height;this.host.css("clip","rect(0px,"+t+"px,"+i+"px,0px)")},this.renderCore=function(e,t){be.DOMPlot.prototype.renderCore.call(this,e,t);var i=T.length;if(0<i)for(var r=t.height,o=t.width,n=this.coordinateTransform.plotToScreenX,a=this.coordinateTransform.plotToScreenY,s=this.xDataTransform&&this.xDataTransform.dataToPlot,l=this.yDataTransform&&this.yDataTransform.dataToPlot,d=s?function(e){return n(s(e))}:n,h=l?function(e){return a(l(e))}:a,g=0;g<i;g++){var c,u,f,p=T[g];if("none"==p._scale)u={x:p.width(),y:p.height()},c={x:(c={x:d(p._x),y:h(p._y)}).x-p._originX*u.x,y:c.y-p._originY*u.y};else c={x:d((f=S(p)).left),y:h(f.top)},u={x:d(f.left+p._width)-c.x,y:h(f.top-p._height)-c.y};u.y,u.x;var v,m=0,y=r,b=c.y,C=c.y+u.y,w=Math.max(m,b),I=Math.min(y,C);if((v=w<I)&&(c.y,c.y,m=0,y=o,b=c.x,C=c.x+u.x,v=(w=Math.max(m,b))<(I=Math.min(y,C))))if(c.x,c.x,p.css("left",c.x+"px"),p.css("top",c.y+"px"),p.css("display","block"),"content"===p._scale){var A=u.x/p.width(),x=u.y/p.height();p.css(be.CssPrefix+"-transform-origin","0% 0%"),p.css(be.CssPrefix+"-transform","scale("+A+","+x+")")}else"element"===p._scale&&(p.css("width",u.x+"px"),p.css("height",u.y+"px"));v||p.css("display","none")}},this.onIsRenderedChanged=function(){if(this.isRendered)for(e=T.length,t=0;t<e;t++){T[t].css("z-index",be.ZIndexDOMMarkers)}else for(var e=T.length,t=0;t<e;t++){T[t].css("display","none")}},this.clear=function(){for(var e=T.length,t=0;t<e;t++){T[t].remove()}T=[],this.invalidateLocalBounds(),this.requestUpdateLayout()},this.add=function(e,t,i,r,o,n,a,s){var l=me(e);return this.host[0].contains(l[0])||l.appendTo(this.host),u(l,t,i,r,o,n,a,s),this.invalidateLocalBounds(),this.requestUpdateLayout(),l.get(0)};function l(t){var e=jQuery.grep(T,function(e){return e[0]===t});if(e&&0<e.length)return e[0]}this.remove=function(e){function t(e){var t=l(e[0]);t&&T.splice(T.indexOf(t),1),e.remove()}e.jquery?t(e):t(me(e)),this.invalidateLocalBounds(),this.requestUpdateLayout()},this.set=function(e,t,i,r,o,n,a){var s=l(e);if(!s)throw"Element is not found in the plot";s._x=t,s._y=i,"none"!=s.scale&&(r&&0<r&&(s._width=r),o&&0<o&&(s._height=o)),s._originX=n||s._originX,s._originY=a||s._originY,this.invalidateLocalBounds(),this.requestUpdateLayout()},this.enableClickablePanel=!1,h.master.centralPart.click(function(e){if(h.enableClickablePanel){var t=h.coordinateTransform.screenToPlotX,i=h.coordinateTransform.screenToPlotY,r=h.xDataTransform&&h.xDataTransform.plotToData,o=h.yDataTransform&&h.yDataTransform.plotToData,n=r?function(e){return r(t(e))}:t,a=o?function(e){return o(i(e))}:i,s=be.Gestures.getXBrowserMouseOrigin(h.master.centralPart,e),l=n(s.x),d=a(s.y);h.host.trigger(g,{x:l,y:d})}}),Object.defineProperty(this,"domElements",{get:function(){return T.slice(0)},configurable:!1})},be.DOMPlot.prototype=new be.Plot,be.GridlinesPlot=function(e,t){var l,d;this.base=be.CanvasPlot,this.base(e,t);var h="1px",g="LightGray",i={};be.Utils.readStyle(this.host,i),g=void 0!==i.stroke?i.stroke:g,h=void 0!==i.thickness?i.thickness:h,Object.defineProperty(this,"xAxis",{get:function(){return l},set:function(e){e!=l&&(l=e,this.requestUpdateLayout())},configurable:!1}),Object.defineProperty(this,"yAxis",{get:function(){return d},set:function(e){e!=d&&(d=e,this.requestUpdateLayout())},configurable:!1}),Object.defineProperty(this,"thickness",{get:function(){return h},set:function(e){if(e!=h){if(e<=0)throw"GridLines thickness must be positive";h=e,this.requestNextFrameOrUpdate()}},configurable:!1}),Object.defineProperty(this,"stroke",{get:function(){return g},set:function(e){e!=g&&(g=e,this.requestNextFrameOrUpdate())},configurable:!1});function c(){var e,t;l||(e=this.host.attr("data-idd-xaxis"))&&(t=this.master.get(e))&&(l=t),d||(e=this.host.attr("data-idd-yaxis"))&&(t=this.master.get(e))&&(d=t)}this.renderCore=function(e,t){be.GridlinesPlot.prototype.renderCore.call(this,e,t),c.call(this);var i=this.getContext(!0);i.strokeStyle=g,i.fillStyle=g,i.lineWidth=1;var r,o=parseInt(h.slice(0,-2)),n=[];l&&(n=l.ticks);for(var a=0,s=n.length;a<s;a++)n[a].invisible||(r=l.getCoordinateFromTick(n[a].position),i.fillRect(r,0,o,t.height));n=[],d&&(n=d.ticks);for(a=0,s=n.length;a<s;a++)n[a].invisible||(r=t.height-1-d.getCoordinateFromTick(n[a].position),i.fillRect(0,r,t.width,o))},this.renderCoreSvg=function(e,t,i){c.call(this);var r,o={width:parseInt(h.slice(0,-2)),color:g},n=[];l&&(n=l.ticks);for(var a=0,s=n.length;a<s;a++)if(!n[a].invisible){if((r=l.getCoordinateFromTick(n[a].position))<0||r>t.width)continue;i.polyline([[r,0],[r,t.height-1]]).stroke(o).fill("none")}n=[],d&&(n=d.ticks);for(a=0,s=n.length;a<s;a++)if(!n[a].invisible){if((r=t.height-1-d.getCoordinateFromTick(n[a].position))<0||r>t.height)continue;i.polyline([[0,r],[t.width-1,r]]).stroke(o).fill("none")}}},be.GridlinesPlot.prototype=new be.CanvasPlot,be.BoundaryLinePlot=function(e,t){var d,h,g=this;this.base=be.CanvasPlot,this.base(e,t);var c="1px",u="Gray",f="";if(void 0===d&&void 0===h){var i=be.Utils.getDataSourceFunction(e,be.readCsv)(e);i&&(i.x?d=i.x:i.y&&(h=i.y),i.thickness&&(c=i.thickness),i.stroke&&(u=i.stroke),i.lineDash&&(f=i.lineDash))}var r={};be.Utils.readStyle(this.host,r),u=void 0!==r.stroke?r.stroke:u,c=void 0!==r.thickness?r.thickness:c,Object.defineProperty(this,"x",{get:function(){return d},set:function(e){e!=d&&(d=e,this.requestUpdateLayout())},configurable:!1}),Object.defineProperty(this,"y",{get:function(){return h},set:function(e){e!=h&&(h=e,this.requestUpdateLayout())},configurable:!1}),Object.defineProperty(this,"thickness",{get:function(){return c},set:function(e){if(e!=c){if(e<=0)throw"Boundary line thickness must be positive";c=e,this.requestNextFrameOrUpdate()}},configurable:!1}),Object.defineProperty(this,"stroke",{get:function(){return u},set:function(e){e!=u&&(u=e,this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"lineDash",{get:function(){return f},set:function(e){e!=f&&(f=e,this.requestNextFrameOrUpdate())},configurable:!1}),this.renderCore=function(e,t){be.BoundaryLinePlot.prototype.renderCore.call(this,e,t);var i=this.getContext(!0);i.strokeStyle=u,i.fillStyle=u,i.setLineDash(be.Utils.getArrayToSetLineDash(f,c)),i.lineWidth=parseInt(c);var r=g.getTransform(),o=r.dataToScreenX,n=r.dataToScreenY;if(i.font="10px serif",void 0!==d){var a=o(d);parseInt(c)%2&&(a+=.5),i.beginPath(),i.moveTo(a,0),i.lineTo(a,t.height),i.stroke(),i.translate(a-3,t.height-10),i.rotate(-Math.PI/2),this.name?i.fillText(this.name,0,0):i.fillText("x = "+d,0,0),i.rotate(Math.PI/2),i.translate(3-a,10-t.height)}if(void 0!==h){var s=n(h);parseInt(c)%2&&(s+=.5),i.beginPath(),i.moveTo(0,s),i.lineTo(t.width,s),i.stroke(),this.name?i.fillText(this.name,10,s-3):i.fillText("y = "+h,10,s-3)}},this.renderCoreSvg=function(e,t,i){var r=g.getTransform(),o=r.dataToScreenX,n=r.dataToScreenY,a={width:parseInt(c),color:u};if(void 0!==d){var s=o(d);0<s&&s<t.width&&(i.polyline([[s,0],[s,t.height-1]]).stroke(a).attr("stroke-dasharray",be.Utils.getArrayToSetLineDash(f,parseInt(c))).fill("none"),this.name?i.text(this.name,0,0).rotate(-90,0,0).translate(s-16,t.height-10).font({family:"serif",size:10,fill:u}):i.text("x = "+d,0,0).rotate(-90,0,0).translate(s-16,t.height-10).font({family:"serif",size:10,fill:u}))}if(void 0!==h){var l=n(h);0<l&&l<t.height&&(i.polyline([[0,l],[t.width-1,l]]).stroke(a).attr("stroke-dasharray",be.Utils.getArrayToSetLineDash(f,parseInt(c))).fill("none"),this.name?i.text(this.name).transform({x:10}).transform({y:l-18},!0).font({family:"serif",size:10,fill:u}):i.text("y = "+h).transform({x:10}).transform({y:l-18},!0).font({family:"serif",size:10,fill:u}))}},this.draw=function(e){void 0!==e.x&&(this.x=e.x),void 0!==e.y&&(this.y=e.y),void 0!==e.thickness&&(this.thickness=e.thickness),void 0!==e.stroke&&(this.stroke=e.stroke),this.invalidateLocalBounds(),this.requestNextFrameOrUpdate(),this.fireAppearanceChanged()}},be.BoundaryLinePlot.prototype=new be.CanvasPlot}();(be=be||{}).SubplotsTrapPlot=function(e,t){if(this.base=be.Plot,this.base(e,t),e){this.renderCallback=function(e){},this.suppressRenderCallback=!1,this.renderCore=function(e,t){if(be.SubplotsTrapPlot.prototype.renderCore.call(this,e,t),!this.suppressRenderCallback){var i=this.xDataTransform&&this.xDataTransform.plotToData?this.xDataTransform.plotToData:function(e){return e},r=this.yDataTransform&&this.yDataTransform.plotToData?this.yDataTransform.plotToData:function(e){return e},o=i(e.x),n=i(e.x+e.width),a=r(e.y),s=r(e.y+e.height),l={x_min:n<o?n:o,x_max:n<o?o:n,y_min:s<a?s:a,y_max:s<a?a:s};this.renderCallback(l)}},this.renderCoreSvg=function(e,t,i){}}},be.factory["subplots-trap"]=function(e,t){return new be.SubplotsTrapPlot(e,t)},be.SubplotsTrapPlot.prototype=new be.Plot,be.SubPlots=function(e){if(!e)throw"SubPlots must be applied to <div> element";if(1!==e.children.length&&2!==e.children.length)throw"SubPlots div must contain one or two child elements: optional element div (subplots title) and mandatory element table";var t=me(e).children().last()[0];if(!t)throw"SubPlots div should contain at least one <div> element";if(1!==t.children.length)throw"SubPlots child div must contain exactly one child element which is a <table>";var i=t.children[0];if(!i||"TABLE"!=i.nodeName)throw"SubPlots child div must contain exactly one child element which is a <table>";var R=t,B=i,F=e;if(me(F).css("flex-direction","column"),me(R).addClass("idd-subplots-legendholder"),2===e.children.length){var r=me(e).children()[0];me(r).addClass("idd-subplots-title")}var V=0,L=[],Z=[],z=[],Y=[],U=[],O=[],W=[],X=void 0,E=void 0,H=me(R).attr("data-idd-horizontal-binding"),K=me(R).attr("data-idd-vertical-binding");H=void 0!==H&&("true"===H||"enabled"===H),K=void 0!==K&&("true"===K||"enabled"===K);var j=this;this.renderSVG=function(){for(var e="div[data-idd-plot='plot']",t="div[data-idd-axis]",i="div.idd-subplot-title",r="div.idd-horizontalTitle",o="div.idd-verticalTitle",n="div.idd-legend",a="div.idd-subplots-title",s=me(F).find(e+", "+t+", "+i+", "+r+", "+o+", "+n+", "+a),l=[],d=document.createElementNS("http://www.w3.org/2000/svg","svg"),h=ye(d).size(me(F).width(),me(F).height()),g=h.nested(),c=[],u=[],f=me(F).offset(),p=0;p<s.length;p++){c[p]=me(s[p]).offset().left-f.left,u[p]=me(s[p]).offset().top-f.top+1;var v=me(s[p]);if(v.is(i+", "+r+", "+o+", "+a)){var m=h.text(s[p].innerText);if(l[p]=m.font({family:me(s[p]).css("font-family"),size:me(s[p]).css("font-size"),weight:me(s[p]).css("font-weight")}),v.is(o))switch(me(s[p]).css("vertical-align")){case"top":l[p].move(c[p],u[p]);break;case"bottom":l[p].move(c[p],u[p]+me(s[p]).height()-l[p].bbox().w),l[p].rotate(-90,c[p],u[p]+me(s[p]).height()-l[p].bbox().w);break;default:l[p].move(c[p],u[p]+me(s[p]).height()/2+l[p].bbox().w/2),l[p].rotate(-90,c[p],u[p]+me(s[p]).height()/2+l[p].bbox().w/2)}else switch(me(s[p]).css("text-align")){case"left":l[p].move(c[p],u[p]);break;case"right":l[p].move(c[p]+me(s[p]).width()-l[p].bbox().w,u[p]);break;default:l[p].move(c[p]+me(s[p]).width()/2-l[p].bbox().w/2,u[p])}}else{if(v.is(e)){var y=me(s[p]).parent().width(),b=me(s[p]).parent().height(),C=h.polyline("0,0 "+y+",0 "+y+","+b+" 0,"+b+" 0,0").fill("none");C.stroke({color:"#808080",width:1}).move(c[p],u[p]),C.attr("shape-rendering","crispEdges"),g.add(C);var w=be.asPlot(v);l[p]=w.exportToSvg(),c[p]+=parseFloat(me(s[p]).css("border-left-width").replace("px","")),u[p]+=parseFloat(me(s[p]).css("border-top-width").replace("px",""))}else if(v.is(t))l[p]=v[0].axis.exportToSvg();else{if(!v.is(n))throw"Unexpected element type. SVG export failure";l[p]=L[X][E].exportLegendToSvg(v[0])}l[p].move(c[p],u[p])}g.add(l[p])}return h},function(){var e=me("tr",B);V=e.length,L=new Array(V/3),Z=new Array(V/3),W=new Array(V/3),O=new Array(V/3);function l(e,t,i){var r=me("div[data-idd-axis]",i),o=r.length;if(0<o)if(1<o)console.warn("subplots: work with multiple axes in a single slot is not implemented");else{var n=be.InitializeAxis(r);z.push(n),U.push([e,t]);var a=e%3==1;Y.push(a);var s=Math.floor(e/3),l=Math.floor(t/3);n.associatedPlotRow=s,n.associatedPlotCol=l,a?W[s][l]=n:O[s][l]=n}}e.each(function(a){var e=me("td",this);if(_NCol=e.length,(a-1)%3==0){var s=Math.floor(a/3);L[s]=new Array(_NCol/3),Z[s]=new Array(_NCol/3),W[s]=new Array(_NCol/3),O[s]=new Array(_NCol/3),e.each(function(e){if((e-1)%3==0){var t=me("div[data-idd-plot='plot']",this);if(0<t.length){var i=Math.floor(e/3),r=be.asPlot(t);(L[s][i]=r).subplotRowIdx=s,r.subplotColIdx=i,Z[s][i]=be.asPlot(me("div[data-idd-plot='subplots-trap']",this));var o={};if(be.Utils.readStyle(t,o),o,"true"===(void 0!==o.isLegendVisible?o.isLegendVisible:"true")){var n=me("<div style='z-index: 10;'></div>").appendTo(t);new be.Legend(r,n,!0);n.css("float","right"),be.Gestures.FullEventList.forEach(function(e){n[0].addEventListener(e,function(e){e.stopPropagation()},!1)})}}}else l(a,e,this)})}else e.each(function(e){l(a,e,this)})});var t={},i=void 0;(t=be.Utils.readStyle(me(R),t))&&t["subplots-margin"]?(i=t["subplots-margin"],me(R).find("td div.idd-subplots-margin-left").css("padding-left",i),me(R).find("tr").find("td div.idd-subplots-margin-left:first").css("padding-left",""),me(R).find("td div.idd-subplots-margin-bottom").css("padding-bottom",i),me(R).find("tr").last().find("td div.idd-subplots-margin-bottom").css("padding-bottom","")):i=me(R).find("td div.idd-axis").parent().css("padding-left");var r=R.getAttribute("data-idd-ext-legend");if(r){var o=r.split(" ");if(3!==o.length)throw"data-idd-ext-legend attribute bust contain string in format 'placement plotRowIdx plotColIdx'";var n=o[0];X=parseInt(o[1]),E=parseInt(o[2]);var a=L[X][E],s=me("<div></div>");switch(n.trim().toLowerCase()){case"left":case"top":s.prependTo(R);break;case"right":case"bottom":s.appendTo(R);break;default:throw"Unexpected external legend placement"}switch(n.trim().toLowerCase()){case"left":me(R).css("flex-direction","row"),i&&s.css("margin-right",i);break;case"right":me(R).css("flex-direction","row"),i&&s.css("margin-left",i);break;case"top":me(R).css("flex-direction","column"),i&&s.css("margin-bottom",i);break;case"bottom":me(R).css("flex-direction","column"),i&&s.css("margin-top",i);break;default:throw"Unexpected external legend placement"}new be.Legend(a,s,!1,void 0,!0)}for(var d=0;d<z.length;d++){var h=z[d],g=U[d][0],c=U[d][1],u=Math.floor(g/3),f=Math.floor(c/3),p=L[u][f];h.dataTransform=g%3==1?p.yDataTransform:p.xDataTransform}me("div[data-idd-plot='grid']",B).each(function(e){var t=this.plot,i=t.master,r=i.subplotRowIdx,o=i.subplotColIdx,n=O[r][o];if(n)t.xAxis=n;else if(H){var a=function(e,t){for(var i=0;i<e.length;i++)if(e[i]&&e[i][t])return i;return-1}(O,o);-1!==a&&(t.xAxis=O[a][o])}var s=W[r][o];if(s)t.yAxis=s;else if(K){var l=function(e){for(var t=0;t<e.length;t++)if(e[t])return t;return-1}(W[r]);-1!==l&&(t.yAxis=W[r][l])}});for(d=0;d<L.length;d++)for(var v=L[d],m=0;m<v.length;m++){if(p=v[m]){var y=me(p.host).attr("data-idd-navigation-enabled");if(y&&"true"===y){var b=me(p.host);b.dblclick(function(){this.plot.master.fitToView()});var C=p.master.subplotRowIdx,w=p.master.subplotColIdx,I=be.Gestures.getGesturesStream(b),A=O[C][w];if(A){var x=A.host,T=be.Gestures.applyHorizontalBehavior(be.Gestures.getGesturesStream(x));I=I.merge(T),x.dblclick(function(){var e=this.axis;L[e.associatedPlotRow][e.associatedPlotCol].fitToViewX()})}var S=W[C][w];if(S){x=S.host;var P=be.Gestures.applyVerticalBehavior(be.Gestures.getGesturesStream(x));I=I.merge(P),x.dblclick(function(){var e=this.axis;L[e.associatedPlotRow][e.associatedPlotCol].fitToViewY()})}p.navigation.gestureSource=I}}}function k(e){if(!M){M=!0,yRange={min:e.y_min,max:e.y_max},xRange={min:e.x_min,max:e.x_max};var t=this.master,i=t.subplotRowIdx,r=t.subplotColIdx;if(!H){var o=O[i][r];o&&o.update(xRange)}if(!K){var n=W[i][r];n&&n.update(yRange)}for(var a=0;a<z.length;a++){var s=z[a];Y[a]&&K?s.update(yRange):!Y[a]&&H&&s.update(xRange)}if(H||K)for(a=0;a<L.length;a++)for(var l=L[a],d=0;d<l.length;d++){var h=l[d];if(h!==this.master){var g=h.visibleRect;H&&(g.x=e.x_min,g.width=e.x_max-e.x_min),K&&(g.y=e.y_min,g.height=e.y_max-e.y_min),h.navigation.setVisibleRect(g,!1,{suppressNotifyBoundPlots:!0,forceOnlyUpdatePlotsOutput:!0,syncUpdate:!0})}}M=!1}}var M=!1;for(d=0;d<Z.length;d++)for(v=Z[d],m=0;m<v.length;m++){var D=v[m];D&&(D.renderCallback=k)}function G(e,t){for(var i=0;i<L.length;i++)for(var r=0;r<L[i].length;r++)for(var o=L[i][r].getPlotsSequence(),n=0;n<o.length;n++)0<t.name.length&&o[n].name===t.name&&o[n].isVisible!==t.isVisible&&(o[n].isVisible=t.isVisible)}var N=me(R).attr("data-idd-common-visibility");if(N&&("true"===N||"enabled"===N))for(d=0;d<L.length;d++)for(m=0;m<L[d].length;m++)L[d][m]&&L[d][m].host.bind("visibleChanged",G);F.subplots=j}()},be.asSubPlots=function(e){return e&&void 0!==e.subplots?e.subplots:new be.SubPlots(e)},be.readTable=function(e){var i={};be.Utils.readStyle(e,i);var t=e.children("table:first-child");if(t&&0<t.length){t.toggle();var r=t.children("tbody").children("tr");if(r&&0<r.length){var o=r.first(),n=[];o.children("th").each(function(e){var t=me(this).text();n[e]=t,i[t]=[]});var a=r.toArray();if(a)for(var s=a.length,l=n.length,d=1;d<s;d++)for(var h=me(a[d]).children("td").toArray(),g=0;g<l;g++)i[n[g]][d-1]=parseFloat(me(h[g]).text())}}return i},be.Utils.getAndClearTextContent=function(e){e[0].normalize();var t=e.contents().filter(function(){return 3==this.nodeType&&!(!this.data||""==this.data.trim())})[0];if(t&&t.data){var i=t.wholeText;return void 0!==t.replaceWholeText?t.replaceWholeText(""):t.data="",i}},be.readCsv=function(e){var t={};be.Utils.readStyle(e,t);var i=be.Utils.getAndClearTextContent(e);if(i){function r(e){return e.split(/\s+/g)}var o=(i=i.trim()).split(/\n/g),n=o.length-1;if(0<n){for(var a=r(o[0]),s=a[0]?0:1,l=s;l<a.length;l++)t[a[l-s]]=[];for(var d=0;d<n;d++){var h=r(o[d+1]);for(l=s=h[0]?0:1;l<h.length;l++){var g=parseFloat(h[l]);isNaN(g)?t[a[l-s]][d]=h[l]:t[a[l-s]][d]=g}}for(l=0;l<a.length;l++){var c=a[l].split(".");1<c.length&&(t[c[0]]||(t[c[0]]={}),t[c[0]][c[1]]=t[a[l]],delete t[a[l]])}}}return t},be.readCsv2d=function(e){var t={};be.Utils.readStyle(e,t);var i=be.Utils.getAndClearTextContent(e);if(i){function r(e){return e.trim().split(/\s+/g)}var o=(i=i.trim()).split(/\n/g),n=o.length-1;if(0<n){var a=r(o[0]),s=a.length-1;if(0<s){for(var l=new Array(s),d=new Array(n),h=new Array(s),g=1;g<=s;g++)h[g-1]=new Array(n),l[g-1]=parseFloat(a[g]);for(var c=1;c<=n;c++){var u=r(o[c]);d[c-1]=parseFloat(u[0]);for(g=1;g<=s;g++)h[g-1][c-1]=parseFloat(u[g])}t.x=l,t.y=d,t.values=h}}}return t},be.readBase64=function(e){function t(e){var t=e[0].split("."),i=t[0];switch(t[1]){case"1D":if("string"==i)return s=e[1].split(",").map(atob);var r=be.Utils.base64toByteArray(e[1]);return s=be.Utils.byteArrayToTypedArray(r,i);case"2D":var o=parseInt(e[1]),n=(r=be.Utils.base64toByteArray(e[2]),be.Utils.byteArrayToTypedArray(r,i));if(n.length%o!=0)throw"InnerDimLen is not divisor of decoded flattened array len";for(var a=n.length/o,s=new Array(a),l=0;l<a;l++)s[l]=n.slice(l*o,(l+1)*o);return s;default:throw"Unexpected dimensionality specified ("+e[0]+")"}}var i={};be.Utils.readStyle(e,i);var r=be.Utils.getAndClearTextContent(e);if(r)for(var o=(r=r.trim()).split(/\n/g),n=o.length,a=0;a<n;a++){var s=o[a].trim().split(/\s+/g),l=s[0];s.splice(0,1);var d=t(s);i[l]=d}return i},be.InitializeAxis=function(e,t){if(e.hasClass("idd-axis"))throw"The div element already is initialized as an axis";switch(e.attr("data-idd-axis")){case"numeric":return e.axis=new be.NumericAxis(e),e.axis;case"log":return e.axis=new be.LogarithmicAxis(e),e.axis;case"labels":if(void 0===t)t=be.Utils.getDataSourceFunction(e,be.readCsv)(e);return e.axis=new be.LabelledAxis(e,t),e.axis}},be.TicksRenderer=function(r,e){if("undefined"!=typeof Modernizr&&r&&(Modernizr.canvas||r.replaceWith('<div">Browser does not support HTML5 canvas</div>')),!r||!r.hasClass("idd-axis")){r&&(r[0].axis=this);var S=this,P=r,k="";r&&(k=r.attr("data-idd-placement"));var M,D,G,o,N,R="top"==k||"bottom"==k,B={min:0,max:1},F=e,V=[],t=be.Utils.generateNextIntId(),L=me("<canvas id='canvas_"+t+"' style='position:relative; float:left'></canvas>"),Z=me("<div id='labelsDiv_"+t+"' style='position:relative; float:left'></div>");if(r){"bottom"==k||"right"==k?(r[0].appendChild(L[0]),r[0].appendChild(Z[0])):(r[0].appendChild(Z[0]),r[0].appendChild(L[0]));var z=be.tickLength+1;R?L[0].height=z:(L[0].width=z,"right"==k?Z.css("left",3):L.css("left",3))}this.updateSize=function(){var e=G;if(r){var t=r.outerWidth(!1),i=r.outerHeight(!1);R?(G=M=t)!=e&&(L[0].width=G,Z.css("width",M)):(G=D=i)!=e&&(L[0].height=G,Z.css("height",D))}o=(G-1)/(B.max-B.min),L[0].height};var Y=-1,U=be.tickLength/3,O=P?P.css("color"):"Black",W=L.get(0).getContext("2d");W.strokeStyle=O,W.fillStyle=O,W.lineWidth=1;var x=12,T=!1,i="";P&&(P[0].currentStyle?(x=P[0].currentStyle["font-size"],i=P[0].currentStyle["font-family"]):document.defaultView&&document.defaultView.getComputedStyle?(x=document.defaultView.getComputedStyle(P[0],null).getPropertyValue("font-size"),i=document.defaultView.getComputedStyle(P[0],null).getPropertyValue("font-family")):P[0].style&&(x=P[0].style["font-size"],i=P[0].style["font-family"]),W.font=x+i),Object.defineProperty(this,"host",{get:function(){return P},configurable:!1}),Object.defineProperty(this,"mode",{get:function(){return k},configurable:!1}),Object.defineProperty(this,"tickSource",{get:function(){return F},set:function(e){F=e,Z.empty(),n()},configurable:!1}),Object.defineProperty(this,"range",{get:function(){return B},configurable:!1}),Object.defineProperty(this,"ticks",{get:function(){return V},configurable:!1}),Object.defineProperty(this,"DesiredSize",{get:function(){return{width:M,height:D}},configurable:!1}),Object.defineProperty(this,"axisSize",{get:function(){return G},configurable:!1}),Object.defineProperty(this,"deltaRange",{get:function(){return o},configurable:!1}),Object.defineProperty(this,"FontSize",{get:function(){return _defaultFontSize},set:function(e){T=!0,x=e+"px",W.font=x+i,F.invalidate(),S.update()},configurable:!1}),Object.defineProperty(this,"rotateAngle",{get:function(){return N/Math.PI*180},set:function(e){N=e*Math.PI/180,F.invalidate(),S.update()},configurable:!1}),this.sizeChanged=!0;var X=void 0;Object.defineProperty(this,"dataTransform",{get:function(){return X},set:function(e){X=e,n()},configurable:!1});function E(e){var t,i,r,o=e.length;K=new Array(o);for(var n=0;n<o;n++){var a=e[n];if(a.label){if(i=(t=a.label._size).width,r=t.height,0==i||0==r){var s=F.getInner(a.position);if("string"==typeof s){var l=W.measureText(s);i=l.width,r=l.height}else{var d=me("<div></div>").append(me(s)).css({display:"block",visibility:"hidden",position:"absolute"}).appendTo(me("body"));i=d.width(),r=d.height(),d.remove()}}var h=N?i*Math.abs(Math.cos(N))+r*Math.abs(Math.sin(N)):i,g=N?i*Math.abs(Math.sin(N))+r*Math.abs(Math.cos(N)):r;K[n]={position:S.getCoordinateFromTick(a.position),width:h,height:g,hasLabel:!0}}else K[n]={position:S.getCoordinateFromTick(a.position),width:0,height:0,hasLabel:!1}}}function H(e){var t,i,r=e.length-1;if(j(e),E(e),-1==r)return 1;for(var o=0,n=0;n<r;){for(o=n,n++;n<1+r&&!K[n].hasLabel;)n++;if(r<n)break;if(K[o].hasLabel){if((t=Math.abs(K[n].position-K[o].position))<be.minTickSpace)return-1;if(R?(i=(K[o].width+K[n].width)/2,0==o&&K[o].position-K[o].width/2<0?i-=K[o].width/2:n==r-1&&K[n].position-K[n].width/2>G&&(i-=K[n].width/2)):(i=(K[o].height+K[n].height)/2,0==o&&K[o].position-K[o].height/2<0?i-=K[o].height/2:n==r-1&&K[n].position-K[n].height/2>G&&(i-=K[n].height/2)),t-i<be.minLabelSpace)return-1}}var a=1;for(o=n=0;n<r;){for(o=n,n++;n<1+r&&!K[n].hasLabel;)n++;if(r<n)break;if(K[o].hasLabel&&(t=Math.abs(K[n].position-K[o].position),R?(i=(K[o].width+K[n].width)/2,0==o&&K[o].position-K[o].width/2<0?i-=K[o].width/2:n==r-1&&K[n].position-K[n].width/2>G&&(i-=K[n].width/2)):(i=(K[o].height+K[n].height)/2,0==o&&K[o].position-K[o].height/2<0?i-=K[o].height/2:n==r-1&&K[n].position-K[n].height/2>G&&(i-=K[n].height/2)),t-i<be.minLabelSpace)){a=0;break}}return a}var K=[];this.getCoordinateFromTick||(this.getCoordinateFromTick=function(e){return e});var n=function(){if(S.updateSize(),X){var e=X.plotToData(B.min),t=X.plotToData(B.max);V=F.getTicks({min:Math.min(e,t),max:Math.max(e,t)})}else V=F.getTicks(B);var i,r,o=H(V),n=0;if(-1==o)for(;n++<be.maxTickArrangeIterations&&(i=F.decreaseTickCount(),r=H(i),V=i,-1==r););if(1==o)for(;n++<be.maxTickArrangeIterations;){if(i=F.increaseTickCount(),-1==(r=H(i))){V=F.decreaseTickCount(),E(V),j(V);break}if(V=i,0==r)break}N&&(V=F.updateTransform(o,N,R)),F.getMinTicks&&(-1==r&&n>be.maxTickArrangeIterations||V.length<2)&&0<(i=F.getMinTicks()).length&&(j(V=i),E(V)),2==V.length&&(j(V),E(V),2!=V.length||K[1].position-K[0].position-(R?(K[0].width+K[1].width)/2:(K[0].height+K[1].height)/2)<be.minLabelSpace&&0);var a,s=V.length,l=Y;if(Y=0,this.sizeChanged=!1,R){for(var d=0;d<s;d++)Y=Math.max(Y,K[d].height);Y!=l&&0!=Y&&(Z.css("height",Y),L[0].height=z,D=Y+z,P.css("height",D),this.sizeChanged=!0)}else{for(d=0;d<s;d++)Y=Math.max(Y,K[d].width);Y!=l&&0!=Y&&(Z.css("width",Y),L[0].width=z,M=Y+z+3,P.css("width",M),this.sizeChanged=!0)}W.strokeStyle=O,W.fillStyle=O,R?(W.clearRect(0,0,G,z),"bottom"==k?W.fillRect(0,0,G,1):W.fillRect(0,be.tickLength,G,1)):(W.clearRect(0,0,z,G),"right"==k?W.fillRect(0,0,1,G):W.fillRect(be.tickLength,0,1,G));for(d=0;d<s;d++){var h=V[d],g=K[d];a=g.position;var c=void 0,u=void 0;0<d&&(u=K[d-1]),d<s-1&&(c=K[d+1]);var f=u&&c&&!u.hasLabel&&!c.hasClass&&g.hasLabel&&h.invisible;if(R){if(h.invisible||W.fillRect(a,1,1,be.tickLength),h.label){var p=void 0,v=g.width,m=h.label._size.width;if(f)if(u.position<0)if(c.position>=v)p=(C=.5*(0+c.position))-.5*m;else p=c.position-.5*(v+m);else if(c.position>G){if(G-u.position>=v)p=(C=.5*(u.position+G))-.5*m;else p=u.position-.5*(m-v)}else p=a-m/2;else p=a-m/2;h.label.css("left",p)}}else if(a=G-1-a,V[d].invisible||W.fillRect(1,a,be.tickLength,1),h.label){var y=g.height,b=h.label._size.height;if(f)if(u.position<0)if(c.position>=y){var C=.5*(0+c.position),w=G-1-(I=C+.5*b);h.label.css("top",w)}else{var I=c.position-.5*(y-b);w=G-1-I;h.label.css("top",w)}else if(c.position>G)if(G-u.position>=y){C=.5*(u.position+G),w=G-1-(I=C+.5*b);h.label.css("top",w)}else{I=u.position+.5*(y+b),w=G-1-I;h.label.css("top",w)}else h.label.css("top",a-b/2);else h.label.css("top",a-b/2)}}var A=F.getSmallTicks(V);if(0<A.length){for(var x=Math.abs(S.getCoordinateFromTick(A[1])-S.getCoordinateFromTick(A[0])),T=1;T<A.length-1;T++)x=Math.min(x,Math.abs(S.getCoordinateFromTick(A[T+1])-S.getCoordinateFromTick(A[T])));if(x>=be.minTickSpace)for(d=0,s=A.length;d<s;d++)a=S.getCoordinateFromTick(A[d]),"bottom"==k?W.fillRect(a,1,1,U):"top"==k?W.fillRect(a,be.tickLength-U,1,U):"left"==k?W.fillRect(be.tickLength-U,G-1-a,U,1):"right"==k&&W.fillRect(1,G-1-a,U,1)}};this.renderToSvg=function(e){function t(e,t,i){d+="M"+e+" "+t+"h"+i}function i(e,t,i){d+="M"+e+" "+t+"v"+i}var r,o,n,a,s=S.host.height(),l=S.host.width(),d="";if(R?(r=D-1,"bottom"==k?(t(0,0,G),be.tickLength):t(0,r,G)):(r=M-1,"right"==k?(i(0,0,G),be.tickLength):i(r,0,G)),e.size(l,s),0<(A=V.length)){var h=void 0;for(p=0;p<V.length;p++)if(V[p]&&V[p].label){h=V[p].label[0];break}a=(v=window.getComputedStyle(h,null))?v.getPropertyValue("font-family"):void 0,n=T?x:v?parseFloat(v.getPropertyValue("font-size")):void 0}for(var g=S.host.offset(),c=Z.offset(),u=c.left-g.left,f=c.top-g.top,p=0;p<A;p++)if(o=K[p].position,V[p].label||!(o<0||G<o)){K[p].width;if(R){if(V[p].invisible||("top"==k?i(o,r,-be.tickLength):i(o,0,be.tickLength)),V[p].label){var v=V[p].label instanceof jQuery?window.getComputedStyle(V[p].label[0],null):window.getComputedStyle(V[p].label,null),m=parseFloat(v.getPropertyValue("Left")),y=0;V[p].label.normalShift&&(y=V[p].label.normalShift),(b=F.renderToSvg(V[p],e).font({family:a,size:n})).transform({x:m+u}),b.transform({y:y+f-1},!0),N&&b.transform({rotation:S.rotateAngle},!0)}}else if(o=G-1-o,V[p].invisible||("left"==k?t(r,o,-be.tickLength):t(0,o,be.tickLength)),V[p].label){v=V[p].label instanceof jQuery?window.getComputedStyle(V[p].label[0],null):window.getComputedStyle(V[p].label,null),m=0;V[p].label.normalShift&&(m=V[p].label.normalShift);var b;y=parseFloat(v.getPropertyValue("Top"));(b=F.renderToSvg(V[p],e).font({family:a,size:n})).transform({x:m+u}),b.transform({y:y+f},!0),N&&b.transform({rotation:S.rotateAngle},!0)}}var C=F.getSmallTicks(V);if(0<C.length){for(var w=Math.abs(S.getCoordinateFromTick(C[1])-S.getCoordinateFromTick(C[0])),I=1;I<C.length-1;I++)w=Math.min(w,Math.abs(S.getCoordinateFromTick(C[I+1])-S.getCoordinateFromTick(C[I])));if(w>=be.minTickSpace){p=0;for(var A=C.length;p<A;p++)o=S.getCoordinateFromTick(C[p]),"bottom"==k?i(o,0,U):"top"==k?i(o,r,-U):"left"==k?t(r,G-o,-U):"right"==k&&t(.5,G-o,U)}}e.path(d).stroke(O).fill("none")},this.exportToSvg=function(){if(!ye.supported)throw"SVG is not supported";var e=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=ye(e).size(P.width(),P.height());return S.renderToSvg(t),t};var j=function(e){for(var t,i=0,r=e.length;i<r;i++)if((t=e[i].label)&&!t.hasClass("idd-axis-label")){var o=t[0];Z[0].appendChild(o),t.addClass("idd-axis-label"),t._size={width:o.offsetWidth,height:o.offsetHeight},T&&t.css("fontSize",x)}};this.update=function(e){e&&(B=e),n()},this.destroy=function(){P[0].innerHTML="",P.removeClass("idd-axis"),P.removeClass("unselectable")},this.remove=function(){var e=P[0].parentElement;if(e){e.removeChild(P[0]);var t=e.parentElement;t&&("idd-plot-master"==t.className||t.classList&&t.classList.contains("idd-plot-master"))&&t.plot.removeDiv(e)}this.destroy()},r&&(n(),r.addClass("idd-axis"),r.addClass("unselectable"))}},be.NumericAxis=function(e){this.base=be.TicksRenderer;e[0].axis=this;var t=!0;this.getCoordinateFromTick=function(e){var t=this.deltaRange;if(isFinite(t)){var i=e,r=this.dataTransform;return r&&(i=r.dataToPlot(e)),(i-this.range.min)*t}return this.axisSize/2};var i=e.attr("data-idd-scientific-notation");void 0!==i&&"false"!=i&&"disable"!=i&&"disabled"!=i||(t=!1),this.base(e,new be.NumericTickSource(t))},be.NumericAxis.prototype=new be.TicksRenderer,be.LogarithmicAxis=function(e){this.base=be.TicksRenderer,this.getCoordinateFromTick=function(e){var t=this.deltaRange;return isFinite(t)?(be.Utils.log10(e)-this.range.min)*t:this.axisSize/2},this.base(e,new be.LogarithmicTickSource)},be.LogarithmicAxis.prototype=new be.TicksRenderer,be.LabelledAxis=function(e,t){this.base=be.TicksRenderer;var l=this,i=!0;this.getCoordinateFromTick=function(e){var t=this.deltaRange;if(isFinite(t)){var i=e;return this.dataTransform&&(i=this.dataTransform.dataToPlot(e)),(i-this.range.min)*t}return this.axisSize/2},this.updateLabels=function(e){this.tickSource=new be.LabelledTickSource(e),this.rotateAngle=e&&e.rotateAngle?e.rotateAngle:0};var r=e.attr("data-idd-force-labels-visibility");return void 0!==r&&"false"!=r&&"disable"!=r&&"disabled"!=r||(i=!1),void 0===t&&(t={}),t.forceLabelsVisibility=i,this.base(e,new be.LabelledTickSource(t)),this.rotateAngle=t&&t.rotateAngle?t.rotateAngle:0,this.getToolTip=function(e){function t(e){return l.dataTransform?l.dataTransform(e):e}for(var i=t(e),r=void 0,o=void 0,n=0;n<l.ticks.length;n++){var a=l.ticks[n];if(!a.text){var s=t(a.position);i<s&&!o&&(o=n),s<i&&(r=n)}}if(o&&!r){if(l.ticks[o-1]&&l.ticks[o-1].text)return l.ticks[o-1].text}else if(r&&!o){if(l.ticks[r+1]&&l.ticks[r+1].text)return l.ticks[r+1].text}else if(r&&o&&o-r==2)return l.ticks[r+1].text},this},be.LabelledAxis.prototype=new be.TicksRenderer,be.TickSource=function(){var s=[],l=[],d=[],h=[],g=0;this.start,this.finish,this.precision=3,this.insertNumericTick=function(e,t,i){if(e.empty(),"string"==typeof t&&i){var r=parseFloat(t);isNaN(r)?e.text(t):Math.abs(r)<Math.pow(10,-2)||Math.abs(r)>=Math.pow(10,3)?e.append(be.Utils.getInScientificNotation(r)):e.text(r)}else e.append(t)},this.getDiv=function(e,t){var i,r=void 0!==t&&t,o=this.getInner(e);if(-1!=(i=d.indexOf(o))){l[i]=!0,h[i].display="block";var n=s[i][0];return s[i]._size={width:n.offsetWidth,height:n.offsetHeight},s[i]}if(-1!=(i=l.indexOf(!1))){l[i]=!0,h[i].display="block",d[i]=o;var a=s[i];this.insertNumericTick(a,o,r);n=a[0];return a._size={width:n.offsetWidth,height:n.offsetHeight},s[i]}a=me("<div></div>");return this.insertNumericTick(a,o,r),l[g]=!0,s[g]=a,d[g]=o,h[g]=a[0].style,a._size=void 0,g++,a},this.getInner=function(e){if(e)return e.toString()},this.invalidate=function(){for(var e=0;e<s.length;e++)s[e].remove();l=[],s=[],d=[],h=[],g=0},this.refreshDivs=function(){for(var e=0;e<g;e++)l[e]?l[e]=!1:h[e].display="none"},this.getTicks=function(e){this.start=e.min,this.finish=e.max},this.decreaseTickCount=function(){},this.increaseTickCount=function(){}},be.Utils.round=function(e,t){if(t<=0)return 15<-t?parseFloat(e.toFixed(15)):parseFloat(e.toFixed(-t));var i=Math.pow(10,t-1);return Math.round(e/i)*i},be.Utils.getInScientificNotation=function(e,t,i){var r=0,o=Math.abs(e),n=e<0?-1:1,a=void 0===t?3:t,s=void 0!==i&&i;if(1<o){for(var l=o;10<=l&&l%10==0;)r++,l/=10;r<a?r=0:(r=Math.floor(Math.log10(o)),o/=Math.pow(10,Math.floor(Math.log10(o))))}else if(o<=1&&0<o)if(-1*a<(r=Math.floor(Math.log10(o))))r=0;else{r=Math.floor(Math.log10(o)),o/=Math.pow(10,Math.floor(Math.log10(o)));o=Math.round(1e6*o)/1e6}var d="";return 0!=o?d+=n*o:d="0",0!=r&&(d+="&#215;10<sup>"+r+"</sup>"),s?{m:n*o,pow:r}:d},be.NumericTickSource=function(e){var d,h;this.base=be.TickSource,this.base(),this.isScientific=void 0!==e&&e;var g=this;this.getInner=function(e,t){var i=void 0===t?be.minNumOrder:t;return 0==e?e.toString():i<=h?be.Utils.round(e/Math.pow(10,h),-1)+"e+"+h:be.Utils.round(e,h).toString()},this.getMPow=function(e,t){return 0==e?{m:e,pow:0}:(void 0===t?3:t)<=h?{m:be.Utils.round(e/Math.pow(10,h),-1),pow:h}:{m:be.Utils.round(e,h),pow:0}},this.getTicks=function(e){return be.NumericTickSource.prototype.getTicks.call(this,e),d=1,h=Math.floor(be.Utils.log10(this.finish-this.start)),t()},this.renderToSvg=function(e,t){if(g.isScientific){var i=be.Utils.getInScientificNotation(e.position,3,!0);return t.text(function(e){e.tspan(i.m).dy(18),0!=i.pow&&(e.tspan(""),e.tspan("10"),e.tspan(i.pow).style("font-size","0.8em").dy(-10))})}return t.text(g.getInner(e.position))};var t=function(){var e=[];if(g.start>g.finish)return e;if(isFinite(h))for(var t,i=d*Math.pow(10,h),r=Math.floor(g.start/i),o=Math.floor(g.finish/i)-r+2,n=0,a=r*i,s=0;s<o;s++)(t=a+s*i)>=g.start&&t<=g.finish&&(e[n]={position:t,label:g.getDiv(t,g.isScientific)},n++);else e[0]={position:g.start,label:g.getDiv(g.start,g.isScientific),invisible:!0};return g.refreshDivs(),e};this.decreaseTickCount=function(){return 1==d?d=2:2==d?d=5:5==d&&(d=1,h++),t()},this.increaseTickCount=function(){return 1==d?(d=5,h--):2==d?d=1:5==d&&(d=2),t()},this.getSmallTicks=function(e){var t=[],i=0;if(1<e.length){var r=e[0].position,o=Math.abs(e[1].position-r)/10;for(r-=o;r>this.start&&i<10;)t[i]=r,i++,r-=o;for(var n=e.length,a=0;a<n-1;a++){r=e[a].position+o;for(var s=0;s<9;s++)t[i]=r,i++,r+=o}r=e[n-1].position+o;for(var l=0;r<this.finish&&l<10;)t[i]=r,i++,r+=o,l++}return t},this.getMinTicks=function(){var e=[];if(h=Math.floor(be.Utils.log10(this.finish-this.start)),isFinite(h)){var t=Math.pow(10,h),i=Math.floor(g.start/t)*t;i<g.start&&(i+=t);var r=Math.floor(g.finish/t)*t;if(r>g.finish&&(r-=t),i!=r)e[0]={position:i,label:g.getDiv(be.Utils.round(i,h))},e[1]={position:r,label:g.getDiv(be.Utils.round(r,h))};else{h--,t=(d=5)*Math.pow(10,h),i=Math.floor(g.start/t);for(var o,n=Math.floor(g.finish/t)-i+2,a=0,s=i*t,l=0;l<n;l++)(o=s+l*t)>=g.start&&o<=g.finish&&(e[a]={position:o,label:g.getDiv(be.Utils.round(o,h))},a++)}}else e[0]={position:g.start,label:g.getDiv(g.start),invisible:!0};return this.refreshDivs(),e}},be.NumericTickSource.prototype=new be.TickSource,be.LogarithmicTickSource=function(){this.base=be.TickSource,this.base();var d,h,g=this,c=1,s=10;this.getInner=function(e){if(Math.abs(e)<be.minLogOrder)return Math.pow(10,e).toString();var t="10<sup>"+e+"</sup>",i=document.createElement("span");return i.innerHTML=t,i},this.renderToSvg=function(e,t){var i=e.position;return t.text(i.toString())},this.getTicks=function(e){return be.LogarithmicTickSource.prototype.getTicks.call(this,e),d=Math.pow(10,this.start),h=Math.pow(10,this.finish),t()};var t=function(){var e=[];if(isFinite(Math.pow(10,-g.start))&&isFinite(h))if(d==h)e[0]={position:g.start,label:g.getDiv(g.start),invisible:!0};else for(var t=g.start/c|0,i=(g.finish/c|0)-t+3,r=(t-1)*c,o=Math.pow(10,r),n=0,a=0;a<i;a++)d<=o&&o<=h&&(e[n]={position:o,label:g.getDiv(r)},n++),r+=c,o*=s;return g.refreshDivs(),e};this.decreaseTickCount=function(){return c*=2,s=Math.pow(10,c),t()},this.increaseTickCount=function(){return 1<c&&(c/=2,s=Math.pow(10,c)),t()},this.getSmallTicks=function(e){var t=[],i=isFinite(Math.pow(10,-g.start))&&isFinite(h),r=0;if(0<e.length&&1==c&&i){var o=e[0].position,n=o/10;for(o-=n;d<o&&r<10;)t[r]=o,r++,o-=n;for(var a=e.length,s=0;s<a-1;s++){o=e[s].position,o+=n=(e[s+1].position-o)/10;for(var l=0;l<9;l++)t[r]=o,r++,o+=n}for(o=e[a-1].position,o+=n=o;o<h;)t[r]=o,r++,o+=n}return t},this.getMinTicks=function(){var e=[];return isFinite(Math.pow(10,-g.start))&&isFinite(h)?d==h&&(e[0]={position:g.start,label:g.getDiv(g.start),invisible:!0},this.refreshDivs()):(e[0]={position:1,label:g.getDiv(0)},this.refreshDivs()),e}},be.LogarithmicTickSource.prototype=new be.TickSource,be.LabelledTickSource=function(e){this.base=be.TickSource,this.base();var c=this,u=[],f=[],p=!1;if(e&&e.forceLabelsVisibility&&(p=e.forceLabelsVisibility),e&&e.labels){for(var t=e.labels.length,i=0;i<t;i++)u[i]=e.labels[i].toString();if(e.ticks)f=e.ticks;else for(i=0;i<t;i++)f[i]=i}var v,m,y=1,b=0<f.length-u.length;this.getInner=function(e){if("string"!=typeof e||-1===e.indexOf("\n"))return e.toString();var t=document.createElement("span");return t.title=e,t.innerText=e,me(t).css("white-space","pre"),t},this.renderToSvg=function(e,t){var i=e.text?e.text:"";return t.text(i)},this.getTicks=function(e){if(be.LabelledTickSource.prototype.getTicks.call(this,e),y=1,!b){var t=0,i=f.length-1,r=0|this.start;if(r>f[t])for(;1<i-t;){var o=Math.round((t+i)/2);f[o]<r?t=o:i=o}if(v=t,t=0,i=f.length-1,(r=1|this.finish)<f[i])for(;1<i-t;){o=Math.round((t+i)/2);f[o]<r?t=o:i=o}if(v<(m=i))for(var n=(f.length-1)/(m-v);y<n;)y*=2}return C()};var C=function(){var e=[];if(b){for(var t=0;f[t]<c.start;)t++;0<t&&t--;for(var i=f.length-1;f[i]>c.finish;)i--;i<f.length-1&&i++;l=i-t+1,d=0;var r=f[t];for(h=0;h<l;h++){boundPos=r,e[d]={position:boundPos},d++;r=f[++t];if(h!=l-1){var o=(boundPos+r)/2;g=c.getDiv(u[t-1]);e[d]={position:o,label:g,invisible:!0,text:u[t-1]},d++}}}else{var n=Math.floor((f.length-1)/y);p&&(n=1),n>f.length-1?n=f.length-1:n<1&&(n=1);for(var a=0,s=0|c.start;f[a]<s;)a+=n;0<=a-n&&f[a]>s&&(a-=n);for(var l=m-v+1,d=0,h=0;h<l;h++){if((s=f[a])>=c.start&&s<=c.finish){var g=c.getDiv(u[a]);e[d]={position:s,label:g,text:u[a]},d++}a+=n}}return c.refreshDivs(),e};this.decreaseTickCount=function(){return b?y++:y/=2,C()},this.increaseTickCount=function(){return b?y--:y*=2,C()},this.updateTransform=function(e,t,i){for(var r=C(),o=0;o<r.length;o++)if(r[o].label){var n=r[o].label,a=t/Math.PI*180,s=n._size.width,l=n._size.height,d=Math.abs(t),h=Math.sin(d),g=Math.cos(d),c="rotate("+a+"deg)";if(i){var u=.5*(s*h+l*g-l);c="translateY("+u+"px)"+c;n.normalShift=u}else{var f=-.5*(s-(s*g+l*h));c="translateX("+f+"px)"+c;n.normalShift=f}n.css("-webkit-transform",c),n.css("-moz-transform",c),n.css("-ms-transform",c),n.css("-o-transform",c),n.css("transform",c)}return r},this.getSmallTicks=function(e){var t=[];if(!b)for(var i=0,r=0,o=0;o<f.length;o++)e.length>r&&f[o]==e[r].position?r++:(t[i]=f[o],i++);return t},this.getMinTicks=function(){var e=[];if(p)return C();if(!b&&0<u.length){var t=c.getDiv(u[0]);e[0]={position:f[0],label:t,text:u[0]},t=c.getDiv(u[u.length-1]),e[1]={position:f[f.length-1],label:t,text:u[u.length-1]},c.refreshDivs()}return e}},be.LabelledTickSource.prototype=new be.TickSource,be.TicksRenderer.getAxisType=function(e){return void 0!==e&&e.type&&"log10"==e.type?"log":"numeric"},(be=be||{}).ColorPalette=function(e,t,i){var f,p,u,r=this;if(Object.defineProperty(this,"isNormalized",{get:function(){return f},configurable:!1}),Object.defineProperty(this,"range",{get:function(){return p},configurable:!1}),Object.defineProperty(this,"points",{get:function(){return u},configurable:!1}),(p=(f=e)?{min:0,max:1}:{min:t.min,max:t.max}).min>=p.max)throw"range is incorrect (min >= max)";if(null==i)throw"points are undefined";if(i.length<2)throw"Palette should have at least two points";u=i.slice(0),this.getRgba=function(e){var t=r.getHsla(e);return be.ColorPalette.HSLtoRGB(t)},this.getHsla=function(e){var t=u.length;if(e<=u[0].x)return u[0].leftColor;if(e>=u[t-1].x)return u[t-1].rightColor;for(var i=0,r=t-1;1<r-i;){var o=Math.round((i+r)/2);u[o].x<e?i=o:r=o}var n=u[i];n.x==e&&(r=i);var a=u[r],s=(e-n.x)/(a.x-n.x),l=n.rightColor,d=a.leftColor;0==l.h&&0==l.s&&(l.h=d.h),0==d.h&&0==d.s&&(d.h=l.h);var h=l.h,g=d.h;3<Math.abs(g-h)&&(h<g?h+=6:g+=6);var c={h:h+(g-h)*s,s:l.s+(d.s-l.s)*s,l:l.l+(d.l-l.l)*s,a:l.a+(d.a-l.a)*s};return 6<=c.h&&(c.h-=6),c},this.absolute=function(e,t){for(var i=u.length,r=(t-e)/(p.max-p.min),o=new Array(i),n=0;n<i;n++){var a=u[n];o[n]={x:r*(a.x-p.min)+e,rightColor:a.rightColor,leftColor:a.leftColor}}return new be.ColorPalette(!1,{min:e,max:t},o)},this.relative=function(){if(f)return this;for(var e=u.length,t=1/(p.max-p.min),i=new Array(e),r=0;r<e;r++){var o=u[r];i[r]={x:t*(o.x-p.min),rightColor:o.rightColor,leftColor:o.leftColor}}return new be.ColorPalette(!0,{min:0,max:1},i)},this.banded=function(e){if(!e)throw"bands is undefined";var t=!1;if("number"==typeof e){if(e<1)throw new"number of bands is less than 1";t=!0;var i=e-1,r=(p.max-p.min)/e;e=new Array(i);for(var o=0;o<i;o++)e[o]=(o+1)*r+p.min}var n=e.length+2,a=e.length+1;if(n<2)throw"number of bands is less than 1";var s,l,d=new Array(n),h=this.getHsla(p.min),g=1<a?(p.max-p.min)/(a-1):.5*(p.max-p.min);for(o=0;o<n-1;o++){if(0==o)s=p.min,l=p.min;else{if(s=o==n-2?p.max:t?p.min+o*g:(e[o-1]+e[o])/2,l>=e[o-1])throw"bands points are incorrect";l=e[o-1]}var c=this.getHsla(s),u={x:l,rightColor:c,leftColor:h};d[o]=u,h=c}if(l>=p.max)throw"bands points are incorrect";return d[n-1]={x:p.max,rightColor:h,leftColor:h},new be.ColorPalette(f,p,d)},this.gradientString=function(){function e(e){function t(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t}for(var i=be.ColorPalette.HSLtoRGB(e),r="#"+t(i.r)+t(i.g)+t(i.b),o=Object.keys(s),n=0;n<o.length;n++){var a=o[n];if(s[a]==r){r=a;break}}return r}var s=be.ColorPalette.getColorNames(),t="",i=u.length;f||(t=u[0].x+"=");for(var r=1;r<i;r++){var o=u[r-1],n=u[r];o.rightColor===n.leftColor?t+=e(o.rightColor):t+=e(o.rightColor)+","+e(n.leftColor),r<i-1&&(t+="="+n.x+"=")}return f||(t+="="+u[i-1].x),t}},be.ColorPalette.getColorNames=function(){return{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},be.ColorPalette.toArray=function(e,t){var i,r,o,n=new Uint8Array(t<<2),a=e.getRgba;e.isNormalized?(i=1/(t-1),r=0):(r=e.range.min,i=(e.range.max-e.range.min)/(t-1));for(var s=0,l=0;s<t;s++)o=a(s*i+r),n[l++]=o.r,n[l++]=o.g,n[l++]=o.b,n[l++]=255*o.a;return n},be.ColorPalette.create=function(){var e=arguments;if(!e||0==e.length)throw"colors is undefined or empty";var t=e.length;1==t&&(t++,e=[e[0],e[0]]);for(var i=new Array(t),r=1/(t-1),o=0;o<t;o++){var n=e[o],a="number"==typeof n.r?be.ColorPalette.RGBtoHSL(n):n;i[o]={x:o*r,rightColor:a,leftColor:a}}return new be.ColorPalette(!0,{min:0,max:1},i)},be.ColorPalette.parse=function(e){var t,i=!0,r=[];if(null==e&&(e=""),""==e)return be.palettes.grayscale;var o,n=new be.Lexer(e),a=-1;if(n.readNext()){if(r.push({x:0,rightColor:{h:0,s:0,l:0,a:1},leftColor:{h:0,s:0,l:1,a:1}}),"number"==n.currentLexeme){if(r[r.length-1].x=n.currentNumber,i=!1,n.readNext()&&("separator"!=n.currentLexeme||"equal"!=n.currentSeparator))throw n.position+": separator '=' expected";if(n.readNext()&&"color"!=n.currentLexeme)throw n.position+": color expected"}if("color"!=n.currentLexeme)throw n.position+": wrong lexeme";r[r.length-1].rightColor=n.currentColor,r[r.length-1].leftColor=n.currentColor,r.push({x:r[0].x,rightColor:n.currentColor,leftColor:n.currentColor})}for(o=r[0].x;n.readNext();){if("separator"!=n.currentLexeme)throw n.position+": separator expected";if("equal"==n.currentSeparator){if(n.readNext())if("number"==n.currentLexeme){if(n.currentNumber<o)throw n.position+": number is less than previous";if(o=n.currentNumber,-1==a)r[r.length-1].x=n.currentNumber,a=1;else{if(0!=a)throw n.position+": wrong lexeme";r[r.length-1].x=n.currentNumber,a=2}}else{if("color"!=n.currentLexeme)throw n.position+": wrong lexeme";if(1==a||2==a)r[r.length-1].rightColor=n.currentColor,a=-1;else{if(0!=a&&-1!=a)throw n.position+": wrong lexeme";r[r.length-1].x=r[0].x-1,r[r.length-1].rightColor=n.currentColor,a=-1}}}else if("comma"==n.currentSeparator&&n.readNext())if(1==a||-1==a||2==a)if("number"==n.currentLexeme){if(n.currentNumber<=o)throw n.position+": number is less than previous";if(o=n.currentNumber,!n.readNext()||"separator"!=n.currentLexeme||"equal"!=n.currentSeparator)throw n.position+": wrong lexeme";if(!n.readNext()||"color"!=n.currentLexeme)throw n.position+": color expected";-1!=a?r.push({x:n.currentNumber,rightColor:n.currentColor,leftColor:n.currentColor}):(r[r.length-1].x=n.currentNumber,r[r.length-1].rightColor=n.currentColor,r[r.length-1].leftColor=n.currentColor),a=-1}else{if("color"!=n.currentLexeme)throw n.position+": wrong lexeme";-1==a&&r.pop(),a=0}else if(0==a)if("number"==n.currentLexeme){if(n.currentNumber<=o)throw n.position+": number is less than previous";if(o=n.currentNumber,r[r.length-1].x=r[0].x-1,!n.readNext()||"separator"!=n.currentLexeme||"equal"!=n.currentSeparator)throw n.position+": wrong lexeme";if(!n.readNext()||"color"!=n.currentLexeme)throw n.position+": color expected";r.push({x:n.currentNumber,rightColor:n.currentColor,leftColor:n.currentColor}),a=-1}else{if("color"!=n.currentLexeme)throw n.position+": wrong lexeme";r[r.length-1].x=r[0].x-1,a=0}-1!=a&&0!=a||r.push({x:r[0].x,rightColor:n.currentColor,leftColor:n.currentColor})}if("separator"==n.currentLexeme)throw n.position+": wrong lexeme";if("number"==n.currentLexeme&&i||"color"==n.currentLexeme&&!i)throw n.position+": wrong ending";if(i&&(r[r.length-1].x=1,r[r.length-1].x<r[r.length-2].x))throw n.position+": number is less than previous";if(r[r.length-1].rightColor=r[r.length-1].leftColor,r[0].x>=r[r.length-1].x)throw n.position+": wrong range of palette";t={min:r[0].x,max:r[r.length-1].x};for(var s=1,l=0,d=1,h=r.length;d<h;d++)if(r[d].x==r[0].x-1)0==l&&(s=d),l++;else if(0!=l){for(var g=(r[s+l].x-r[s-1].x)/(l+1),c=0;c<l;c++)r[s+c].x=r[s-1].x+g*(c+1);l=0,s=1}return new be.ColorPalette(i,t,r)},be.Lexer=function(e){if("string"!=typeof e)throw"wrong definition of palette: must be a string";var o,n,a,s,l=e,d=0;Object.defineProperty(this,"position",{get:function(){return d},configurable:!1}),Object.defineProperty(this,"paletteString",{get:function(){return l},configurable:!1}),Object.defineProperty(this,"currentSeparator",{get:function(){return s},configurable:!1}),Object.defineProperty(this,"currentLexeme",{get:function(){return a},configurable:!1}),Object.defineProperty(this,"currentNumber",{get:function(){return n},configurable:!1}),Object.defineProperty(this,"currentColor",{get:function(){return o},configurable:!1}),this.readNext=function(){if(d>=l.length)return!1;for(;" "===l[d];)d++;if("#"===l[d]||/^[a-z]/.test(l[d].toLowerCase())){a="color";for(var e=d;d<l.length&&" "!=l[d]&&"="!=l[d]&&","!=l[d];)d++;var t=be.ColorPalette.colorFromString(l.substring(e,d));o=be.ColorPalette.RGBtoHSL(t)}else if("="===l[d]||","===l[d])a="separator",s="="==l[d]?"equal":"comma",d++;else{a="number";for(e=d;d<l.length&&" "!=l[d]&&"="!=l[d]&&","!=l[d];)d++;var i=l.substring(e,d),r=i.replace(/[^0-9+-Ee.]/g,"");if(i!=r)throw"wrong number value";n=parseFloat(l.substring(e,d))}return!0}},be.ColorPalette.colorFromString=function(e){var t,i,r,o,n=be.ColorPalette.getColorNames();if("string"!=typeof e)throw"wrong definition of color: must be a string";var a=!1;n[e.toLowerCase()]&&(e=n[e.toLowerCase()]);if("#"==e.charAt(0)){if(7==e.length)o=1,t=parseInt(e.substring(1,3),16),i=parseInt(e.substring(3,5),16),r=parseInt(e.substring(5,7),16);else{if(9!=e.length)throw"wrong definition of hex color";t=parseInt(e.substring(1,3),16),i=parseInt(e.substring(3,5),16),r=parseInt(e.substring(5,7),16),o=parseInt(e.substring(7,9),16)/255}a=!0}if(!a){null!==(s=/rgb\(\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\s*\)/.exec(e))&&(o=1,t=parseInt(s[1]),i=parseInt(s[2]),r=parseInt(s[3]),a=!0),a||null!==(s=/rgb\(\s*([0-9]|[1-8][0-9]|9[0-9]|100)%,\s*([0-9]|[1-8][0-9]|9[0-9]|100)%,\s*([0-9]|[1-8][0-9]|9[0-9]|100)%\s*\)/.exec(e))&&(o=1,t=Math.round(2.55*parseInt(s[1])),i=Math.round(2.55*parseInt(s[2])),r=Math.round(2.55*parseInt(s[3])),a=!0)}if(!a){var s;null!==(s=/rgba\(\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*([0|1]\.?\d+)\)/.exec(e))&&(t=parseInt(s[1]),i=parseInt(s[2]),r=parseInt(s[3]),o=parseFloat(s[4]),a=!0)}if(!a)throw"Unsupported color definition";if(isNaN(t)||isNaN(i)||isNaN(r)||isNaN(o))throw"wrong definition of hex color";return{r:t,g:i,b:r,a:o}},be.ColorPalette.RGBtoHSL=function(e){var t,i,r;r=e.a;var o=e.r/255,n=e.g/255,a=e.b/255,s=Math.max(o,n);s=Math.max(s,a);var l=Math.min(o,n);return i=(s+(l=Math.min(l,a)))/2,s==l?t=0:s==o?t=a<=n?(n-a)/(s-l):(n-a)/(s-l)+6:s==n?t=2+(a-o)/(s-l):s==a&&(t=4+(o-n)/(s-l)),{h:t,s:s==l?0:i<.5?(s-l)/(s+l):(s-l)/(2-s-l),l:i,a:r}},be.ColorPalette.HSLtoRGB=function(e){var t,i,r,o;o=e.a;var n=e.h,a=e.s,s=e.l,l=(1-Math.abs(2*s-1))*a,d=l*(1-Math.abs(n%2-1));n<2?(r=0,i=n<1?(t=Math.round(255*l),Math.round(255*d)):(t=Math.round(255*d),Math.round(255*l))):n<4?(t=0,r=n<3?(i=Math.round(255*l),Math.round(255*d)):(i=Math.round(255*d),Math.round(255*l))):n<6&&(i=0,r=n<5?(t=Math.round(255*d),Math.round(255*l)):(t=Math.round(255*l),Math.round(255*d)));var h=255*(s-l/2),g=t+h;return{r:t=255<g?255:g<0?0:Math.round(g),g:i=255<(g=i+h)?255:g<0?0:Math.round(g),b:r=255<(g=r+h)?255:g<0?0:Math.round(g),a:o}},be.ColorPaletteViewer=function(e,t,i){var r=e,n=r.width(),a=20,o=!0,s=!1,l=t,d=void 0;void 0!==i&&(void 0!==i.height&&(a=i.height),void 0!==i.width&&(n=i.width),void 0!==i.axisVisible&&(o=i.axisVisible),void 0!==i.logAxis&&(s=i.logAxis));var h=me("<canvas height='"+a+"px'width='"+n+"px' style='display: block'></canvas>");r[0].appendChild(h[0]);var g=h.get(0).getContext("2d"),c=null,u=null;function f(e){return s?{min:be.Utils.log10(e.min),max:be.Utils.log10(e.max)}:e}function p(){c=me("<div data-idd-placement='bottom' style='width: "+n+"px; color: rgb(0,0,0)'></div>"),r[0].appendChild(c[0]),u=s?new be.LogarithmicAxis(c):new be.NumericAxis(c),l&&!l.isNormalized?u.update(f({min:l.range.min,max:l.range.max})):d&&u.update(f({min:d.min,max:d.max}))}o&&p(),Object.defineProperty(this,"axisVisible",{get:function(){return o},set:function(e){o!=(e=!!e)&&((o=e)?p():(r[0].removeChild(c[0]),u=c=null))},configurable:!1}),Object.defineProperty(this,"palette",{get:function(){return l},set:function(e){e&&(l=e,!o||l.isNormalized&&d||u.update(f({min:l.range.min,max:l.range.max})),v())},configurable:!1}),Object.defineProperty(this,"dataRange",{get:function(){return d},set:function(e){e&&(d=e,!o||l&&!l.isNormalized||u.update(f({min:d.min,max:d.max})))},configurable:!1});var v=function(){for(var e,t=(l.range.max-l.range.min)/n,i=g.createLinearGradient(0,0,n,0),r=l.range.min,o=0;o<n;o++)e=l.getRgba(r),i.addColorStop(o/n,"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"),r+=t;g.fillStyle=i,g.fillRect(0,0,n,a)};l&&v()},be.SvgColorPaletteViewer=function(e,t,i,r){var o=170,n=20,a=!0,s=t;void 0!==r&&(void 0!==r.height&&(n=r.height),void 0!==r.width&&(o=r.width),void 0!==r.axisVisible&&(a=r.axisVisible));var l=e.group();a&&(i.children[1].axis.renderToSvg(l),l.translate(0,n+.5));var d,h,g;s&&(h=(s.range.max-s.range.min)/o,g=e.gradient("linear",function(e){for(var t=s.range.min,i=0;i<o;i++)d=s.getRgba(t),e.at(i/o,"rgba("+d.r+","+d.g+","+d.b+","+d.a+")"),t+=h}),e.rect(o,n).fill(g))},be.SizePalette=function(e,t,i){var r,o,n;if(Object.defineProperty(this,"isNormalized",{get:function(){return r},configurable:!1}),Object.defineProperty(this,"range",{get:function(){return o},configurable:!1}),Object.defineProperty(this,"sizeRange",{get:function(){return n},configurable:!1}),o=(r=e)?{min:0,max:1}:{min:i.min,max:i.max},n={min:t.min,max:t.max},o.min>o.max)throw"valueRange is incorrect (min >= max)";var a=(n.max-n.min)/(o.max-o.min);this.getSize=function(e){return e<=o.min?n.min:e>=o.max?n.max:a*(e-o.min)+n.min}},be.SizePalette.Create=function(e){if(e instanceof be.SizePalette)return e;var t=e.sizeRange,i=e.valueRange;return new be.SizePalette(void 0===i,t,i)},be.SizePaletteViewer=function(e,t,i){var r=e,o=r.width(),n=35,a=!0,s=t;void 0!==i&&(void 0!==i.axisVisible&&(a=i.axisVisible),void 0!==i.width&&(o=i.width),void 0!==i.height&&(n=i.height));var l=me("<canvas height='"+n+"px'width='"+o+"px' style='display: block'></canvas>");r[0].appendChild(l[0]);var d=null,h=null;function g(){h=me("<div data-idd-placement='bottom' style='width: "+o+"px; margin-top: -1px; color: rgb(0,0,0)'></div>"),d=new be.NumericAxis(h),r[0].appendChild(h[0]),s?s.isNormalized||d.update({min:s.range.min,max:s.range.max}):c&&d.update({min:c.min,max:c.max})}a&&g(),Object.defineProperty(this,"axisVisible",{get:function(){return a},set:function(e){a!=(e=!!e)&&((a=e)?g():(r[0].removeChild(h[0]),d=h=null))},configurable:!1}),Object.defineProperty(this,"palette",{get:function(){return s},set:function(e){e&&(s=e,a&&!s.isNormalized&&d.update({min:s.range.min,max:s.range.max}),f())},configurable:!1});var c=void 0;Object.defineProperty(this,"dataRange",{get:function(){return c},set:function(e){e&&(c=e,!a||s&&!s.isNormalized||d.update({min:c.min,max:c.max}))},configurable:!1});var u=l.get(0).getContext("2d"),f=function(){u.clearRect(0,0,o,n),u.fillStyle="lightgray",u.strokeStyle="black";var e=0,t=n;s&&s.sizeRange&&(e=s.sizeRange.min,t=s.sizeRange.max);var i=n*o/Math.max(t,e);u.beginPath(),u.moveTo(0,n),0!=e&&u.lineTo(0,Math.max(0,n-e)),i<o?(u.lineTo(i,0),e<=t?u.lineTo(o,0):u.lineTo(o,Math.max(0,n-t))):u.lineTo(o,Math.max(0,n-t)),u.lineTo(o,n),u.lineTo(0,n),u.closePath(),u.fill(),u.stroke()};f()},be.SvgSizePaletteViewer=function(o,e,t,i){var n=170,a=75,r=!0,s=e;void 0!==i&&(void 0!==i.axisVisible&&(r=i.axisVisible),void 0!==i.width&&(n=i.width),void 0!==i.height&&(a=i.height));var l,d;r&&(l=t.children[1],d=o.group(),l.axis.renderToSvg(d),d.translate(0,a));!function(){var e=0,t=a;s.sizeRange&&(e=s.sizeRange.min,t=s.sizeRange.max);var i=a*n/Math.max(t,e),r=[];0!=e?r.push([0,Math.max(0,a-e)]):r.push([0,a]),i<n?(r.push([i,0]),e<=t?r.push([n,0]):r.push([n,Math.max(0,a-t)])):(r.push([n,Math.max(0,a-t)]),r.push([n,Math.max(0,a-t)])),o.polyline([[0,a],r[0],r[1],r[2],[n,a],[0,a]]).fill("lightgray").stroke("black")}()},be.UncertaintySizePaletteViewer=function(e,t){var i=e;i.width();void 0!==t&&(void 0!==t.width&&t.width,void 0!==t.height&&t.height);var r=void 0;Object.defineProperty(this,"maxDelta",{get:function(){return r},set:function(e){e&&(r=e,s())}});var o=me("<canvas height='50px'></canvas>");i[0].appendChild(o[0]);var n=o[0].getContext("2d"),a=[{x:25,y:20,min:16,max:16},{x:75,y:20,min:10,max:16},{x:125,y:20,min:0,max:16}],s=function(){for(var e=0;e<a.length;e++)be.Petal.drawSample(n,a[e].x,a[e].y,a[e].min,a[e].max,"#484848");n.lineWidth=1,n.beginPath(),n.moveTo(20,45.5),n.lineTo(118,45.5),n.stroke(),n.closePath(),n.beginPath(),n.moveTo(118,45.5),n.lineTo(103.5,40.5),n.lineTo(103.5,49.5),n.lineTo(118,45.5),n.stroke(),n.closePath(),n.fill(),n.strokeStyle="black",n.fillStyle="black",n.lineWidth=1,r&&(n.fillText("X",9,49),n.fillText("X",122,49),n.beginPath(),n.moveTo(134,44.5),n.lineTo(141,44.5),n.stroke(),n.closePath(),n.beginPath(),n.moveTo(134,48.5),n.lineTo(141,48.5),n.stroke(),n.closePath(),n.beginPath(),n.moveTo(137.5,41),n.lineTo(137.5,48),n.stroke(),n.closePath(),n.fillText("",round(r,{min:0,max:r},!1),145,49))};s(),me("<div style='margin-left: 30px; margin-top: -10px'>uncertainty</div>").appendTo(i)},be.palettes={grayscale:new be.ColorPalette(!0,{min:0,max:1},[{x:0,rightColor:{h:0,s:0,l:0,a:1},leftColor:{h:0,s:0,l:0,a:1}},{x:1,rightColor:{h:0,s:0,l:1,a:1},leftColor:{h:0,s:0,l:1,a:1}}])},(be=be||{}).ColorPaletteEditor=function(u,e){if(!u.hasClass("idd-colorPaletteEditor")){u.addClass("idd-colorPaletteEditor"),u[0].editor=this;var f="rgba(100,100,100,0.3)",p=e;Object.defineProperty(this,"palette",{get:function(){return p},set:function(e){p=e,C.palette=p,k()},configurable:!1});function v(e){u.trigger("paletteChanged",[e])}var m=!1,a=!1,y=u.width(),b=me("<div></div>").height(10).width(y).addClass("idd-colorPaletteEditor-bar").appendTo(u),t=me("<div></div>").height(20).width(y).addClass("idd-colorPaletteEditor-viewer").appendTo(u),i={height:20,axisVisible:!1},C=new be.ColorPaletteViewer(t,p,i),w=10+t.height();u.height(w);function I(e){var t=be.ColorPalette.HSLtoRGB(e);return"rgba("+t.r+","+t.g+","+t.b+","+t.a+")"}function s(e){function t(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t}var i=be.ColorPalette.HSLtoRGB(e);return"#"+t(i.r)+t(i.g)+t(i.b)}function A(e,t,i,r,o,n){o&&(e.fillStyle=o,e.beginPath(),e.moveTo(t,i),e.lineTo(t+5,i),e.lineTo(t+5,i+10),e.fill()),n&&(e.fillStyle=n,e.beginPath(),e.moveTo(t+5,i),e.lineTo(t+10,i),e.lineTo(t+5,i+10),e.fill()),e.strokeStyle=r,e.beginPath(),e.moveTo(t,i),e.lineTo(t+10,i),e.lineTo(t+5,i+10),e.closePath(),e.stroke()}function x(){P[0].getContext("2d").clearRect(0,0,y,10)}function T(){if(a){var e=me(".idd-colorPaletteEditor-colorPicker",b);if(0<e.length){var t=me.data(e[0],"onClick");t&&me(window).off("click",t),me(".idd-colorPaletteEditor-colorPicker",b).remove()}a=!1}}function S(e,t,r){T(),a=!0;var i=me("<div></div>").addClass("idd-colorPaletteEditor-colorPicker").css({position:"absolute",left:e-30,top:10}).appendTo(b);me("<span>Color:</span>").css("margin-right",10).appendTo(i);function o(e){me(e.target).hasClass("idd-colorPaletteEditor-colorPicker")||0<i.has(me(e.target)).length||(T(),e.stopPropagation())}var n=me("<input type=color></input>").width(60).height(20).val(s(t)).change(function(){var e=n.val(),t=be.ColorPalette.colorFromString(e),i=be.ColorPalette.RGBtoHSL(t);r(i),T()}).appendTo(i);me(window).click(o),me.data(i[0],"onClick",o)}function o(l,e,t,i){var r=y/(p.range.max-p.range.min),o=r*(l.x-p.range.min),n=r*(e-p.range.min),a=r*(t-p.range.min),d=me("<div style='position:absolute;'></div>").addClass("idd-colorPaletteEditor-marker").width(10).height(10).appendTo(b),s=me("<canvas height='10px'width='10px' style='display: block'></canvas>").appendTo(d);if(d.css("left",o-5),i){var h=P.offset(),g=!1;d.draggable({axis:"x",containment:[h.left+n-5,h.top,h.left+a-5,h.top+10],start:function(e){g=!(m=!0),T(),x();var t=P.offset();me(e.target).draggable("option","containment",[t.left+n-5,t.top,t.left+a-5,t.top+10])},drag:function(e){var t=u.offset(),i=e.pageY-t.top;if(i<0||w<i)g||((r=s[0].getContext("2d")).clearRect(0,0,10,10),A(r,0,0,"gray",f,f),g=!0);else if(g){var r;(r=s[0].getContext("2d")).clearRect(0,0,10,10),A(r,0,0,"black",l.leftColor&&I(l.leftColor),l.rightColor&&I(l.rightColor)),g=!1}},stop:function(e){m=!1;var t,i,r,o=u.offset(),n=e.pageY-o.top;if(n<0||w<n){for(var a=0;a<p.points.length;a++)if(p.points[a].x==l.x){p.points.splice(a,1),v(p),C.palette=p;break}}else{var s=(t=d,i=P.offset(),r=t.offset().left+t.width()/2-i.left,(p.range.max-p.range.min)/y*r+p.range.min);s>p.range.min&&s<p.range.max&&(l.x=s,v(p),C.palette=p)}k()}})}d.click(function(e){S(o,l.rightColor?l.rightColor:l.leftColor,function(e){l.leftColor&&(l.leftColor=e),l.rightColor&&(l.rightColor=e),C.palette=p,v(p),k()}),e.stopPropagation()});var c=s[0].getContext("2d");A(c,0,0,"black",l.leftColor&&I(l.leftColor),l.rightColor&&I(l.rightColor))}var P=me("<canvas height='10px'width='"+y+"px' style='display: block'></canvas>").css("position","absolute").appendTo(b),k=function(){m=!1,T();var e=me(".idd-colorPaletteEditor-marker",b);if(e.filter(".ui-draggable").each(function(){me(this).draggable("destroy")}),e.remove(),0<p.points.length){var t=p.range.min,i=p.points[1].x;o(p.points[0],t,i,!1)}if(1<p.points.length){t=p.points[p.points.length-2].x,i=p.range.max;o(p.points[p.points.length-1],t,i,!1)}for(var r=1;r<p.points.length-1;r++){t=p.points[r-1].x,i=p.points[r+1].x;o(p.points[r],t,i,!0)}};P.mousemove(function(e){if(!m&&!a){var t=P.offset(),i=e.pageX-t.left,r=P[0].getContext("2d");r.clearRect(0,0,y,10),A(r,i-5,0,"gray",f,f)}}),P.mouseleave(function(){x()}),P.click(function(e){if(!m&&!a){var t=P.offset(),i=e.pageX-t.left,r=(p.range.max-p.range.min)/y*i+p.range.min,o=p.getHsla(r);!function(e){var t=p.points;if(!(t[0].x>=e.x||t[t.length-1].x<=e.x)){for(var i,r=1;r<t.length;r++){if(e.x==t[r].x)return;if(e.x<t[r].x){(i=t.slice()).splice(r,0,e);break}}p=new be.ColorPalette(p.isNormalized,p.range,i),C.palette=p,v(p),k()}}({x:r,leftColor:o,rightColor:o})}}),k()}},be.Gestures={},be.Gestures.FullEventList=["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","touchcancel","gesturestart","gesturechange","gestureend","MSGestureStart","MSGestureChange","MSGestureEnd","MSGestureCancel","MSPointerDown"],be.Gestures.zoomLevelFactor=1.4,be.Gestures.getXBrowserMouseOrigin=function(e,t){var i=function(e){for(var t=0,i=0;e;)t+=e.offsetLeft,i+=e.offsetTop,e=e.offsetParent;return{left:t,top:i}}(e[0]);return{x:t.pageX-i.left,y:t.pageY-i.top}},be.Gestures.PanGesture=function(e,t,i){this.Type="Pan",this.Source=i,this.xOffset=e,this.yOffset=t},be.Gestures.ZoomGesture=function(e,t,i,r){this.Type="Zoom",this.Source=r,this.xOrigin=e,this.yOrigin=t,this.scaleFactor=i},be.Gestures.PinGesture=function(e){this.Type="Pin",this.Source=e},be.Gestures.createPanSubject=function(e){var t=me(document),i=A.Observable.fromEvent(e,"mousedown"),r=A.Observable.fromEvent(e,"mousemove"),o=A.Observable.fromEvent(t,"mouseup"),n=r.skip(1).zip(r,function(e,t){return new be.Gestures.PanGesture(e.clientX-t.clientX,e.clientY-t.clientY,"Mouse")}),a=o;return i.selectMany(function(e){return n.takeUntil(a)})},be.Gestures.createPinSubject=function(e){return A.Observable.fromEvent(e,"mousedown").select(function(e){return new be.Gestures.PinGesture("Mouse")})},be.Gestures.createZoomSubject=function(r){r.unbind("mousewheel"),r.mousewheel(function(e,t){e.preventDefault();var i=jQuery.Event("xbrowserwheel");i.delta=t,i.origin=be.Gestures.getXBrowserMouseOrigin(r,e),r.trigger(i)});var e=A.Observable.fromEvent(r,"xbrowserwheel"),t=e.zip(e,function(e){return new be.Gestures.ZoomGesture(e.origin.x,e.origin.y,0<e.delta?1/be.Gestures.zoomLevelFactor:+be.Gestures.zoomLevelFactor,"Mouse")}),i=A.Observable.fromEvent(r,"dblclick");i.zip(i,function(e){var t=be.Gestures.getXBrowserMouseOrigin(r,e);return new be.Gestures.ZoomGesture(t.x,t.y,1/be.Gestures.zoomLevelFactor,"Mouse")});return t},be.Gestures.createTouchPanSubject=function(e){var t=me(document),i=A.Observable.fromEvent(e,"touchstart"),r=A.Observable.fromEvent(e,"touchmove"),o=A.Observable.fromEvent(t,"touchend"),n=A.Observable.fromEvent(t,"touchcancel");return i.selectMany(function(e){return r.takeUntil(o.merge(n)).skip(1).zip(r,function(e,t){return{left:e.originalEvent,right:t.originalEvent}}).where(function(e){return 1==e.left.targetTouches.length&&1==e.right.targetTouches.length&&1==e.left.changedTouches.length&&1==e.right.changedTouches.length}).select(function(e){return new be.Gestures.PanGesture(e.left.targetTouches[0].pageX-e.right.targetTouches[0].pageX,e.left.targetTouches[0].pageY-e.right.targetTouches[0].pageY,"Touch")})})},be.Gestures.createTouchPinSubject=function(e){return A.Observable.fromEvent(e,"touchstart").select(function(e){return new be.Gestures.PinGesture("Touch")})},be.Gestures.createTouchZoomSubject=function(e){var t=me(document),i=A.Observable.fromEvent(e,"touchstart"),r=A.Observable.fromEvent(e,"touchmove"),o=A.Observable.fromEvent(t,"touchend"),n=A.Observable.fromEvent(t,"touchcancel");return i.selectMany(function(e){return r.takeUntil(o.merge(n)).skip(1).zip(r,function(e,t){return{left:e.originalEvent,right:t.originalEvent}}).where(function(e){return 2==e.left.targetTouches.length&&2==e.right.targetTouches.length}).select(function(e){var t=Math.sqrt((e.left.targetTouches[0].pageX-e.left.targetTouches[1].pageX)*(e.left.targetTouches[0].pageX-e.left.targetTouches[1].pageX)+(e.left.targetTouches[0].pageY-e.left.targetTouches[1].pageY)*(e.left.targetTouches[0].pageY-e.left.targetTouches[1].pageY))/Math.sqrt((e.right.targetTouches[0].pageX-e.right.targetTouches[1].pageX)*(e.right.targetTouches[0].pageX-e.right.targetTouches[1].pageX)+(e.right.targetTouches[0].pageY-e.right.targetTouches[1].pageY)*(e.right.targetTouches[0].pageY-e.right.targetTouches[1].pageY)),i={x:Math.abs(e.right.targetTouches[1].pageX-e.right.targetTouches[0].pageX),y:Math.abs(e.right.targetTouches[1].pageY-e.right.targetTouches[0].pageY)};return new be.Gestures.ZoomGesture(i.x,i.y,1/t,"Touch")})})},be.Gestures.createTouchPanSubjectWin8=function(e){var t=A.Observable.fromEvent(e,"MSGestureStart"),i=A.Observable.fromEvent(e,"MSGestureChange"),r=A.Observable.fromEvent(me(document),"MSGestureEnd");return t.selectMany(function(e){var t=i.startWith({originalEvent:{offsetX:e.originalEvent.offsetX,offsetY:e.originalEvent.offsetY}});return t.takeUntil(r).skip(1).zip(t,function(e,t){return{left:e.originalEvent,right:t.originalEvent}}).where(function(e){return e.left.scale===e.right.scale&&e.left.detail!=e.left.MSGESTURE_FLAG_INERTIA&&e.right.detail!=e.right.MSGESTURE_FLAG_INERTIA}).select(function(e){return new be.Gestures.PanGesture(e.left.offsetX-e.right.offsetX,e.left.offsetY-e.right.offsetY,"Touch")})})},be.Gestures.createTouchPinSubjectWin8=function(e){return A.Observable.fromEvent(e,"MSPointerDown").select(function(e){return new be.Gestures.PinGesture("Touch")})},be.Gestures.createTouchZoomSubjectWin8=function(e){var t=A.Observable.fromEvent(e,"MSGestureStart"),i=A.Observable.fromEvent(e,"MSGestureChange"),r=A.Observable.fromEvent(e,"MSGestureEnd");return t.selectMany(function(t){return i.takeUntil(r).where(function(e){return 1!==e.originalEvent.scale&&0!==e.originalEvent.scale&&e.originalEvent.detail!=e.originalEvent.MSGESTURE_FLAG_INERTIA}).select(function(e){return new be.Gestures.ZoomGesture(t.originalEvent.offsetX,t.originalEvent.offsetY,1/e.originalEvent.scale,"Touch")})})},be.Gestures.GesturesPool=function(){var e=[];this.addMSGestureSource=function(i){e.forEach(function(e){}),e.push(i),i.addEventListener("MSPointerDown",function(e){if(void 0===i.gesture){var t=new MSGesture;(t.target=i).gesture=t}i.gesture.addPointer(e.pointerId)},!1)}},be.Gestures.GesturesPool=new be.Gestures.GesturesPool,be.Gestures.getGesturesStream=function(e){var t,i,r;if(window.navigator.msPointerEnabled&&"undefined"!=typeof MSGesture){var o=e[0];be.Gestures.GesturesPool.addMSGestureSource(o),t=be.Gestures.createTouchPanSubjectWin8(e);var n=be.Gestures.createTouchZoomSubjectWin8(e),a=be.Gestures.createZoomSubject(e);i=n.merge(a),r=be.Gestures.createTouchPinSubjectWin8(e)}else t=be.Gestures.createPanSubject(e),i=be.Gestures.createZoomSubject(e),r=be.Gestures.createPinSubject(e);var s=r.merge(t.merge(i));return"ontouchstart"in document.documentElement&&(t=be.Gestures.createTouchPanSubject(e),i=be.Gestures.createTouchZoomSubject(e),r=be.Gestures.createTouchPinSubject(e),s=s.merge(r.merge(t.merge(i)))),s},be.Gestures.applyHorizontalBehavior=function(e){return e.select(function(e){return"Pan"==e.Type?e.yOffset=0:"Zoom"==e.Type&&(e.preventVertical=!0),e})},be.Gestures.applyVerticalBehavior=function(e){return e.select(function(e){return"Pan"==e.Type?e.xOffset=0:"Zoom"==e.Type&&(e.preventHorizontal=!0),e})},(be=void 0===be?{}:be).DataTransform=function(e,t,i,r){this.dataToPlot=e,this.plotToData=t,this.domain=i||{isInDomain:function(e){return!0}},this.type=r};var e,T,l,v,t,m,y,i,b,n,a,r,d,C,be,w,o,S,P,k,M,D=85.05112878,G=D/Math.log(Math.tan(D*Math.PI/360+Math.PI/4));function N(e,i,t,r){e.empty();var o=void 0!==r?r:1,n=me("<canvas width='"+40*o+"' height='"+40*o+"'></canvas>").appendTo(e).get(0).getContext("2d");n.globalAlpha=.9;var a=new Image;a.onload=function(){if(n.drawImage(a,0,0,40*o,40*o),void 0!==i){n.fillStyle="white";var e=(i<10?14:11)*o;n.font=e+"px Arial";var t=(i<10?16:13)*o;n.fillText(i,t,20*o)}},a.src=t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC45bDN+TgAAApdJREFUaEPtWc1KW0EUDrjL+9RVN2ZVNC1SaBdREewmYkW00NI+QVEkxJ+2/iBq1KX2CVrJM3Tj1ifIG9yebzhnvFxO4iR3Zm4C94Nvk8yc7zs/czOXVEower3eFLHqyCneVjxghk11iYkjsbbYRCDOJqzxfw+Pyf5NdyCxRtbz3viJQJDFrfG9624yv36STC8eDiTWYK2SSJwkIMSCxkSrc5/MrOyrZgextnKQtK/u04mETwICLGSEl75equaG4fK3TpwkEJgFjGB97ZdqaBS++XgcNgkE5MDezQuDJkHB8KQwAj7Gph8z41Rl+XxAJYim+jiwmrBP4mBzAn66QEFs9Ud52gzL2ocDf11ABYim+nh2a4IhCC1OIF8XaLOtvsuPlOXCnttnffh249RPFyQBXAE0oZCEZvwEHKr8wrETxSTgkWUCQJlADhaTQHmIn+g1Afyo4LaoCWnUquxaeTBzM82VgL1K7F78UcVCsHX5V8znv9BRgOhj5GV8BJIAWvpu60wV9EloeBkfAQWxYxSjC6nq5x8fAQWyXXjV/KEK+yBie62+AJUgmi6EfC/w9h6ggQLaLsyu+n+pR8wg1RegIsRgZyHI7GdBgW0XGp/PVSOjsPHlImz1BagM0XsXolRfQAK2C5vbd6qhYYgYUaovQIWIpgsQrq8dqcZciL0p8+GrL4AQC+YapaijkwUJ2lHa2vmtGhxE7Ik6OlmgYkQ7Su8/ud+TsLaQ0ckCwmzAGHq5/PydH2vGwrwABtiI0zWj0LnvBzJiz8PG91vVOIjvUtWPP/f9gEoS7Shp/yHgs7EanSxgiI0Zo3OrP615/KMz1uYFMMYGjeHXzbbhRJgXwCAbFdOTY14Ao0Qc7DQnw3yJoVCp/AcXkU+yAO498gAAAABJRU5ErkJggg==":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC45bDN+TgAAAylJREFUaEPVmdtOMjEUhX0Wn9CHwkPQeIxwwQ0SD1eaqIkHghEidxD1Dfrvb0KT+ScLpu0UEy6+xL1ou9fedGbKuNVqtTYaKW4SUkzl9/d329ipYVvNTUWKsWBqYW5guBoYk60QKYaCiYWZwc/PjxuNRu729tZdXl66drvtdnd3C/gbjc8+Pj4cY5mzmNuoECmGQGJv/PHx0R0fHzvTg2Ds09NTuZDkIqRYhzf/9fXlzs/PpckQLi4u3HQ6bVSEFFfhzb+/v7v9/X1pLAbWGA6HyUVIcRll8+xt07LAWqlFSFHhzbNtcnS+CmumbCcpKmzRHS66Jnu+Dq6JxYW9Y7H0UUWKVegIneFuY/FaeX5+jvoWpFiFjtCZmFtlKicnJ1HfghTL0Ak6wkPK4iAODg6CtGXwsCMnuS2WvjxSLEMnjOIpavGfcHd3RwFB34IUy/gCOApYvJKQLoeM6XQ6+QvgPGPxn3B4eJi/gJwPrjrIlb2Avb09mWwdkCt7AUdHRzLZOiBX9gK63a5MVibXRUyu7AVwa7P4T8h9Gy0eZJwWLQ5CdTmk856Yk6kUq9CJ7+/vKBOpkINc5LRY+ikjxSosZrh+vy+T5oQc5MpdQLGNPj8/ZdKckINc5LRY+ikjRQUdMYozu8VrgbXJQS6LpY8qUlTQEWPw8vIik+fg9fU1qvsgxWXQGc7qp6en0kATzs7Oon+NgRSXQWfo0NvbmzTRBF4UsDY5LJb5FVJcBR0yiiOvxVmIOT5XkeIq6JAxmEwm0kwKrMWarG2xzLsMKdZBpwx3fX0tDcVwc3OT3H2QYh10yhjM5/NGp1TmsgZrsaZpMt8qpBiCLyLmjFSlyStFjxRDscTFVrq6upIGV8Ec5rKGxXL9EKQYCp0ziq0U+3q96dbxSDEGXwRnmJDfzYwZj8dZzIMUY/FF3N/fS9NlGJPLPEgxBTNUHDN6vZ40Dnxm4xrv+zJSTIGOGoPZbFa83zTtP9D4jDGMZU4OpJiKL6L6PwT+RsttHqTYBF8EhzOLC1IPaiFIsSm+iIeHBwfrMg9SzMGiCB50sBbzIMVNQoqbhBQ3h9bWP/HfsYvIwP9AAAAAAElFTkSuQmCC"}function R(e,t,s,i){this.currentPlots={},this.div=e;var o=this,r=this.iddDiv=me("<div data-idd-plot='chart'></div>").appendTo(e);r.width(e.width()),r.height(e.height());var d=this.iddChart=v.asPlot(r);d.legend.isVisible=!1,d.isToolTipEnabled=!0,d.doFitOnDataTransformChanged=!1;var n=me("<div></div>").addClass("dsv-onscreennavigationcontainer").attr("data-idd-placement","center").appendTo(t),a=me("<div></div>").addClass("dsv-onscreennavigation").appendTo(n),l=(new v.OnScreenNavigation(a,d,s),me("<div></div>").attr("data-idd-name","draggableMarkers").appendTo(d.host)),h=new v.DOMPlot(l,d);h.order=9007199254740991,d.addChild(h),this.persistentViewState=s,d.navigation.setVisibleRect(this.persistentViewState.plotRect,!1,{suppressNotifyBoundPlots:!0}),d.isAutoFitEnabled=this.persistentViewState.isAutoFit,s.probesViewModel.getProbeContent=function(e){for(var t=d.children,i=[],r=0;r<t.length;r++)if(t[r].isVisible){var o=t[r].xDataTransform&&t[r].xDataTransform.domain&&t[r].xDataTransform.domain.isInDomain&&t[r].xDataTransform.domain.isInDomain(e.location.x)?t[r].xDataTransform.dataToPlot(e.location.x):e.location.x,n=t[r].yDataTransform&&t[r].yDataTransform.domain&&t[r].yDataTransform.domain.isInDomain&&t[r].yDataTransform.domain.isInDomain(e.location.y)?t[r].yDataTransform.dataToPlot(e.location.y):e.location.y,a=t[r].getTooltip(e.location.x,e.location.y,o,n,!0);void 0!==a&&i.push(a)}return 0<i.length?i:void 0};function g(e){var r=e.id,t=e.location.x,i=e.location.y,o=me("<div></div>");o.addClass("dragPoint"),h.add(o[0],"none",t,i,void 0,void 0,.5,.92);var n=h.domElements,a=n[n.length-1];a.id=r,o.draggable({containment:h.master.centralPart[0],scroll:!1,opacity:.9,stop:function(e,t){var i={x:a._x,y:a._y};s.probesViewModel.updateProbe(r,i)}}),e.selected?v.createSmallProbe(o,r,"#365C95"):v.createSmallProbe(o,r)}h.host.droppable({accept:".probe",tolerance:"fit",drop:function(e,t){me(this).offset();var i={x:t.position.left+t.draggable.width()/2,y:t.position.top+t.draggable.height()},r=h.coordinateTransform,o=d.xDataTransform?d.xDataTransform.plotToData(r.screenToPlotX(i.x)):r.screenToPlotX(i.x),n=d.yDataTransform?d.yDataTransform.plotToData(r.screenToPlotY(i.y)):r.screenToPlotY(i.y),a=s.probesViewModel.addProbe({x:o,y:n});g({id:a,location:{x:o,y:n}})}}),s.probesViewModel.subscribe(function(e){var t=e.probe;switch(e.status){case"fit":for(var i=h.domElements,r=0;r<i.length;r++){if((s=i[r]).id===t.id){var o=d.visibleRect,n=d.xDataTransform?d.xDataTransform.dataToPlot(s._x):s._x,a=d.yDataTransform?d.yDataTransform.dataToPlot(s._y):s._y;(1e-7<Math.abs(n-o.x-o.width/2)||1e-7<Math.abs(a-o.y-o.height/2))&&d.navigation.setVisibleRect({x:n-o.width/2,y:a-o.height/2,width:o.width,height:o.height},!0);break}}break;case"remove":for(i=h.domElements,r=0;r<i.length;r++){var s;if((s=i[r]).id===t.id){h.remove(s);break}}break;case"unselected":for(i=h.domElements,r=0;r<i.length;r++){var l=i[r];v.createSmallProbe(l,l.id)}break;case"selected":for(i=h.domElements,r=0;r<i.length;r++){(l=i[r]).id===t.id?v.createSmallProbe(l,l.id,"#365C95"):v.createSmallProbe(l,l.id)}}});for(var c=s.probesViewModel.getProbes(),u=0;u<c.length;u++)g(c[u]);r.on("visibleChanged",function(){var e=[];for(var t in o.currentPlots){var i=o.currentPlots[t],r=i.Plots;r&&0<r.length&&(r[0].isVisible||e.push(i.Id))}o.persistentViewState.selectedPlots=e}),r.on("isAutoFitEnabledChanged",function(){s.isAutoFit=d.isAutoFitEnabled}),r.on("visibleRectChanged",function(){var e=d.visibleRect;i.plotXFormatter=new v.AdaptiveFormatter(e.x,e.x+e.width),i.plotYFormatter=new v.AdaptiveFormatter(e.y,e.y+e.height),s.plotRect=e,void 0!==s.probesViewModel&&s.probesViewModel.refresh()})}function B(e){this.rightPanelExtraShift=3,this.navigationPanelShift=65,this.minWidthToShowLeftPanel=540,this.plotList=void 0,this.viewState=void 0;var t=this,i=this.controlDiv=me(e);this.persistentViewState=this.viewState=new y.PersistentViewState,this.transientViewState=new y.TransientViewState;var r=i.width(),o=i.height();0===r&&i.width(400),0===o&&i.height(400);var n=me("<div class='dsv-visualizaition-control'></div>");i.append(n);var a=me("<div class='dsv-leftpanelcontainer'></div>");n.append(a);var s=me("<div class='dsv-rightpanel'></div>");n.append(s);var l=me("<div class='dsv-leftpanel'></div>");a.append(l),l.append(me("<div class='plotlist'></div>")),s.append(me("<div class='dsv-visualization-preview'></div>"));var d=me("<div class='dsv-navigation-container'></div>").appendTo(n);d.addClass("no-print");var h=this.rightpanel=i.find(".dsv-rightpanel"),g=i.find(".dsv-leftpanel"),c=this.leftPanelContainer=i.find(".dsv-leftpanelcontainer"),u=this.persistentViewState.isLegendShown;this.plotViewer=new y.PlotViewer(i.find(".dsv-visualization-preview"),d,this.persistentViewState,this.transientViewState);var f=i.find(".plotlist");this.plotList=new y.PlotList(f,this.plotViewer,this.persistentViewState,this.transientViewState),this.plotList.isEditable=!1,this.plotViewer.iddChart.exportToSvg=function(e,t,i){if(!ye.supported)throw"SVG is not supported";t=this.screenSize,e=this.coordinateTransform.getPlotRect({x:0,y:0,width:t.width,height:t.height});var r=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=(i=ye(r).size(this.host.width(),this.host.height())).group();this.exportContentToSvg(e,t,o);var n=i.group(),a=this.host.width();return u&&(n.add(this.exportLegendToSvg(this.legend.div[0])).translate(a,30),i.size(200+a,this.host.height())),i};var p=d[0].children[0].firstChild.firstChild;me(p).click(function(){u?(u=!1,t.persistentViewState.isLegendShown=!1,g.hide(),me(p).removeClass("idd-onscreennavigation-showlegend").addClass("idd-onscreennavigation-hidelegend")):(u=!0,t.persistentViewState.isLegendShown=!0,g.show(),me(p).removeClass("idd-onscreennavigation-hidelegend").addClass("idd-onscreennavigation-showlegend")),h.width(i.width()-c.width()-t.rightPanelExtraShift-t.navigationPanelShift),t.plotViewer.updateLayout(),t.persistentViewState.probesViewModel.refresh()}),u?(g.show(),me(p).removeClass("idd-onscreennavigation-hidelegend").addClass("idd-onscreennavigation-showlegend")):g.hide(),h.width(i.width()-c.width()-this.rightPanelExtraShift-this.navigationPanelShift),me(window).resize(function(){t.updateLayout()}),this.updateLayout()}function F(e,t,i){return t[e]===i[e]||(t[e]=i[e],!1)}function V(e){return!isNaN(parseFloat(e))&&isFinite(e)}function L(e){return e===e+""}function Z(e){return V(e)||L(e)}function z(e){if("object"!=typeof e||null==e)return e;if(n.Utils.isArray(e)){for(var t=[],i=0;i<e.length;i++)t.push(z(e[i]));return t}var r={};for(var o in e)r[o]=z(e[o]);return r}function Y(n,e){var a,s,t=r.Utils.getDataSourceFunction(n,r.readCsv)(n);this.base=r.CanvasPlot,this.base(n,e),t&&(a=t.kind),this.draw=function(e){a=e.kind,s=e.error,this.fireAppearanceChanged("error")},Object.defineProperty(this,"isErrorVisible",{get:function(){return!0},configurable:!0}),this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.renderCore=function(e,t){},this.getLegend=function(){function i(){t.text(e.name)}var e=this,t=me("<span></span>"),r=me("<div class='plotcard-error'></div>");i();function o(){var e="";e=s||(a?'kind "'+a+'" is unknown':"Error plot definition!"),r.text(e)}o(),this.host.bind("appearanceChanged",function(e,t){t&&"error"!=t||o(),t&&"name"!=t||i()});e=this;return{name:t,legend:{thumbnail:void 0,content:r},onLegendRemove:function(){e.host.unbind("appearanceChanged"),n[0].innerHTML="",n.removeClass("idd-legend-item")}}}}return be.mercatorTransform=new be.DataTransform(function(e){return-D<=e&&e<=D?G*Math.log(Math.tan(Math.PI*(e+90)/360)):e},function(e){return-D<=e&&e<=D?360*Math.atan(Math.exp(e/G))/Math.PI-90:e},void 0,"mercator"),Math.LOGE10=Math.log(10),be.logTransform=new be.DataTransform(function(e){return Math.log(e)/Math.LOGE10},function(e){return Math.pow(10,e)},{isInDomain:function(e){return 1e-8<e}},"log10"),be.identityTransform=new be.DataTransform(function(e){return e},function(e){return e},{isInDomain:function(e){return!0}},"identity"),be.AnimationBase=function(){var t=void 0,e=this;this.isInAnimation=!1;var i=A.Observable.create(function(e){return t=e,function(){}});Object.defineProperty(this,"currentObserver",{get:function(){return t},configurable:!1}),Object.defineProperty(this,"currentObservable",{get:function(){return i},configurable:!1}),this.targetPlotRect=void 0,this.getCurrentPlotRect=function(){},this.stop=function(){e.isInAnimation&&(e.isInAnimation=!1),t&&(t.onNext({plotRect:e.getCurrentPlotRect(),isLast:!0}),t.onCompleted(),t=void 0),this.additionalStopRutines()},this.additionalStopRutines=function(){},this.animate=function(e,t){}},be.PanZoomAnimation=function(){this.base=be.AnimationBase,this.base();var f=this,p=void 0,v=void 0,m=new Date,y=void 0,r=void 0,b=void 0,C=0,o=void 0,w=void 0,I=0,A=0;this.getCurrentPlotRect=function(){return y},Object.defineProperty(this,"previousEstimatedPlotRect",{get:function(){return r},configurable:!1});var n=function(){!function(){var e=f.currentObserver;if(e){var t=new Date,i=t.getTime()-m.getTime(),r=w*i,o=v.x-y.x,n=v.y-y.y,a=Math.max(v.width/1e3,Math.sqrt(o*o+n*n)),s=y.x+a*r*b.x,l=y.y+a*r*b.y,d=(v.width-y.width)*r+y.width,h=(v.height-y.height)*r+y.height;m=t,o=s-p.x,n=l-p.y;var g=Math.sqrt(o*o+n*n),c=d-p.width,u=h-p.height;C<=g||Math.abs(c)>Math.abs(I)||Math.abs(u)>Math.abs(A)?(f.isInAnimation=!1,y=v,f.stop()):(y={x:s,y:l,width:d,height:h},f.currentPlotRect=y,e.onNext({plotRect:y,isLast:!1}))}}(),f.isInAnimation&&(o=setTimeout(function(){n()},1e3/60))};this.animate=function(e,t){1.2!=be.Gestures.zoomLevelFactor&&(be.Gestures.zoomLevelFactor=1.2),void 0!==o&&(clearTimeout(o),o=void 0),r=t;var i=e();p=void 0===y?i.plotRect:y,y=p,b={x:(v=t).x-p.x,y:v.y-p.y},C=Math.sqrt(b.x*b.x+b.y*b.y),b=1e-10<C?{x:b.x/C,y:b.y/C}:{x:0,y:0},I=t.width-p.width,A=t.height-p.height,w=0!=I||0!=A?.008:.009,f.isInAnimation=!0,n()},this.additionalStopRutines=function(){void 0!==o&&(clearTimeout(o),o=void 0),f.isInAnimation=!1,startCS=p=void 0,v=void 0,m=new Date,startScreenCenter=void(C=0),previousFrameScreenCenter=b=r=y=void 0,endScreenCenter=void 0,o=void 0,A=I=0}},be.PanZoomAnimation.prototype=new be.AnimationBase,be.Utils.getPlotRectForMap=function(e,t){var i=85.05112878,r=void 0===t?{width:e.getWidth(),height:e.getHeight()}:t,o=e.getCenter(),n=r.width,a=r.height,s=e.tryLocationToPixel({latitude:0,longitude:o.longitude},Microsoft.Maps.PixelReference.control),l=e.tryLocationToPixel({latitude:0,longitude:o.longitude+30},Microsoft.Maps.PixelReference.control).x-s.x;l<0&&(l=s.x-e.tryLocationToPixel({latitude:0,longitude:o.longitude-30},Microsoft.Maps.PixelReference.control).x);var d=l/30,h=o.longitude-s.x/d,g=o.longitude+(n-s.x)/d,c=e.getBounds(),u=c.getNorth(),f=c.getSouth(),p=0;i<=u&&(u=i,p=e.tryLocationToPixel({latitude:u,longitude:o.longitude},Microsoft.Maps.PixelReference.control).y);var v=0;f<=-i&&(f=-i,v=a-e.tryLocationToPixel({latitude:f,longitude:o.longitude},Microsoft.Maps.PixelReference.control).y);var m=g-h;m<0&&(m=c.width);var y={y:f,x:h,width:m,height:u-f},b=be.mercatorTransform.dataToPlot(y.y),C=be.mercatorTransform.dataToPlot(y.y+y.height);if(y.y=b,y.height=C-b,0!=v||0!=p){var w=a-p-v,I=y.height/w,A=v*I,x=p*I,T=y.y-A,S=y.y+y.height+x;y.y=T,y.height=S-T}return y},be.BingMapsAnimation=function(e){this.base=be.AnimationBase,this.base();var c=this,u=e,g=void 0,f=void 0,p=new Date,v=void 0,m=void 0,y=void 0,b=0,o=void 0,C=void 0,w=!1;Object.defineProperty(this,"previousEstimatedPlotRect",{get:function(){return m},configurable:!1});var n=function(){!function(){if(c.currentObserver){var e=new Date,t=e.getTime()-p.getTime(),i=C*t,r=f.x-v.x,o=f.y-v.y,n=Math.max(f.width/1e3,Math.sqrt(r*r+o*o)),a=v.x+n*i*y.x,s=v.y+n*i*y.y,l=(f.width-v.width)*i+v.width,d=(f.height-v.height)*i+v.height;p=e,r=a-g.x,o=s-g.y;var h=Math.sqrt(r*r+o*o);b<=h?(c.isInAnimation=!1,x(f),c.stop()):(v={x:a,y:s,width:l,height:d},c.currentPlotRect=v,x(v))}}(),c.isInAnimation&&(o=setTimeout(function(){n()},1e3/60))};this.animate=function(e,t,i){if(1.4!=be.Gestures.zoomLevelFactor&&(be.Gestures.zoomLevelFactor=1.4),void 0!==o&&(clearTimeout(o),o=void 0),m=t,c.isInAnimation=!0,i&&i.isFirstFrame&&T(!0),i&&"Pan"==i.gestureType){w=!1;var r=e();g=void 0===v?r.plotRect:v,v=g,y={x:(f=t).x-g.x,y:f.y-g.y},b=Math.sqrt(y.x*y.x+y.y*y.y),y=1e-10<b?{x:y.x/b,y:y.y/b}:{x:0,y:0},C=.008,n()}else w=!0,x(t)};function I(e,t,i){var r=Math.max(1,Math.log(t.width/e.width*360/256)/Math.log(2)),o=be.mercatorTransform.plotToData(e.y),n=be.mercatorTransform.plotToData(e.y+e.height),a=Math.max(1,Math.log(t.height/(n-o)*180/256)/Math.log(2));return!0===i&&(r=Math.ceil(r)-1,a=Math.ceil(a)),Math.min(r,a)}this.setMapView=function(e,t){var i=t;void 0===t&&(i={width:u.getWidth(),height:u.getHeight()});var r=I(e,i,!0),o=(u.getZoom(),{x:e.x+e.width/2,y:be.mercatorTransform.plotToData(e.y+e.height/2)});u.setView({center:new Microsoft.Maps.Location(o.y,o.x),zoom:r,animate:!1})};var A=0,x=function(e){var t,i=u.getZoom()+A;A=0,t=w?I(e,{width:u.getWidth(),height:u.getHeight()}):i;var r,o,n={x:e.x+e.width/2,y:be.mercatorTransform.plotToData(e.y+e.height/2)};if(w)if(1<i||i<t){var a=Math.round(t),s=(r=a,{width:360*(o={width:u.getWidth(),height:u.getHeight()}).width/(256*Math.pow(2,r)),height:180*o.height/(256*Math.pow(2,r))});if(e.zoomOrigin)var l=e.zoomOrigin.x,d=be.mercatorTransform.plotToData(e.zoomOrigin.y),h=d-n.y,g={x:l-(l-n.x)*(s.width/e.width),y:d-h*(s.height/e.height)};else g=n;u.setView({center:new Microsoft.Maps.Location(g.y,g.x),zoom:t,animate:!0})}else T(),m=c.getCurrentPlotRect(),c.stop();else u.setView({center:new Microsoft.Maps.Location(n.y,n.x),zoom:t,animate:!1})};this.getCurrentPlotRect=function(){return u.getBounds(),u.getCenter(),be.Utils.getPlotRectForMap(u)};var T=function(e){var t=c.currentObserver;if(void 0!==t){var i={plotRect:c.getCurrentPlotRect(),isLast:!1};void 0!==e&&(i.syncUpdate=e),t.onNext(i)}};Microsoft.Maps.Events.addHandler(u,"viewchange",function(e){T()}),Microsoft.Maps.Events.addHandler(u,"viewchangeend",function(e){m=c.getCurrentPlotRect(),w||!c.isInAnimation?c.stop():T()}),this.additionalStopRutines=function(){void 0!==o&&(clearTimeout(o),o=void 0),c.isInAnimation=!1,m=f=g=void 0,p=new Date,y=v=void 0,o=void(b=0),0}},be.BingMapsAnimation.prototype=new be.AnimationBase,be.Event=be.Event||{},be.Event.widthScaleChanged=jQuery.Event("widthScaleChanged"),be.Navigation=function(e,i){var s=e,l=this;s.master.host.on("visibleRectChanged",function(e){var t=s.screenSize.width,i=s.screenSize.width;ct=s.coordinateTransform,vis=ct.getPlotRect({x:0,y:0,width:t,height:i});var r=t/vis.width;s.master.host.trigger(be.Event.widthScaleChanged,{widthScale:r})});function d(){var e=s.screenSize,t=s.coordinateTransform;return{plotRect:t.getPlotRect({x:0,y:0,width:e.width,height:e.height}),screenSize:e,cs:t}}function h(e,t){i(e,t)}var t=void 0,r=void 0,o=void 0,g=void 0;Object.defineProperty(this,"animation",{get:function(){return o},set:function(e){l.stop(),o=e},configurable:!1});var c=be.NavigationUtils.calcPannedRect,u=be.NavigationUtils.calcZoomedRect;Object.defineProperty(this,"widthScale",{get:function(){return s.coordinateTransform.getScale().x},set:function(e){l.stop();var t=s.visibleRect,i=s.screenSize.width/e,r=i/(t.width/t.height),o={x:t.x+.5*t.width-.5*i,y:t.y+.5*t.height-.5*r,width:i,height:r};l.setVisibleRect(o,!1,{suppressScaleChangeNotification:!0})},configurable:!1});function f(){return o&&o.currentObservable.subscribe(function(e){e.isLast&&(s.isInAnimation=!1);var t={syncUpdate:e.syncUpdate};h(e.plotRect,t)},function(e){},function(){})}this.setVisibleRect=function(e,t,i){if(l.stop(),g=e,t)l.animation.isInAnimation||f(),s.isInAnimation=!0,l.animation.animate(d,e);else{var r=e;l.animation&&l.animation.constraint&&(r=l.animation.constraint(r)),h(r,i)}};this.stop=function(){s.isInAnimation=!1,g=void 0,l.animation&&l.animation.stop()},Object.defineProperty(this,"gestureSource",{get:function(){return t},set:function(e){t!=e&&(r&&r.dispose(),void 0!==(t=e)&&(r=t.subscribe(function(e){!function(e){var t,i,r=s.screenSize,o=void 0!==l.animation?l.animation.previousEstimatedPlotRect:g;if(i=void 0!==o?(t=be.Utils.calcCSWithPadding(o,{width:r.width,height:r.height},{left:0,top:0,bottom:0,right:0},s.aspectRatio),o):(t=s.coordinateTransform).getPlotRect({x:0,y:0,width:r.width,height:r.height}),"Pin"!=e.Type){var n=void 0;if("Pan"==e.Type?(n=c(i,r,e),g=n):"Zoom"==e.Type&&((n=u(i,t,e)).width<1e-9&&(n.width=i.width,n.x=i.x),n.height<1e-9&&(n.height=i.height,n.y=i.y),g=n),n)if(l.animation){var a=!l.animation.isInAnimation;a&&f(),s.isInAnimation=!0,l.animation.animate(d,n,{gestureType:e.Type,isFirstFrame:a})}else h(n)}else l.animation&&l.animation.isInAnimation&&l.stop()}(e)})))},configurable:!1}),l.animation=new be.PanZoomAnimation},be.NavigationUtils={},be.NavigationUtils.SuppressDefaultMultitouch=function(){navigator.userAgent.match(/(iPhone|iPod|iPad)/)&&document.addEventListener("touchmove",function(e){e.preventDefault()},!1),-1!=navigator.userAgent.indexOf("Mac")&&(document.getElementsByTagName("body")[0].style.overflow="hidden")},be.NavigationUtils.calcPannedRect=function(e,t,i){var r=e.width/t.width,o=e.height/t.height,n=i.xOffset*r,a=-i.yOffset*o;return{x:e.x-n,y:e.y-a,width:e.width,height:e.height}},be.NavigationUtils.calcZoomedRect=function(e,t,i){var r=t.getScale(),o=t.plotToScreenX(e.x+e.width/2),n=t.plotToScreenY(e.y+e.height/2),a=i.preventHorizontal?0:i.xOrigin-o,s=i.preventVertical?0:i.yOrigin-n,l=e.x+a/r.x,d=e.y-s/r.y,h=e.width,g=e.height,c=e.width*(i.preventHorizontal?1:i.scaleFactor),u=e.height*(i.preventVertical?1:i.scaleFactor),f=d+g/2-u/2;return{x:l+h/2-c/2-i.scaleFactor*a/r.x,y:f+i.scaleFactor*s/r.y,width:c,height:u,zoomOrigin:{x:t.screenToPlotX(i.xOrigin),y:t.screenToPlotY(i.yOrigin)}}},be.SharedRenderWorker=function(t,o){var e=!!window.Worker;!e&&window.console&&console.log("Web workers are not available");var n=null;try{n=e?new Worker(t):null}catch(e){console.error("Error creating Web worker from "+t+": "+e.message)}function r(e,t){for(var i=s.length,r=0;r<i;r++)if(s[r].source==e)return s[r];if(!t){var o={source:e,pendingTask:void 0,index:i};return s.push(o),o}}var a=!1,s=[];n&&(n.onmessage=function(e){var t=e.data,i=s[t.sourceIndex],r=function(e){var t=s.length,i=0;if(e){for(var r=(i=e.index)+1;r<t;r++)if(s[r].pendingTask)return s[r];for(r=0;r<i;r++)if(s[r].pendingTask)return s[r];if(s[i].pendingTask)return s[i]}else for(r=0;r<t;r++)if(s[r].pendingTask)return s[r]}(i);r?(a=!0,n.postMessage(r.pendingTask),r.pendingTask=void 0):a=!1,o&&o(i.source,t)},n.onerror=function(e){var t=e.message+" ("+e.filename+":"+e.lineno+")";"object"==typeof console&&console.log(t)}),this.enqueue=function(e,t){var i=r(t);e.sourceIndex=i.index,a?i.pendingTask=e:(a=!0,i.pendingTask=void 0,n.postMessage(e))},this.cancelPending=function(e){var t=r(e,!0);t&&(t.pendingTask=void 0)},e||(this.enqueue=function(e,t){},this.cancelPending=function(e){})},be.heatmapBackgroundRendererCodeBase64="SW50ZXJhY3RpdmVEYXRhRGlzcGxheSA9IHR5cGVvZiBJbnRlcmFjdGl2ZURhdGFEaXNwbGF5ID09ICd1bmRlZmluZWQnID8ge30gOiBJbnRlcmFjdGl2ZURhdGFEaXNwbGF5Ow0KIA0KSW50ZXJhY3RpdmVEYXRhRGlzcGxheS5EYXRhVHJhbnNmb3JtID0gZnVuY3Rpb24gKGRhdGFUb1Bsb3QsIHBsb3RUb0RhdGEsIGRvbWFpbiwgdHlwZSkgew0KICAgIHRoaXMuZGF0YVRvUGxvdCA9IGRhdGFUb1Bsb3Q7DQogICAgdGhpcy5wbG90VG9EYXRhID0gcGxvdFRvRGF0YTsNCg0KICAgIHRoaXMuZG9tYWluID0gZG9tYWluIHx8IHsNCiAgICAgICAgaXNJbkRvbWFpbjogZnVuY3Rpb24gKHZhbHVlKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICB0aGlzLnR5cGUgPSB0eXBlOw0KfTsNCg0KdmFyIG1lcmNhdG9yX21heFBoaSA9IDg1LjA1MTEyODc4OyAvLzg3LjExNDc1NzYzNjMzODQ7IC8vIGRlZw0KdmFyIG1lcmNhdG9yX1IgPSBtZXJjYXRvcl9tYXhQaGkgLyBNYXRoLmxvZyhNYXRoLnRhbihtZXJjYXRvcl9tYXhQaGkgKiBNYXRoLlBJIC8gMzYwLjAgKyBNYXRoLlBJIC8gNCkpOw0KSW50ZXJhY3RpdmVEYXRhRGlzcGxheS5tZXJjYXRvclRyYW5zZm9ybSA9IG5ldyBJbnRlcmFjdGl2ZURhdGFEaXNwbGF5LkRhdGFUcmFuc2Zvcm0oDQogICAgZnVuY3Rpb24gKHBoaV9kZWcpIHsNCiAgICAgICAgaWYgKHBoaV9kZWcgPj0gLW1lcmNhdG9yX21heFBoaSAmJiBwaGlfZGVnIDw9IG1lcmNhdG9yX21heFBoaSkNCiAgICAgICAgICAgIHJldHVybiBtZXJjYXRvcl9SICogTWF0aC5sb2coTWF0aC50YW4oTWF0aC5QSSAqIChwaGlfZGVnICsgOTApIC8gMzYwKSk7DQogICAgICAgIGVsc2UgcmV0dXJuIHBoaV9kZWc7DQogICAgfSwNCiAgICBmdW5jdGlvbiAoeSkgew0KICAgICAgICBpZiAoLW1lcmNhdG9yX21heFBoaSA8PSB5ICYmIHkgPD0gbWVyY2F0b3JfbWF4UGhpKSB7DQogICAgICAgICAgICByZXR1cm4gMzYwICogTWF0aC5hdGFuKE1hdGguZXhwKHkgLyBtZXJjYXRvcl9SKSkgLyBNYXRoLlBJIC0gOTA7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHk7DQogICAgfSwNCiAgICB1bmRlZmluZWQsDQogICAgIm1lcmNhdG9yIg0KKTsNCg0KDQpNYXRoLkxPR0UxMCA9IE1hdGgubG9nKDEwKTsNCg0KSW50ZXJhY3RpdmVEYXRhRGlzcGxheS5sb2dUcmFuc2Zvcm0gPSBuZXcgSW50ZXJhY3RpdmVEYXRhRGlzcGxheS5EYXRhVHJhbnNmb3JtKA0KICAgIGZ1bmN0aW9uICh4X2QpIHsNCiAgICAgICAgcmV0dXJuIE1hdGgubG9nKHhfZCkgLyBNYXRoLkxPR0UxMDsNCiAgICB9LA0KICAgIGZ1bmN0aW9uICh4X3ApIHsNCiAgICAgICAgcmV0dXJuIE1hdGgucG93KDEwLCB4X3ApOw0KICAgIH0sDQogICAgeyBpc0luRG9tYWluOiBmdW5jdGlvbiAoeCkgeyByZXR1cm4geCA+IDAuMDAwMDAwMDE7IH0gfSwNCiAgICAibG9nMTAiDQopOw0KDQpJbnRlcmFjdGl2ZURhdGFEaXNwbGF5LmlkZW50aXR5VHJhbnNmb3JtID0gbmV3IEludGVyYWN0aXZlRGF0YURpc3BsYXkuRGF0YVRyYW5zZm9ybSgNCiAgICBmdW5jdGlvbiAoeF9kKSB7IHJldHVybiB4X2Q7IH0sDQogICAgZnVuY3Rpb24gKHhfcCkgeyByZXR1cm4geF9wOyB9LA0KICAgIHsgaXNJbkRvbWFpbjogZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHRydWUgfSB9LA0KICAgICJpZGVudGl0eSINCik7O3NlbGYub25tZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7DQogICAgdmFyIHhzY2FsZSA9IGV2ZW50LmRhdGEuc2NhbGVYLCB4b2Zmc2V0ID0gZXZlbnQuZGF0YS5vZmZzZXRYLCB5c2NhbGUgPSBldmVudC5kYXRhLnNjYWxlWSwgeW9mZnNldCA9IGV2ZW50LmRhdGEub2Zmc2V0WTsNCiAgICB2YXIgZGF0YVRvU2NyZWVuWCwgZGF0YVRvU2NyZWVuWTsNCiAgICB2YXIgaGFzZHRYLCBoYXNkdFk7DQoNCiAgICBpZiAodHlwZW9mIGV2ZW50LmRhdGEueERhdGFUcmFuc2Zvcm0gPT0gJ3N0cmluZycpIHsNCiAgICAgICAgdmFyIGR0ID0gZ2V0RGF0YVRyYW5zZm9ybShldmVudC5kYXRhLnhEYXRhVHJhbnNmb3JtKTsNCiAgICAgICAgdmFyIGYgPSBkdC5kYXRhVG9QbG90Ow0KICAgICAgICBoYXNkdFggPSB0cnVlOw0KICAgICAgICBkYXRhVG9TY3JlZW5YID0gZnVuY3Rpb24gKHgpIHsNCiAgICAgICAgICAgIHJldHVybiBmKHgpICogeHNjYWxlICsgeG9mZnNldDsNCiAgICAgICAgfTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBoYXNkdFggPSBmYWxzZTsNCiAgICAgICAgZGF0YVRvU2NyZWVuWCA9IGZ1bmN0aW9uICh4KSB7DQogICAgICAgICAgICByZXR1cm4geHNjYWxlICogeCArIHhvZmZzZXQ7DQogICAgICAgIH07DQogICAgfQ0KICAgIGlmICh0eXBlb2YgZXZlbnQuZGF0YS55RGF0YVRyYW5zZm9ybSA9PSAnc3RyaW5nJykgew0KICAgICAgICB2YXIgZHQgPSBnZXREYXRhVHJhbnNmb3JtKGV2ZW50LmRhdGEueURhdGFUcmFuc2Zvcm0pOw0KICAgICAgICB2YXIgZiA9IGR0LmRhdGFUb1Bsb3Q7DQogICAgICAgIGhhc2R0WSA9IHRydWU7DQogICAgICAgIGRhdGFUb1NjcmVlblkgPSBmdW5jdGlvbiAoeSkgew0KICAgICAgICAgICAgcmV0dXJuIHlvZmZzZXQgLSBmKHkpICogeXNjYWxlOw0KICAgICAgICB9Ow0KICAgIH0gZWxzZSB7DQogICAgICAgIGhhc2R0WSA9IGZhbHNlOw0KICAgICAgICBkYXRhVG9TY3JlZW5ZID0gZnVuY3Rpb24gKHkpIHsNCiAgICAgICAgICAgIHJldHVybiB5b2Zmc2V0IC0geSAqIHlzY2FsZTsNCiAgICAgICAgfTsNCiAgICB9DQoNCiAgICB2YXIgd2lkdGggPSBldmVudC5kYXRhLndpZHRoOw0KICAgIHZhciBoZWlnaHQgPSBldmVudC5kYXRhLmhlaWdodDsNCg0KICAgIGlmIChldmVudC5kYXRhLngubGVuZ3RoICE9IGV2ZW50LmRhdGEuZi5sZW5ndGgpIHsNCiAgICAgICAgcmVuZGVyTWF0cml4KGV2ZW50LmRhdGEuaW1hZ2UsIHdpZHRoLCBoZWlnaHQsIGV2ZW50LmRhdGEueCwgZXZlbnQuZGF0YS55LCBldmVudC5kYXRhLmYsIGV2ZW50LmRhdGEuZm1pbiwgZXZlbnQuZGF0YS5mbWF4LCBldmVudC5kYXRhLnBhbGV0dGUsIGV2ZW50LmRhdGEucGxvdFJlY3QsIGRhdGFUb1NjcmVlblgsIGRhdGFUb1NjcmVlblksIGhhc2R0WCwgaGFzZHRZKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICB2YXIgc2NyZWVuVG9EYXRhWCwgc2NyZWVuVG9EYXRhWTsNCiAgICAgICAgeHNjYWxlX3IgPSAxIC8geHNjYWxlOw0KICAgICAgICB5c2NhbGVfciA9IDEgLyB5c2NhbGU7DQogICAgICAgIGlmIChoYXNkdFgpIHsNCiAgICAgICAgICAgIHZhciBwbG90VG9EYXRhID0gZHQucGxvdFRvRGF0YTsNCiAgICAgICAgICAgIHNjcmVlblRvRGF0YVggPSBmdW5jdGlvbiAoeHMpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gcGxvdFRvRGF0YSgoeHMgLSB4b2Zmc2V0KSAqIHhzY2FsZV9yKTsNCiAgICAgICAgICAgIH07DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzY3JlZW5Ub0RhdGFYID0gZnVuY3Rpb24gKHhzKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICh4cyAtIHhvZmZzZXQpICogeHNjYWxlX3I7DQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQogICAgICAgIGlmIChoYXNkdFkpIHsNCiAgICAgICAgICAgIHZhciBwbG90VG9EYXRhID0gZHQucGxvdFRvRGF0YTsNCiAgICAgICAgICAgIHNjcmVlblRvRGF0YVkgPSBmdW5jdGlvbiAoeXMpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gcGxvdFRvRGF0YSgoeW9mZnNldCAtIHlzKSAqIHlzY2FsZV9yKTsNCiAgICAgICAgICAgIH07DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzY3JlZW5Ub0RhdGFZID0gZnVuY3Rpb24gKHlzKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICh5b2Zmc2V0IC0geXMpICogeXNjYWxlX3I7DQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQogICAgICAgIHJlbmRlckdyYWRpZW50KGV2ZW50LmRhdGEuaW1hZ2UsIHdpZHRoLCBoZWlnaHQsIGV2ZW50LmRhdGEueCwgZXZlbnQuZGF0YS55LCBldmVudC5kYXRhLmYsIGV2ZW50LmRhdGEuZm1pbiwgZXZlbnQuZGF0YS5mbWF4LCBldmVudC5kYXRhLnBhbGV0dGUsIGV2ZW50LmRhdGEucGxvdFJlY3QsIGRhdGFUb1NjcmVlblgsIHNjcmVlblRvRGF0YVgsIGRhdGFUb1NjcmVlblksIHNjcmVlblRvRGF0YVksIGhhc2R0WCwgaGFzZHRZKTsNCiAgICB9DQogICAgZXZlbnQuZGF0YS54ID0gdW5kZWZpbmVkOw0KICAgIGV2ZW50LmRhdGEueSA9IHVuZGVmaW5lZDsNCiAgICBldmVudC5kYXRhLmYgPSB1bmRlZmluZWQ7DQogICAgZXZlbnQuZGF0YS5wYWxldHRlID0gdW5kZWZpbmVkOw0KICAgIHNlbGYucG9zdE1lc3NhZ2UoZXZlbnQuZGF0YSk7DQp9Ow0KDQp2YXIgZ2V0RGF0YVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0eXBlKSB7DQogICAgaWYgKHR5cGUgPT0gJ21lcmNhdG9yJykNCiAgICAgICAgcmV0dXJuIEludGVyYWN0aXZlRGF0YURpc3BsYXkubWVyY2F0b3JUcmFuc2Zvcm07DQogICAgdGhyb3cgJ1Vua25vd24gZGF0YSB0cmFuc2Zvcm0nOw0KfTsNCg0KDQp2YXIgcmVuZGVyTWF0cml4ID0gZnVuY3Rpb24gKGltYWdlLCB3aWR0aCwgaGVpZ2h0LCB4LCB5LCBmLCBmbWluLCBmbWF4LCBwYWxldHRlLCBwbG90UmVjdCwgZGF0YVRvU2NyZWVuWCwgZGF0YVRvU2NyZWVuWSwgaGFzRGF0YVRyYW5zZm9ybVgsIGhhc0RhdGFUcmFuc2Zvcm1ZKSB7DQogICAgdmFyIG4gPSB4Lmxlbmd0aDsNCiAgICB2YXIgbSA9IHkubGVuZ3RoOw0KICAgIHZhciBpbWFnZURhdGEgPSBpbWFnZS5kYXRhOw0KICAgIHZhciB3ID0gd2lkdGg7DQogICAgdmFyIGggPSBoZWlnaHQ7DQoNCiAgICB2YXIgaTAsIGowOw0KICAgIHZhciB4MCwgeTA7IC8vIGluIGRhdGEgc3BhY2UNCg0KDQogICAgLy8gcHJlY29tcHV0aW5nIHkgaW4gc2NyZWVuIGNvb3JkaW5hdGVzOg0KICAgIHZhciB5c2NyID0gbmV3IEZsb2F0MzJBcnJheShtKTsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG07IGkrKykNCiAgICAgICAgeXNjcltpXSA9IGRhdGFUb1NjcmVlblkoeVtpXSkgfCAwOyAvLyBmbG9vcjsNCg0KICAgIC8vIHN0YXJ0IGNlbGwNCiAgICB2YXIgbGVmdHAgPSBwbG90UmVjdC54Ow0KICAgIHZhciByaWdodHAgPSBsZWZ0cCArIHBsb3RSZWN0LndpZHRoOw0KICAgIGlmIChoYXNEYXRhVHJhbnNmb3JtWCkgew0KICAgICAgICBmb3IgKGkwID0gMDsgaTAgPCBuOyBpMCsrKSB7DQogICAgICAgICAgICBpZiAoZGF0YVRvU2NyZWVuWCh4W2kwXSkgPj0gMCkgew0KICAgICAgICAgICAgICAgIGlmIChpMCA9PSAwKSBpMCsrOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgZm9yIChpMCA9IDA7IGkwIDwgbjsgaTArKykgew0KICAgICAgICAgICAgaWYgKHhbaTBdID49IGxlZnRwKSB7DQogICAgICAgICAgICAgICAgaWYgKGkwID09IDApIGkwKys7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKGkwID09IG4pIHJldHVybjsNCg0KICAgIHZhciBib3R0b21wID0gcGxvdFJlY3QueTsNCiAgICB2YXIgdG9wcCA9IGJvdHRvbXAgKyBwbG90UmVjdC5oZWlnaHQ7DQogICAgZm9yIChqMCA9IDA7IGowIDwgbTsgajArKykgew0KICAgICAgICBpZiAoeXNjcltqMF0gPCBoKSB7DQogICAgICAgICAgICBpZiAoajAgPT0gMCkgajArKzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChqMCA9PSBtKSByZXR1cm47DQoNCiAgICAvLyByZW5kZXJpbmcgZnJvbSBsZWZ0IHRvIHJpZ2h0LCBib3R0b20gdG8gdG9wDQogICAgdmFyIGNlbGxMZWZ0X3MgPSAwLCBjZWxsUmlnaHRfcyA9IDA7DQoNCiAgICB2YXIgaXNOb3JtYWxpemVkID0gcGFsZXR0ZS5pc05vcm1hbGl6ZWQ7DQogICAgdmFyIGNvbG9ycyA9IHBhbGV0dGUuY29sb3JzOw0KICAgIHZhciBjb2xOID0gKGNvbG9ycy5sZW5ndGggPj4gMikgLSAxOw0KICAgIGlmICghaXNOb3JtYWxpemVkKSB7DQogICAgICAgIGZtYXggPSBwYWxldHRlLnJhbmdlLm1heDsNCiAgICAgICAgZm1pbiA9IHBhbGV0dGUucmFuZ2UubWluOw0KICAgIH0NCiAgICB2YXIgcGFsZXR0ZUsgPSBmbWF4ICE9PSBmbWluID8gMS4wIC8gKGZtYXggLSBmbWluKSA6IDA7DQoNCiAgICBmb3IgKHZhciBpID0gaTA7IGkgPCBuICYmIGNlbGxSaWdodF9zIDwgdzsgaSsrKSB7DQogICAgICAgIC8vIGkwIGlzIHRoZSByaWdodCB2aXNpYmxlIGVkZ2Ugb2YgdGhlIGNlbGwNCiAgICAgICAgeDAgPSB4W2kgLSAxXTsNCiAgICAgICAgdmFyIHgxID0geFtpXTsNCg0KICAgICAgICBpZiAoeDAgIT0geDAgfHwgeDEgIT0geDEpIHsNCiAgICAgICAgICAgIGNlbGxSaWdodF9zID0gdW5kZWZpbmVkOw0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoY2VsbFJpZ2h0X3MpDQogICAgICAgICAgICBjZWxsTGVmdF9zID0gY2VsbFJpZ2h0X3M7DQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIGNlbGxMZWZ0X3MgPSBNYXRoLmNlaWwoZGF0YVRvU2NyZWVuWCh4MCkpOw0KDQogICAgICAgIGNlbGxSaWdodF9zID0gTWF0aC5jZWlsKGRhdGFUb1NjcmVlblgoeDEpKTsNCiAgICAgICAgaWYgKGNlbGxMZWZ0X3MgPCAwKSBjZWxsTGVmdF9zID0gMDsNCiAgICAgICAgaWYgKGNlbGxSaWdodF9zID49IHcpIGNlbGxSaWdodF9zID0gdzsNCg0KICAgICAgICAvL2lmIChpID09IG4gLSAxKSBjZWxsUmlnaHRfcysrOw0KICAgICAgICBpZiAoY2VsbFJpZ2h0X3MgLSBjZWxsTGVmdF9zID09IDApIGNvbnRpbnVlOw0KDQogICAgICAgIHkwID0geVtqMCAtIDFdOw0KICAgICAgICB2YXIgY2VsbEJvdHRvbV9zID0gMCwNCiAgICAgICAgICAgIGNlbGxUb3BfcyA9IHlzY3JbajAgLSAxXTsNCiAgICAgICAgZm9yICh2YXIgaiA9IGowOyBqIDwgbSAmJiBjZWxsQm90dG9tX3MgPj0gMDsgaisrKSB7DQogICAgICAgICAgICB5MCA9IHlbaiAtIDFdOw0KICAgICAgICAgICAgdmFyIHkxID0geVtqXTsNCg0KICAgICAgICAgICAgaWYgKHkwICE9IHkwIHx8IHkxICE9IHkxKSB7DQogICAgICAgICAgICAgICAgY2VsbFRvcF9zID0gdW5kZWZpbmVkOw0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoY2VsbFRvcF9zKQ0KICAgICAgICAgICAgICAgIGNlbGxCb3R0b21fcyA9IGNlbGxUb3BfczsNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICBjZWxsQm90dG9tX3MgPSB5c2NyW2ogLSAxXTsNCiAgICAgICAgICAgIGNlbGxUb3BfcyA9IHlzY3Jbal07DQogICAgICAgICAgICBpZiAoY2VsbFRvcF9zIDwgMCkgY2VsbFRvcF9zID0gLTE7DQogICAgICAgICAgICBpZiAoY2VsbEJvdHRvbV9zID49IGgpIGNlbGxCb3R0b21fcyA9IGggLSAxOw0KDQogICAgICAgICAgICBpZiAoY2VsbFRvcF9zIC0gY2VsbEJvdHRvbV9zID09IDApIGNvbnRpbnVlOw0KDQogICAgICAgICAgICB2YXIgX2YgPSBmW2kgLSAxXVtqIC0gMV07DQogICAgICAgICAgICBpZiAoX2YgIT0gX2YpIGNvbnRpbnVlOw0KICAgICAgICAgICAgdmFyIHBhbGV0dGVWYWwgPSBwYWxldHRlSyAqIChfZiAtIGZtaW4pOw0KICAgICAgICAgICAgdmFyIGsgPSAocGFsZXR0ZVZhbCAqIGNvbE4pIHwgMDsNCiAgICAgICAgICAgIGlmIChrIDwgMCkgayA9IDA7DQogICAgICAgICAgICBlbHNlIGlmIChrID4gY29sTikgayA9IGNvbE47DQogICAgICAgICAgICBrID0gayA8PCAyOw0KDQogICAgICAgICAgICAvLyBmaWxscyB0aGUgY2VsbCB3aXRoIHNhbWUgY29sb3INCiAgICAgICAgICAgIGZvciAodmFyIHlzID0gY2VsbFRvcF9zICsgMTsgeXMgPD0gY2VsbEJvdHRvbV9zOyB5cysrKSB7DQogICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gKHcgKiB5cyArIGNlbGxMZWZ0X3MpIDw8IDI7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgeHMgPSBjZWxsTGVmdF9zOyB4cyA8IGNlbGxSaWdodF9zOyB4cysrKSB7DQogICAgICAgICAgICAgICAgICAgIGltYWdlRGF0YVtpbmRleCsrXSA9IGNvbG9yc1trXTsNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2luZGV4KytdID0gY29sb3JzW2sgKyAxXTsNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2luZGV4KytdID0gY29sb3JzW2sgKyAyXTsNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2luZGV4KytdID0gY29sb3JzW2sgKyAzXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoY2VsbFRvcF9zIDw9IDApIGJyZWFrOw0KICAgICAgICB9DQogICAgICAgIGlmIChjZWxsUmlnaHRfcyA+PSB3KSBicmVhazsNCiAgICB9DQp9Ow0KDQoNCnZhciByZW5kZXJHcmFkaWVudCA9IGZ1bmN0aW9uIChpbWFnZSwgd2lkdGgsIGhlaWdodCwgeCwgeSwgZiwgZm1pbiwgZm1heCwgcGFsZXR0ZSwgcGxvdFJlY3QsIGRhdGFUb1NjcmVlblgsIHNjcmVlblRvRGF0YVgsIGRhdGFUb1NjcmVlblksIHNjcmVlblRvRGF0YVksIGhhc0RhdGFUcmFuc2Zvcm1YLCBoYXNEYXRhVHJhbnNmb3JtWSkgew0KICAgIHZhciBuID0geC5sZW5ndGg7DQogICAgdmFyIG0gPSB5Lmxlbmd0aDsNCiAgICB2YXIgaW1hZ2VEYXRhID0gaW1hZ2UuZGF0YTsNCiAgICB2YXIgdyA9IHdpZHRoOw0KICAgIHZhciBoID0gaGVpZ2h0Ow0KDQogICAgLy8gcHJlY29tcHV0aW5nIHkgaW4gc2NyZWVuIGNvb3JkaW5hdGVzOg0KICAgIHZhciB5c2NyID0gbmV3IEZsb2F0MzJBcnJheShtKTsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG07IGkrKykNCiAgICAgICAgeXNjcltpXSA9IGRhdGFUb1NjcmVlblkoeVtpXSkgfCAwOyAvLyBmbG9vcjsNCg0KICAgIC8vIHByZXBhcmluZyBzY3JlZW4gdG8gZGF0YSBtYXBwaW5nDQogICAgdmFyIG1hcFNjcmVlblRvRGF0YVggPSBuZXcgRmxvYXQzMkFycmF5KHcpOw0KICAgIGZvciAodmFyIHhzID0gMDsgeHMgPCB3OyB4cysrKSB7DQogICAgICAgIG1hcFNjcmVlblRvRGF0YVhbeHNdID0gc2NyZWVuVG9EYXRhWCh4cyArIDAuNSk7IC8vIHRvZG86IG1ha2UgaW5saW5lIHRyYW5zZm9ybSBmb3IgbGluZWFyIGNhc2UNCiAgICB9DQogICAgdmFyIG1hcFNjcmVlblRvRGF0YVkgPSBuZXcgRmxvYXQzMkFycmF5KGgpOw0KICAgIGZvciAodmFyIHlzID0gMDsgeXMgPCBoOyB5cysrKSB7DQogICAgICAgIG1hcFNjcmVlblRvRGF0YVlbeXNdID0gc2NyZWVuVG9EYXRhWSh5cyArIDAuNSk7IC8vIHRvZG86IG1ha2UgaW5saW5lIHRyYW5zZm9ybSBmb3IgbGluZWFyIGNhc2UNCiAgICB9DQoNCiAgICB2YXIgaTAsIGowOw0KICAgIHZhciB4MCwgeTA7IC8vIGluIGRhdGEgc3BhY2UNCg0KICAgIC8vIHN0YXJ0IGNlbGwNCiAgICB2YXIgbGVmdHAgPSBwbG90UmVjdC54Ow0KICAgIHZhciByaWdodHAgPSBsZWZ0cCArIHBsb3RSZWN0LndpZHRoOw0KICAgIGlmIChoYXNEYXRhVHJhbnNmb3JtWCkgew0KICAgICAgICBmb3IgKGkwID0gMDsgaTAgPCBuOyBpMCsrKSB7DQogICAgICAgICAgICBpZiAoZGF0YVRvU2NyZWVuWCh4W2kwXSkgPj0gMCkgew0KICAgICAgICAgICAgICAgIGlmIChpMCA9PSAwKSBpMCsrOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgZm9yIChpMCA9IDA7IGkwIDwgbjsgaTArKykgew0KICAgICAgICAgICAgaWYgKHhbaTBdID49IGxlZnRwKSB7DQogICAgICAgICAgICAgICAgaWYgKGkwID09IDApIGkwKys7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKGkwID09IG4pIHJldHVybjsNCg0KICAgIHZhciBib3R0b21wID0gcGxvdFJlY3QueTsNCiAgICB2YXIgdG9wcCA9IGJvdHRvbXAgKyBwbG90UmVjdC5oZWlnaHQ7DQogICAgZm9yIChqMCA9IDA7IGowIDwgbTsgajArKykgew0KICAgICAgICBpZiAoeXNjcltqMF0gPCBoKSB7DQogICAgICAgICAgICBpZiAoajAgPT0gMCkgajArKzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChqMCA9PSBtKSByZXR1cm47DQoNCiAgICAvLyByZW5kZXJpbmcgZnJvbSBsZWZ0IHRvIHJpZ2h0LCBib3R0b20gdG8gdG9wDQogICAgdmFyIGNlbGxMZWZ0X3MgPSAwLCBjZWxsUmlnaHRfcyA9IDA7DQoNCiAgICB2YXIgaXNOb3JtYWxpemVkID0gcGFsZXR0ZS5pc05vcm1hbGl6ZWQ7DQogICAgdmFyIGNvbG9ycyA9IHBhbGV0dGUuY29sb3JzOw0KICAgIHZhciBjb2xOID0gKGNvbG9ycy5sZW5ndGggPj4gMikgLSAxOw0KICAgIGlmICghaXNOb3JtYWxpemVkKSB7DQogICAgICAgIGZtYXggPSBwYWxldHRlLnJhbmdlLm1heDsNCiAgICAgICAgZm1pbiA9IHBhbGV0dGUucmFuZ2UubWluOw0KICAgIH0NCiAgICB2YXIgcGFsZXR0ZUsgPSBmbWF4ICE9PSBmbWluID8gMS4wIC8gKGZtYXggLSBmbWluKSA6IDA7DQoNCiAgICB2YXIgZmxiLCBmbHQsIGZydCwgZnJiOw0KICAgIHZhciBmaSwgZmkxOw0KDQogICAgLy8gcmVuZGVyaW5nIHRoZSBpbWFnZQ0KICAgIGZvciAodmFyIGkgPSBpMDsgaSA8IG4gJiYgY2VsbFJpZ2h0X3MgPCB3OyBpKyspIHsNCiAgICAgICAgLy8gaTAgaXMgdGhlIHJpZ2h0IHZpc2libGUgZWRnZSBvZiB0aGUgY2VsbA0KICAgICAgICB4MCA9IHhbaSAtIDFdOw0KICAgICAgICB2YXIgeDEgPSB4W2ldOw0KICAgICAgICBpZiAoeDAgIT0geDAgfHwgeDEgIT0geDEpIHsgLy8gYSAhPSBhICBlcXVpdi4gaXNOYU4oYSkNCiAgICAgICAgICAgIGNlbGxSaWdodF9zID0gdW5kZWZpbmVkOw0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoY2VsbFJpZ2h0X3MpDQogICAgICAgICAgICBjZWxsTGVmdF9zID0gY2VsbFJpZ2h0X3M7DQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIGNlbGxMZWZ0X3MgPSBNYXRoLmNlaWwoZGF0YVRvU2NyZWVuWCh4MCkpOw0KICAgICAgICBjZWxsUmlnaHRfcyA9IE1hdGguY2VpbChkYXRhVG9TY3JlZW5YKHgxKSk7DQogICAgICAgIGlmIChjZWxsTGVmdF9zIDwgMCkgY2VsbExlZnRfcyA9IDA7DQogICAgICAgIGlmIChjZWxsUmlnaHRfcyA+PSB3KSBjZWxsUmlnaHRfcyA9IHc7DQogICAgICAgIGlmIChjZWxsUmlnaHRfcyAtIGNlbGxMZWZ0X3MgPT0gMCkgY29udGludWU7DQoNCiAgICAgICAgdmFyIGNlbGxCb3R0b21fcyA9IDAsIGNlbGxUb3BfcyA9IDA7DQogICAgICAgIGZpID0gZltpXTsNCiAgICAgICAgZmkxID0gZltpIC0gMV07DQogICAgICAgIGZvciAodmFyIGogPSBqMDsgaiA8IG0gJiYgY2VsbEJvdHRvbV9zID49IDA7IGorKykgew0KICAgICAgICAgICAgeTAgPSB5W2ogLSAxXTsNCiAgICAgICAgICAgIHZhciB5MSA9IHlbal07DQogICAgICAgICAgICBpZiAoeTAgIT0geTAgfHwgeTEgIT0geTEpIHsNCiAgICAgICAgICAgICAgICBjZWxsVG9wX3MgPSB1bmRlZmluZWQ7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChjZWxsVG9wX3MpDQogICAgICAgICAgICAgICAgY2VsbEJvdHRvbV9zID0gY2VsbFRvcF9zOw0KICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIGNlbGxCb3R0b21fcyA9IHlzY3JbaiAtIDFdOw0KICAgICAgICAgICAgY2VsbFRvcF9zID0geXNjcltqXTsNCiAgICAgICAgICAgIGlmIChjZWxsVG9wX3MgPCAwKSBjZWxsVG9wX3MgPSAtMTsNCiAgICAgICAgICAgIGlmIChjZWxsQm90dG9tX3MgPj0gaCkgY2VsbEJvdHRvbV9zID0gaCAtIDE7DQogICAgICAgICAgICBpZiAoY2VsbEJvdHRvbV9zIC0gY2VsbFRvcF9zID09IDApIGNvbnRpbnVlOw0KDQogICAgICAgICAgICAvLyBmaWxscyB0aGUgY2VsbA0KICAgICAgICAgICAgZmx0ID0gZmkxW2pdOw0KICAgICAgICAgICAgZmxiID0gZmkxW2ogLSAxXTsNCiAgICAgICAgICAgIGZydCA9IGZpW2pdOw0KICAgICAgICAgICAgZnJiID0gZmlbaiAtIDFdOw0KDQogICAgICAgICAgICBpZiAoZmx0ICE9IGZsdCB8fCBmbGIgIT0gZmxiIHx8IGZydCAhPSBmcnQgfHwgZnJiICE9IGZyYikNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCg0KICAgICAgICAgICAgdmFyIGt5TGVmdCA9IChmbHQgLSBmbGIpIC8gKHkxIC0geTApOw0KICAgICAgICAgICAgdmFyIGt5UmlnaHQgPSAoZnJ0IC0gZnJiKSAvICh5MSAtIHkwKTsNCiAgICAgICAgICAgIGZvciAodmFyIHlzID0gY2VsbFRvcF9zICsgMTsgeXMgPD0gY2VsbEJvdHRvbV9zOyB5cysrKSB7DQogICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gKHcgKiB5cyArIGNlbGxMZWZ0X3MpIDw8IDI7DQogICAgICAgICAgICAgICAgdmFyIF95ID0gbWFwU2NyZWVuVG9EYXRhWVt5c107DQogICAgICAgICAgICAgICAgdmFyIGZsZWZ0ID0ga3lMZWZ0ICogKF95IC0geTApICsgZmxiOw0KICAgICAgICAgICAgICAgIHZhciBmcmlnaHQgPSBreVJpZ2h0ICogKF95IC0geTApICsgZnJiOw0KICAgICAgICAgICAgICAgIHZhciBreCA9IChmcmlnaHQgLSBmbGVmdCkgLyAoeDEgLSB4MCk7DQoNCiAgICAgICAgICAgICAgICBmb3IgKHZhciB4cyA9IGNlbGxMZWZ0X3M7IHhzIDwgY2VsbFJpZ2h0X3M7IHhzKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIF94ID0gbWFwU2NyZWVuVG9EYXRhWFt4c107DQogICAgICAgICAgICAgICAgICAgIHZhciBfZiA9IGt4ICogKF94IC0geDApICsgZmxlZnQ7DQogICAgICAgICAgICAgICAgICAgIHZhciBwYWxldHRlVmFsID0gcGFsZXR0ZUsgKiAoX2YgLSBmbWluKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGsgPSAocGFsZXR0ZVZhbCAqIGNvbE4pIHwgMDsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGsgPCAwKSBrID0gMDsNCiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoayA+IGNvbE4pIGsgPSBjb2xOOw0KICAgICAgICAgICAgICAgICAgICBrID0gayA8PCAyOw0KDQogICAgICAgICAgICAgICAgICAgIC8vdmFyIGNvbG9yID0gZ2V0Q29sb3IocGFsZXR0ZVZhbCk7DQogICAgICAgICAgICAgICAgICAgIC8vaWYgKHhzID09IGNlbGxMZWZ0X3MgfHwgeHMgPT0gY2VsbFJpZ2h0X3MgLSAxIHx8ICAvKiB1bmNvbW1lbnQgdG8gZHJhdyB0aGUgYm9yZGVyIG9mIGNlbGxzICovDQogICAgICAgICAgICAgICAgICAgIC8vICAgIHlzID09IGNlbGxUb3BfcyArIDEgfHwgeXMgPT0gY2VsbEJvdHRvbV9zKQ0KICAgICAgICAgICAgICAgICAgICAvLyAgICBjb2xvciA9IHsgYTogMSwgcjogMCwgZzogMCwgYjogMjU1IH07DQoNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2luZGV4KytdID0gY29sb3JzW2srK107DQogICAgICAgICAgICAgICAgICAgIGltYWdlRGF0YVtpbmRleCsrXSA9IGNvbG9yc1trKytdOw0KICAgICAgICAgICAgICAgICAgICBpbWFnZURhdGFbaW5kZXgrK10gPSBjb2xvcnNbaysrXTsNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2luZGV4KytdID0gY29sb3JzW2tdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChjZWxsVG9wX3MgPD0gMCkgYnJlYWs7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGNlbGxSaWdodF9zID49IHcpIGJyZWFrOw0KICAgIH0NCn07DQo=",be.Figure=function(e,t){if(void 0!==t)throw"Figure cannot be a dependent plot";if(e){var i;e&&(i=me("<div data-idd-plot='plot' data-idd-placement='center'></div>")).css("z-index",be.ZIndexNavigationLayer).css("background-color","rgba(0,0,0,0)");var r=e.children().toArray();i.appendTo(e),this.base=be.Plot,this.base(e,t,i);var w=this;i.dblclick(function(){w.master.fitToView()});function a(e){var t=e.css("position");return"static"!=t&&"inherit"!=t||e.css("position","relative"),void 0!==t&&""!=t||e.css("position","relative"),"relative"==e.css("position")}function n(e,t){if(e.attr("data-idd-axis")){var i=be.InitializeAxis(e,t);e.axis=i,e.dblclick(function(){var e=this.getAttribute("data-idd-placement");"bottom"==e||"top"==e?w.master.fitToViewX():w.master.fitToViewY()})}}function s(e,t,i){var r=me("<div></div>");r.appendTo(w.host).addClass("idd-figure-container"),(r.content=e).appendTo(r);function o(e){if(i){var t=g(i,e);e.splice(t.index,0,r)}else e.push(r)}var n=e.attr("data-idd-placement");"left"==n?o(I):"bottom"==n?o(A):"center"==n?o(x):"right"==n?o(S):"top"==n&&o(T),n&&r.attr("data-idd-placement",n)}var I=[],A=[],x=[],T=[],S=[];this.getAxes=function(t){if(t){if("top"==t?e=jQuery.grep(T,function(e){if(e.content&&e.content.axis&&e.content.axis.mode==t)return e.content.axis}):"bottom"==t?e=jQuery.grep(A,function(e){if(e.content&&e.content.axis&&e.content.axis.mode==t)return e.content.axis}):"left"==t?e=jQuery.grep(I,function(e){if(e.content&&e.content.axis&&e.content.axis.mode==t)return e.content.axis}):"right"==t&&(e=jQuery.grep(S,function(e){if(e.content&&e.content.axis&&e.content.axis.mode==t)return e.content.axis})),e&&0<e.length){for(r=0;r<e.length;r++)e[r]=e[r].content.axis;return e}}else{var e,i=I.concat(A).concat(S).concat(T);if((e=jQuery.grep(i,function(e){if(e.content&&e.content.axis)return e.content.axis}))&&0<e.length){for(var r=0;r<e.length;r++)e[r]=e[r].content.axis;return e}}},this.get=function(e){var t=be.Figure.prototype.get.call(this,e);if(t)return t;var i=this.getAxes();if(i)for(var r=0;r<i.length;r++)if(i[r].host[0].id==e||i[r].host[0]==e)return i[r]},r.forEach(function(e){var t=me(e);a(t)&&(s(t),n(t))});function l(e,t,i,r,o){var n=me(e);if(!n.is("div"))throw"Only DIVs can be added to figure!";if(void 0!==t){if("top"!=t&&"bottom"!=t&&"center"!=t&&"left"!=t&&"right"!=t)throw"Placement is incorrect!";n.attr("data-idd-placement",t)}return a(n)&&void 0!==n.attr("data-idd-placement")?s(n,0,o):o?n.insertBefore(o):n.appendTo(w.host),void 0!==r&&r||w.requestUpdateLayout(),n}this.addDiv=function(e,t){return l(e,t)[0]};function d(e){var t=[],i=[];return e.forEach(function(e){0==e.children().toArray().length?t.push(e):i.push(e)}),t.forEach(function(e){e.remove()}),i}function h(t,e){var i=jQuery.grep(e,function(e){return e.content[0]==t});return i&&0<i.length}var g=function(e,t){for(var i=0;i<t.length;i++)if(t[i].content[0]==e)return{pack:e,index:i};throw"Pack not found"};if(this.removeDiv=function(e){if(void 0===e)throw"Unable to remove undefined object!";var t,i,r,o=this.host.children().toArray();if(t=e,i=o,!((r=jQuery.grep(i,function(e){return e==t}))&&0<r.length||h(e,I)||h(e,A)||h(e,x)||h(e,S)||h(e,T)))throw"Specified div doesn't belong to figure!";var n=me(e);n.remove(),n.attr("data-idd-placement")&&("left"==n.attr("data-idd-placement")?I=d(I):"bottom"==n.attr("data-idd-placement")?A=d(A):"center"==n.attr("data-idd-placement")?x=d(x):"right"==n.attr("data-idd-placement")?S=d(S):"top"==n.attr("data-idd-placement")&&(T=d(T))),w.requestUpdateLayout()},this.addAxis=function(e,t,i,r){var o=l('<div data-idd-axis="'+(void 0===t?"numeric":t)+'"></div>',e,0,!1,r);return n(o,i),o},this.getTooltip=function(e,t,i,r){var o=w.getAxes(),n=!1,a=new Array;if(o)for(var s=0;s<o.length;s++){if(o[s].getToolTip){var l;n=!0,l="left"==o[s].mode||"right"==o[s].mode?t:e;var d=o[s].getToolTip(l);d&&a.push(d)}}if(n){var h=me("<div></div>").addClass("idd-tooltip-compositevalue");return h.append(me("<div>"+a.join(", ")+"</div>")),h}},this.measure=function(t){w.screenSize.width!==t.width||(w.screenSize.height,t.height);var e=this.fit(t);t.width,t.height;function i(e,t,i,r,o,n){for(var a=0,s=e.length-1;0<=s;s--){var l=e[s],d=l.content;if(l.width(t),n&&l.css("top",r(a)),l.css("left",o),void 0!==d.axis){d.width(t),d.axis.update(i);var h=d.height();l.height()!==h&&l.height(h),a+=l.height()}else a+=l.height();n||l.css("top",r(a))}return a}function r(e,t,i,r,o,n){for(var a=0,s=e.length-1;0<=s;s--){var l=e[s],d=l.content;if(l.height(t),d.height(t),n&&l.css("left",r(a)),l.css("top",o),void 0!==d.axis){d.height(t),d.axis.update(i);var h=d.width();l.width()!==h&&l.width(h),a+=l.width()}else a+=l.width();n||l.css("left",r(a))}return a}var o,n,a;n=i(T,t.width,{min:e.x,max:e.x+e.width},function(e){return e},0,!0),a=i(A,t.width,{min:e.x,max:e.x+e.width},function(e){return t.height-e},0,!1),o=n+a;var s,l,d;l=r(I,t.height-o,{min:e.y,max:e.y+e.height},function(e){return e},n,!0),d=r(S,t.height-o,{min:e.y,max:e.y+e.height},function(e){return t.width-e},n,!1),s=l+d;var h={width:t.width-s,height:t.height-o};h.width<0&&(h.width=0),h.height<0&&(h.height=0),void 0!==w.mapControl&&w.mapControl.setOptions({width:h.width,height:h.height}),e=this.fit(h,!0),x.forEach(function(e){e.width(h.width),e.height(h.height),e.css("top",n),e.css("left",l)}),this.children.forEach(function(e){var t=e.host;t.width(h.width),t.height(h.height),t.css("top",n),t.css("left",l)});var g,c;if(g=i(T,h.width,{min:e.x,max:e.x+e.width},function(e){return e},l,!0),c=i(A,h.width,{min:e.x,max:e.x+e.width},function(e){return t.height-e},l,!1),g!=n)for(var u=n/g,f=0,p=0;p<T.length;p++){var v="scaleY("+u+") translate(0px,"+f+"px)",m="0% 0%";(C=T[p]).css("-webkit-transform",v),C.css("-webkit-transform-origin",m),C.css("-moz-transform",v),C.css("-moz-transform-origin",m),C.css("-o-transform",v),C.css("-o-transform-origin",m),C.css("-ms-transform",v),C.css("-ms-transform-origin",m),C.css("transform",v),C.css("transform-origin",m),f+=C.height()*(u-1)}else T.forEach(function(e){e.css("-ms-transform",""),e.css("-webkit-transform",""),e.css("-moz-transform",""),e.css("-o-transform",""),e.css("transform","")});if(a!=c)for(u=a/c,f=0,p=0;p<A.length;p++){v="scaleY("+u+") translate(0px,"+-f+"px)",m="0% 0%";(C=A[p]).css("-webkit-transform",v),C.css("-webkit-transform-origin",m),C.css("-moz-transform",v),C.css("-moz-transform-origin",m),C.css("-o-transform",v),C.css("-o-transform-origin",m),C.css("-ms-transform",v),C.css("-ms-transform-origin",m),C.css("transform",v),C.css("transform-origin",m),f+=C.height()*(u-1)}else A.forEach(function(e){e.css("-ms-transform",""),e.css("-webkit-transform",""),e.css("-moz-transform",""),e.css("-o-transform",""),e.css("transform","")});var y,b;if(y=r(I,t.height-o,{min:e.y,max:e.y+e.height},function(e){return e},n,!0),b=r(S,t.height-o,{min:e.y,max:e.y+e.height},function(e){return t.width-e},n,!1),l!=y)for(u=l/y,f=0,p=0;p<I.length;p++){v="scaleX("+u+") translate("+f+"px, 0px)",m="0% 0%";(C=I[p]).css("-webkit-transform",v),C.css("-webkit-transform-origin",m),C.css("-moz-transform",v),C.css("-moz-transform-origin",m),C.css("-o-transform",v),C.css("-o-transform-origin",m),C.css("-ms-transform",v),C.css("-ms-transform-origin",m),C.css("transform",v),C.css("transform-origin",m),f+=C.width()*(u-1)}else I.forEach(function(e){e.css("-ms-transform",""),e.css("-webkit-transform",""),e.css("-moz-transform",""),e.css("-o-transform",""),e.css("transform","")});if(d!=b)for(u=d/b,f=0,p=0;p<S.length;p++){var C;v="scaleX("+u+") translate("+-f+"px, 0px)",m="100% 0%";(C=S[p]).css("-webkit-transform",v),C.css("-webkit-transform-origin",m),C.css("-moz-transform",v),C.css("-moz-transform-origin",m),C.css("-o-transform",v),C.css("-o-transform-origin",m),C.css("-ms-transform",v),C.css("-ms-transform-origin",m),C.css("transform",v),C.css("transform-origin",m),f+=C.width()*(u-1)}else S.forEach(function(e){e.css("-ms-transform",""),e.css("-webkit-transform",""),e.css("-moz-transform",""),e.css("-o-transform",""),e.css("transform","")});return h},this.arrange=function(e){be.Figure.prototype.arrange.call(this,e)},this.exportContentToSvg=function(e,t,i){function r(e,t){var i,r,o=e instanceof jQuery?window.getComputedStyle(e[0],null):window.getComputedStyle(e,null),n=o?o.getPropertyValue("transform"):void 0,a=o?o.getPropertyValue("padding-bottom"):void 0,s=o?parseFloat(o.getPropertyValue("font-size")):void 0,l=o?o.getPropertyValue("font-family"):void 0,d=o?o.getPropertyValue("font-weight"):void 0,h=o?o.getPropertyValue("text-align"):void 0;"center"==h&&(h="middle"),"left"==h&&(h="start"),"right"==h&&(h="end"),r=me(e).hasClass("idd-verticalTitle-inner")?(i=me(e).parent().width(),me(e).parent().height()):(i=me(e).width(),me(e).height());var g=me(e).text().trim(),c=t.text(g).font({family:l,size:s,weight:d,anchor:h});"middle"==h?c.translate(i/2,-r/2):"end"==h?c.translate(i,-r/2):c.translate(0,-r/2),"none"!=n&&null!=n&&(a=null!=a?parseFloat(a.substring(0,a.length-2)):0,c.attr({transform:n}),c.translate(-a,r/2))}for(var o=i.group(),n=0,a=I.length;0<=--a;){var s=I[a];if((v=o.group()).translate(n,0),n+=s.width(),s.content)if(s.content.axis)s.content.axis.renderToSvg(v);else{var l=me("div.idd-verticalTitle-inner",s.content);(g=1===l.length&&0===l[0].children.length)&&r(l,v)}}var d=i.group(),h=0;for(a=T.length;0<=--a;){s=T[a];if((v=d.group()).translate(n,h),h+=s.height(),s.content)if(s.content.axis)s.content.axis.renderToSvg(v);else{var g=!0;me(s.content).contents().each(function(){3!=this.nodeType&&(g=!1)}),g&&r(s.content,v)}}o.translate(0,h);var c=i.group(),u=h+t.height;for(a=0;a<A.length;a++){s=A[a];if((v=c.group()).translate(n,u),u+=s.height(),s.content)if(s.content.axis)s.content.axis.renderToSvg(v);else{g=!0;me(s.content).contents().each(function(){3!=this.nodeType&&(g=!1)}),g&&r(s.content,v)}}var f=i.group(),p=n+t.width;for(a=0;a<S.length;a++){var v;s=S[a];if((v=f.group()).translate(p,h),p+=s.width(),s.content)if(s.content.axis)s.content.axis.renderToSvg(v);else{l=me("div.idd-verticalTitle-inner",s.content);(g=1===l.length&&0===l[0].children.length)&&r(l,v)}}var m=i.group();m.viewbox(0,0,t.width,t.height).translate(n,h),be.Figure.prototype.exportContentToSvg.call(this,e,t,m)},this.requestUpdateLayout(),"true"===e.attr("data-idd-navigation-enabled")){var o=be.Gestures.getGesturesStream(this.centralPart);this.navigation.gestureSource=o}var c=me("<div></div>").prependTo(this.centralPart),u=new be.Legend(this,c,!0);c.css("float","right"),Object.defineProperty(this,"legend",{get:function(){return u},configurable:!1}),be.Gestures.FullEventList.forEach(function(e){c[0].addEventListener(e,function(e){e.stopPropagation()},!1)});var f={};be.Utils.readStyle(e,f);var p=f.isLegendVisible;p?"true"==p?u.isVisible=!0:"false"==p&&(u.isVisible=!1):u.isVisible=!1}},be.Figure.prototype=new be.Plot,be.Chart=function(s,e){if(s){if(void 0!==e)throw"Chart cannot be a dependent plot";var t=me("<div data-idd-plot='grid' data-idd-placement='center'></div>").prependTo(s),r=me('<div data-idd-axis="numeric" data-idd-placement="left"></div>').prependTo(s),o=me('<div data-idd-axis="numeric" data-idd-placement="bottom"></div>').prependTo(s);this.base=be.Figure,this.base(s,e);var l=this,n=this.get(t[0]);o.axis=n.xAxis=this.get(o[0]),r.axis=n.yAxis=this.get(r[0]);this.changeXAxis=function(e,t){var i=o;o=l.addAxis("bottom",e,t,o[0]),l.removeDiv(i[0]),i.axis.destroy(),n.xAxis=this.get(o[0]),o.axis.dataTransform=l.xDataTransform},this.changeYAxis=function(e,t){var i=r;r=l.addAxis("left",e,t,r[0]),l.removeDiv(i[0]),i.axis.destroy(),n.yAxis=this.get(r[0]),r.axis.dataTransform=l.yDataTransform},this.onDataTranformChangedCore=function(e){if("y"==e){var t=be.TicksRenderer.getAxisType(l.yDataTransform);if(r.axis.host.attr("data-idd-axis")==t)"log"!=t&&(r.axis.dataTransform=l.yDataTransform);else{var i=r;r=l.addAxis("left",t,!0,r[0]),l.removeDiv(i[0]),i.axis.destroy(),n.yAxis=this.get(r[0])}l.enumAll(l,function(e){e!=l&&(e.yDataTransform=l.yDataTransform)})}else if("x"==e){t=be.TicksRenderer.getAxisType(l.xDataTransform);if(o.axis.host.attr("data-idd-axis")==t)"log"!=t&&(o.axis.dataTransform=l.xDataTransform);else{i=o;o=l.addAxis("bottom",t,!0,o[0]),l.removeDiv(i[0]),i.axis.destroy(),n.xAxis=this.get(o[0])}l.enumAll(l,function(e){e!=l&&(e.xDataTransform=l.xDataTransform)})}},this.fireChildrenChanged=function(e){"add"==e.type&&(l.xDataTransform&&(e.plot.xDataTransform=l.xDataTransform),l.yDataTransform&&(e.plot.yDataTransform=l.yDataTransform)),this.host.trigger(be.Event.childrenChanged,e)},this.exportToSvg=function(e,t,i){if(!ye.supported)throw"SVG is not supported";t=this.screenSize,e=this.coordinateTransform.getPlotRect({x:0,y:0,width:t.width,height:t.height});var r=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=(i=ye(r).size(s.width(),s.height())).group();this.exportContentToSvg(e,t,o);var n=i.group(),a=s.width()+20;return l.legend.isVisible&&(n.add(this.exportLegendToSvg(l.legend.Host[0])).translate(a,20),i.size(200+a,s.height())),i};var i,a,d,h={};be.Utils.readStyle(s,h),h.isLegendVisible||(l.legend.isVisible=!0),i=be.Gestures.getGesturesStream(l.centralPart),a=be.Gestures.applyHorizontalBehavior(be.Gestures.getGesturesStream(o)),d=be.Gestures.applyVerticalBehavior(be.Gestures.getGesturesStream(r)),l.navigation.gestureSource=i.merge(a.merge(d))}},be.Chart.prototype=new be.Figure,be.LabelPlot=function(e,t){this.base=be.CanvasPlot,this.base(e,t);var I=[],A=[],x=[],T=[],S=120,P=25,k=[];this.getData=function(){for(var e=[],t=I.length,i=0;i<t;i++)e.push({text:I[i],position:{x:A[i],y:x[i]},placement:T[i]});return e},this.draw=function(e){if(e){for(var t=e.length,i=[],r=[],o=[],n=[],a=0;a<t;a++)i.push(e[a].text),r.push(e[a].position.x),o.push(e[a].position.y),e[a].placement?n.push(e[a].placement):n.push("center"),k.push(0);I=i,A=r,x=o,T=n}this.invalidateLocalBounds(),this.requestNextFrameOrUpdate(),this.fireAppearanceChanged()},this.computeLocalBounds=function(){var e=this.xDataTransform&&this.xDataTransform.dataToPlot,t=this.yDataTransform&&this.yDataTransform.dataToPlot;if(0<A.length&&0<x.length){var i=be.Utils.getMinMax(A),r=be.Utils.getMinMax(x),o=i.min-.2,n=i.max+.2,a=r.min,s=r.max;return e&&(o=e(o),n=e(n)),t&&(a=t(a),s=t(s)),{x:o,y:a,width:n-o,height:s-a}}},this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.renderCore=function(e,t){be.LabelPlot.prototype.renderCore.call(this,e,t);var i=this.getContext(!0),r=I.length;if(0!=r)for(var o=this.getTransform(),n=o.dataToScreenX,a=o.dataToScreenY,s=0;s<r;s++){var l={x:n(A[s]),y:a(x[s])};"left"==T[s]?l={x:n(A[s])-S,y:a(x[s])}:"right"==T[s]?l={x:n(A[s])+S,y:a(x[s])}:"top"==T[s]?l={x:n(A[s]),y:a(x[s])-P}:"bottom"==T[s]&&(l={x:n(A[s]),y:a(x[s])+P});var d=window.getComputedStyle(document.body,null),h=d?parseFloat(d.getPropertyValue("font-size")):void 0,g=d?d.getPropertyValue("font-family"):void 0,c=d?d.getPropertyValue("font-weight"):void 0,u=l.x-.5*S,f=l.y;i.fillStyle="black",i.font=c+" "+h+"px "+g,i.textALign="center";for(var p=I[s],v=i.measureText(p).width;S<v;)p=p.substring(0,p.length-1),v=i.measureText(p).width;k[s]=(S-v)/2,i.fillText(p,u+k[s],f)}},this.renderCoreSvg=function(e,t,i){var r=I.length;if(0<r){for(var o=t.height,n=t.width,a=this.coordinateTransform.plotToScreenX,s=this.coordinateTransform.plotToScreenY,l=this.xDataTransform&&this.xDataTransform.dataToPlot,d=this.yDataTransform&&this.yDataTransform.dataToPlot,h=l?function(e){return a(l(e))}:a,g=d?function(e){return s(d(e))}:s,c=i.group(),u=0;u<r;u++){var f=window.getComputedStyle(document.body,null),p=f?parseFloat(f.getPropertyValue("font-size")):void 0,v=f?f.getPropertyValue("font-family"):void 0,m=f?f.getPropertyValue("font-weight"):void 0,y={x:h(A[u]),y:g(x[u])};"left"==T[u]?y={x:h(A[u])-S,y:g(x[u])}:"right"==T[u]?y={x:h(A[u])+S,y:g(x[u])}:"top"==T[u]?y={x:h(A[u]),y:g(x[u])-P}:"bottom"==T[u]&&(y={x:h(A[u]),y:g(x[u])+P});var b=y.x-.5*S,C=y.y-.9*P,w=c.group();w.size(S,P);w.text(I[u]).font({family:v,size:p,weight:m});w.translate(b+k[u],C),w.clipWith(w.rect(S,P))}c.clipWith(c.rect(n,o))}}},be.LabelPlot.prototype=new be.CanvasPlot,be.MaxMarkersPerAnimationFrame=3e3,be.Markers=function(e,t){if(this.base=be.CanvasPlot,this.base(e,t),e){function y(e){var t={},i={},r=-1;for(var o in e){var n=e[o];be.Utils.isArray(n)?((n.length<r||-1===r)&&(r=n.length),t[o]=n):i[o]=n}return{arrays:t,scalars:i,length:-1===r?0:r}}var m={},b=void 0,C={},w={},g=void 0,c=!1,I={},A=this;this.getDataCopy=function(){return m},this.draw=function(e,t){if(null==e||null==e)throw"The argument 'data' is undefined or null";var i;if(void 0===(m=e).shape||null==e.shape)i=be.Markers.shapes.box;else if("string"==typeof e.shape){if(null==(i=be.Markers.shapes[e.shape]))throw"The given marker shape is unknown"}else{if("object"!=typeof e.shape||null==e.shape||"function"!=typeof e.shape.draw)throw"The argument 'data' is incorrect: value of the property 'shape' must be a string, a MarkerShape object, undefined or null";i=e.shape}b=i;var r=me.extend({},e);null!=i.prepare&&i.prepare(r),null!=A.mapControl&&null!=g&&(g.forEach(function(e){var t=A.mapControl.entities.indexOf(e);0<=t&&A.mapControl.entities.removeAt(t)}),g=void 0),C=r,w={},this.invalidateLocalBounds(),this.requestNextFrameOrUpdate(),this.setTitles(t,!0),this.fireAppearanceChanged()},this.computeLocalBounds=function(e,t){var i=this.xDataTransform&&this.xDataTransform.dataToPlot,r=this.yDataTransform&&this.yDataTransform.dataToPlot;if(b&&(void 0!==b.getBoundingBox||void 0!==b.getPlotBoundingBox)&&C){if(0==C.x.length)return;var o=y(C),n=o.length,a=o.arrays,s=o.scalars,l=void 0;if(b.hasOwnProperty("getBoundingBox")){for(var d=0;d<n;d++){for(var h in a)s[h]=a[h][d];var g=b.getBoundingBox(s);l=be.Utils.unionRects(l,g)}if(i){var c=i(l.x),u=i(l.x+l.width);l.x=c,l.width=u-c}if(r){var f=r(l.y),p=r(l.y+l.height);l.y=f,l.height=p-f}}else{if(!b.hasOwnProperty("getPlotBoundingBox"))throw"Shape does not have neither getBoundingBox nor getPlotBoundingBox";var v=A.getTransform();for(d=0;d<n;d++){for(var h in a)s[h]=a[h][d];var m=b.getPlotBoundingBox(s,v);l=be.Utils.unionRects(l,m)}}return l}if(void 0!==C.x&&void 0!==C.y)return be.Utils.getBoundingBoxForArrays(C.x,C.y,i,r)},this.getLocalPadding=function(){if(b&&void 0!==b.getPadding)return b.getPadding(C);return{left:0,right:0,top:0,bottom:0}},this.renderCore=function(e,t){if(be.Markers.prototype.renderCore.call(this,e,t),null!=b){var i=this.getTransform(),r=!A.master.isInAnimation||void 0===A.master.mapControl;if(void 0!==A.mapControl&&(void 0===g&&function(){if(void 0!==C.x&&void 0!==C.y){var e=C.x,t=C.y;if(be.Utils.isArray(e)&&be.Utils.isArray(t)){var i=Math.min(e.length,t.length);if(i<=be.MaxMarkersPerAnimationFrame){g=new Array(i);for(var r=0;r<i;r++){var o=new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(t[r],e[r]),{visible:!1,htmlContent:'<div style="background-color: white; opacity: 0.5; width: 10px; height: 10px"></div>',anchor:new Microsoft.Maps.Point(5,5)});g[r]=o,A.mapControl.entities.push(o)}}}}}(),void 0!==g&&(A.master.isInAnimation&&!c?(g.forEach(function(e){e.setOptions({visible:!0})}),c=!0):!A.master.isInAnimation&&c&&(g.forEach(function(e){e.setOptions({visible:!1})}),c=!1))),r){var o=this.getContext(!0);w=C,void 0!==b.preRender&&(w=b.preRender(C,e,t,i,o));for(var n=y(w),a=n.length,s=n.arrays,l=n.scalars,d=0;d<a;d++){for(var h in s)l[h]=s[h][d];b.draw(l,e,t,i,o,d)}}}},this.renderCoreSvg=function(e,t,i){if(null!=b&&null!=b.renderSvg){var r=this.getTransform();b.renderSvg(e,t,i,C,r)}},this.findToolTipMarkers=function(e,t,i,r){if(null==b||void 0===b.hitTest||null==w)return[];for(var o=this.getTransform(),n={x:o.dataToScreenX(e),y:o.dataToScreenY(t)},a={x:e,y:t},s=y(w),l=s.length,d=s.arrays,h=s.scalars,g=[],c=0;c<l;c++){for(var u in d)h[u]=d[u][c];if(b.hitTest(h,o,n,a)&&"number"==typeof h.indices){var f=h.indices,p={};if(b.getTooltipData)p=b.getTooltipData(m,f);else{for(var u in m){var v=m[u];be.Utils.isArray(v)&&f<v.length&&(I[u]=new be.AdaptiveFormatter(v),p[u]=I[u].toString(v[f]))}p.index=f}g.push(p)}}return g},this.getTooltip=function(e,t,i,r){var n=this;if(this.isVisible&&!this.isErrorVisible){var o=n.findToolTipMarkers(e,t,i,r),a=function(e){var t=me("<div></div>").addClass("idd-tooltip-compositevalue");for(var i in e)if(e.hasOwnProperty(i)){var r=n.getTitle(i),o=void 0;"object"==typeof e[i]&&(o=a(e[i])),o?t.append(me("<div>"+r+":</div>")).append(o):t.append(me("<div>"+r+": "+e[i]+"</div>"))}return t};if(0<o.length){var s=me("<div></div>");return me("<div></div>").addClass("idd-tooltip-name").text(n.name||"markers").appendTo(s),o.forEach(function(e){a(e).addClass("idd-tooltip-itemvalues").appendTo(s)}),s}}},this.getLegend=function(){function e(){t.empty(),b&&void 0!==b.getLegend&&(i.content.empty(),b.getLegend(C,A.getTitle,i)),t.text(A.name)}var t=me("<span></span>"),i={thumbnail:me("<canvas></canvas>"),content:me("<div></div>")};this.host.bind("appearanceChanged",e),e();return{name:t,legend:i,onLegendRemove:function(){A.host.unbind("appearanceChanged",e),t.empty()}}},this.buildSvgLegend=function(e,t){var i={thumbnail:t.group(),content:t.group()};e.height=30,b&&void 0!==b.buildSvgLegendElements&&(i=b.buildSvgLegendElements(e,t,C,this.getTitle)),t.rect(e.width,e.height).fill({color:"white",opacity:0}),t.add(i.thumbnail.translate(5,5));var r=window.getComputedStyle(e.legendDiv.children[0].children[1],null),o=parseFloat(r.getPropertyValue("font-size")),n=r.getPropertyValue("font-family");t.add(t.text(this.name).font({family:n,size:o}).translate(40,0)),t.add(i.content.translate(5,30))},this.onDataTransformChanged=function(e){this.invalidateLocalBounds(),be.Markers.prototype.onDataTransformChanged.call(this,e)};var i=be.Utils.getDataSourceFunction(e,be.readCsv)(e);i&&void 0!==i.y&&("bars"==i.shape&&(barWidthFloat=parseFloat(i.barWidth),isNaN(barWidthFloat)?(void 0===i.barWidth?console.error("barWidth parameter of BarChart plot should be set"):console.error("barWidth parameter of BarChart plot should be a number"),i.barWidth=void 0):i.barWidth=barWidthFloat),this.draw(i))}},be.Markers.prototype=new be.CanvasPlot,be.Markers.defaults={color:"#4169ed",colorPalette:be.palettes.grayscale,border:"#000000",size:10},be.Markers.shapes=be.Markers.shapes||{},e={prepare:function(e){var t=e.shape?e.shape.toLowerCase():"box";if("box"==t)e.shape=1;else if("circle"==t)e.shape=2;else if("diamond"==t)e.shape=3;else if("cross"==t)e.shape=4;else{if("triangle"!=t)throw"Unexpected value of property 'shape'";e.shape=5}if(null==e.y||null==e.y)throw"The mandatory property 'y' is undefined or null";if(!be.Utils.isArray(e.y))throw"The property 'y' must be an array of numbers";var i=e.y.length,r=new Int8Array(i);if(be.Utils.maskNaN(r,e.y),null==e.x)e.x=be.Utils.range(0,i-1);else{if(!be.Utils.isArray(e.x))throw"The property 'x' must be an array of numbers";if(e.x.length!=i)throw"Length of the array which is a value of the property 'x' differs from lenght of 'y'";be.Utils.maskNaN(r,e.x)}if(null!=e.border&&"none"!=e.border||(e.border=null),null==e.color&&(e.color=be.Markers.defaults.color),be.Utils.isArray(e.color)){if(e.color.length!=i)throw"Length of the array 'color' is different than length of the array 'y'";if(0<i&&"string"!=typeof e.color[0]){if(null==(h=e.colorPalette)&&(h=be.Markers.defaults.colorPalette),"string"==typeof h&&(h=new be.ColorPalette.parse(h)),null!=h&&h.isNormalized){var o=be.Utils.getMinMax(e.color);o=be.Utils.makeNonEqual(o),h=h.absolute(o.min,o.max)}e.colorPalette=h;for(var n=new Array(i),a=0;a<i;a++){var s=e.color[a];if(s!=s)r[a]=1;else{var l=h.getRgba(s);n[a]="rgba("+l.r+","+l.g+","+l.b+","+l.a+")"}}e.color=n}e.individualColors=!0}else e.individualColors=!1;var d=new Array(i);if(null==e.size&&(e.size=be.Markers.defaults.size),be.Utils.isArray(e.size)){if(e.size.length!=i)throw"Length of the array 'size' is different than length of the array 'y'";if(null!=e.sizePalette){var h;if((h=be.SizePalette.Create(e.sizePalette)).isNormalized){o=be.Utils.getMinMax(e.size);o=be.Utils.makeNonEqual(o),h=new be.SizePalette(!1,h.sizeRange,o)}e.sizePalette=h;for(a=0;a<i;a++){var g=e.size[a];g!=g?r[a]=1:d[a]=h.getSize(g)}}else d=e.size,e.sizeMax=be.Utils.getMax(e.size)}else{for(a=0;a<i;a++)d[a]=e.size;e.sizeMax=e.size}e.size=d;var c=0;for(a=0;a<i;a++)1===r[a]&&c++;if(0<c){c=i-c,e.x=be.Utils.applyMask(r,e.x,c),e.y=be.Utils.applyMask(r,e.y,c),e.size=be.Utils.applyMask(r,e.size,c),e.individualColors&&(e.color=be.Utils.applyMask(r,e.color,c));for(var u=Array(c),f=(a=0,0);a<i;a++)0===r[a]&&(u[f++]=a);e.indices=u}else e.indices=be.Utils.range(0,i-1)},preRender:function(e,t,i,r,o){return e.individualColors||(o.fillStyle=e.color),null!=e.border&&(o.strokeStyle=e.border),e},draw:function(e,t,i,r,o,n){e.individualColors&&(o.fillStyle=e.color);var a=null!=e.border,s=r.dataToScreenX(e.x),l=r.dataToScreenY(e.y),d=i.width,h=i.height,g=e.size,c=g/2;if(!(d<s-c||s+c<0||h<l-c||l+c<0))switch(e.shape){case 1:o.fillRect(s-c,l-c,g,g),a&&o.strokeRect(s-c,l-c,g,g);break;case 2:o.beginPath(),o.arc(s,l,c,0,2*Math.PI),o.fill(),a&&o.stroke();break;case 3:o.beginPath(),o.moveTo(s-c,l),o.lineTo(s,l-c),o.lineTo(s+c,l),o.lineTo(s,l+c),o.closePath(),o.fill(),a&&o.stroke();break;case 4:var u=g/3,f=u/2;a?(o.beginPath(),o.moveTo(s-c,l-f),o.lineTo(s-f,l-f),o.lineTo(s-f,l-c),o.lineTo(s+f,l-c),o.lineTo(s+f,l-f),o.lineTo(s+c,l-f),o.lineTo(s+c,l+f),o.lineTo(s+f,l+f),o.lineTo(s+f,l+c),o.lineTo(s-f,l+c),o.lineTo(s-f,l+f),o.lineTo(s-c,l+f),o.closePath(),o.fill(),o.stroke()):(o.fillRect(s-f,l-c,u,g),o.fillRect(s-c,l-f,g,u));break;case 5:o.beginPath(),o.moveTo(s-c,l+c),o.lineTo(s,l-c),o.lineTo(s+c,l+c),o.closePath(),o.fill(),a&&o.stroke()}},getPadding:function(e){var t=e.sizeMax/2;return{left:t,right:t,top:t,bottom:t}},hitTest:function(e,t,i,r){function o(e,t){for(var i,r,o,n,a,s,l,d=t.length,h=0;h<d;h++)if(1!=(i=e,r=t[h],o=t[(h+1)%d],s=a=n=void 0,n=o.x-r.x,a=o.y-r.y,s=i.x-r.x,0<(l=n*(i.y-r.y)-a*s)?1:l<0?2:0))return!1;return!0}var n=t.dataToScreenX(e.x),a=t.dataToScreenY(e.y),s=i.x,l=i.y,d=e.size,h=d/2;if(i.x>=n-h&&i.x<=n+h&&i.y>=a-h&&i.y<=a+h)switch(e.shape){case 1:return!0;case 2:return(n-s)*(n-s)+(a-l)*(a-l)<=h*h;case 3:return o({x:s,y:l},[{x:n-h,y:a},{x:n,y:a-h},{x:n+h,y:a},{x:n,y:a+h}]);case 4:var g=d/3/2;return o({x:s,y:l},[{x:n-g,y:a+h},{x:n-g,y:a-h},{x:n+g,y:a-h},{x:n+g,y:a+h}])||o({x:s,y:l},[{x:n-h,y:a+g},{x:n-h,y:a-g},{x:n+h,y:a-g},{x:n+h,y:a+g}]);case 5:return o({x:s,y:l},[{x:n-h,y:a+h},{x:n,y:a-h},{x:n+h,y:a+h}])}},getLegend:function(i,r,e){var o=e.content,t=14;document.defaultView&&document.defaultView.getComputedStyle&&(t=parseFloat(document.defaultView.getComputedStyle(o[0],null).getPropertyValue("font-size"))),!isNaN(t)&&0!=t||(t=14);var n=e.thumbnail,a=!0,s=1.5*t,l=s/2+1,d=l;n[0].width=n[0].height=2+s;var h=n[0].style,g=n.get(0).getContext("2d");g.clearRect(0,0,n[0].width,n[0].height);var c,u,f,p,v,m,y,b,C,w,I,A,x=0,T=0,S=0;!function(){if(f=!1,i.individualColors&&i.colorPalette){var e=r("color");if(0==T){p=me("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(o),A=me("<div class='idd-legend-item-property'></div>").text(e).appendTo(p),v=p[0].style;var t=me("<div style='width: 170px; color: rgb(0,0,0); '></div>").appendTo(p);m=new be.ColorPaletteViewer(t),T=2}else A.text(e);m.palette=i.colorPalette,1==T&&(v.display="block",T=2)}else 2==T&&(v.display="none",T=1);i.individualColors?(u="#000000",c="#ffffff",f=!0):(c=i.color,u=c,null!=i.border&&(f=!0,u=i.border))}(),function(){if(y=s,i.sizePalette){var e=r("size");if(0==S){C=me("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(o),I=me("<div class='idd-legend-item-property'></div>").text(e).appendTo(C),C[0].style;var t=me("<div style='width: 170px; color: rgb(0,0,0)'></div>").appendTo(C);w=new be.SizePaletteViewer(t),S=2}else I.text(e);w.palette=be.SizePalette.Create(i.sizePalette)}b=y/2}(),function(){switch(2==x&&((void 0).display="none",x=1),g.clearRect(0,0,2+s,2+s),g.strokeStyle=u,g.fillStyle=c,i.shape){case 1:g.fillRect(l-b,d-b,y,y),f&&g.strokeRect(l-b,d-b,y,y);break;case 2:g.beginPath(),g.arc(l,d,b,0,2*Math.PI),g.fill(),f&&g.stroke();break;case 3:g.beginPath(),g.moveTo(l-b,d),g.lineTo(l,d-b),g.lineTo(l+b,d),g.lineTo(l,d+b),g.closePath(),g.fill(),f&&g.stroke();break;case 4:var e=y/3,t=e/2;f?(g.beginPath(),g.moveTo(l-b,d-t),g.lineTo(l-t,d-t),g.lineTo(l-t,d-b),g.lineTo(l+t,d-b),g.lineTo(l+t,d-t),g.lineTo(l+b,d-t),g.lineTo(l+b,d+t),g.lineTo(l+t,d+t),g.lineTo(l+t,d+b),g.lineTo(l-t,d+b),g.lineTo(l-t,d+t),g.lineTo(l-b,d+t),g.closePath(),g.fill(),g.stroke()):(g.fillRect(l-t,d-b,e,y),g.fillRect(l-b,d-t,y,e));break;case 5:g.beginPath(),g.moveTo(l-b,d+b),g.lineTo(l,d-b),g.lineTo(l+b,d+b),g.closePath(),g.fill(),f&&g.stroke()}a||(h.display="inline-block",a=!0)}()},renderSvg:function(e,t,i,a,r){var s=a.y.length;if(0!=s){var l,d,h=i.group(),g=r.dataToScreenX,c=r.dataToScreenY,u=t.width,f=t.height,p=0;!function(){for(var e=null==a.border?"none":a.border;p<s;p++){l=g(a.x[p]),d=c(a.y[p]);var t=a.size[p],i=t/2;c1=u<l-i||l+i<0||f<d-i||d+i<0;var r=a.individualColors?a.color[p]:a.color;if(!c1)if(1==a.shape)h.rect(a.size[p],a.size[p]).translate(l-i,d-i).fill(r).style({stroke:e});else if(2==a.shape)h.circle(a.size[p]).translate(l-i,d-i).style({fill:r,stroke:e});else if(3==a.shape)h.rect(a.size[p]/Math.sqrt(2),a.size[p]/Math.sqrt(2)).translate(l,d-i).style({fill:r,stroke:e}).rotate(45);else if(4==a.shape){var o=t/6;h.polyline([[-i,-o],[-o,-o],[-o,-i],[o,-i],[o,-o],[i,-o],[i,o],[o,o],[o,i],[-o,i],[-o,o],[-i,o],[-i,-o]]).translate(l,d).style({fill:r,stroke:e})}else if(5==a.shape){var n=Math.sqrt(3)/6*t;h.polyline([[l-i,d+n],[l,d-2*n],[l+i,d+n],[l-i,d+n]]).style({fill:r,stroke:e})}}h.clipWith(h.rect(u,f))}()}},buildSvgLegendElements:function(e,t,i,r){var o=t.group(),n=t.group(),a=12,s=1.5*a,l=s/2+1,d=l,h=s/2;switch(i.individualColors?(border="#000000",color="#ffffff"):(color=i.color,border="none",null!=i.border&&(border=i.border)),i.shape){case 1:o.rect(s,s).translate(l-h,d-h).fill({color:color,opacity:1}).stroke(border);break;case 2:o.circle(s).translate(l-h,d-h).fill(color).stroke(border);break;case 3:o.rect(s/Math.sqrt(2),s/Math.sqrt(2)).translate(l,d-h).fill(color).stroke(border).rotate(45);break;case 4:var g=s/6;o.polyline([[-h,-g],[-g,-g],[-g,-h],[g,-h],[g,-g],[h,-g],[h,g],[g,g],[g,h],[-g,h],[-g,g],[-h,g],[-h,-g]]).translate(l,d).fill(color).stroke(border);break;case 5:var c=Math.sqrt(3)/6*s;o.polyline([[l-h,d+c],[l,d-2*c],[l+h,d+c],[l-h,d+c]]).fill(color).stroke(border)}var u=0,f=e.legendDiv.children[1],p=i.individualColors&&i.colorPalette,v=(i.sizePalette,f&&e.legendDiv.children[1].children[0]&&e.legendDiv.children[1].children[0].children[0]?window.getComputedStyle(e.legendDiv.children[1].children[0].children[0],null):void 0);a=v?parseFloat(v.getPropertyValue("font-size")):void 0,fontFamily=v?v.getPropertyValue("font-family"):void 0;var m=v?v.getPropertyValue("font-weight"):void 0;if(p){var y=r("color");n.text(y).font({family:fontFamily,size:a,weight:m});var b=t.group(),C=e.width,w=20;be.SvgColorPaletteViewer(b,i.colorPalette,e.legendDiv.children[1].children[0].children[1],{width:C,height:w}),b.translate(5,50),u=50+w,e.height+=50+w}if(i.sizePalette){var I=r("size");n.add(t.text(I).font({family:fontFamily,size:a,weight:m}).translate(0,u));var A=t.group(),x=(C=e.width,w=35,p?e.legendDiv.children[1].children[1].children[1]:e.legendDiv.children[1].children[0].children[1]);be.SvgSizePaletteViewer(A,i.sizePalette,x,{width:C,height:w}),A.translate(5,50+u),e.height+=50+w}return t.front(),{thumbnail:o,content:n}}},be.Markers.shapes.box=e,be.Markers.shapes.circle=e,be.Markers.shapes.diamond=e,be.Markers.shapes.cross=e,be.Markers.shapes.triangle=e,be.Petal={prepare:function(e){if(!e.maxDelta){for(var t=0;isNaN(e.size.upper95[t])||isNaN(e.size.lower95[t]);)t++;var i=e.size.upper95[t]-e.size.lower95[t];for(t++;t<e.size.upper95.length;t++)isNaN(e.size.upper95[t])||isNaN(e.size.lower95[t])||(i=Math.max(i,e.size.upper95[t]-e.size.lower95[t]));e.maxDelta=i}if(null==e.y||null==e.y)throw"The mandatory property 'y' is undefined or null";if(!be.Utils.isArray(e.y))throw"The property 'y' must be an array of numbers";var r=e.y.length,o=new Int8Array(r);if(be.Utils.maskNaN(o,e.y),null==e.x)e.x=be.Utils.range(0,r-1);else{if(!be.Utils.isArray(e.x))throw"The property 'x' must be an array of numbers";if(e.x.length!=r)throw"Length of the array which is a value of the property 'x' differs from lenght of 'y'";be.Utils.maskNaN(o,e.x)}if(null!=e.border&&"none"!=e.border||(e.border=null),null==e.color&&(e.color=be.Markers.defaults.color),be.Utils.isArray(e.color)){if(e.color.length!=r)throw"Length of the array 'color' is different than length of the array 'y'";if(0<r&&"string"!=typeof e.color[0]){var n=e.colorPalette;if(null==n&&(n=be.Markers.defaults.colorPalette),"string"==typeof n&&(n=new be.ColorPalette.parse(n)),null!=n&&n.isNormalized){var a=be.Utils.getMinMax(e.color);a=be.Utils.makeNonEqual(a),n=n.absolute(a.min,a.max)}e.colorPalette=n;var s=new Array(r);for(t=0;t<r;t++){var l=e.color[t];if(l!=l)o[t]=1;else{var d=n.getRgba(l);s[t]="rgba("+d.r+","+d.g+","+d.b+","+d.a+")"}}e.color=s}e.individualColors=!0}else e.individualColors=!1;var h=new Array(r);if(be.Utils.isArray(e.size.lower95)&&be.Utils.isArray(e.size.upper95)){if(e.size.lower95.length!=r&&e.size.upper95.length!=r)throw"Length of the array 'size' is different than length of the array 'y'";if(0<r&&"number"==typeof e.size.lower95[0]&&"number"==typeof e.size.upper95[0]){var g=[],c=[];for(t=0;t<r;t++){var u=e.size.upper95[t],f=e.size.lower95[t];u!=u||f!=f?o[t]=1:(g[t]=e.size.upper95[t],c[t]=e.size.lower95[t])}e.upper95=g,e.lower95=c}}e.size="15.0";for(t=0;t<r;t++)h[t]=e.size;e.sizeMax=e.size,e.size=h;var p=0;for(t=0;t<r;t++)1===o[t]&&p++;if(0<p){p=r-p,e.x=be.Utils.applyMask(o,e.x,p),e.y=be.Utils.applyMask(o,e.y,p),e.size=be.Utils.applyMask(o,e.size,p),e.upper95=be.Utils.applyMask(o,e.upper95,p),e.lower95=be.Utils.applyMask(o,e.lower95,p),e.individualColors&&(e.color=be.Utils.applyMask(o,e.color,p));for(var v=Array(p),m=(t=0,0);t<r;t++)0===o[t]&&(v[m++]=t);e.indices=v}else e.indices=be.Utils.range(0,r-1)},preRender:function(e,t,i,r,o){return e.individualColors||(o.fillStyle=e.color),null!=e.border&&(o.strokeStyle=e.border),e},draw:function(e,t,i,r,o){var n=r.dataToScreenX(e.x),a=r.dataToScreenY(e.y);if(!(n>i.width||n<0||a>i.height||a<0)){var s=e.size/2,l=s*(1-(e.upper95-e.lower95)/e.maxDelta);e.maxDelta<=0&&(l=NaN),be.Petal.drawSample(o,n,a,l,s,e.color)}},drawSample:function(e,t,i,r,o,n){var a,s,l=Math.random()*Math.PI*2;isNaN(r)?(a=0,s=o,e.fillStyle="rgba(0, 0, 0, 0.2)"):(a=(o-r)/2,s=(o+r)/2,e.fillStyle=n),e.strokeStyle="black",e.beginPath();for(var d=2*Math.PI/200,h=0;h<200;h++){var g=d*h,c=a*Math.sin(6*g+l)+s;0==h?e.moveTo(t+c*Math.cos(g),i+c*Math.sin(g)):e.lineTo(t+c*Math.cos(g),i+c*Math.sin(g))}e.stroke(),e.closePath(),e.fill(),e.strokeStyle="gray",e.beginPath(),e.arc(t,i,1,0,2*Math.PI),e.stroke(),e.closePath()},hitTest:function(e,t,i,r){var o=t.dataToScreenX(e.x),n=t.dataToScreenY(e.y),a=e.size/2;return!(i.x<o-a||i.x>o+a)&&!(i.y<n-a||i.y>n+a)},getLegend:function(i,r,e){var o=e.content,t=14;document.defaultView&&document.defaultView.getComputedStyle&&(t=parseFloat(document.defaultView.getComputedStyle(o[0],null).getPropertyValue("font-size"))),!isNaN(t)&&0!=t||(t=14);var n=e.thumbnail,a=1.5*t,s=a/2+1,l=a/2+1;n[0].width=n[0].height=2+a;n[0].style;var d,h,g,c=n.get(0).getContext("2d");c.clearRect(0,0,n[0].width,n[0].height);var u,f,p,v,m,y=0,b=0;!function(){if(i.individualColors&&i.colorPalette){var e=r("color");if(0==y){d=me("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(o),m=me("<div class='idd-legend-item-property'></div>").text(e).appendTo(d),h=d[0].style;var t=me("<div style='width: 170px;'></div>").appendTo(d);g=new be.ColorPaletteViewer(t),y=2}else m.text(e);g.palette=i.colorPalette,1==y&&(h.display="block",y=2)}else 2==y&&(h.display="none",y=1);i.individualColors?0:(i.color,null!=i.border&&i.border)}(),function(){u=a;var e=r("size");if(0==b){p=me("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(o),v=me("<div class='idd-legend-item-property'></div>").text(e).appendTo(p),p[0].style;var t=me("<div style='width: 170px;'></div>").appendTo(p);new be.UncertaintySizePaletteViewer(t),b=2}else v.text(e);f=u/2}(),be.Petal.drawSample(c,s,l,f/2,f,"gray")},getTooltipData:function(e,t){var i={},r={};return be.Utils.isArray(e.x)&&t<e.x.length&&(r.x=new be.AdaptiveFormatter(e.x),i.x=r.x.toString(e.x[t])),be.Utils.isArray(e.y)&&t<e.y.length&&(r.y=new be.AdaptiveFormatter(e.y),i.y=r.y.toString(e.y[t])),be.Utils.isArray(e.color)&&t<e.color.length&&(r.color=new be.AdaptiveFormatter(e.color),i.color=r.color.toString(e.color[t])),e.size&&(i.size={},be.Utils.isArray(e.size.lower95)&&t<e.size.lower95.length&&(r.lower95=new be.AdaptiveFormatter(e.size.lower95),i.size["lower 95%"]=r.lower95.toString(e.size.lower95[t])),be.Utils.isArray(e.size.upper95)&&t<e.size.upper95.length&&(r.upper95=new be.AdaptiveFormatter(e.size.upper95),i.size["upper 95%"]=r.upper95.toString(e.size.upper95[t]))),i.index=t,i},renderSvg:function(e,t,i,r,o){var n=r.y.length;if(0!=n){var a,s,l=i.group(),d=o.dataToScreenX,h=o.dataToScreenY,g=t.width,c=t.height,u=0,f=r.size[0];for(null==r.border||r.border;u<n;u++){a=d(r.x[u]),s=h(r.y[u]);var p=f/2,v=p*(1-(r.upper95[u]-r.lower95[u])/r.maxDelta),m=r.color[u];if(c1=g<a||a<0||c<s||s<0,!c1){var y,b,C=Math.random()*Math.PI*2;y=(p-v)/2,b=(p+v)/2;for(var w=2*Math.PI/200,I=[],A=0;A<200;A++){var x=w*A,T=y*Math.sin(6*x+C)+b;I.push([a+T*Math.cos(x),s+T*Math.sin(x)])}l.polyline(I).fill(m).stroke("black"),l.circle(2).translate(a-1,s-1).fill("gray").stroke({width:2,color:"gray"})}}l.clipWith(l.rect(g,c))}}},be.BullEye={prepare:function(e){if(e.bullEyeShape=e.bullEyeShape?e.bullEyeShape.toLowerCase():"circle",null==e.y||null==e.y)throw"The mandatory property 'y' is undefined or null";if(!be.Utils.isArray(e.y))throw"The property 'y' must be an array of numbers";var t=e.y.length,i=new Int8Array(t);if(be.Utils.maskNaN(i,e.y),null==e.x)e.x=be.Utils.range(0,t-1);else{if(!be.Utils.isArray(e.x))throw"The property 'x' must be an array of numbers";if(e.x.length!=t)throw"Length of the array which is a value of the property 'x' differs from lenght of 'y'";be.Utils.maskNaN(i,e.x)}if(null!=e.border&&"none"!=e.border||(e.border=null),be.Utils.isArray(e.color.lower95)&&be.Utils.isArray(e.color.upper95)){if(e.color.lower95.length!=t&&e.color.upper95.length!=t)throw"Length of the array 'color' is different than length of the array 'y'";if(0<t&&void 0!==e.color.lower95[0]&&"string"!=typeof e.color.upper95[0]){if(null==(c=e.colorPalette)&&(c=be.Markers.defaults.colorPalette),"string"==typeof c&&(c=new be.ColorPalette.parse(c)),null!=c&&c.isNormalized){var r={min:be.Utils.getMin(e.color.lower95),max:be.Utils.getMax(e.color.upper95)};r=be.Utils.makeNonEqual(r),c=c.absolute(r.min,r.max)}e.colorPalette=c;for(var o=[],n=[],a=0;a<t;a++){var s=e.color.upper95[a],l=e.color.lower95[a];if(s!=s||l!=l)i[a]=1;else{var d=c.getRgba(s),h=c.getRgba(l);o[a]="rgba("+d.r+","+d.g+","+d.b+","+d.a+")",n[a]="rgba("+h.r+","+h.g+","+h.b+","+h.a+")"}}e.upper95=o,e.lower95=n}e.individualColors=!0}else e.individualColors=!1;var g=new Array(t);if(null==e.size&&(e.size=be.Markers.defaults.size),be.Utils.isArray(e.size)){if(e.size.length!=t)throw"Length of the array 'size' is different than length of the array 'y'";if(null!=e.sizePalette){var c;if((c=be.SizePalette.Create(e.sizePalette)).isNormalized){r=be.Utils.getMinMax(e.size);r=be.Utils.makeNonEqual(r),c=new be.SizePalette(!1,c.sizeRange,r)}e.sizePalette=c;for(a=0;a<t;a++){var u=e.size[a];u!=u?i[a]=1:g[a]=c.getSize(u)}}else e.sizeMax=be.Utils.getMax(e.size)}else{for(a=0;a<t;a++)g[a]=e.size;e.sizeMax=e.size}e.size=g;var f=0;for(a=0;a<t;a++)1===i[a]&&f++;if(0<f){f=t-f,e.x=be.Utils.applyMask(i,e.x,f),e.y=be.Utils.applyMask(i,e.y,f),e.size=be.Utils.applyMask(i,e.size,f),e.individualColors&&(e.upper95=be.Utils.applyMask(i,e.upper95,f),e.lower95=be.Utils.applyMask(i,e.lower95,f));for(var p=Array(f),v=(a=0,0);a<t;a++)0===i[a]&&(p[v++]=a);e.indices=p}else e.indices=be.Utils.range(0,t-1)},preRender:function(e,t,i,r,o){return null!=e.border&&(o.strokeStyle=e.border),e},draw:function(e,t,i,r,o){e.y_mean;var n=e.upper95,a=e.lower95,s=e.size,l=s/2,d=r.dataToScreenX(e.x),h=r.dataToScreenY(e.y);d+l<0||d-l>i.width||h+l<0||h-l>i.height||(be.BullEye.drawBullEye(o,e.bullEyeShape,d,h,s,s,n),be.BullEye.drawBullEye(o,e.bullEyeShape,d,h,l,l,a))},drawBullEye:function(e,t,i,r,o,n,a,s){var l=o,d=n,h="none"!==s;e.strokeStyle=void 0!==s?s:"black",e.fillStyle=void 0!==a?a:"black";var g=i,c=r,u=Math.min(l,d),f=.5*u;switch(e.clearRect(0,0,l,d),t){case"box":h&&e.strokeRect(g-f,c-f,u,u),e.fillRect(g-f,c-f,u,u);break;case"circle":e.beginPath(),e.arc(g,c,f,0,2*Math.PI),h&&e.stroke(),e.fill();break;case"diamond":e.beginPath(),e.moveTo(g-f,c),e.lineTo(g,c-f),e.lineTo(g+f,c),e.lineTo(g,c+f),e.closePath(),h&&e.stroke(),e.fill();break;case"cross":var p=u/3/2;e.beginPath(),e.moveTo(g-f,c-p),e.lineTo(g-p,c-p),e.lineTo(g-p,c-f),e.lineTo(g+p,c-f),e.lineTo(g+p,c-p),e.lineTo(g+f,c-p),e.lineTo(g+f,c+p),e.lineTo(g+p,c+p),e.lineTo(g+p,c+f),e.lineTo(g-p,c+f),e.lineTo(g-p,c+p),e.lineTo(g-f,c+p),e.closePath(),h&&e.stroke(),e.fill();break;case"triangle":var v=Math.sqrt(3)/6*u;e.beginPath(),e.moveTo(g-f,c+v),e.lineTo(g,c-2*v),e.lineTo(g+f,c+v),e.closePath(),h&&e.stroke(),e.fill()}},hitTest:function(e,t,i,r){var o=t.dataToScreenX(e.x),n=t.dataToScreenY(e.y);return i.x>o-e.size/2&&i.x<o+e.size/2&&i.y>n-e.size/2&&i.y<n+e.size/2},getPadding:function(e){return{left:0,right:0,top:0,bottom:0}},getLegend:function(i,r,e){var o=e.content,t=14;document.defaultView&&document.defaultView.getComputedStyle&&(t=parseFloat(document.defaultView.getComputedStyle(o[0],null).getPropertyValue("font-size"))),!isNaN(t)&&0!=t||(t=14);var n=e.thumbnail,a=1.5*t,s=a/2+1,l=a/2+1;n[0].width=n[0].height=2+a;n[0].style;var d,h,g,c=n.get(0).getContext("2d");c.clearRect(0,0,n[0].width,n[0].height);var u,f,p,v,m,y=0,b=0;!function(){if(i.individualColors&&i.colorPalette){var e=r("color");if(0==y){d=me("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(o),m=me("<div class='idd-legend-item-property'></div>").text(e).appendTo(d),h=d[0].style;var t=me("<div style='width: 170px;'></div>").appendTo(d);g=new be.ColorPaletteViewer(t),y=2}else m.text(e);g.palette=i.colorPalette,1==y&&(h.display="block",y=2)}else 2==y&&(h.display="none",y=1);i.individualColors?0:(i.color,null!=i.border&&i.border)}(),function(){if(u=a,i.sizePalette){var e=r("size");if(0==b){f=me("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(o),v=me("<div class='idd-legend-item-property'></div>").text(e).appendTo(f),f[0].style;var t=me("<div style='width: 170px;'></div>").appendTo(f);p=new be.SizePaletteViewer(t),b=2}else v.text(e);p.palette=be.SizePalette.Create(i.sizePalette)}0}(),be.BullEye.drawBullEye(c,i.bullEyeShape,s,l,u,u,"gray","gray")},getTooltipData:function(e,t){var i={},r={};return be.Utils.isArray(e.x)&&t<e.x.length&&(r.x=new be.AdaptiveFormatter(e.x),i.x=r.x.toString(e.x[t])),be.Utils.isArray(e.y)&&t<e.y.length&&(r.y=new be.AdaptiveFormatter(e.y),i.y=r.y.toString(e.y[t])),e.color&&(i.color={},be.Utils.isArray(e.color.lower95)&&t<e.color.lower95.length&&(r.lower95=new be.AdaptiveFormatter(e.color.lower95),i.color["lower 95%"]=r.lower95.toString(e.color.lower95[t])),be.Utils.isArray(e.color.upper95)&&t<e.color.upper95.length&&(r.upper95=new be.AdaptiveFormatter(e.color.upper95),i.color["upper 95%"]=r.upper95.toString(e.color.upper95[t]))),be.Utils.isArray(e.size)&&t<e.size.length&&(r.size=new be.AdaptiveFormatter(e.size),i.size=r.size.toString(e.size[t])),i.index=t,i},renderSvg:function(e,t,i,r,o){var n=r.y.length;if(0!=n){for(var a,s,l=i.group(),d=o.dataToScreenX,h=o.dataToScreenY,g=t.width,c=t.height,u=0,f=r.size[0],p=.5*f,v=.5*p;u<n;u++){a=d(r.x[u]),s=h(r.y[u]),c1=a+p<0||g<a-p||s+p<0||c<s-p;var m=r.individualColors?r.upper95[u]:r.upper95,y=r.individualColors?r.lower95[u]:r.lower95;if(!c1)switch(r.bullEyeShape){case"box":l.rect(f,f).translate(a-p,s-p).fill(m).stroke({width:.5,color:"black"}),l.rect(p,p).translate(a-v,s-v).fill(y).stroke({width:.5,color:"black"});break;case"circle":l.circle(f).translate(a-p,s-p).fill(m).stroke({width:.5,color:"black"}),l.circle(p).translate(a-v,s-v).fill(y).stroke({width:.5,color:"black"});break;case"diamond":l.rect(f/Math.sqrt(2),f/Math.sqrt(2)).translate(a,s-p).fill(m).stroke({width:.5,color:"black"}).rotate(45),l.rect(p/Math.sqrt(2),p/Math.sqrt(2)).translate(a,s-v).fill(y).stroke({width:.5,color:"black"}).rotate(45);break;case"cross":var b=f/6,C=p/6;l.polyline([[-p,-b],[-b,-b],[-b,-p],[b,-p],[b,-b],[p,-b],[p,b],[b,b],[b,p],[-b,p],[-b,b],[-p,b],[-p,-b]]).translate(a,s).fill(m).stroke({width:.5,color:"black"}),l.polyline([[-v,-C],[-C,-C],[-C,-v],[C,-v],[C,-C],[v,-C],[v,C],[C,C],[C,v],[-C,v],[-C,C],[-v,C],[-v,-C]]).translate(a,s).fill(y).stroke({width:.5,color:"black"});break;case"triangle":var w=Math.sqrt(3)/6*f,I=Math.sqrt(3)/6*p;l.polyline([[-p,w],[0,2*-w],[p,w],[-p,w]]).translate(a,s).fill(m).stroke({width:.5,color:"black"}),l.polyline([[-v,I],[0,2*-I],[v,I],[-v,I]]).translate(a,s).fill(y).stroke({width:.5,color:"black"})}}l.clipWith(l.rect(g,c))}}},be.BoxWhisker={prepare:function(e){if(null==e.y.median||null==e.y.median)throw"The mandatory property 'y' is undefined or null";if(!be.Utils.isArray(e.y.median))throw"The property 'y' must be an array of numbers";var t=e.y.median.length,i=new Int8Array(t);if(be.Utils.maskNaN(i,e.y.median),null==e.x)e.x=be.Utils.range(0,t-1);else{if(!be.Utils.isArray(e.x))throw"The property 'x' must be an array of numbers";if(e.x.length!=t)throw"Length of the array which is a value of the property 'x' differs from lenght of 'y'";be.Utils.maskNaN(i,e.x)}null!=e.border&&"none"!=e.border||(e.border=null),null!=e.thickness&&"none"!=e.thickness||(e.thickness=2),null==e.color&&(e.color=be.Markers.defaults.color);var r=new Array(t);if(null==e.size&&(e.size=be.Markers.defaults.size),be.Utils.isArray(e.y.lower95)&&be.Utils.isArray(e.y.upper95)){if(e.y.lower95.length!=t&&e.y.upper95.length!=t)throw"Length of the array 'y' is different than length of the array 'y'";if(0<t&&"number"==typeof e.y.lower95[0]&&"number"==typeof e.y.upper95[0]){for(var o=[],n=[],a=0;a<t;a++){var s=e.y.upper95[a],l=e.y.lower95[a];s!=s||l!=l?i[a]=1:(o[a]=e.y.upper95[a],n[a]=e.y.lower95[a])}e.upper95=o,e.lower95=n}}if(be.Utils.isArray(e.y.lower68)&&be.Utils.isArray(e.y.upper68)){if(e.y.lower68.length!=t&&e.y.upper68.length!=t)throw"Length of the array 'y' is different than length of the array 'y'";if(0<t&&"number"==typeof e.y.lower68[0]&&"number"==typeof e.y.upper68[0]){var d=[],h=[];for(a=0;a<t;a++){var g=e.y.upper68[a],c=e.y.lower68[a];g!=g||c!=c?i[a]=1:(d[a]=e.y.upper68[a],h[a]=e.y.lower68[a])}e.upper68=d,e.lower68=h}}for(a=0;a<t;a++)r[a]=e.size;e.sizeMax=e.size,e.size=r;var u=0;for(a=0;a<t;a++)1===i[a]&&u++;if(0<u){u=t-u,e.x=be.Utils.applyMask(i,e.x,u),e.y=be.Utils.applyMask(i,e.y.median,u),e.size=be.Utils.applyMask(i,e.size,u),e.upper95=be.Utils.applyMask(i,e.upper95,u),e.lower95=be.Utils.applyMask(i,e.lower95,u),e.upper68=be.Utils.applyMask(i,e.upper68,u),e.lower68=be.Utils.applyMask(i,e.lower68,u);for(var f=Array(u),p=(a=0,0);a<t;a++)0===i[a]&&(f[p++]=a);e.indices=f}else e.y=e.y.median,e.indices=be.Utils.range(0,t-1)},preRender:function(e,t,i,r,o){return o.fillStyle=e.color,null!=e.border&&(o.strokeStyle=e.border),e},draw:function(e,t,i,r,o){var n=e.size,a=n/2,s=r.dataToScreenX(e.x),l=r.dataToScreenY(e.upper68),d=r.dataToScreenY(e.lower68),h=r.dataToScreenY(e.upper95),g=r.dataToScreenY(e.lower95),c=r.dataToScreenY(e.y);o.beginPath(),o.strokeStyle=void 0===e.border?"black":e.border,o.lineWidth=e.thickness,e.color&&o.fillRect(s-a,d,n,l-d),o.strokeRect(s-a,d,n,l-d),o.moveTo(s-a,h),o.lineTo(s+a,h),o.moveTo(s,h),o.lineTo(s,l),o.moveTo(s,d),o.lineTo(s,g),o.moveTo(s-a,g),o.lineTo(s+a,g),o.moveTo(s-a,c),o.lineTo(s+a,c),o.stroke(),void 0!==e.y_min&&(o.beginPath(),o.arc(s,r.dataToScreenY(e.y_min),a/2,0,2*Math.PI),o.stroke()),void 0!==e.y_max&&(o.beginPath(),o.arc(s,r.dataToScreenY(e.y_max),a/2,0,2*Math.PI),o.stroke())},hitTest:function(e,t,i,r){var o=t.dataToScreenX(e.x),n=t.dataToScreenY(void 0===e.y_min?e.lower95:e.y_min),a=t.dataToScreenY(void 0===e.y_max?e.upper95:e.y_max);return i.x>o-e.size/2&&i.x<o+e.size/2&&i.y>a&&i.y<n},getBoundingBox:function(e){e.size;var t=e.x,i=e.lower95?e.lower95:e.lower68?e.lower68:e.y,r=e.upper95?e.upper95:e.upper68?e.upper68:e.y;return{x:t,y:i,width:0,height:Math.abs(r-i)}},getPadding:function(e){return{left:0,right:0,top:0,bottom:0}},getLegend:function(n,i,e){var r=e.content,t=14;document.defaultView&&document.defaultView.getComputedStyle&&(t=parseFloat(document.defaultView.getComputedStyle(r[0],null).getPropertyValue("font-size"))),!isNaN(t)&&0!=t||(t=14);var o=e.thumbnail,a=1.5*t,s=a/2+1,l=a/2+1;o[0].width=o[0].height=2+a;o[0].style;var d,h,g,c,u,f,p,v,m=o.get(0).getContext("2d"),y=0,b=0;!function(){if(n.individualColors&&n.colorPalette){var e=i("color");if(0==y){d=me("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(r),v=me("<div class='idd-legend-item-property'></div>").text(e).appendTo(d),h=d[0].style;var t=me("<div style='width: 170px;'></div>").appendTo(d);g=new be.ColorPaletteViewer(t),y=2}else v.text(e);g.palette=n.colorPalette,1==y&&(h.display="block",y=2)}else 2==y&&(h.display="none",y=1);n.individualColors?0:(n.color,null!=n.border&&n.border)}(),function(){if(c=a,n.sizePalette){var e=i("size");if(0==b){u=me("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(r),p=me("<div class='idd-legend-item-property'></div>").text(e).appendTo(u),u[0].style;var t=me("<div style='width: 170px;'></div>").appendTo(u);f=new be.SizePaletteViewer(t),b=2}else p.text(e);f.palette=be.SizePalette.Create(n.sizePalette)}0}(),function(){var e="string"==typeof n.color?n.color:"gray",t="string"==typeof n.border?n.border:"gray",i="none"!==t;m.strokeStyle=void 0!==t?t:"black",m.fillStyle=void 0!==e?e:"black";var r=.5*c,o=.5*r;m.clearRect(0,0,c,c),m.fillRect(s-r,l-o,c,r),i&&m.strokeRect(s-r,l-o,c,r),m.beginPath(),m.moveTo(s-r,l+r),m.lineTo(s+r,l+r),m.moveTo(s-r,l-r),m.lineTo(s+r,l-r),m.moveTo(s,l+r),m.lineTo(s,l+o),m.moveTo(s,l-r),m.lineTo(s,l-o),m.closePath(),i&&m.stroke(),i&&(m.beginPath(),m.moveTo(s-r,l),m.lineTo(s+r,l),m.stroke())}()},getTooltipData:function(e,t){var i={},r={};return be.Utils.isArray(e.x)&&t<e.x.length&&(r.x=new be.AdaptiveFormatter(e.x),i.x=r.x.toString(e.x[t])),e.y&&(i.y={},be.Utils.isArray(e.y.median)&&t<e.y.median.length&&(r.median=new be.AdaptiveFormatter(e.y.median),i.y.median=r.median.toString(e.y.median[t])),be.Utils.isArray(e.y.lower95)&&t<e.y.lower95.length&&(r.lower95=new be.AdaptiveFormatter(e.y.lower95),i.y["lower 95%"]=r.lower95.toString(e.y.lower95[t])),be.Utils.isArray(e.y.upper95)&&t<e.y.upper95.length&&(r.upper95=new be.AdaptiveFormatter(e.y.upper95),i.y["upper 95%"]=r.upper95.toString(e.y.upper95[t])),be.Utils.isArray(e.y.lower68)&&t<e.y.lower68.length&&(r.lower68=new be.AdaptiveFormatter(e.y.lower68),i.y["lower 68%"]=r.lower68.toString(e.y.lower68[t])),be.Utils.isArray(e.y.upper68)&&t<e.y.upper68.length&&(r.upper68=new be.AdaptiveFormatter(e.y.upper68),i.y["upper 68%"]=r.upper68.toString(e.y.upper68[t]))),be.Utils.isArray(e.size)&&t<e.size.length&&(r.size=new be.AdaptiveFormatter(e.size),i.size=r.size.toString(e.size[t])),i.index=t,i},renderSvg:function(e,t,i,r,o){var n=r.y.length;if(0!=n){for(var a,s,l,d,h,g,c,u=i.group(),f=o.dataToScreenX,p=o.dataToScreenY,v=t.width,m=t.height,y=0,b=r.size[0],C=b/2,w=r.color,I=null==r.border?"none":r.border,A=r.thickness;y<n;y++)a=f(r.x[y]),s=p(r.y[y]),l=r.upper68?p(r.upper68[y]):void 0,d=r.lower68?p(r.lower68[y]):void 0,h=r.upper95?p(r.upper95[y]):void 0,g=r.lower95?p(r.lower95[y]):void 0,c=p(r.y[y]),c1=a<0||v<a||s<0||m<s,c1||(null!=h&&null!=g&&(u.polyline([[a-C,h],[a+C,h]]).style({fill:"none",stroke:I,"stroke-width":A}),u.polyline([[a,h],[a,g]]).style({fill:"none",stroke:I,"stroke-width":A}),u.polyline([[a-C,g],[a+C,g]]).style({fill:"none",stroke:I,"stroke-width":A})),null!=l&&null!=d&&u.rect(b,Math.abs(l-d)).translate(a-C,l).fill(w).style({fill:w,stroke:I,"stroke-width":A}),u.polyline([[a-C,c],[a+C,c]]).style({fill:"none",stroke:I,"stroke-width":A}));u.clipWith(u.rect(v,m))}}},be.Bars={prepare:function(e){var t,i;if("h"==e.orientation){if(null==e.x||null==e.x)throw"The mandatory property 'x' is undefined or null";if(!be.Utils.isArray(e.x))throw"The property 'x' must be an array of numbers";if(t=e.x.length,i=new Int8Array(t),be.Utils.maskNaN(i,e.x),null==e.y)e.y=be.Utils.range(0,t-1);else{if(!be.Utils.isArray(e.y))throw"The property 'x' must be an array of numbers";if(e.y.length!=t)throw"Length of the array which is a value of the property 'x' differs from length of 'y'";be.Utils.maskNaN(i,e.y)}}else{if(null==e.y||null==e.y)throw"The mandatory property 'y' is undefined or null";if(!be.Utils.isArray(e.y))throw"The property 'y' must be an array of numbers";if(t=e.y.length,i=new Int8Array(t),be.Utils.maskNaN(i,e.y),null==e.x)e.x=be.Utils.range(0,t-1);else{if(!be.Utils.isArray(e.x))throw"The property 'x' must be an array of numbers";if(e.x.length!=t)throw"Length of the array which is a value of the property 'x' differs from length of 'y'";be.Utils.maskNaN(i,e.x)}}if(null!=e.border&&"none"!=e.border||(e.border=null),null!=e.shadow&&"none"!=e.shadow||(e.shadow=null),null==e.color&&(e.color=be.Markers.defaults.color),be.Utils.isArray(e.color)){if(e.color.length!=t)throw"Length of the array 'color' is different than length of the array 'y'";if(0<t&&"string"!=typeof e.color[0]){var r=e.colorPalette;if(null==r&&(r=be.Markers.defaults.colorPalette),"string"==typeof r&&(r=new be.ColorPalette.parse(r)),null!=r&&r.isNormalized){var o=be.Utils.getMinMax(e.color);o=be.Utils.makeNonEqual(o),r=r.absolute(o.min,o.max)}e.colorPalette=r;for(var n=new Array(t),a=0;a<t;a++){var s=e.color[a];if(s!=s)i[a]=1;else{var l=r.getRgba(s);n[a]="rgba("+l.r+","+l.g+","+l.b+","+l.a+")"}}e.color=n}e.individualColors=!0}else e.individualColors=!1;var d=0;for(a=0;a<t;a++)1===i[a]&&d++;if(0<d){d=t-d,e.x=be.Utils.applyMask(i,e.x,d),e.y=be.Utils.applyMask(i,e.y,d),e.individualColors&&(e.color=be.Utils.applyMask(i,e.color,d));for(var h=Array(d),g=(a=0,0);a<t;a++)0===i[a]&&(h[g++]=a);e.indices=h}else e.indices=be.Utils.range(0,t-1)},draw:function(e,t,i,r,o){var n,a,s,l,d,h;if("h"==e.orientation){if(n=r.dataToScreenX(0),(a=r.dataToScreenX(e.x))<n){var g=a;a=n,n=g}if(n>i.width||a<0)return;if(h=r.plotToScreenY(e.barWidth)-r.plotToScreenY(0),l=r.dataToScreenY(e.y)-h/2,(s=r.dataToScreenY(e.y)+h/2)>i.height||l<0)return}else{if(d=r.plotToScreenX(e.barWidth)-r.plotToScreenX(0),n=r.dataToScreenX(e.x)-d/2,a=r.dataToScreenX(e.x)+d/2,n>i.width||a<0)return;if((l=r.dataToScreenY(0))<(s=r.dataToScreenY(e.y))){g=l;l=s,s=g}if(s>i.height||l<0)return}e.shadow&&(o.fillStyle=e.shadow,o.fillRect(n+2,s+2,a-n,l-s)),o.fillStyle=e.color,o.fillRect(n,s,a-n,l-s),e.border&&(o.strokeStyle=e.border,o.strokeRect(n,s,a-n,l-s))},getPlotBoundingBox:function(e,t){var i,r,o,n,a=e.barWidth,s=t.dataToPlotX,l=t.dataToPlotY;return void 0===s&&(s=function(e){return e}),void 0===l&&(l=function(e){return e}),n="h"==e.orientation?(i=s(Math.min(0,e.x)),r=l(e.y)-a/2,o=s(Math.abs(e.x)),a):(i=s(e.x)-a/2,r=l(Math.min(0,e.y)),o=a,l(Math.abs(e.y))),{x:i,y:r,width:o,height:n}},hitTest:function(e,t,i,r){var o=e.barWidth,n="h"==e.orientation?Math.min(0,e.x):e.x-o/2,a="h"==e.orientation?e.y-o/2:Math.min(0,e.y);return"h"==e.orientation?!(r.x<n||r.x>n+Math.abs(e.x))&&!(r.y<a||r.y>a+o):!(r.x<n||r.x>n+o)&&!(r.y<a||r.y>a+Math.abs(e.y))},getLegend:function(i,r,e){var o=e.content,t=14;document.defaultView&&document.defaultView.getComputedStyle&&(t=parseFloat(document.defaultView.getComputedStyle(o[0],null).getPropertyValue("font-size"))),!isNaN(t)&&0!=t||(t=14);var n=e.thumbnail,a=1.5*t,s=a/3-.5,l=a/3*2,d=a,h=a/2,g=a/3;n[0].width=n[0].height=2+a;n[0].style;var c,u,f,p,v,m,y,b,C=n.get(0).getContext("2d"),w=0;!function(){if(0,i.individualColors&&i.colorPalette){var e=r("color");if(0==w){c=me("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(o),p=me("<div class='idd-legend-item-property'></div>").text(e).appendTo(c),u=c[0].style;var t=me("<div style='width: 170px;'></div>").appendTo(c);f=new be.ColorPaletteViewer(t),w=2}else p.text(e);f.palette=i.colorPalette,1==w&&(u.display="block",w=2)}else 2==w&&(u.display="none",w=1);i.individualColors?0:(i.color,null!=i.border&&i.border,null!=i.shadow&&i.shadow)}(),v="string"==typeof i.color?i.color:"lightgray",m="string"==typeof i.border?i.border:"gray",y="string"==typeof i.shadow?i.shadow:"gray",b="none"!==m,C.clearRect(0,0,a,a),y&&(C.fillStyle=y,C.fillRect(1,1+h,s,a-h),s+=1,C.fillRect(s+1,1,l-s,a),l+=1,C.fillRect(l+1,1+g,d-l,a-g)),C.strokeStyle=void 0!==m?m:"black",C.fillStyle=void 0!==v?v:"black",C.fillStyle=v,C.fillRect(0,h,s,a-h),C.fillRect(s,0,l-s,a),C.fillRect(l,g,d-l,a-g),b&&(C.strokeStyle=m,C.strokeRect(0,h,s,a-h),C.strokeRect(s,0,l-s,a),C.strokeRect(l,g,d-l,a-g))},renderSvg:function(e,t,i,r,o){var n=r.y.length;if(0!=n){for(var a,s,l,d,h,g=i.group(),c=o.dataToScreenX,u=o.dataToScreenY,f=t.width,p=t.height,v=0,m=r.barWidth/2,y=null==r.border?"none":r.border,b=null==r.shadow?"none":r.shadow;v<n;v++){if("h"==r.orientation){if(a=c(0),s=c(r.x[v]),l=u(r.y[v]+m),d=u(r.y[v]-m),s<a){var C=s;s=a,a=C}}else if(a=c(r.x[v]-m),s=c(r.x[v]+m),l=u(r.y[v]),(d=u(0))<l){C=d;d=l,l=C}h=r.individualColors?r.color[v]:r.color,c1=s<0||f<a||d<0||p<l,c1||(g.polyline([[a+2,d+2],[a+2,l+2],[s+2,l+2],[s+2,d+2],[a+2,d+2]]).fill(b),g.polyline([[a,d],[a,l],[s,l],[s,d],[a,d]]).fill(h).stroke({width:1,color:y}))}g.clipWith(g.rect(f,p))}},buildSvgLegendElements:function(e,t,i,r){var o=t.group(),n=t.group(),a=1.5*(v=12),s=a/3-.5,l=a/3*2,d=a,h=a/2,g=a/3,c="none";i.individualColors?(border="#000000",color="lightgrey",c="grey"):(color=i.color,border="none",null!=i.border&&(border=i.border),null!=i.shadow&&(c=i.shadow)),o.polyline([[1,1+a],[1,1+h],[s+1,1+h],[s+1,1+a],[1,1+a]]).fill(c),o.polyline([[0,a],[0,h],[s,h],[s,a],[0,a]]).fill(color).stroke({width:.2,color:border}),s+=1,o.polyline([[s+1,1+a],[s+1,1],[l+1,1],[l+1,1+a],[s+1,1+a]]).fill(c),o.polyline([[s,a],[s,0],[l,0],[l,a],[s,a]]).fill(color).stroke({width:.2,color:border}),l+=1,o.polyline([[l+1,1+a],[l+1,1+g],[1+d,1+g],[1+d,1+a],[l+1,1+a]]).fill(c),o.polyline([[l,a],[l,g],[d,g],[d,a],[l,a]]).fill(color).stroke({width:.2,color:border});var u=e.legendDiv.children[1],f=i.individualColors&&i.colorPalette,p=u&&e.legendDiv.children[1].children[0]&&e.legendDiv.children[1].children[0].children[0]?window.getComputedStyle(e.legendDiv.children[1].children[0].children[0],null):void 0,v=p?parseFloat(p.getPropertyValue("font-size")):void 0,m=p?p.getPropertyValue("font-family"):void 0,y=p?p.getPropertyValue("font-weight"):void 0;if(f){var b=r("color");n.text(b).font({family:m,size:v,weight:y});var C=t.group(),w=e.width;be.SvgColorPaletteViewer(C,i.colorPalette,e.legendDiv.children[1].children[0].children[1],{width:w,height:20}),C.translate(5,50),shiftsizePalette=70,e.height+=70}return t.front(),{thumbnail:o,content:n}}},be.Markers.shapes.boxwhisker=be.BoxWhisker,be.Markers.shapes.petals=be.Petal,be.Markers.shapes.bulleye=be.BullEye,be.Markers.shapes.bars=be.Bars,be.Area=function(e,t){var c,u,f,n="rgba(65, 105, 237, 0.4)",i=be.Utils.getDataSourceFunction(e,be.readCsv)(e);this.base=be.CanvasPlot,this.base(e,t);var l=n;i&&(l=void 0!==i.fill?i.fill:n),this.draw=function(e){var t=e.y1;if(!t)throw"Data series y1 is undefined";var i=t.length,r=e.y2;if(!r)throw"Data series y2 is undefined";if(r.length!==i)throw"Data series y1 and y2 have different lengths";var o=e.x;if((o=o||be.Utils.range(0,i-1)).length!==i)throw"Data series x and y1, y2 have different lengths";u=t,f=r,c=o,l=void 0!==e.fill?e.fill:n,this.invalidateLocalBounds(),this.requestNextFrameOrUpdate(),this.fireAppearanceChanged()},this.computeLocalBounds=function(){var e=this.xDataTransform&&this.xDataTransform.dataToPlot,t=this.yDataTransform&&this.yDataTransform.dataToPlot,i=be.Utils.getBoundingBoxForArrays(c,u,e,t),r=be.Utils.getBoundingBoxForArrays(c,f,e,t);return be.Utils.unionRects(i,r)},this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.getTooltip=function(e,t,i,r){if(void 0!==c&&null!=u&&null!=f&&(0!=u.length&&this.isVisible)){var o=this.getContext(!1);if(void 0!==o){for(var n=this.getTransform(),a=n.dataToScreenX(e),s=n.dataToScreenY(t),l=o.getImageData(a-1,s-1,3,3),d=0,h=0;h<l.data.length;h++)0===l.data[h]&&d++;if(d!==l.data.length){var g=me("<div></div>");return me("<div></div>").addClass("idd-tooltip-name").text(this.name||"area").appendTo(g),g}}}},this.renderCore=function(e,t){be.Area.prototype.renderCore.call(this,e,t);var i=this.getContext(!0);be.Area.render.call(this,c,u,f,l,e,t,i)},this.renderCoreSvg=function(e,t,i){be.Area.renderSvg.call(this,e,t,i,c,u,f,l)};this.onDataTransformChanged=function(e){this.invalidateLocalBounds(),be.Area.prototype.onDataTransformChanged.call(this,e)},Object.defineProperty(this,"fill",{get:function(){return l},set:function(e){e!=l&&(l=e,this.fireAppearanceChanged("fill"),this.requestNextFrameOrUpdate())},configurable:!1}),this.getLegend=function(){var e=this,i=me("<canvas></canvas>");i[0].width=40,i[0].height=40;var r=i.get(0).getContext("2d");r.globalAlpha=1,r.strokeStyle=l,r.fillStyle=l,r.beginPath(),r.moveTo(0,0),r.lineTo(0,10),r.lineTo(30,40),r.lineTo(40,40),r.lineTo(40,30),r.lineTo(10,0),r.lineTo(0,0),r.fill(),r.stroke(),r.closePath();function o(){t.text(e.name)}var t=me("<span></span>");o(),this.host.bind("appearanceChanged",function(e,t){t&&"name"!=t||o(),r.clearRect(0,0,i[0].width,i[0].height),r.strokeStyle=l,r.fillStyle=l,r.beginPath(),r.moveTo(0,0),r.lineTo(0,10),r.lineTo(30,40),r.lineTo(40,40),r.lineTo(40,30),r.lineTo(10,0),r.lineTo(0,0),r.fill(),r.stroke(),r.closePath()});e=this;return{name:t,legend:{thumbnail:i,content:void 0},onLegendRemove:function(){e.host.unbind("appearanceChanged")}}},this.buildSvgLegend=function(e,t){e.height=30,t.add(t.rect(e.width,e.height).fill("white").opacity(.5));var i=be.ColorPalette.colorFromString(l),r="rgb("+i.r+","+i.g+","+i.b+")";t.add(t.polyline([[0,0],[0,4.5],[13.5,18],[18,18],[18,13.5],[4.5,0],[0,0]]).fill(r).opacity(i.a).translate(5,5));var o=window.getComputedStyle(e.legendDiv.children[0].children[1],null),n=parseFloat(o.getPropertyValue("font-size")),a=o.getPropertyValue("font-family"),s=o?o.getPropertyValue("font-weight"):void 0;t.add(t.text(this.name).font({family:a,size:n,weight:s}).translate(40,0)),t.front()},i&&i.x&&i.y1&&i.y2&&this.draw(i)},be.Area.prototype=new be.CanvasPlot,be.Area.render=function(e,t,i,r,o,n,a){if(void 0!==e&&null!=t&&null!=i){var s=t.length;if(0!=s){var l=this.getTransform(),d=l.dataToScreenX,h=l.dataToScreenY;a.fillStyle=r;for(var g=[],c=void 0,u=0;u<s;u++)isNaN(e[u])||isNaN(t[u])||isNaN(i[u])?c=void 0===c?u:void g.push([c,u]):void 0===c?c=u:u===s-1&&(g.push([c,u]),c=void 0);var f=g.length;for(u=0;u<f;u++){a.beginPath();var p=g[u];a.moveTo(d(e[p[0]]),h(t[p[0]]));for(var v=p[0]+1;v<=p[1];v++)a.lineTo(d(e[v]),h(t[v]));for(v=p[1];v>=p[0];v--)a.lineTo(d(e[v]),h(i[v]));a.fill()}}}},be.Area.renderSvg=function(e,t,i,r,o,n,a){if(void 0!==r&&null!=o&&null!=n){var s=o.length;if(0!=s){for(var l=this.getTransform(),d=l.dataToScreenX,h=l.dataToScreenY,g=i.group(),c=t.width,u=t.height,f=[],p=void 0,v=0;v<s;v++)isNaN(r[v])||isNaN(o[v])||isNaN(n[v])?void 0!==p&&(f.push([p,v-1]),p=void 0):void 0===p?p=v:v===s-1&&(f.push([p,v]),p=void 0);var m=[],y=f.length,b=be.ColorPalette.colorFromString(a),C="rgb("+b.r+","+b.g+","+b.b+")";for(v=0;v<y;v++){var w=f[v];(m=[]).push([d(r[w[0]]),h(o[w[0]])]);for(var I=w[0]+1;I<=w[1];I++)m.push([d(r[I]),h(o[I])]);for(I=w[1];I>=w[0];I--)m.push([d(r[I]),h(n[I])]);m.push([d(r[w[0]]),h(o[w[0]])]),g.polyline(m).fill(C).opacity(b.a)}g.clipWith(g.rect(c,u))}}},be.heatmapBackgroundRenderer=void 0,be.Heatmap=function(e,I){var t=be.Utils.getDataSourceFunction(e,be.readCsv2d)(e);if(t&&void 0!==t.y&&void 0!==t.values){var i=t.y,r=t.values,o=i.length,n=r.length;if(1<o&&0<n&&i[0]>i[1]){i.reverse();for(var a=0;a<o;a++)r[a].reverse()}}if(this.base=be.CanvasPlot,this.base(e,I),e){null==be.heatmapBackgroundRenderer&&(be.heatmapBackgroundRenderer=new be.SharedRenderWorker(function(){var e;if(void 0===be.heatmapBackgroundRendererCodeBase64||/PhantomJS/.test(window.navigator.userAgent)||0<be.Utils.getIEVersion())e=be.HeatmapworkerPath?be.HeatmapworkerPath+"idd.heatmapworker.js":"idd.heatmapworker.js";else{var t=new Blob([window.atob(be.heatmapBackgroundRendererCodeBase64)],{type:"text/javascript"});e=window.URL.createObjectURL(t)}return e}(),function(e,t){e.onRenderTaskCompleted(t)}));function v(e){if(e)try{F="string"==typeof e?be.ColorPalette.parse(e):e,L=be.ColorPalette.toArray(F,512)}catch(e){window.console&&console.error("Failed to initialize the palette")}}function m(e){R=Math.min(1,Math.max(0,e))}var A,x,T,S,y,b,C,P,k,M,w,D,G,N,R,B,F,V,L,Z,z,Y,U,O,W,X,f,E=document.createElement("canvas");m(t&&void 0!==t.opacity?parseFloat(t.opacity):1),v(t&&void 0!==t.colorPalette?t.colorPalette:be.palettes.grayscale);function H(e){var t=e.length;if(!(t<1)){var i=e[0].length;if(!(i<1)){var r,o;r=o=e[0][0];for(var n=0;n<t;n++)for(var a=e[n],s=0;s<i;s++){var l=a[s];l==l&&((o<l||isNaN(o))&&(o=l),(l<r||isNaN(r))&&(r=l))}return{min:r,max:o}}}}function K(e,t,i,r){if(!e||!t||!i)return{};if(!e.length||!t.length||i.v&&!i.v.length||i.m&&(!i.m.length||!i.lb68.length||!i.ub68.length))return{};e=Array.prototype.slice.call(e),t=Array.prototype.slice.call(t),i.v?i.v=Array.prototype.slice.call(i.v):i.m&&(i.m=Array.prototype.slice.call(i.m),i.lb68=Array.prototype.slice.call(i.lb68),i.ub68=Array.prototype.slice.call(i.ub68)),!i.v||e.length===t.length&&e.length===i.v.length&&t.length===i.v.length?!i.m||e.length===t.length&&e.length===i.m.length&&t.length===i.m.length&&i.m.length===i.lb68.length&&i.m.length===i.ub68.length||(e.length=t.length=i.m.length=i.lb68.length=i.ub68.length=Math.min(e.length,t.length,i.m.length,i.lb68.length,i.ub68.length)):e.length=t.length=i.v.length=Math.min(e.length,t.length,i.v.length);var o,n,a,s,l=e.map(function(e,t){return{v:e,i:t}}),d=t.map(function(e,t){return{v:e,i:t}}),h=l.sort(function(e,t){return e.v<t.v?-1:e.v>t.v?1:0}),g=d.sort(function(e,t){return e.v<t.v?-1:e.v>t.v?1:0}),c=h.filter(function(e,t){return!t||e.v!=h[t-1].v}).map(function(e){return e.v}),u=g.filter(function(e,t){return!t||e.v!=g[t-1].v}).map(function(e){return e.v}),f=[],p=[];o=0,h.forEach(function(e,t){return f[e.i]=t?e.v!=h[t-1].v?++o:o:0}),o=0,g.forEach(function(e,t){return p[e.i]=t?e.v!=g[t-1].v?++o:o:0});function v(e,t){for(var i=[],r=0;r<e;++r){i[r]=[];for(var o=0;o<t;++o)i[r][o]=NaN}return i}if(i.v)for(n=v(c.length,u.length),o=0;o<i.v.length;++o)n[f[o]][p[o]]=i.v[o];else for(m=v(c.length,u.length),a=v(c.length,u.length),s=v(c.length,u.length),o=0;o<i.m.length;++o)m[f[o]][p[o]]=i.m[o],a[f[o]][p[o]]=i.lb68[o],s[f[o]][p[o]]=i.ub68[o];if(r){if(2<=c.length){var m,y=[];for(y.push(c[0]-(c[1]-c[0])/2),m=1;m<c.length;m++)y.push(c[m]-(c[m]-c[m-1])/2);y.push(c[c.length-1]+(c[c.length-1]-c[c.length-2])/2),c=y}if(2<=u.length){var b,C=[];for(C.push(u[0]-(u[1]-u[0])/2),b=1;b<u.length;b++)C.push(u[b]-(u[b]-u[b-1])/2);C.push(u[u.length-1]+(u[u.length-1]-u[u.length-2])/2),u=C}}return{x:c,y:u,values:n,m:m,l68:a,u68:s}}function j(){var e=H(S);P=e.min,k=e.max,M&&(P=Math.max(P,w),k=Math.max(k,w),G=be.Utils.log10(P),N=be.Utils.log10(k))}var Q,s=this;if(this.onRenderTaskCompleted=function(e){Q=e,E.width===Q.width&&E.height===Q.height||(E.width=Q.width,E.height=Q.height),E.getContext("2d").putImageData(Q.image,0,0),s.requestNextFrame()},this.draw=function(e,t){var i=e.values;if(!i)throw"Data series f is undefined";var r=void 0!==i.median&&!be.Utils.isArray(i.median[0])||!be.Utils.isArray(i[0]),o=e.x,n=e.y;if(null==z&&null==Z&&(z=e.interval),Z=e.interval,M=void 0!==e.logPalette&&e.logPalette,w=e.logTolerance?e.logTolerance:1e-12,i.median){if(null==Y){var a=me("<div></div>").attr("data-idd-name","heatmap__nav_").appendTo(this.host);(Y=new be.Heatmap(a,this.master)).getLegend=function(){},this.addChild(Y),Y.getTooltip=function(e,t,i,r){}}if(r){var s=K(o,n,{v:void 0,m:i.median,lb68:i.lower68,ub68:i.upper68},"discrete"===e.treatAs);T=s.x,x=s.y,S=s.m,C=s.m,b=s.l68,y=s.u68,Y.x=s.x,Y.y=s.y,Y.f_median=s.m,Y.f_l68=s.l68,Y.f_u68=s.u68}else T=o,x=n,S=i.median,C=i.median,b=i.lower68,y=i.upper68,Y.x=s.x,Y.y=s.y,Y.f_median=i.median68,Y.f_l68=i.lower68,Y.f_u68=i.upper68;Z&&_()}else if(Y&&Y.remove(),Y=void 0,r){s=K(o,n,{v:i},"discrete"===e.treatAs);T=s.x,x=s.y,S=s.values}else S=i,T=o,x=n;if(M){D=new Array(S.length);for(var l=0;l<S.length;l++)for(var d=S[l],h=D[l]=new Float32Array(d.length),g=0;g<d.length;g++)h[g]=be.Utils.log10(d[g])}X=W=O=U=void 0;var c=C?C.length:S.length,u=C?C[0].length:S[0].length;if(T){if(T.length!=c&&T.length!=c+1)throw"Data series x must have length equal or one more than length of data series f by first dimension"}else T=be.Utils.range(0,c);if(x){if(x.length!=u&&x.length!=u+1)throw"Data series y must have length equal or one more than length of data series f by second dimension"}else x=be.Utils.range(0,u);if(T.length==c){if(x.length!=u)throw"Data series y must have length equal to length of data series f by second dimension";B="gradient"}else{if(x.length!=u+1)throw"Data series y must have length equal to one more than length of data series f by second dimension";B="matrix"}if(T.length<2)throw"Data series x must have at least 2 elements by each dimension";if(x.length<2)throw"Data series y must have at least 2 elements by each dimension";e&&void 0!==e.opacity&&m(parseFloat(e.opacity)),e&&void 0!==e.colorPalette&&v(e.colorPalette),F.isNormalized&&j(),V=!0;var f=this.invalidateLocalBounds(),p=this.getLocalBounds();be.Utils.equalRect(f,p)?this.requestNextFrame():this.requestNextFrameOrUpdate(),this.setTitles(t,!0),this.fireAppearanceChanged()},this.computeLocalBounds=function(){var e;if(T&&x){var t,i,r,o,n,a=T.length,s=x.length;for(n=0;n<a&&(t=T[n])!=t;n++);for(n=a;0<=--n&&(i=T[n])!=i;);for(n=0;n<s&&(r=x[n])!=r;n++);for(n=s;0<=--n&&(o=x[n])!=o;);var l=this.xDataTransform&&this.xDataTransform.dataToPlot,d=this.yDataTransform&&this.yDataTransform.dataToPlot;l&&(t=l(t),i=l(i)),d&&(r=d(r),o=d(o)),e={x:Math.min(t,i),y:Math.min(r,o),width:Math.abs(i-t),height:Math.abs(o-r)}}return e},"undefined"==typeof Modernizr||!e||Modernizr.webworkers&&Modernizr.postmessage){var J=void 0,q=void 0;this.renderCore=function(e,t){be.Heatmap.prototype.renderCore.call(this,e,t);var i=this.getContext(!0);if(null!=T&&null!=x&&null!=S){var r=this.coordinateTransform,o=r.plotToScreenX,n=r.plotToScreenY,a=this.getLocalBounds(),s=be.Utils.intersect(a,e);if(s){var l=!0;if(void 0!==I.mapControl){var d=a.x,h=a.x+a.width/2,g=a.x+a.width;if(void 0===J){var c={fillColor:new Microsoft.Maps.Color(120,120,120,120),strokeColor:new Microsoft.Maps.Color(120,120,120,120),strokeThickness:0};J=new Microsoft.Maps.Polygon([new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y),d),new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y),h),new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y+a.height),h),new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y+a.height),d)],c),q=new Microsoft.Maps.Polygon([new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y),h),new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y),g),new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y+a.height),g),new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y+a.height),h)],c),I.mapControl.entities.push(J),I.mapControl.entities.push(q)}V&&(J.setLocations([new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y),d),new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y),h),new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y+a.height),h),new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y+a.height),d)]),q.setLocations([new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y),h),new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y),g),new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y+a.height),g),new Microsoft.Maps.Location(be.mercatorTransform.plotToData(a.y+a.height),h)])),l=!I.isInAnimation,J.setOptions({visible:I.isInAnimation}),q.setOptions({visible:I.isInAnimation})}if(l){var u={left:Math.floor(o(s.x)),width:Math.ceil(r.plotToScreenWidth(s.width)),top:Math.floor(n(s.y+s.height)),height:Math.ceil(r.plotToScreenHeight(s.height))},f=r.getScale(),p=r.getOffset();if(i.fillStyle="rgba(200,200,200,0.3)",i.fillRect(u.left,u.top,u.width,u.height),Q)if(be.Utils.intersect(Q.plotRect,e)){var v,m=o(Q.plotRect.x),y=n(Q.plotRect.y+Q.plotRect.height);if(1!=R&&(v=i.globalAlpha,i.globalAlpha=R),f.x!=Q.scaleX||f.y!=Q.scaleY){var b=f.x/Q.scaleX,C=f.y/Q.scaleY;i.drawImage(E,0,0,Q.image.width,Q.image.height,m,y,b*Q.image.width,C*Q.image.height)}else i.drawImage(E,m,y);1!=R&&(i.globalAlpha=v)}if((V||!this.master.isInAnimation&&(!Q||Q.scaleX!=f.x||Q.scaleY!=f.y||!be.Utils.includes(Q.plotRect,s)))&&0!==u.width&&0!==u.heigh){A&&A.width===u.width&&A.height===u.height||(A=i.createImageData(u.width,u.height));var w={image:A,width:A.width,height:A.height,x:T,y:x,f:M?D:S,fmin:M?G:P,fmax:M?N:k,plotRect:s,scaleX:f.x,scaleY:f.y,offsetX:p.x-u.left,offsetY:p.y-u.top,palette:{isNormalized:F.isNormalized,range:F.range,points:F.points,colors:L},xDataTransform:this.xDataTransform&&this.xDataTransform.type,yDataTransform:this.yDataTransform&&this.yDataTransform.type};be.heatmapBackgroundRenderer.enqueue(w,this),V=!1}}}}},this.renderCoreSvg=function(e,t,i){var r=i.group();if(null!=T&&null!=x&&null!=S){t.width,t.height;var o=this.coordinateTransform,n=o.plotToScreenX,a=o.plotToScreenY,s=this.getLocalBounds(),l=be.Utils.intersect(s,e);if(l){var d={left:Math.floor(n(l.x)),width:Math.ceil(o.plotToScreenWidth(l.width)),top:Math.floor(a(l.y+l.height)),height:Math.ceil(o.plotToScreenHeight(l.height))},h=E.toDataURL("image/png");r.image(h,A.width,A.height).opacity(R).clipWith(r.rect(d.width,d.height)),r.translate(d.left,d.top)}}},this.onIsRenderedChanged=function(){this.isRendered||be.heatmapBackgroundRenderer.cancelPending(this)},this.onDataTransformChanged=function(e){this.invalidateLocalBounds(),be.Heatmap.prototype.onDataTransformChanged.call(this,e)};this.getValue=function(e,t,i){var r=T.length,o=x.length;if(0==r||0==o)return null;var n,a,s,l,d,h=function(e,t){var i=T.length,r=x.length;if(0!=i&&0!=r&&!(e<T[0]||t<x[0]||e>T[i-1]||t>x[r-1])){var o,n;for(o=1;o<i;o++)if(e<=T[o]){if(isNaN(T[o-1]))return NaN;break}for(n=1;n<r;n++)if(t<=x[n]){if(isNaN(x[n-1]))return NaN;break}return i<=o||r<=n?NaN:{iLeft:o-1,jBottom:n-1}}}(e,t);if(null==h)return null;if(h!=h)return"<div>"+(this.name||"heatmap")+": (unknown value)</div>";if("gradient"===B)if(s=i[h.iLeft][h.jBottom+1],a=i[h.iLeft][h.jBottom],l=i[h.iLeft+1][h.jBottom+1],d=i[h.iLeft+1][h.jBottom],isNaN(s)||isNaN(a)||isNaN(l)||isNaN(d))n=NaN;else{var g=x[h.jBottom],c=x[h.jBottom+1],u=(s-a)/(c-g)*(t-g)+a,f=(l-d)/(c-g)*(t-g)+d,p=T[h.iLeft];n=(f-u)/(T[h.iLeft+1]-p)*(e-p)+u}else n=i[h.iLeft][h.jBottom];return n};var _=function(){for(var e=Y.f_median,t=new Array(e.length),i=0;i<e.length;i++){var r=e[i];t[i]=new Array(r.length);for(var o=0;o<r.length;o++)t[i][o]=Y.f_l68[i][o]<Z.max&&Y.f_u68[i][o]>Z.min?0:1}Y.draw({x:Y.x,y:Y.y,values:t,opacity:.5,colorPalette:be.ColorPalette.parse("0=#00000000=#00000080=1")}),Y.isVisible=!0};this.getTooltip=function(e,t,i,r,o){if(void 0!==S){var n=this;if(this.isVisible&&!this.IsErrorVisible){var a={x:e,y:t};if(void 0===y||void 0===b||void 0===C){var s=H(S);U=be.AdaptiveFormatter(s.min,s.max);var l=me("<div></div>");me("<div></div>").addClass("idd-tooltip-name").text(this.name||"heatmap").appendTo(l);var d=this.getValue(a.x,a.y,S,B);if(null==d)return;var h=this.getTitle("values");return me("<div>"+h+": "+U.toString(d)+"</div>").appendTo(l),l}s=H(C);O=be.AdaptiveFormatter(s.min,s.max),s=H(b),W=be.AdaptiveFormatter(s.min,s.max),s=H(y),X=be.AdaptiveFormatter(s.min,s.max);l=me("<div></div>");me("<div></div>").addClass("idd-tooltip-name").text(this.name||"heatmap").appendTo(l);var g=this.getValue(a.x,a.y,b),c=this.getValue(a.x,a.y,y),u=this.getValue(a.x,a.y,C);if(null!=g&&null!=c&&null!=u){h=this.getTitle("values");var f=me("<div></div>").addClass("idd-tooltip-compositevalue");f.append(me("<div>median: "+O.toString(u)+"</div>")),f.append(me("<div>lower 68%: "+W.toString(g)+"</div>")),f.append(me("<div>upper 68%: "+X.toString(c)+"</div>"));var p=me("<div></div>");p.append(me("<div>"+h+":</div>")).append(f),p.appendTo(l);var v=me("<div></div>").css("display","inline-block").appendTo(l),m=me("<div></div>").addClass("checkButton").appendTo(v);return Z&&(o?Z!=z?(Z={min:g,max:c},me(".checkButton").removeClass("checkButton-checked"),m.addClass("checkButton-checked"),this.fireAppearanceChanged("interval")):me(".checkButton").removeClass("checkButton-checked"):(me(".checkButton").removeClass("checkButton-checked"),m.addClass("checkButton-checked")),_()),m.click(function(){m.hasClass("checkButton-checked")?(m.removeClass("checkButton-checked"),z?(Z=z,_()):(Z=void 0,Y.isVisible=!1)):(me(".checkButton").removeClass("checkButton-checked"),m.addClass("checkButton-checked"),Z={min:g,max:c},_()),n.fireAppearanceChanged("interval")}),me(me("<span style='margin-left:3px;'>highlight similar</span>")).appendTo(v),l}}}},Object.defineProperty(this,"palette",{get:function(){return F},set:function(e){if(e!=F){if(!e)throw"Heatmap palette is undefined";F&&e.isNormalized&&!F.isNormalized&&S&&j(),v(e),Q=void 0,this.fireAppearanceChanged("palette"),this.requestNextFrame()}},configurable:!1}),Object.defineProperty(this,"opacity",{get:function(){return R},set:function(e){if(!e)throw"Heatmap opacity is undefined";e!=R&&(m(e),this.fireAppearanceChanged("opacity"),this.requestNextFrame())},configurable:!1}),Object.defineProperty(this,"mode",{get:function(){return B},configurable:!1}),this.getLegend=function(){function r(){o.text(i.name)}var e=me("<canvas></canvas>"),t=me("<div></div>"),i=this,o=me("<span></span>");r();var n,a,s,l,d,h=0;a=me("<div class='idd-legend-item-palette'></div>").appendTo(t);function g(){l=i.getTitle("values"),0==h?(a.empty(),d=me("<div class='idd-legend-item-property'></div>").text(l).appendTo(a),s=me("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px;'></div>").appendTo(a),n=new be.ColorPaletteViewer(s,F,{logAxis:M}),h=2):d.text(l),F&&F.isNormalized&&(n.dataRange={min:P,max:k})}var c;g();function u(){null==Z&&c?c.empty():Z&&(f=be.AdaptiveFormatter(Z.min,Z.max),c?c.text("highlighted interval: "+f.toString(Z.min)+", "+f.toString(Z.max)):c=me("<div style='font-size:14px;'>highlighted interval: "+f.toString(Z.min)+", "+f.toString(Z.max)+"</div>").appendTo(t))}u(),this.host.bind("appearanceChanged",function(e,t){t&&"name"!=t||r(),t&&"interval"!=t||u(),t&&"values"!=t&&"colorPalette"!=t||(h=0,g()),t&&"palette"!=t||(n.palette=F);var i=n.dataRange;F&&F.isNormalized&&(null==i||i.min!=P||i.max!=k)&&(n.dataRange={min:P,max:k})});return{name:o,legend:{thumbnail:e,content:t},onLegendRemove:function(){i.host.unbind("appearanceChanged")}}},this.buildSvgLegend=function(e,t){e.height=30,t.add(t.rect(e.width,e.height).fill("white").opacity(.5));var i=window.getComputedStyle(e.legendDiv.children[0].children[1],null),r=parseFloat(i.getPropertyValue("font-size")),o=i.getPropertyValue("font-family"),n=i?i.getPropertyValue("font-weight"):void 0;t.add(t.text(this.name).font({family:o,size:r,weight:n}).translate(40,0));var a=e.legendDiv.children[1];r=(i=a&&e.legendDiv.children[1].children[0]&&e.legendDiv.children[1].children[0].children[0]?window.getComputedStyle(e.legendDiv.children[1].children[0].children[0],null):void 0)?parseFloat(i.getPropertyValue("font-size")):void 0,o=i?i.getPropertyValue("font-family"):void 0,n=i?i.getPropertyValue("font-weight"):void 0;var s=t.group(),l=this.getTitle("values");s.text(l).font({family:o,size:r,weight:n}),s.translate(5,30);var d=t.group(),h=e.width,g=20;if(be.SvgColorPaletteViewer(d,F,e.legendDiv.children[1].children[0].children[1],{width:h,height:g}),d.translate(5,50),e.height+=50+g,Z){r=(i=a&&e.legendDiv.children[1].children[1]&&e.legendDiv.children[1].children[1]?window.getComputedStyle(e.legendDiv.children[1].children[1],null):void 0)?parseFloat(i.getPropertyValue("font-size")):void 0,o=i?i.getPropertyValue("font-family"):void 0,n=i?i.getPropertyValue("font-weight"):void 0;var c=t.group(),u=me(e.legendDiv.children[1].children[1]).text();c.add(c.text(u).font({family:o,size:r,weight:n}));h=e.width,g=25;c.translate(5,100),e.height+=50+g}t.front()},t&&void 0!==t.values&&this.draw(t)}else{var l=e[0].parentElement;if(l){var d=!1;for(a=0;a<l.childNodes.length;a++)if(me(l.childNodes[a]).hasClass("nowebworkers")){d=!0;break}e[0].removeAttribute("data-idd-plot"),e[0].innerText="",d?e[0].innerText="":(e[0].innerText=" Heatmap cannot be rendered: browser does not support web workers.",e.addClass("nowebworkers"))}}}},be.Heatmap.prototype=new be.CanvasPlot,be.register("heatmap",function(e,t){return new be.Heatmap(e,t)}),be.NavigationPanel=function(r,e,t){if(e.attr("tabindex","0"),e.addClass("idd-navigation-container"),r.legend){var i=me("<div></div>").appendTo(e);r.legend.isVisible?i.addClass("idd-onscreennavigation-showlegend"):i.addClass("idd-onscreennavigation-hidelegend"),i.click(function(){r.legend.isVisible?(r.legend.isVisible=!1,i.removeClass("idd-onscreennavigation-showlegend").addClass("idd-onscreennavigation-hidelegend")):(r.legend.isVisible=!0,i.removeClass("idd-onscreennavigation-hidelegend").addClass("idd-onscreennavigation-showlegend"))})}t?me('<a style="display:block" target="_blank"></div>').addClass("idd-onscreennavigation-help").appendTo(e).attr("href",t):me('<a href="https://github.com/predictionmachines/InteractiveDataDisplay/wiki/UI-Guidelines" style="display:block" target="_blank"></div>').addClass("idd-onscreennavigation-help").appendTo(e);var o=me("<div></div>").addClass("idd-onscreennavigation-exportsvg").appendTo(e),n=me("<div></div>").addClass("idd-onscreennavigation-navigationlockpressed").appendTo(e),a=me("<div style='overflow: hidden; height: 0px'></div>").appendTo(e),s=me("<div></div>").addClass("idd-onscreennavigation-panner").appendTo(a),l=me("<div></div>").addClass("idd-onscreennavigation-zoomin").appendTo(a),d=me("<div></div>").addClass("idd-onscreennavigation-zoomout").appendTo(a),h=me("<div></div>").addClass("idd-onscreennavigation-fit").appendTo(a),g=me("<div></div>").addClass("idd-onscreennavigation-logscale").appendTo(a),c=void 0,u=A.Observable.create(function(e){return c=e,function(){c=void 0}});o.click(function(){try{new Blob;var e=r.exportToSvg(),t=new Blob([e.svg()]);x(t,"chart.svg")}catch(e){throw e.message}});var f=new function(t){var i=void 0;this.switch=function(){if(!t.mapControl){var e=(1+((t.xDataTransform?1:0)|(t.yDataTransform?2:0)))%4;return function(e){if(e!==i){switch(e){case 0:t.xDataTransform=void 0,t.yDataTransform=void 0;break;case 1:t.xDataTransform=be.logTransform,t.yDataTransform=void 0;break;case 2:t.xDataTransform=void 0,t.yDataTransform=be.logTransform;break;case 3:t.xDataTransform=be.logTransform,t.yDataTransform=be.logTransform}i=e}}(e),t.isAutoFitEnabled=!0,e}}}(r);g.click(function(e){var t=f.switch(),i=r.navigation.gestureSource;r.navigation.gestureSource=i?u.merge(i):u,me(this).trigger("axisChanged",[t])});var p=void 0;p=void 0!==r.navigation.gestureSource?u.merge(r.navigation.gestureSource):u,r.navigation.gestureSource=p;function v(){return void 0===r.mapControl?be.Gestures.zoomLevelFactor:3}function m(){c&&c.onNext(new be.Gestures.ZoomGesture(r.centralPart.width()/2,r.centralPart.height()/2,1/v(),"Mouse"))}function y(){c&&c.onNext(new be.Gestures.ZoomGesture(r.centralPart.width()/2,r.centralPart.height()/2,v(),"Mouse"))}var b,C=r.navigation.gestureSource;r.navigation.gestureSource=void 0,n.click(function(){void 0!==r.navigation.gestureSource?(r.navigation.gestureSource=void 0,n.removeClass("idd-onscreennavigation-navigationlock").addClass("idd-onscreennavigation-navigationlockpressed"),a.animate({height:0},200)):(r.navigation.gestureSource=C,n.removeClass("idd-onscreennavigation-navigationlockpressed").addClass("idd-onscreennavigation-navigationlock"),a.animate({height:225},200)),me(this).trigger("classChanged")}),d.dblclick(function(e){e.stopPropagation()}),d.click(function(e){e.stopPropagation(),y()}),l.dblclick(function(e){e.stopPropagation()}),l.click(function(e){e.stopPropagation(),m()}),r.isAutoFitEnabled&&h.attr("class","idd-onscreennavigation-fit-pressed"),h.click(function(){r.isAutoFitEnabled=!r.isAutoFitEnabled}),r.host.on("isAutoFitEnabledChanged",function(){r.isAutoFitEnabled?h.attr("class","idd-onscreennavigation-fit-pressed"):h.attr("class","idd-onscreennavigation-fit")}),e.keydown(function(e){var t=e.which;37==t?(c&&c.onNext(new be.Gestures.PanGesture(10,0,"Mouse")),e.preventDefault()):38==t?(c&&c.onNext(new be.Gestures.PanGesture(0,10,"Mouse")),e.preventDefault()):39==t?(c&&c.onNext(new be.Gestures.PanGesture(-10,0,"Mouse")),e.preventDefault()):40==t?(c&&c.onNext(new be.Gestures.PanGesture(0,-10,"Mouse")),e.preventDefault()):107==t||187==t?(m(),e.preventDefault()):109!=t&&189!=t||(y(),e.preventDefault())});var w={x:0,y:0};s.mousedown(function(e){var t=s.offset(),i=s.outerWidth()/2;w.x=(e.pageX-t.left-i)/i,w.y=(e.pageY-t.top-i)/i,1<w.x*w.x+w.y*w.y||(me(document).on("mousemove",I),s.removeClass("idd-onscreennavigation-panner").addClass("idd-onscreennavigation-panner-moved"),b=setInterval(function(){c.onNext(new be.Gestures.PanGesture(-10*w.x,-10*w.y,"Mouse"))},25))}),me(document).mouseup(function(){me(document).off("mousemove",I),b&&clearInterval(b),s.removeClass("idd-onscreennavigation-panner-moved").addClass("idd-onscreennavigation-panner")});var I=function(e){var t=s.offset(),i=s.outerWidth()/2;w.x=(e.pageX-t.left-i)/i,w.y=(e.pageY-t.top-i)/i};this.remove=function(){r.navigation.gestureSource=C,e.removeClass("idd-navigation-container"),e[0].innerHTML=""}},be.BingMaps=be.BingMaps||{},be.BingMaps.ESRI=be.BingMaps.ESRI||{},be.BingMaps.ESRI.GetWorldTopo=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(e){return"http://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/"+e.levelOfDetail+"/"+e.y+"/"+e.x}})},be.BingMaps.ESRI.GetDeLorme=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(e){return"http://server.arcgisonline.com/ArcGIS/rest/services/Specialty/DeLorme_World_Base_Map/MapServer/tile/"+e.levelOfDetail+"/"+e.y+"/"+e.x}})},be.BingMaps.ESRI.GetWorldImagery=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(e){return"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/"+e.levelOfDetail+"/"+e.y+"/"+e.x}})},be.BingMaps.ESRI.GetOceanBasemap=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(e){return"http://services.arcgisonline.com/ArcGIS/rest/services/Ocean_Basemap/MapServer/tile/"+e.levelOfDetail+"/"+e.y+"/"+e.x}})},be.BingMaps.ESRI.GetNationalGeographicMap=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(e){return"http://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/"+e.levelOfDetail+"/"+e.y+"/"+e.x}})},be.BingMaps.ESRI.GetWorldShadedRelief=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(e){return"http://services.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/"+e.levelOfDetail+"/"+e.y+"/"+e.x}})},be.BingMaps.ESRI.GetWorldTerrainBase=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(e){return"http://services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/"+e.levelOfDetail+"/"+e.y+"/"+e.x}})},be.BingMaps.OpenStreetMap=be.BingMaps.OpenStreet||{},be.BingMaps.OpenStreetMap.GetTileSource=function(){return new Microsoft.Maps.TileSource({uriConstructor:function(e){return"http://tile.openstreetmap.org/"+e.levelOfDetail+"/"+e.x+"/"+e.y+".png"}})},be.BingMapsPlot=function(e,t){if(e){var i=me('<div style="position: absolute"></div>').prependTo(e);this.base=be.Plot,this.base(e,t);if("undefined"==typeof Microsoft)me("<p></p>").css("margin",15).css("word-wrap","break-word").text("BingMaps script is unavailable. Check your internet connection.").appendTo(e);else{var r=void 0,o=void 0;0===this.children.length&&((r=me('<div style="position: absolute;"></div>').appendTo(e)).css("z-index",be.ZIndexNavigationLayer),o=me("<canvas></canvas>").appendTo(r));this.mapKey=e.attr("data-idd-mapKey");var n=new Microsoft.Maps.Map(i[0],{credentials:this.mapKey,mapTypeId:Microsoft.Maps.MapTypeId.aerial,enableClickableLogo:!1,enableSearchLogo:!1,showCopyright:!1,showDashboard:!1,showLogo:!1,disablePanning:!0,disableZooming:!0,width:e.width(),height:e.height()});Object.defineProperty(this,"map",{get:function(){return n},configurable:!1});var a=new be.BingMapsAnimation(n);this.arrange=function(e){be.BingMapsPlot.prototype.arrange.call(this,e),n.width=e.width,n.height=e.height},this.setMap=function(e){if(n.setMapType(Microsoft.Maps.MapTypeId.mercator),n.entities.clear(),e)if(e instanceof Microsoft.Maps.TileSource){var t=new Microsoft.Maps.TileLayer({mercator:e,opacity:1});n.entities.push(t)}else n.setMapType(e)},this.constraint=function(e,t,i){if(!0!==i)return e;var r=n.getWidth(),o=n.getHeight();return r<=1||o<=1?e:(a.setMapView(e,t),mapRect=be.Utils.getPlotRectForMap(n),mapRect)},this.arrange=function(e){be.CanvasPlot.prototype.arrange.call(this,e),void 0!==r&&(r.width(e.width),r.height(e.height),o[0].width=e.width,o[0].height=e.height)},a.constraint=this.constraint,this.navigation.animation=a,this.selfMapRefresh()}}},be.BingMapsPlot.prototype=new be.Plot,(T=be=be||{}).PersistentViewState=function(){var r=this,o=[];function t(e,t){for(var i=0;i<o.length;++i)o[i](r,e,t)}function e(e){return null!=e&&null!=e&&"undefined"!=e}this.subscribe=function(t){return o.push(t),function(){var e=o.indexOf(t);0<=e&&o.splice(e,1)}};var i=sessionStorage.getItem("plotRect"),n=e(i)?JSON.parse(i):void 0;Object.defineProperty(this,"plotRect",{get:function(){return n},set:function(e){e!=n&&(n=e,sessionStorage.setItem("plotRect",JSON.stringify(n)),t("plotRect"))},configurable:!1,enumerable:!0});var a=sessionStorage.getItem("isAutoFit"),s=!e(a)||JSON.parse(a);Object.defineProperty(this,"isAutoFit",{get:function(){return s},set:function(e){e!=s&&(s=e,sessionStorage.setItem("isAutoFit",JSON.stringify(s)),t("isAutoFit"))},configurable:!1,enumerable:!0});var l=sessionStorage.getItem("selectedPlots"),d=e(l)?JSON.parse(l):[];Object.defineProperty(this,"selectedPlots",{get:function(){return d},set:function(e){e!=d&&(d=e,sessionStorage.setItem("selectedPlots",JSON.stringify(d)),t("selectedPlots"))},configurable:!1,enumerable:!0});var h=sessionStorage.getItem("probes"),g=e(h)?new T.ProbesVM(JSON.parse(h)):new T.ProbesVM(void 0);g.subscribe(function(e){sessionStorage.setItem("probes",JSON.stringify(g.getProbes())),t("probes")}),Object.defineProperty(this,"probesViewModel",{get:function(){return g},configurable:!1,enumerable:!0});var c=sessionStorage.getItem("isLegendShown"),u=!!e(c)&&JSON.parse(c);Object.defineProperty(this,"isLegendShown",{get:function(){return u},set:function(e){e!=u&&(u=e,sessionStorage.setItem("isLegendShown",JSON.stringify(u)),t("isLegendShown"))},configurable:!1,enumerable:!0});var f=sessionStorage.getItem("isNavigationPanelOpen"),p=!!e(f)&&JSON.parse(f);Object.defineProperty(this,"isNavigationPanelOpen",{get:function(){return p},set:function(e){e!=p&&(p=e,sessionStorage.setItem("isNavigationPanelOpen",JSON.stringify(p)),t("isNavigationPanelOpen"))},configurable:!1,enumerable:!0});var v=sessionStorage.getItem("isLogAxis"),m=e(v)?JSON.parse(v):0;Object.defineProperty(this,"isLogAxis",{get:function(){return m},set:function(e){e!=m&&(m=e,sessionStorage.setItem("isLogAxis",JSON.stringify(m)),t("isLogAxis"))},configurable:!1,enumerable:!0});var y=sessionStorage.getItem("mapType"),b=e(y)?JSON.parse(y):void 0;Object.defineProperty(this,"mapType",{get:function(){return b},set:function(e){e!=b&&(b=e,sessionStorage.setItem("mapType",JSON.stringify(b)),t("mapType"))},configurable:!1,enumerable:!0});var C=sessionStorage.getItem("xDataTransform"),w=e(C)?JSON.parse(C):void 0;Object.defineProperty(this,"xDataTransform",{get:function(){return w},set:function(e){e!=w&&(w=e,sessionStorage.setItem("xDataTransform",JSON.stringify(w)),t("xDataTransform"))},configurable:!1,enumerable:!0});var I=sessionStorage.getItem("yDataTransform"),A=e(I)?JSON.parse(I):void 0;Object.defineProperty(this,"yDataTransform",{get:function(){return A},set:function(e){e!=A&&(A=e,sessionStorage.setItem("yDataTransform",JSON.stringify(A)),t("yDataTransform"))},configurable:!1,enumerable:!0});var x={};Object.defineProperty(this,"uncertaintyRange",{get:function(){return x},set:function(e){e!=x&&(x=e,t("uncertaintyRange"))},configurable:!1,enumerable:!0})},T.TransientViewState=function(){var r=this,o=[];function i(e,t){for(var i=0;i<o.length;++i)o[i](r,e,t)}this.subscribe=function(e){o.push(e)},this.unsubscribe=function(t){o=o.filter(function(e){return e!==t})};var n={};Object.defineProperty(this,"ranges",{get:function(){return n},configurable:!1,enumerable:!0});var t=new T.AdaptiveFormatter(0,1);Object.defineProperty(this,"plotXFormatter",{get:function(){return t},set:function(e){e!=t&&(t=e,i("plotXFormatter"))},configurable:!1,enumerable:!0});var a=new T.AdaptiveFormatter(0,1);Object.defineProperty(this,"plotYFormatter",{get:function(){return a},set:function(e){e!=a&&(a=e,i("plotYFormatter"))},configurable:!1,enumerable:!0}),this.setRangesForPlot=function(e,t){n[e]=t,i("ranges",{id:e})}},(be||(be={})).PlotRegistry={},(l=be=be||{}).createSmallProbe=N,l.ProbePull=function(e,t){var i=e,r=me("<div></div>").addClass("dragPoint").addClass("probe").appendTo(i);r.draggable({containment:"document",scroll:!1,zIndex:2500,helper:function(){var e=me("<div></div>").addClass("dragPoint");return N(e),e},appendTo:t}),r.mousedown(function(e){e.stopPropagation()})},l.OnScreenNavigation=function(e,t,i){l.NavigationPanel(t,e,"https://github.com/predictionmachines/InteractiveDataDisplay/wiki/UI-Guidelines#chartviewer");var r=e.find(".idd-onscreennavigation-showlegend");r.remove(),(r=e.find(".idd-onscreennavigation-hidelegend")).remove(),me("<div></div>").addClass("idd-onscreennavigation-hidelegend").prependTo(e);var o=e.find(".idd-onscreennavigation-navigationlockpressed");i.isNavigationPanelOpen&&me(o).click(),me(o).bind("classChanged",function(){i.isNavigationPanelOpen=me(this).hasClass("idd-onscreennavigation-navigationlock")});for(var n=e.find(".idd-onscreennavigation-logscale"),a=0;a<i.isLogAxis;a++)me(n).click();me(n).on("axisChanged",function(e,t){i.isLogAxis=t})},v=be=be||{},R.prototype.setupPlotsVisibility=function(){for(var e in this.currentPlots){var t=this.currentPlots[e],i=t.Plots;if(i)for(var r=-1==this.initiallySelectedPlots.indexOf(t.Id),o=0;o<i.length;++o)i[o].isVisible=r}},R.prototype.checkLatLon=function(e){var t,i,r,o;return void 0!==e.x&&(r=v.getTitle(e,"x"),"lon"===(o=r.toLowerCase())||"longitude"===o)&&void 0!==e.y&&(t=v.getTitle(e,"y"),"lat"===(i=t.toLowerCase())||"latitude"===i)},R.prototype.addPlot=function(t){var i=v.PlotRegistry[t.Definition.kind]?v.PlotRegistry[t.Definition.kind]:v.PlotRegistry.fallback;t.Plots=i.initialize(t.Definition,this.persistentViewState,this.iddChart);try{i.draw(t.Plots,t.Definition)}catch(e){void 0!==t.Plots&&t.Plots.forEach(function(e){e.remove()}),i=v.PlotRegistry.fallback,t.Definition.error=e.message,t.Plots=i.initialize(t.Definition,this.persistentViewState,this.iddChart),i.draw(t.Plots,t.Definition)}},R.prototype.updateAxes=function(){var e="",t="",i=[],r=[];for(var o in this.currentPlots){var n=this.currentPlots[o].Definition;if(n.x){for(var a=v.getTitle(n,"x"),s=!1,l=0;l<i.length;l++)if(i[l]===a){s=!0;break}s||(i.push(a),""!==e&&(e+=", "),e+=a)}if(n.y){var d=v.getTitle(n,"y");for(s=!1,l=0;l<r.length;l++)if(r[l]===d){s=!0;break}s||(r.push(d),""!==t&&(t+=", "),t+=d)}}""!==e?(void 0===this.xAxisTitle&&(this.xAxisTitle=me(this.iddChart.addDiv('<div style="font-size: larger; text-align: center"></div>',"bottom"))),this.xAxisTitle.text(e)):void 0!==this.xAxisTitle&&(this.iddChart.removeDiv(this.xAxisTitle[0]),this.xAxisTitle.remove(),this.xAxisTitle=void 0),""!==t?(void 0===this.yAxisTitle&&(this.yAxisTitle=me(this.iddChart.addDiv('<div class="idd-verticalTitle" style="font-size: larger;"></div>',"left"))),this.yAxisTitle.text(t)):void 0!==this.yAxisTitle&&(this.iddChart.removeDiv(this.yAxisTitle[0]),this.yAxisTitle.remove(),this.yAxisTitle=void 0)},R.prototype.createMap=function(){var e=me("<div></div>").attr("data-idd-name","bingMaps").css("z-index",0).prependTo(this.iddChart.host),t=new v.BingMapsPlot(e,this.iddChart);return t.order=9007199254740991,this.iddChart.addChild(t),t},R.prototype.updateMap=function(){var e=!1,t=!0;for(var i in this.currentPlots){var r=this.currentPlots[i];e=(t||e)&&this.checkLatLon(r.Definition),t=!1}e&&"undefined"!=typeof Microsoft?(void 0===this.bingMapsPlot?(this.bingMapsPlot=this.createMap(),this.persistentViewState.mapType?this.bingMapsPlot.setMap(this.persistentViewState.mapType):this.bingMapsPlot.setMap(Microsoft.Maps.MapTypeId.road)):this.persistentViewState.mapType&&this.bingMapsPlot.setMap(this.persistentViewState.mapType),this.iddChart.yDataTransform=v.mercatorTransform,this.iddChart.xDataTransform=void 0,this.bingMapsPlot.navigation.animation.setMapView(this.persistentViewState.plotRect,this.iddChart.screenSize)):void 0!==this.bingMapsPlot&&(this.bingMapsPlot.remove(),this.bingMapsPlot=void 0,this.iddChart.yDataTransform=void 0)},R.prototype.draw=function(e){var r=this;this.currentPlots=v.updateBag(this.currentPlots,e,function(e,t,i){return t.Definition.kind==i.Definition.kind?(v.syncProps(t.Definition,i.Definition)&&v.PlotRegistry[t.Definition.kind].draw(t.Plots,t.Definition),t):(void 0!==t.Plots&&t.Plots.forEach(function(e){e.remove()}),r.addPlot(i),i)},function(e,t){return r.addPlot(t),t},function(e,t){void 0!==t.Plots&&t.Plots.forEach(function(e){e.remove()})}),this.updateAxes(),this.updateMap(),this.persistentViewState.probesViewModel.refresh();var t=0;for(var i in this.currentPlots)(o=this.currentPlots[i]).ZIndex&&(t=Math.max(o.ZIndex,t));for(var i in this.currentPlots){var o;if((o=this.currentPlots[i]).ZIndex||(o.ZIndex=++t),o.Plots)for(var n=0;n<o.Plots.length;++n){var a=o.Plots[n];a.host.css("z-index",o.ZIndex),a.requestNextFrameOrUpdate()}}return this.persistentViewState.selectedPlots&&(this.initiallySelectedPlots=this.persistentViewState.selectedPlots,this.setupPlotsVisibility()),this.currentPlots},R.prototype.updateLayout=function(){this.iddDiv.width(this.div.width()),this.iddDiv.height(this.div.height()),this.iddChart.updateLayout(),void 0!==this.bingMapsPlot&&this.iddChart.navigation.setVisibleRect(this.iddChart.visibleRect,!1)},t=R,v.PlotViewer=t,(m=be=be||{}).PlotList=function(e,t,i,r){e.addClass("dsv-plotlist");var o=me("<div></div>").appendTo(e),n=new m.Legend(t.iddChart,o,!1,!0);t.iddChart.host.bind("visibleChanged",function(){i.probesViewModel.refresh(i.probesViewModel.getProbes())}),i.probesViewModel.refresh(i.probesViewModel.getProbes());var a=me("<div></div>").addClass("probes").appendTo(e),s=me("<div style='width:240px; margin-bottom: 16px'></div>").appendTo(a),l=me("<div></div>").addClass("dsv-onscreennavigation-probepull").appendTo(s),d=(new m.ProbePull(l,t.iddChart.centralPart),me("<div style='width: 195px; display:inline-block'></div>").appendTo(s));me("<div style='width:180px; height:1px; margin-bottom:6px; float:right; margin-top: 8px; background-color:lightgrey'></div>").appendTo(d),me("<div style='float:left; margin-left:15px;font-family: Segoe UI;font-size: 12px;color:grey; margin-bottom:16px'>Probes</div>").appendTo(d);var h=me("<div></div>").addClass("probes-list").appendTo(a);h[0].style.display="none",new m.ProbesControl(a,h,i,r),this.remove=function(){t.iddChart.host.bind("visibleChanged"),n.remove()}},y=be=be||{},B.prototype.update=function(e){var t={};for(var i in e){var r=e[i];null!=r?(t[i]={Id:i,Definition:r},null!==r.displayName&&void 0!==r.displayName||(t[(r=me.extend(!1,{},r)).displayName=i].Definition=r)):t[i]=null}t=this.plotViewer.draw(t)},B.prototype.updateLayout=function(){var e=0;this.controlDiv.width()<this.minWidthToShowLeftPanel&&void 0!==this.leftPanelContainer?this.leftPanelContainer.hide():void 0!==this.leftPanelContainer&&(this.leftPanelContainer.show(),e=this.leftPanelContainer.width()),this.rightpanel.width(this.controlDiv.width()-e-this.rightPanelExtraShift-this.navigationPanelShift),this.plotViewer.updateLayout(),this.persistentViewState.probesViewModel.refresh()},B.prototype.dispose=function(){this.plotList.remove(),this.controlDiv.children().remove()},i=B,y.ChartViewerControl=i,(b=be=be||{}).ProbesVM=function(e){function n(e,t){if(0<o.length)for(var i=0;i<o.length;i++)o[i]({probe:e,status:t})}var i=this,r=0,o=[],a=[];if(this.subscribe=function(e){o.push(e)},this.clear=function(){for(var e=a.slice(0),t=0;t<e.length;t++)i.removeProbe(e[t].id)},this.addProbe=function(e){var t={id:++r,location:e,selected:!1};return a.push(t),n(t,"add"),t.id},this.removeProbe=function(e){for(var t=void 0,i=0;i<a.length;i++){var r=a[i];if(r.id==e){t=r;break}}void 0!==t&&(a=a.filter(function(e){return e!==t}),n(t,"remove"))},this.updateProbe=function(e,t){for(var i=void 0,r=0;r<a.length;r++){var o=a[r];if(o.id==e){i=o;break}}void 0!==i&&(i.location=t,n(i,"update"))},this.selectProbe=function(e){if(-1!==e){var t=void 0;for(i=0;i<a.length;i++){(r=a[i]).id==e?(t=r).selected=!0:r.selected=!1}void 0!==t&&n(t,"selected")}else{for(var i=0;i<a.length;i++){var r;(r=a[i]).selected=!1}n(void 0,"unselected")}},this.fitToProbe=function(e){for(var t=0;t<a.length;t++){var i=a[t];i.id==e&&n(i,"fit")}},this.getProbes=function(){return a.slice(0)},this.getProbeContent=function(e){},this.refresh=function(){void 0!==i.onRefresh&&i.onRefresh(a.slice(0))},void 0!==e)for(var t=0;t<e.length;t++){var s={id:e[t].id,location:{x:e[t].location.x,y:e[t].location.y},selected:e[t].selected};a.push(s),r<s.id&&(r=s.id)}},b.ProbesControl=function(l,d,h,g){function a(e){l[0].style.display="block";var t=me("<div></div>").addClass("probeCard");!0===e.selected&&t.addClass("probeCard-selected");var i=me("<div></div>").addClass("probeHeader").appendTo(t).height(24),r=me("<div></div>").addClass("probe").css("float","left").css("margin-right",3).width(24).height(24).appendTo(i);e.selected?b.createSmallProbe(r,e.id,"#365C95",.6):b.createSmallProbe(r,e.id,void 0,.6),me("<div></div>").addClass("probeHeader-name").text(g.plotXFormatter.toString(e.location.x)+", "+g.plotYFormatter.toString(e.location.y)).appendTo(i);var o=me("<div></div>").addClass("probeActionPanel").appendTo(t);me("<div></div>").addClass("probeCard-remove").appendTo(o).click(function(){c.removeProbe(e.id),void 0!==h.uncertaintyRange&&h.uncertaintyRange.probeid===e.id&&(h.uncertaintyRange=void 0),0==d[0].childNodes.length&&(d[0].style.display="none")}),me("<div></div>").addClass("probeCard-fit").appendTo(o).click(function(){c.fitToProbe(e.id)});var n=c.getProbeContent(e);if(void 0!==n)for(var a=0;a<n.length;a++){var s=me(n[a]);s.addClass("probecard-record"),s.appendTo(t)}return t}function s(e){u.empty(),f=[];for(var t=0;t<e.length;t++){var i=e[t],r=a(i),o=me("<div></div>").css("display","inline").appendTo(u);r.appendTo(o),f.push({id:i.id,div:r,host:o})}0<e.length&&(d[0].style.display="block")}var c=h.probesViewModel,u=d,f=[];s(c.getProbes()),c.subscribe(function(e){var t=e.probe;switch(e.status){case"add":d[0].style.display="block";var i=a(e.probe),r=me("<div></div>").css("display","inline").appendTo(u);i.appendTo(r),f.push({id:t.id,div:i,host:r});break;case"remove":for(var o=0;o<f.length;o++){if((n=f[o]).id===t.id){n.host.remove(),f=f.filter(function(e){return e.id!==t.id}),0==d[0].childNodes.length&&(d[0].style.display="none");break}}break;case"update":for(o=0;o<f.length;o++){var n;if((n=f[o]).id===t.id){n.host.empty(),(i=a(e.probe)).appendTo(n.host),n.div=i;break}}break;case"selected":case"unselected":s(c.getProbes())}}),c.onRefresh=function(e){s(e)}},b.show=function(e,t,i){if(i)throw"viewState argument is not supported";var r=new b.ChartViewerControl(e);return r.update(t),r},(n=be=be||{}).updateBag=function(e,t,i,r,o){var n={};for(var a in t){var s=e[a];void 0!==(l=t[a])&&(n[a]=void 0!==s?null==l?s:i(a,s,l):r(a,l))}for(var a in e){s=e[a];var l=t[a];void 0!==s&&void 0===l&&o(a,s)}return n},n.getTitle=function(e,t){return e.titles&&void 0!==e.titles[t]?e.titles[t]:t},n.updateProp=F,n.isNumber=V,n.isString=L,n.isStringOrNumber=Z,n.deepCopyJS=z,n.syncProps=function e(t,i){var r=!1;for(var o in i)if(void 0===t[o]||Z(t[o])&&!Z(i[o]))t[o]=z(i[o]),r=r||!0;else if(Z(i[o])){var n=!F(o,t,i);r=r||n}else n=e(t[o],i[o]),r=r||n;var a=[];for(var s in t)if("d3Graphs"!==s&&"isPresented"!==s){var l=!1;for(var o in i)if(o===s){l=!0;break}l||(a.push(s),r=r||!0)}a.forEach(function(e){delete t[e]});for(var d=0;d<t.length;d++)null==t[d]&&"function"!=typeof t&&(t.splice(d,1),d--);return r},(a=be=be||{}).PlotRegistry.area={initialize:function(e,t,i){var r=me("<div></div>").attr("data-idd-name",e.displayName).appendTo(i.host),o=new a.Area(r,i.master);return i.addChild(o),i.assignChildOrder(o),[o]},draw:function(e,t){var i=t;e[0].draw(i)}},(r=be=be||{}).PlotRegistry.fallback={initialize:function(e,t,i){var r=new Y(me("<div></div>").attr("data-idd-name",e.displayName).appendTo(i.host),i.master);return i.addChild(r),i.assignChildOrder(r),[r]},draw:function(e,t){var i={kind:t.kind,error:t.error};e[0].draw(i)}},(r.FallbackPlot=Y).prototype=new r.CanvasPlot,(d=be=be||{}).PlotRegistry.heatmap={initialize:function(e,t,i){var r=me("<div></div>").attr("data-idd-name",e.displayName).appendTo(i.host),o=new d.Heatmap(r,i.master);return i.addChild(o),i.assignChildOrder(o),[o]},draw:function(e,t){e[0].draw(t,t.titles)}},(C=be=be||{}).PlotRegistry.line={initialize:function(e,t,i){var r=me("<div></div>").attr("data-idd-name",e.displayName).appendTo(i.host),o=new C.Polyline(r,i.master);return i.addChild(o),i.assignChildOrder(o),[o]},draw:function(e,t){var i=t;e[0].draw(i)}},(w=be=be||{}).PlotRegistry.markers={initialize:function(e,t,i){var r=me("<div></div>").attr("data-idd-name",e.displayName).appendTo(i.host),o=new w.Markers(r,i.master);return i.addChild(o),i.assignChildOrder(o),[o]},draw:function(e,t){e[0].draw(t,t.titles)}},S=o=o||{},(P=S.MarkerShape||(S.MarkerShape={})).Box="box",P.Circle="circle",P.Diamond="diamond",P.Cross="cross",P.Triangle="triangle",(k=S.HeatmapRenderType||(S.HeatmapRenderType={})).Gradient="gradient",k.Discrete="discrete",(M=S.LineTreatAs||(S.LineTreatAs={})).Function="function",M.Trajectory="trajectory",S.line=function(e){var t=e;return t.kind="line",t},S.area=function(e){var t=e;return t.kind="area",t},S.boxplot=function(e){var t=e;return t.kind="markers",t.shape="boxwhisker",t},S.markers=function(e){var t=e;return t.kind="markers",t},S.heatmap=function(e){var t=e;return t.kind="heatmap",t},function(w){if(I){var e=function(){function r(e,t,i,r,o){var n=e.getAttribute("data-idd-plot")||e.parentElement.getAttribute("data-idd-plot");if(!a.hasOwnProperty(n))throw new Error("There is no bindings registered for "+n+" plot");a[n](e,t,i,r,o)}var a={};this.registerPlotBinding=function(e,t,i){a[e]=t,i.forEach(function(e){I.bindingHandlers[e]={update:r}})}};w.KnockoutBindings=new e,I.bindingHandlers.iddPlotName={update:function(e,t,i,r,o){var n=t(),a=I.unwrap(n);null!=e.getAttribute("data-idd-plot")&&(void 0!==e.plot?e.plot.name=a:e.setAttribute("data-idd-name",a))}},I.bindingHandlers.iddIgnoredByFitToView={update:function(e,t,i,r,o){var n=t(),a=I.unwrap(n);null!=e.getAttribute("data-idd-plot")&&(void 0!==e.plot?e.plot.isIgnoredByFitToView=a:w.Utils.updateStyle(e,style,"ignored-by-fit-to-view",a))}},I.bindingHandlers.iddIgnoredByFitToViewX={update:function(e,t,i,r,o){var n=t(),a=I.unwrap(n);null!=e.getAttribute("data-idd-plot")&&(void 0!==e.plot?e.plot.isIgnoredByFitToViewX=a:w.Utils.updateStyle(e,style,"ignored-by-fit-to-view-x",a))}},I.bindingHandlers.iddIgnoredByFitToViewY={update:function(e,t,i,r,o){var n=t(),a=I.unwrap(n);null!=e.getAttribute("data-idd-plot")&&(void 0!==e.plot?e.plot.isIgnoredByFitToViewY=a:w.Utils.updateStyle(e,style,"ignored-by-fit-to-view-y",a))}},I.bindingHandlers.iddXlog={update:function(e,t,i,r,o){var n=t(),a=I.unwrap(n);if(null!=e.getAttribute("data-idd-plot"))if(void 0!==e.plot){var s,l=e.plot.master,d=l.getAxes("bottom")[0];s=a?(e.plot.xDataTransform=w.logTransform,l.addAxis("bottom","log",!0,d.host[0])):(e.plot.xDataTransform=w.identity,l.addAxis("bottom","numeric",!0,d.host[0])),l.removeDiv(d.host[0]),d.destroy(),l.getPlotsSequence().filter(function(e){return"xAxis"in e}).forEach(function(e){e.xAxis=l.get(s[0])}),s.dataTransform=e.plot.xDataTransform;var h=w.Gestures.applyHorizontalBehavior(w.Gestures.getGesturesStream(s));e.plot.master.navigation.gestureSource=e.plot.master.navigation.gestureSource.merge(h)}else e.setAttribute("data-idd-X-log",a)}},I.bindingHandlers.iddYlog={update:function(e,t,i,r,o){var n=t(),a=I.unwrap(n);if(null!=e.getAttribute("data-idd-plot"))if(void 0!==e.plot){var s,l=e.plot.master,d=l.getAxes("left")[0];s=a?(e.plot.yDataTransform=w.logTransform,l.addAxis("left","log",!0,d.host[0])):(e.plot.yDataTransform=w.identityTransform,l.addAxis("left","numeric",!0,d.host[0])),l.removeDiv(d.host[0]),d.destroy(),l.getPlotsSequence().filter(function(e){return"yAxis"in e}).forEach(function(e){e.yAxis=l.get(s[0])}),s.dataTransform=e.plot.yDataTransform;var h=w.Gestures.applyVerticalBehavior(w.Gestures.getGesturesStream(s));e.plot.master.navigation.gestureSource=e.plot.master.navigation.gestureSource.merge(h)}else e.setAttribute("data-idd-Y-log",a)}},I.bindingHandlers.iddPlotTitles={update:function(e,t,i,r,o){var n=t(),a=I.unwrap(n);null!=e.getAttribute("data-idd-plot")&&void 0!==e.plot&&e.plot.setTitles(a)}},I.bindingHandlers.iddEditorColorPalette={update:function(e,t,i,r,o){var n=t(),a=I.unwrap(n);me(e).hasClass("idd-colorPaletteEditor")&&void 0!==e.editor&&(e.editor.palette=a)}},I.bindingHandlers.iddXAxisSettings={update:function(e,t,i,r,o){var n=t(),a=I.unwrap(n);if(void 0!==e.plot){var s=e.plot.master,l=s.getAxes("bottom")[0].host,d=s.getAxes("left")[0].host,h=l.attr("data-idd-axis");if(null!=h&&a.type){var g=l.attr("data-idd-placement");if(void 0!==l.axis){var c=me(l).closest("div[data-idd-plot]");if(h!=a.type){var u=s.onDataTranformChangedCore;s.onDataTranformChangedCore=function(e){},"log"==a.type?s.xDataTransform=w.logTransform:s.xDataTransform=w.identityTransform,s.onDataTranformChangedCore=u;var f=c[0].plot.addAxis(g,a.type,{labels:a.labels?a.labels:[],ticks:a.ticks?a.ticks:[],rotate:a.rotate,rotateAngle:a.rotateAngle},l[0]);l.axis.remove(),l=f}else"labels"==h&&l.axis.updateLabels({labels:a.labels,ticks:a.ticks,rotate:a.rotate,rotateAngle:a.rotateAngle});if(void 0!==a.fontSize&&a.fontSize&&(l.axis.FontSize=a.fontSize),void 0!==a.attachGrid&&a.attachGrid&&void 0!==c[0].plot)for(var p=c[0].plot.getPlotsSequence(),v=0;v<p.length;v++){var m=p[v];if(m instanceof w.GridlinesPlot){m.xAxis=l.axis,m.requestUpdateLayout();break}}if(void 0!==a.attachNavigation&&a.attachNavigation&&void 0!==c[0].plot){var y=w.Gestures.getGesturesStream(s.centralPart),b=w.Gestures.applyHorizontalBehavior(w.Gestures.getGesturesStream(l)),C=w.Gestures.applyVerticalBehavior(w.Gestures.getGesturesStream(d));s.navigation.gestureSource=y.merge(b.merge(C))}"log"==a.type?l.dataTransform=w.logTransform:l.dataTransform=w.identityTransform}}}}},I.bindingHandlers.iddYAxisSettings={update:function(e,t,i,r,o){var n=t(),a=I.unwrap(n);if(void 0!==e.plot){var s=e.plot.master,l="left",d=s.getAxes(l)[0].host,h=s.getAxes("bottom")[0].host,g=d.attr("data-idd-axis");if(null!=g&&a.type){l=d.attr("data-idd-placement");if(void 0!==d.axis){var c=me(d).closest("div[data-idd-plot]");if(g!=a.type){var u=s.onDataTranformChangedCore;s.onDataTranformChangedCore=function(e){},"log"==a.type?s.yDataTransform=w.logTransform:s.yDataTransform=w.identityTransform,s.onDataTranformChangedCore=u;var f=c[0].plot.addAxis(l,a.type,{labels:a.labels?a.labels:[],ticks:a.ticks?a.ticks:[],rotate:a.rotate,rotateAngle:a.rotateAngle},d[0]);d.axis.remove(),d=f}else"labels"==g&&d.axis.updateLabels({labels:a.labels,ticks:a.ticks,rotate:a.rotate,rotateAngle:a.rotateAngle});if(void 0!==a.fontSize&&a.fontSize&&(d.axis.FontSize=a.fontSize),void 0!==a.attachGrid&&a.attachGrid&&void 0!==c[0].plot)for(var p=c[0].plot.getPlotsSequence(),v=0;v<p.length;v++){var m=p[v];if(m instanceof w.GridlinesPlot){m.yAxis=d.axis,m.requestUpdateLayout();break}}if(void 0!==a.attachNavigation&&a.attachNavigation&&void 0!==c[0].plot){var y=w.Gestures.getGesturesStream(s.centralPart),b=w.Gestures.applyVerticalBehavior(w.Gestures.getGesturesStream(d)),C=w.Gestures.applyHorizontalBehavior(w.Gestures.getGesturesStream(h));s.navigation.gestureSource=y.merge(C.merge(b))}"log"==a.type?d.dataTransform=w.logTransform:d.dataTransform=w.identityTransform}}}}},I.bindingHandlers.iddPlotOrder={update:function(e,t,i,r,o){var n=t(),a=I.unwrap(n);void 0!==e.plot?e.plot.order=Number(a):e.setAttribute("data-idd-plot-order",a)}},I.bindingHandlers.iddAutoFitMode={update:function(e,t,i,r,o){var n=t(),a=I.unwrap(n);if(null!=e.getAttribute("data-idd-plot"))if(void 0!==e.plot)switch(typeof a){case"boolean":e.plot.isAutoFitEnabled=a;break;case"string":if("true"===a||"enable"===a||"enabled"===a)e.plot.isAutoFitEnabled=!0;else if("false"===a||"disable"===a||"disabled"===a)e.plot.isAutoFitEnabled=!1;else{var s=a.slice(0,7),l=a.slice(-1);if("bounds("!==s||")"!==l)throw"iddAutoFitMode binding value can be 'enable'/'disable' string or 'bounds(x1,x2,y1,y2)' string";var d=a.slice(7,-1).split(/[ ,]+/);if(4!=d.length)throw"iddAutoFitMode binding value should conform the 'bounds(x1,x2,y1,y2)' pattern";for(var h=0;h<4;h++)isNaN(parseFloat(d[h]))?("auto"!==d[h]&&console.log("iddAutoFitMode bounds should be set by numbers or 'auto' string. Changing "+d[h]+" value to 'auto'"),d[h]="auto"):d[h]=parseFloat(d[h]);e.plot.isAutoFitEnabled=d}break;default:throw"unknown value type for iddAutoFitMode binding"}else e.setAttribute("data-idd-visible-region",a)}}}else console.log("Knockout was no found, please load Knockout first")}(be=be||{}),function(e){if(I){e.KnockoutBindings.registerPlotBinding("markers",function(e,t,i,r,o){var n={};if(!i.has("iddX"))throw new Error("Please define iddX binding for marker plot");n.x=I.unwrap(i.get("iddX"));var a=n.x.length;if(i.has("iddShape")&&(n.shape=I.unwrap(i.get("iddShape"))),"boxwhisker"==n.shape){if(i.has("iddSize")&&(n.size=I.unwrap(i.get("iddSize")),n.size.constructor===Array&&(console.warn("Ignoring markers (boxwhisker) iddSize binding. It must be number, not an array!"),delete n.size)),i.has("iddColor")&&(n.color=I.unwrap(i.get("iddColor")),n.color.constructor===Array&&(console.warn("Ignoring markers (boxwhisker) iddColor binding. It must be string, not an array!"),delete n.color)),i.has("iddBorder")&&(n.border=I.unwrap(i.get("iddBorder")),n.border.constructor===Array&&(console.warn("Ignoring markers (boxwhisker) iddBorder binding. It must be string, not an array!"),delete n.border)),i.has("iddThickness")&&(n.thickness=I.unwrap(i.get("iddThickness"))),!i.has("iddYMedian"))throw new Error('Please define iddYMedian binding for "boxwhisker" marker shape');if(n.y={median:I.unwrap(i.get("iddYMedian"))},n.y.median.length!=a)return;if(i.has("iddLower68")&&i.has("iddLower68")&&(n.y.lower68=I.unwrap(i.get("iddLower68")),n.y.upper68=I.unwrap(i.get("iddUpper68")),n.y.lower68.length!=a||n.y.upper68.length!=a))return;if(i.has("iddUpper95")&&i.has("iddLower95")&&(n.y.upper95=I.unwrap(i.get("iddUpper95")),n.y.lower95=I.unwrap(i.get("iddLower95")),n.y.lower95.length!=a||n.y.upper95.length!=a))return}else if("petals"==n.shape){if(!(i.has("iddY")&&i.has("iddUpper95")&&i.has("iddLower95")))throw new Error('Please define iddY, iddLower95, iddUpper95 bindings for "petals" marker shape');if(n.y=I.unwrap(i.get("iddY")),n.size={},n.size.upper95=I.unwrap(i.get("iddUpper95")),n.size.lower95=I.unwrap(i.get("iddLower95")),n.size.lower95.length!=a||n.size.upper95.length!=a||n.y.length!=a)return}else if("bulleye"==n.shape){if(!(i.has("iddY")&&i.has("iddUpper95")&&i.has("iddLower95")))throw new Error('Please define iddY, iddLower95, iddUpper95 bindings for "bulleye" marker shape');if(i.has("iddSize")&&(n.size=I.unwrap(i.get("iddSize")),n.size.constructor===Array&&(console.warn("Ignoring markers (bulleye) iddSize binding. It must be number, not an array!"),delete n.size)),n.y=I.unwrap(i.get("iddY")),n.color={},n.color.upper95=I.unwrap(i.get("iddUpper95")),n.color.lower95=I.unwrap(i.get("iddLower95")),n.color.lower95.length!=a||n.color.upper95.length!=a||n.y.length!=a)return}else{if(i.has("iddY")&&(n.y=I.unwrap(i.get("iddY"))),n.x&&n.y&&n.x.length!==n.y.length)return;if(i.has("iddColor")&&(n.color=I.unwrap(i.get("iddColor"))),n.y&&n.color&&Array.isArray(n.color)&&n.color.length!==n.y.length)return;var s,l=void 0;i.has("iddSize")&&(n.size=I.unwrap(i.get("iddSize"))),i.has("iddBorder")&&(n.border=I.unwrap(i.get("iddBorder"))),i.has("iddColorPalette")&&(n.colorPalette=I.unwrap(i.get("iddColorPalette"))),i.has("iddBarWidth")&&(n.barWidth=I.unwrap(i.get("iddBarWidth"))),i.has("iddShadow")&&(n.shadow=I.unwrap(i.get("iddShadow"))),i.has("iddOrientation")&&(n.orientation=I.unwrap(i.get("iddOrientation"))),i.has("iddLabelPlacement")&&(n.placement=I.unwrap(i.get("iddLabelPlacement"))),i.has("iddCustomShape")&&(s=I.unwrap(i.get("iddCustomShape"))),i.has("iddPlotTitles")&&(l=I.unwrap(i.get("iddPlotTitles")))}if(null!=e.getAttribute("data-idd-plot"))if(void 0!==e.plot){if(s)for(var d in s)n[d]=I.unwrap(s[d]);e.plot.draw(n,l)}else e.setAttribute("data-idd-datasource",JSON.stringify(n))},["iddX","iddY","iddYMedian","iddMedian","iddLower68","iddUpper68","iddLower95","iddUpper95","iddShape","iddSize","iddBorder","iddThickness","iddColor","iddColorPalette","iddBarWidth","iddShadow","iddOrientation","iddCustomShape","iddLabelPlacement"])}else console.log("Knockout was no found, please load Knockout first")}(be=be||{}),function(e){if(I){e.KnockoutBindings.registerPlotBinding("polyline",function(e,t,i,r,o){var n,a={};if(i.has("iddY"))a.y=I.unwrap(i.get("iddY"));else{if(!i.has("iddYMedian"))throw new Error("Please define iddY or iddYMedian binding along with iddX");a.y={median:I.unwrap(i.get("iddYMedian"))},i.has("iddLower68")&&(a.y.lower68=I.unwrap(i.get("iddLower68"))),i.has("iddUpper68")&&(a.y.upper68=I.unwrap(i.get("iddUpper68"))),i.has("iddUpper95")&&(a.y.upper95=I.unwrap(i.get("iddUpper95"))),i.has("iddLower95")&&(a.y.lower95=I.unwrap(i.get("iddLower95")))}if(!i.has("iddX"))throw new Error("Please define iddX binding along with iddY");if(a.x=I.unwrap(i.get("iddX")),!Array.isArray(a.x))throw new Error("iddX is not an array");if(n=a.x.length,Array.isArray(a.y)){if(a.y.length!==n)return}else if(Array.isArray(a.y.median)){if(a.y.median.length!==n)return;if(Array.isArray(a.y.lower68)&&a.y.lower68.length!==n)return;if(Array.isArray(a.y.upper68)&&a.y.upper68.length!==n)return;if(Array.isArray(a.y.lower95)&&a.y.lower95.length!==n)return;if(Array.isArray(a.y.upper95)&&a.y.upper95.length!==n)return}i.has("iddStroke")&&(a.stroke=I.unwrap(i.get("iddStroke"))),i.has("iddThickness")&&(a.thickness=I.unwrap(i.get("iddThickness"))),i.has("iddLineCap")&&(a.lineCap=I.unwrap(i.get("iddLineCap"))),i.has("iddLineJoin")&&(a.lineJoin=I.unwrap(i.get("iddLineJoin"))),i.has("iddFill68")&&(a.fill68=I.unwrap(i.get("iddFill68"))),i.has("iddFill95")&&(a.fill95=I.unwrap(i.get("iddFill95"))),i.has("iddLineDash")&&(a.lineDash=I.unwrap(i.get("iddLineDash"))),null!=e.getAttribute("data-idd-plot")&&(void 0!==e.plot?e.plot.draw(a):e.setAttribute("data-idd-datasource",JSON.stringify(a)))},["iddX","iddY","iddYMedian","iddLower68","iddUpper68","iddLower95","iddUpeer95","iddFill68","iddFill95","iddStroke","iddThickness","iddLineCap","iddLineJoin","iddLineDash"])}else console.log("Knockout was no found, please load Knockout first")}(be=be||{}),function(e){if(I){e.KnockoutBindings.registerPlotBinding("dom",function(t,e,i,r,o){var n,a,s,l;if(!i.has("iddY"))throw new Error("Please define iddY binding along with iddX");if(a=I.unwrap(i.get("iddY")),!i.has("iddX"))throw new Error("Please define iddX binding along with iddY");if(n=I.unwrap(i.get("iddX")),i.has("iddWidth")&&(s=I.unwrap(i.get("iddWidth"))),i.has("iddHeight")&&(l=I.unwrap(i.get("iddHeight"))),void 0!==t.parentElement.plot){var d=t.parentElement.plot;if(void 0!==d.domElements){d.domElements.some(function(e){return e[0]===t})?d.set(t,n,a,s,l,.5,1):d.add(t,"none",n,a,s,l,.5,1)}}},["iddX","iddY","iddWidth","iddHeight"])}else console.log("Knockout was no found, please load Knockout first")}(be=be||{}),function(e){if(I){e.KnockoutBindings.registerPlotBinding("area",function(e,t,i,r,o){var n,a={};if(!i.has("iddY1"))throw new Error("Please define iddY1 and iddY2 bindings along with iddX");if(a.y1=I.unwrap(i.get("iddY1")),!i.has("iddY2"))throw new Error("Please define iddY1 and iddY2 bindings along with iddX");if(a.y2=I.unwrap(i.get("iddY2")),!i.has("iddX"))throw new Error("Please define iddX binding along with iddY1 and iddY2");if(a.x=I.unwrap(i.get("iddX")),!Array.isArray(a.x))throw new Error("iddX is not an array");n=a.x.length,Array.isArray(a.y1)&&a.y1.length!==n||(Array.isArray(a.y2)&&a.y2.length!==n||(i.has("iddFill")&&(a.fill=I.unwrap(i.get("iddFill"))),i.has("iddOpacity")&&(a.opacity=I.unwrap(i.get("iddOpacity"))),null!=e.getAttribute("data-idd-plot")&&(void 0!==e.plot?e.plot.draw(a):e.setAttribute("data-idd-datasource",JSON.stringify(a)))))},["iddX","iddY1","iddY2","iddFill","iddOpacity"])}else console.log("Knockout was no found, please load Knockout first")}(be=be||{}),function(e){if(I){e.KnockoutBindings.registerPlotBinding("heatmap",function(e,t,i,r,o){var n={};if(!i.has("iddX"))throw new Error("Please define iddX and iddY");if(n.x=I.unwrap(i.get("iddX")),!i.has("iddY"))throw new Error("Please define iddX and iddY");if(n.y=I.unwrap(i.get("iddY")),!i.has("iddValues"))throw new Error("Please define iddValues binding along with iddX and iddY");n.values=I.unwrap(i.get("iddValues"));var a=n.x.length,s=n.y.length;if(!(n.values.length!==a||!Array.isArray(n.values[0])||n.values[0].length!==s||a<2||s<2)){var l=void 0;if(i.has("iddInterval")&&(n.interval=I.unwrap(i.get("iddInterval"))),i.has("iddColorPalette")&&(n.colorPalette=I.unwrap(i.get("iddColorPalette"))),i.has("iddOpacity")&&(n.opacity=I.unwrap(i.get("iddOpacity"))),i.has("iddPlotTitles")&&(l=I.unwrap(i.get("iddPlotTitles"))),i.has("iddLogColors")&&(n.logPalette=I.unwrap(i.get("iddLogColors"))),i.has("iddLogTolerance")&&(n.logTolerance=I.unwrap(i.get("iddLogTolerance"))),null!=e.getAttribute("data-idd-plot"))if(void 0!==e.plot)e.plot.draw(n,l);else{var d="(function(){return "+JSON.stringify(n)+"})";e.setAttribute("data-idd-datasource",d)}}},["iddX","iddY","iddValues","iddOpacity","iddColorPalette","iddInterval"])}else console.log("Knockout was no found, please load Knockout first")}(be=be||{}),function(c){if(I){c.KnockoutBindings.registerPlotBinding("label",function(e,t,i,r,o){var n=[],a=[],s=[],l=[];if(!i.has("iddX"))throw new Error("Please define iddX and iddY");if(a=I.unwrap(i.get("iddX")),!i.has("iddY"))throw new Error("Please define iddX and iddY");if(s=I.unwrap(i.get("iddY")),!i.has("iddLabelsText"))throw new Error("Please define iddLabelsText binding along with iddX and iddY");if(l=I.unwrap(i.get("iddLabelsText")),a.length==s.length&&a.length==l.length){for(var d=0;d<a.length;d++)n.push({text:l[d],position:{x:a[d],y:s[d]}});null!=e.getAttribute("data-idd-plot")&&(void 0!==e.plot?e.plot.draw(n):e.setAttribute("data-idd-datasource",JSON.stringify(n)))}},["iddX","iddY","iddLabelsText"]),I.bindingHandlers.iddBottomAxisLabels={update:function(e,t,i,r,o){var n=t(),a=I.unwrap(n);if(null!=e.getAttribute("data-idd-plot")&&void 0!==e.plot){if(void 0===e.plot.addAxis)throw"The target for the iddBottomAxisLabels binding must be figure or derived.";var s=e.plot.getAxes("bottom");if(void 0!==s)for(var l=0;l<s.length;l++){"true"==s[l].host.data("iddBottomAxisLabels")&&s[l].remove()}var d=e.plot.addAxis("bottom","labels",{labels:a.labels,ticks:a.ticks,rotateAngle:a.rotateAngle});if(d.data("iddBottomAxisLabels","true"),void 0!==a.attachGrid&&a.attachGrid){var h=e.plot.getPlotsSequence();for(l=0;l<h.length;l++){var g=h[l];if(g instanceof c.GridlinesPlot){g.xAxis=d.axis;break}}}}}}}else console.log("Knockout was no found, please load Knockout first")}(be=be||{}),function(e){if(I){e.KnockoutBindings.registerPlotBinding("boundaryLine",function(e,t,i,r,o){var n={};if(i.has("iddX")){if(i.has("iddY"))throw new Error("Please define either iddX or iddY binding");n.x=I.unwrap(i.get("iddX"))}else{if(!i.has("iddY"))throw new Error("Please define iddX or iddY binding");n.y=I.unwrap(i.get("iddY"))}i.has("iddStroke")&&(n.stroke=I.unwrap(i.get("iddStroke"))),i.has("iddThickness")&&(n.thickness=I.unwrap(i.get("iddThickness"))),i.has("iddLineDash")&&(n.lineDash=I.unwrap(i.get("iddLineDash"))),null!=e.getAttribute("data-idd-plot")&&(void 0!==e.plot?e.plot.draw(n):e.setAttribute("data-idd-datasource",JSON.stringify(n)))},["iddX","iddY","iddStroke","iddThickness","iddLineDash"])}else console.log("Knockout was no found, please load Knockout first")}(be=be||{}),be}!function(){if(window.define)define(["jquery","rx","knockout","svg","filesaver","jqueryui","jquery-mousewheel"],function(e,t,i,r,o){return IDD(e,t,i,r,o)});else{var e=IDD($,Rx,ko,SVG,saveAs);window.InteractiveDataDisplay=e}}();
//# sourceMappingURL=idd_knockout.min.js.map